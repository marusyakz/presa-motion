/*! For license information please see main.f8134872.js.LICENSE.txt */
(()=>{var e={724:function(e){e.exports=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var i=n(1),r=function(){function e(e,t,n){void 0===e&&(e=NaN),void 0===t&&(t=NaN),void 0===n&&(n=!1),this._minFPS=t,this._maxFPS=e,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new i.default,this._onPause=new i.default,this._onTick=new i.default,this._onTickOncePerFrame=new i.default,n||this.resume()}return e.prototype.updateOnce=function(e){e(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},e.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},e.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(e.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){this._timeScale!==e&&(this._timeScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),e.prototype.animateOnce=function(){var e=this;this._animationFrameHandle=window.requestAnimationFrame((function(){return e.onFrame()}))},e.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},e.prototype.update=function(e,t){void 0===t&&(t=!0),this._currentTick++,this._currentTime+=e,this._tickDeltaTime=e,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),t&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.getTimer=function(){return Date.now()},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";var n=function(){function e(){this.functions=[]}return e.prototype.add=function(e){return-1===this.functions.indexOf(e)&&(this.functions.push(e),!0)},e.prototype.remove=function(e){var t=this.functions.indexOf(e);return t>-1&&(this.functions.splice(t,1),!0)},e.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},e.prototype.dispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.functions.concat().forEach((function(t){t.apply(void 0,e)}))},Object.defineProperty(e.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}])}))}])},497:(e,t,n)=>{"use strict";var i=n(218);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,o){if(o!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},173:(e,t,n)=>{e.exports=n(497)()},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},120:e=>{e.exports=function(e,t,n,i){var r=0,s=0,o=(i=i||{}).step||1,a=i.maxTimeMS||8,l=i.probeElements||5e3;setTimeout((function i(){var c=Math.min(e.length,r+l),u=r,h=new Date;for(u=r;u<c;u+=o)t(e[u],u,e);u<e.length?(s+=new Date-h,r=u,l=Math.round(r*a/s),setTimeout(i,0)):n(e)}),0)}},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},A={};function f(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(A,e)||!h.call(p,e)&&(d.test(e)?A[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,v);m[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,v);m[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,v);m[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var k,B=Object.assign;function F(e){if(void 0===k)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return"\n"+k+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function q(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case _:return"Portal";case T:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function j(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=H(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=j(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=j(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,j(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+j(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:j(n)}}function se(e,t){var n=j(t.value),i=j(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function Ae(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=Ae(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,_e=null,we=null;function Se(e){if(e=fr(e)){if("function"!==typeof xe)throw Error(s(280));var t=e.stateNode;t&&(t=gr(t),xe(e.stateNode,e.type,t))}}function Te(e){_e?we?we.push(e):we=[e]:_e=e}function Me(){if(_e){var e=_e,t=we;if(we=_e=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var Re=!1;function Pe(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ee(e,t,n)}finally{Re=!1,(null!==_e||null!==we)&&(Ce(),Me())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var i=gr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){De=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(eu){De=!1}function Ie(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,ke=null,Be=!1,Fe=null,Ue={onError:function(e){Oe=!0,ke=e}};function ze(e,t,n,i,r,s,o,a,l){Oe=!1,ke=null,Ie.apply(Ue,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(qe(e)!==e)throw Error(s(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Ge(r),e;if(o===i)return Ge(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var We=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Qe=r.unstable_requestPaint,Ke=r.unstable_now,Ze=r.unstable_getCurrentPriorityLevel,Je=r.unstable_ImmediatePriority,$e=r.unstable_UserBlockingPriority,et=r.unstable_NormalPriority,tt=r.unstable_LowPriority,nt=r.unstable_IdlePriority,it=null,rt=null;var st=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ot(e)/at|0)|0},ot=Math.log,at=Math.LN2;var lt=64,ct=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ut(a):0!==(s&=o)&&(i=ut(s))}else 0!==(o=n&~r)?i=ut(o):0!==s&&(i=ut(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-st(t)),i|=e[n],t&=~r;return i}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function At(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-st(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var vt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,xt,_t,wt,St,Tt=!1,Mt=[],Et=null,Ct=null,Rt=null,Pt=new Map,Nt=new Map,Dt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Ot(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=fr(t))&&xt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function kt(e){var t=Ar(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void St(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=fr(n))&&xt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ye=i,n.target.dispatchEvent(i),ye=null,t.shift()}return!0}function Ft(e,t,n){Bt(e)&&n.delete(t)}function Ut(){Tt=!1,null!==Et&&Bt(Et)&&(Et=null),null!==Ct&&Bt(Ct)&&(Ct=null),null!==Rt&&Bt(Rt)&&(Rt=null),Pt.forEach(Ft),Nt.forEach(Ft)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function qt(e){function t(t){return zt(t,e)}if(0<Mt.length){zt(Mt[0],e);for(var n=1;n<Mt.length;n++){var i=Mt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Et&&zt(Et,e),null!==Ct&&zt(Ct,e),null!==Rt&&zt(Rt,e),Pt.forEach(t),Nt.forEach(t),n=0;n<Dt.length;n++)(i=Dt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)kt(n),null===n.blockedOn&&Dt.shift()}var Vt=b.ReactCurrentBatchConfig,Gt=!0;function jt(e,t,n,i){var r=vt,s=Vt.transition;Vt.transition=null;try{vt=1,Wt(e,t,n,i)}finally{vt=r,Vt.transition=s}}function Ht(e,t,n,i){var r=vt,s=Vt.transition;Vt.transition=null;try{vt=4,Wt(e,t,n,i)}finally{vt=r,Vt.transition=s}}function Wt(e,t,n,i){if(Gt){var r=Yt(e,t,n,i);if(null===r)zi(e,t,i,Xt,n),It(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Et=Ot(Et,e,t,n,i,r),!0;case"dragenter":return Ct=Ot(Ct,e,t,n,i,r),!0;case"mouseover":return Rt=Ot(Rt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Pt.set(s,Ot(Pt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Nt.set(s,Ot(Nt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(It(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var s=fr(r);if(null!==s&&bt(s),null===(s=Yt(e,t,n,i))&&zi(e,t,i,Xt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else zi(e,t,i,null,n)}}var Xt=null;function Yt(e,t,n,i){if(Xt=null,null!==(e=Ar(e=be(i))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case $e:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Kt=null,Zt=null,Jt=null;function $t(){if(Jt)return Jt;var e,t,n=Zt,i=n.length,r="value"in Kt?Kt.value:Kt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Jt=r.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function rn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var sn,on,an,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=rn(ln),un=B({},ln,{view:0,detail:0}),hn=rn(un),dn=B({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==an&&(an&&"mousemove"===e.type?(sn=e.screenX-an.screenX,on=e.screenY-an.screenY):on=sn=0,an=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=rn(dn),An=rn(B({},dn,{dataTransfer:0})),fn=rn(B({},un,{relatedTarget:0})),mn=rn(B({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=rn(B({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),vn=rn(B({},ln,{data:0})),yn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function wn(){return _n}var Sn=rn(B({},un,{key:function(e){if(e.key){var t=yn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Tn=rn(B({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mn=rn(B({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wn})),En=rn(B({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=rn(B({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Rn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,Nn=null;u&&"documentMode"in document&&(Nn=document.documentMode);var Dn=u&&"TextEvent"in window&&!Nn,Ln=u&&(!Pn||Nn&&8<Nn&&11>=Nn),In=String.fromCharCode(32),On=!1;function kn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function qn(e,t,n,i){Te(i),0<(t=Vi(t,"onChange")).length&&(n=new cn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Vn=null,Gn=null;function jn(e){Ii(e,0)}function Hn(e){if(X(mr(e)))return e}function Wn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Yn;if(u){var Qn="oninput"in document;if(!Qn){var Kn=document.createElement("div");Kn.setAttribute("oninput","return;"),Qn="function"===typeof Kn.oninput}Yn=Qn}else Yn=!1;Xn=Yn&&(!document.documentMode||9<document.documentMode)}function Zn(){Vn&&(Vn.detachEvent("onpropertychange",Jn),Gn=Vn=null)}function Jn(e){if("value"===e.propertyName&&Hn(Gn)){var t=[];qn(t,Gn,e,be(e)),Pe(jn,t)}}function $n(e,t,n){"focusin"===e?(Zn(),Gn=n,(Vn=t).attachEvent("onpropertychange",Jn)):"focusout"===e&&Zn()}function ei(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Hn(Gn)}function ti(e,t){if("click"===e)return Hn(t)}function ni(e,t){if("input"===e||"change"===e)return Hn(t)}var ii="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ri(e,t){if(ii(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!ii(e[r],t[r]))return!1}return!0}function si(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function oi(e,t){var n,i=si(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=si(i)}}function ai(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ai(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function li(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function ci(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ui(e){var t=li(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ai(n.ownerDocument.documentElement,n)){if(null!==i&&ci(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=oi(n,s);var o=oi(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hi=u&&"documentMode"in document&&11>=document.documentMode,di=null,pi=null,Ai=null,fi=!1;function mi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;fi||null==di||di!==Y(i)||("selectionStart"in(i=di)&&ci(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},Ai&&ri(Ai,i)||(Ai=i,0<(i=Vi(pi,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=di)))}function gi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var vi={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionend:gi("Transition","TransitionEnd")},yi={},bi={};function xi(e){if(yi[e])return yi[e];if(!vi[e])return e;var t,n=vi[e];for(t in n)if(n.hasOwnProperty(t)&&t in bi)return yi[e]=n[t];return e}u&&(bi=document.createElement("div").style,"AnimationEvent"in window||(delete vi.animationend.animation,delete vi.animationiteration.animation,delete vi.animationstart.animation),"TransitionEvent"in window||delete vi.transitionend.transition);var _i=xi("animationend"),wi=xi("animationiteration"),Si=xi("animationstart"),Ti=xi("transitionend"),Mi=new Map,Ei="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(e,t){Mi.set(e,t),l(t,[e])}for(var Ri=0;Ri<Ei.length;Ri++){var Pi=Ei[Ri];Ci(Pi.toLowerCase(),"on"+(Pi[0].toUpperCase()+Pi.slice(1)))}Ci(_i,"onAnimationEnd"),Ci(wi,"onAnimationIteration"),Ci(Si,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(Ti,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ni="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ni));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(ze.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=ke;Oe=!1,ke=null,Be||(Be=!0,Fe=u)}}(i,t,void 0,e),e.currentTarget=null}function Ii(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Li(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Li(r,a,c),s=l}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Oi(e,t){var n=t[hr];void 0===n&&(n=t[hr]=new Set);var i=e+"__bubble";n.has(i)||(Ui(t,e,2,!1),n.add(i))}function ki(e,t,n){var i=0;t&&(i|=4),Ui(n,e,i,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function Fi(e){if(!e[Bi]){e[Bi]=!0,o.forEach((function(t){"selectionchange"!==t&&(Di.has(t)||ki(t,!1,e),ki(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bi]||(t[Bi]=!0,ki("selectionchange",!1,t))}}function Ui(e,t,n,i){switch(Qt(t)){case 1:var r=jt;break;case 4:r=Ht;break;default:r=Wt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function zi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=Ar(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Pe((function(){var i=s,r=be(n),o=[];e:{var a=Mi.get(e);if(void 0!==a){var l=cn,c=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=fn;break;case"focusout":c="blur",l=fn;break;case"beforeblur":case"afterblur":l=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=An;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mn;break;case _i:case wi:case Si:l=mn;break;case Ti:l=En;break;case"scroll":l=hn;break;case"wheel":l=Cn;break;case"copy":case"cut":case"paste":l=gn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,A=i;null!==A;){var f=(p=A).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==d&&(null!=(f=Ne(A,d))&&u.push(qi(A,f,p)))),h)break;A=A.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!Ar(c)&&!c[ur])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?Ar(c):null)&&(c!==(h=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,f="onMouseLeave",d="onMouseEnter",A="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,f="onPointerLeave",d="onPointerEnter",A="pointer"),h=null==l?a:mr(l),p=null==c?a:mr(c),(a=new u(f,A+"leave",l,n,r)).target=h,a.relatedTarget=p,f=null,Ar(r)===i&&((u=new u(d,A+"enter",c,n,r)).target=p,u.relatedTarget=h,f=u),h=f,l&&c)e:{for(d=c,A=0,p=u=l;p;p=Gi(p))A++;for(p=0,f=d;f;f=Gi(f))p++;for(;0<A-p;)u=Gi(u),A--;for(;0<p-A;)d=Gi(d),p--;for(;A--;){if(u===d||null!==d&&u===d.alternate)break e;u=Gi(u),d=Gi(d)}u=null}else u=null;null!==l&&ji(o,a,l,u,!1),null!==c&&null!==h&&ji(o,h,c,u,!0)}if("select"===(l=(a=i?mr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Wn;else if(zn(a))if(Xn)m=ni;else{m=ei;var g=$n}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ti);switch(m&&(m=m(e,i))?qn(o,m,n,r):(g&&g(e,a,i),"focusout"===e&&(g=a._wrapperState)&&g.controlled&&"number"===a.type&&ee(a,"number",a.value)),g=i?mr(i):window,e){case"focusin":(zn(g)||"true"===g.contentEditable)&&(di=g,pi=i,Ai=null);break;case"focusout":Ai=pi=di=null;break;case"mousedown":fi=!0;break;case"contextmenu":case"mouseup":case"dragend":fi=!1,mi(o,n,r);break;case"selectionchange":if(hi)break;case"keydown":case"keyup":mi(o,n,r)}var v;if(Pn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Fn?kn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Ln&&"ko"!==n.locale&&(Fn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Fn&&(v=$t()):(Zt="value"in(Kt=r)?Kt.value:Kt.textContent,Fn=!0)),0<(g=Vi(i,y)).length&&(y=new vn(y,e,null,n,r),o.push({event:y,listeners:g}),v?y.data=v:null!==(v=Bn(n))&&(y.data=v))),(v=Dn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(On=!0,In);case"textInput":return(e=t.data)===In&&On?null:e;default:return null}}(e,n):function(e,t){if(Fn)return"compositionend"===e||!Pn&&kn(e,t)?(e=$t(),Jt=Zt=Kt=null,Fn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Vi(i,"onBeforeInput")).length&&(r=new vn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=v))}Ii(o,t)}))}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ne(e,n))&&i.unshift(qi(e,s,r)),null!=(s=Ne(e,t))&&i.push(qi(e,s,r))),e=e.return}return i}function Gi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function ji(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Ne(n,s))&&o.unshift(qi(n,l,a)):r||null!=(l=Ne(n,s))&&o.push(qi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Hi=/\r\n?/g,Wi=/\u0000|\uFFFD/g;function Xi(e){return("string"===typeof e?e:""+e).replace(Hi,"\n").replace(Wi,"")}function Yi(e,t,n){if(t=Xi(t),Xi(e)!==t&&n)throw Error(s(425))}function Qi(){}var Ki=null,Zi=null;function Ji(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var $i="function"===typeof setTimeout?setTimeout:void 0,er="function"===typeof clearTimeout?clearTimeout:void 0,tr="function"===typeof Promise?Promise:void 0,nr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof tr?function(e){return tr.resolve(null).then(e).catch(ir)}:$i;function ir(e){setTimeout((function(){throw e}))}function rr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void qt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);qt(t)}function sr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function or(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ar=Math.random().toString(36).slice(2),lr="__reactFiber$"+ar,cr="__reactProps$"+ar,ur="__reactContainer$"+ar,hr="__reactEvents$"+ar,dr="__reactListeners$"+ar,pr="__reactHandles$"+ar;function Ar(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ur]||n[lr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=or(e);null!==e;){if(n=e[lr])return n;e=or(e)}return t}n=(e=n).parentNode}return null}function fr(e){return!(e=e[lr]||e[ur])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function mr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function gr(e){return e[cr]||null}var vr=[],yr=-1;function br(e){return{current:e}}function xr(e){0>yr||(e.current=vr[yr],vr[yr]=null,yr--)}function _r(e,t){yr++,vr[yr]=e.current,e.current=t}var wr={},Sr=br(wr),Tr=br(!1),Mr=wr;function Er(e,t){var n=e.type.contextTypes;if(!n)return wr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Cr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rr(){xr(Tr),xr(Sr)}function Pr(e,t,n){if(Sr.current!==wr)throw Error(s(168));_r(Sr,t),_r(Tr,n)}function Nr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,G(e)||"Unknown",r));return B({},n,i)}function Dr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wr,Mr=Sr.current,_r(Sr,e),_r(Tr,Tr.current),!0}function Lr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Nr(e,t,Mr),i.__reactInternalMemoizedMergedChildContext=e,xr(Tr),xr(Sr),_r(Sr,e)):xr(Tr),_r(Tr,n)}var Ir=null,Or=!1,kr=!1;function Br(e){null===Ir?Ir=[e]:Ir.push(e)}function Fr(){if(!kr&&null!==Ir){kr=!0;var e=0,t=vt;try{var n=Ir;for(vt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Ir=null,Or=!1}catch(r){throw null!==Ir&&(Ir=Ir.slice(e+1)),We(Je,Fr),r}finally{vt=t,kr=!1}}return null}var Ur=[],zr=0,qr=null,Vr=0,Gr=[],jr=0,Hr=null,Wr=1,Xr="";function Yr(e,t){Ur[zr++]=Vr,Ur[zr++]=qr,qr=e,Vr=t}function Qr(e,t,n){Gr[jr++]=Wr,Gr[jr++]=Xr,Gr[jr++]=Hr,Hr=e;var i=Wr;e=Xr;var r=32-st(i)-1;i&=~(1<<r),n+=1;var s=32-st(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Wr=1<<32-st(t)+r|n<<r|i,Xr=s+e}else Wr=1<<s|n<<r|i,Xr=e}function Kr(e){null!==e.return&&(Yr(e,1),Qr(e,1,0))}function Zr(e){for(;e===qr;)qr=Ur[--zr],Ur[zr]=null,Vr=Ur[--zr],Ur[zr]=null;for(;e===Hr;)Hr=Gr[--jr],Gr[jr]=null,Xr=Gr[--jr],Gr[jr]=null,Wr=Gr[--jr],Gr[jr]=null}var Jr=null,$r=null,es=!1,ts=null;function ns(e,t){var n=Ec(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function is(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Jr=e,$r=sr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Jr=e,$r=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Hr?{id:Wr,overflow:Xr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ec(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Jr=e,$r=null,!0);default:return!1}}function rs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ss(e){if(es){var t=$r;if(t){var n=t;if(!is(e,t)){if(rs(e))throw Error(s(418));t=sr(n.nextSibling);var i=Jr;t&&is(e,t)?ns(i,n):(e.flags=-4097&e.flags|2,es=!1,Jr=e)}}else{if(rs(e))throw Error(s(418));e.flags=-4097&e.flags|2,es=!1,Jr=e}}}function os(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Jr=e}function as(e){if(e!==Jr)return!1;if(!es)return os(e),es=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Ji(e.type,e.memoizedProps)),t&&(t=$r)){if(rs(e))throw ls(),Error(s(418));for(;t;)ns(e,t),t=sr(t.nextSibling)}if(os(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){$r=sr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}$r=null}}else $r=Jr?sr(e.stateNode.nextSibling):null;return!0}function ls(){for(var e=$r;e;)e=sr(e.nextSibling)}function cs(){$r=Jr=null,es=!1}function us(e){null===ts?ts=[e]:ts.push(e)}var hs=b.ReactCurrentBatchConfig;function ds(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ps(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function As(e){return(0,e._init)(e._payload)}function fs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Lc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===w?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&As(s)===t.type)?((i=r(t,n.props)).ref=ds(e,t,n),i.return=e,i):((i=Pc(n.type,n.key,n.props,null,e.mode,i)).ref=ds(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ic(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Nc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=ds(e,null,t),n.return=e,n;case _:return(t=Ic(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Nc(t,e.mode,n,null)).return=e,t;ps(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?c(e,t,n,i):null;case _:return n.key===r?u(e,t,n,i):null;case D:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||O(n))return null!==r?null:h(e,t,n,i,null);ps(e,n)}return null}function A(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case _:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case D:return A(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||O(i))return h(t,e=e.get(n)||null,i,r,null);ps(t,i)}return null}function f(r,s,a,l){for(var c=null,u=null,h=s,f=s=0,m=null;null!==h&&f<a.length;f++){h.index>f?(m=h,h=null):m=h.sibling;var g=p(r,h,a[f],l);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(r,h),s=o(g,s,f),null===u?c=g:u.sibling=g,u=g,h=m}if(f===a.length)return n(r,h),es&&Yr(r,f),c;if(null===h){for(;f<a.length;f++)null!==(h=d(r,a[f],l))&&(s=o(h,s,f),null===u?c=h:u.sibling=h,u=h);return es&&Yr(r,f),c}for(h=i(r,h);f<a.length;f++)null!==(m=A(h,r,f,a[f],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?f:m.key),s=o(m,s,f),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(r,e)})),es&&Yr(r,f),c}function m(r,a,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,f=a,m=a=0,g=null,v=l.next();null!==f&&!v.done;m++,v=l.next()){f.index>m?(g=f,f=null):g=f.sibling;var y=p(r,f,v.value,c);if(null===y){null===f&&(f=g);break}e&&f&&null===y.alternate&&t(r,f),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y,f=g}if(v.done)return n(r,f),es&&Yr(r,m),u;if(null===f){for(;!v.done;m++,v=l.next())null!==(v=d(r,v.value,c))&&(a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return es&&Yr(r,m),u}for(f=i(r,f);!v.done;m++,v=l.next())null!==(v=A(f,r,m,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?m:v.key),a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return e&&f.forEach((function(e){return t(r,e)})),es&&Yr(r,m),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===w&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===w){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&As(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=ds(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===w?((s=Nc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Pc(o.type,o.key,o.props,null,i.mode,l)).ref=ds(i,s,o),l.return=i,i=l)}return a(i);case _:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Ic(o,i.mode,l)).return=i,i=s}return a(i);case D:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return f(i,s,o,l);if(O(o))return m(i,s,o,l);ps(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Lc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var ms=fs(!0),gs=fs(!1),vs=br(null),ys=null,bs=null,xs=null;function _s(){xs=bs=ys=null}function ws(e){var t=vs.current;xr(vs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ts(e,t){ys=e,xs=bs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(fa=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===bs){if(null===ys)throw Error(s(308));bs=e,ys.dependencies={lanes:0,firstContext:e}}else bs=bs.next=e;return t}var Es=null;function Cs(e){null===Es?Es=[e]:Es.push(e)}function Rs(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Cs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ps(e,i)}function Ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ns=!1;function Ds(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Os(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Sl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ps(e,n)}return null===(r=i.interleaved)?(t.next=t,Cs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ps(e,n)}function ks(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Bs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fs(e,t,n,i){var r=e.updateQueue;Ns=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=e,f=a;switch(d=t,p=n,f.tag){case 1:if("function"===typeof(A=f.payload)){h=A.call(p,h,d);break e}h=A;break e;case 3:A.flags=-65537&A.flags|128;case 0:if(null===(d="function"===typeof(A=f.payload)?A.call(p,h,d):A)||void 0===d)break e;h=B({},h,d);break e;case 2:Ns=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Dl|=o,e.lanes=o,e.memoizedState=h}}function Us(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var zs={},qs=br(zs),Vs=br(zs),Gs=br(zs);function js(e){if(e===zs)throw Error(s(174));return e}function Hs(e,t){switch(_r(Gs,t),_r(Vs,e),_r(qs,zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xr(qs),_r(qs,t)}function Ws(){xr(qs),xr(Vs),xr(Gs)}function Xs(e){js(Gs.current);var t=js(qs.current),n=le(t,e.type);t!==n&&(_r(Vs,e),_r(qs,n))}function Ys(e){Vs.current===e&&(xr(qs),xr(Vs))}var Qs=br(0);function Ks(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Zs=[];function Js(){for(var e=0;e<Zs.length;e++)Zs[e]._workInProgressVersionPrimary=null;Zs.length=0}var $s=b.ReactCurrentDispatcher,eo=b.ReactCurrentBatchConfig,to=0,no=null,io=null,ro=null,so=!1,oo=!1,ao=0,lo=0;function co(){throw Error(s(321))}function uo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ii(e[n],t[n]))return!1;return!0}function ho(e,t,n,i,r,o){if(to=o,no=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$s.current=null===e||null===e.memoizedState?Qo:Ko,e=n(i,r),oo){o=0;do{if(oo=!1,ao=0,25<=o)throw Error(s(301));o+=1,ro=io=null,t.updateQueue=null,$s.current=Zo,e=n(i,r)}while(oo)}if($s.current=Yo,t=null!==io&&null!==io.next,to=0,ro=io=no=null,so=!1,t)throw Error(s(300));return e}function po(){var e=0!==ao;return ao=0,e}function Ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ro?no.memoizedState=ro=e:ro=ro.next=e,ro}function fo(){if(null===io){var e=no.alternate;e=null!==e?e.memoizedState:null}else e=io.next;var t=null===ro?no.memoizedState:ro.next;if(null!==t)ro=t,io=e;else{if(null===e)throw Error(s(310));e={memoizedState:(io=e).memoizedState,baseState:io.baseState,baseQueue:io.baseQueue,queue:io.queue,next:null},null===ro?no.memoizedState=ro=e:ro=ro.next=e}return ro}function mo(e,t){return"function"===typeof t?t(e):t}function go(e){var t=fo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=io,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((to&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,no.lanes|=h,Dl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ii(i,t.memoizedState)||(fa=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,no.lanes|=o,Dl|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vo(e){var t=fo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ii(o,t.memoizedState)||(fa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function yo(){}function bo(e,t){var n=no,i=fo(),r=t(),o=!ii(i.memoizedState,r);if(o&&(i.memoizedState=r,fa=!0),i=i.queue,Do(wo.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==ro&&1&ro.memoizedState.tag){if(n.flags|=2048,Eo(9,_o.bind(null,n,i,r,t),void 0,null),null===Tl)throw Error(s(349));0!==(30&to)||xo(n,t,r)}return r}function xo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=no.updateQueue)?(t={lastEffect:null,stores:null},no.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _o(e,t,n,i){t.value=n,t.getSnapshot=i,So(t)&&To(e)}function wo(e,t,n){return n((function(){So(t)&&To(e)}))}function So(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ii(e,n)}catch(i){return!0}}function To(e){var t=Ps(e,1);null!==t&&Jl(t,e,1,-1)}function Mo(e){var t=Ao();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:e},t.queue=e,e=e.dispatch=jo.bind(null,no,e),[t.memoizedState,e]}function Eo(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=no.updateQueue)?(t={lastEffect:null,stores:null},no.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Co(){return fo().memoizedState}function Ro(e,t,n,i){var r=Ao();no.flags|=e,r.memoizedState=Eo(1|t,n,void 0,void 0===i?null:i)}function Po(e,t,n,i){var r=fo();i=void 0===i?null:i;var s=void 0;if(null!==io){var o=io.memoizedState;if(s=o.destroy,null!==i&&uo(i,o.deps))return void(r.memoizedState=Eo(t,n,s,i))}no.flags|=e,r.memoizedState=Eo(1|t,n,s,i)}function No(e,t){return Ro(8390656,8,e,t)}function Do(e,t){return Po(2048,8,e,t)}function Lo(e,t){return Po(4,2,e,t)}function Io(e,t){return Po(4,4,e,t)}function Oo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Po(4,4,Oo.bind(null,t,e),n)}function Bo(){}function Fo(e,t){var n=fo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&uo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Uo(e,t){var n=fo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&uo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function zo(e,t,n){return 0===(21&to)?(e.baseState&&(e.baseState=!1,fa=!0),e.memoizedState=n):(ii(n,t)||(n=At(),no.lanes|=n,Dl|=n,e.baseState=!0),t)}function qo(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var i=eo.transition;eo.transition={};try{e(!1),t()}finally{vt=n,eo.transition=i}}function Vo(){return fo().memoizedState}function Go(e,t,n){var i=Zl(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ho(e))Wo(t,n);else if(null!==(n=Rs(e,t,n,i))){Jl(n,e,i,Kl()),Xo(n,t,i)}}function jo(e,t,n){var i=Zl(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ho(e))Wo(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ii(a,o)){var l=t.interleaved;return null===l?(r.next=r,Cs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Rs(e,t,r,i))&&(Jl(n,e,i,r=Kl()),Xo(n,t,i))}}function Ho(e){var t=e.alternate;return e===no||null!==t&&t===no}function Wo(e,t){oo=so=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,gt(e,n)}}var Yo={readContext:Ms,useCallback:co,useContext:co,useEffect:co,useImperativeHandle:co,useInsertionEffect:co,useLayoutEffect:co,useMemo:co,useReducer:co,useRef:co,useState:co,useDebugValue:co,useDeferredValue:co,useTransition:co,useMutableSource:co,useSyncExternalStore:co,useId:co,unstable_isNewReconciler:!1},Qo={readContext:Ms,useCallback:function(e,t){return Ao().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:No,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4194308,4,Oo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var n=Ao();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ao();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Go.bind(null,no,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ao().memoizedState=e},useState:Mo,useDebugValue:Bo,useDeferredValue:function(e){return Ao().memoizedState=e},useTransition:function(){var e=Mo(!1),t=e[0];return e=qo.bind(null,e[1]),Ao().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=no,r=Ao();if(es){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Tl)throw Error(s(349));0!==(30&to)||xo(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,No(wo.bind(null,i,o,e),[e]),i.flags|=2048,Eo(9,_o.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=Ao(),t=Tl.identifierPrefix;if(es){var n=Xr;t=":"+t+"R"+(n=(Wr&~(1<<32-st(Wr)-1)).toString(32)+n),0<(n=ao++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=lo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ko={readContext:Ms,useCallback:Fo,useContext:Ms,useEffect:Do,useImperativeHandle:ko,useInsertionEffect:Lo,useLayoutEffect:Io,useMemo:Uo,useReducer:go,useRef:Co,useState:function(){return go(mo)},useDebugValue:Bo,useDeferredValue:function(e){return zo(fo(),io.memoizedState,e)},useTransition:function(){return[go(mo)[0],fo().memoizedState]},useMutableSource:yo,useSyncExternalStore:bo,useId:Vo,unstable_isNewReconciler:!1},Zo={readContext:Ms,useCallback:Fo,useContext:Ms,useEffect:Do,useImperativeHandle:ko,useInsertionEffect:Lo,useLayoutEffect:Io,useMemo:Uo,useReducer:vo,useRef:Co,useState:function(){return vo(mo)},useDebugValue:Bo,useDeferredValue:function(e){var t=fo();return null===io?t.memoizedState=e:zo(t,io.memoizedState,e)},useTransition:function(){return[vo(mo)[0],fo().memoizedState]},useMutableSource:yo,useSyncExternalStore:bo,useId:Vo,unstable_isNewReconciler:!1};function Jo(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function $o(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ea={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Kl(),r=Zl(e),s=Is(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Os(e,s,r))&&(Jl(t,e,r,i),ks(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Kl(),r=Zl(e),s=Is(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Os(e,s,r))&&(Jl(t,e,r,i),ks(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kl(),i=Zl(e),r=Is(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Os(e,r,i))&&(Jl(t,e,i,n),ks(t,e,i))}};function ta(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!ri(n,i)||!ri(r,s))}function na(e,t,n){var i=!1,r=wr,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(r=Cr(t)?Mr:Sr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Er(e,r):wr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ea,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ia(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ea.enqueueReplaceState(t,t.state,null)}function ra(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ds(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ms(s):(s=Cr(t)?Mr:Sr.current,r.context=Er(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&($o(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ea.enqueueReplaceState(r,r.state,null),Fs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function sa(e,t){try{var n="",i=t;do{n+=q(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function oa(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function aa(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var la="function"===typeof WeakMap?WeakMap:Map;function ca(e,t,n){(n=Is(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){zl||(zl=!0,ql=i),aa(0,t)},n}function ua(e,t,n){(n=Is(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){aa(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){aa(0,t),"function"!==typeof i&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ha(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new la;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=xc.bind(null,e,t,n),t.then(e,e))}function da(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function pa(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Is(-1,1)).tag=2,Os(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var Aa=b.ReactCurrentOwner,fa=!1;function ma(e,t,n,i){t.child=null===e?gs(t,null,n,i):ms(t,e.child,n,i)}function ga(e,t,n,i,r){n=n.render;var s=t.ref;return Ts(t,r),i=ho(e,t,n,i,s,r),n=po(),null===e||fa?(es&&n&&Kr(t),t.flags|=1,ma(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,za(e,t,r))}function va(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Cc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ya(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:ri)(o,i)&&e.ref===t.ref)return za(e,t,r)}return t.flags|=1,(e=Rc(s,i)).ref=t.ref,e.return=t,t.child=e}function ya(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(ri(s,i)&&e.ref===t.ref){if(fa=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,za(e,t,r);0!==(131072&e.flags)&&(fa=!0)}}return _a(e,t,n,i,r)}function ba(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_r(Rl,Cl),Cl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_r(Rl,Cl),Cl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,_r(Rl,Cl),Cl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,_r(Rl,Cl),Cl|=i;return ma(e,t,r,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _a(e,t,n,i,r){var s=Cr(n)?Mr:Sr.current;return s=Er(t,s),Ts(t,r),n=ho(e,t,n,i,s,r),i=po(),null===e||fa?(es&&i&&Kr(t),t.flags|=1,ma(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,za(e,t,r))}function wa(e,t,n,i,r){if(Cr(n)){var s=!0;Dr(t)}else s=!1;if(Ts(t,r),null===t.stateNode)Ua(e,t),na(t,n,i),ra(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ms(c):c=Er(t,c=Cr(n)?Mr:Sr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&ia(t,o,i,c),Ns=!1;var d=t.memoizedState;o.state=d,Fs(t,i,o,r),l=t.memoizedState,a!==i||d!==l||Tr.current||Ns?("function"===typeof u&&($o(t,n,u,i),l=t.memoizedState),(a=Ns||ta(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Jo(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ms(l):l=Er(t,l=Cr(n)?Mr:Sr.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&ia(t,o,i,l),Ns=!1,d=t.memoizedState,o.state=d,Fs(t,i,o,r);var A=t.memoizedState;a!==h||d!==A||Tr.current||Ns?("function"===typeof p&&($o(t,n,p,i),A=t.memoizedState),(c=Ns||ta(t,n,c,i,d,A,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,A,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,A,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=A),o.props=i,o.state=A,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Sa(e,t,n,i,s,r)}function Sa(e,t,n,i,r,s){xa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Lr(t,n,!1),za(e,t,s);i=t.stateNode,Aa.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ms(t,e.child,null,s),t.child=ms(t,null,a,s)):ma(e,t,a,s),t.memoizedState=i.state,r&&Lr(t,n,!0),t.child}function Ta(e){var t=e.stateNode;t.pendingContext?Pr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pr(0,t.context,!1),Hs(e,t.containerInfo)}function Ma(e,t,n,i,r){return cs(),us(r),t.flags|=256,ma(e,t,n,i),t.child}var Ea,Ca,Ra,Pa,Na={dehydrated:null,treeContext:null,retryLane:0};function Da(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var i,r=t.pendingProps,o=Qs.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),_r(Qs,1&o),null===e)return ss(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Dc(l,r,0,null),e=Nc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Da(n),t.memoizedState=Na,e):Ia(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Oa(e,t,a,i=oa(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Dc({mode:"visible",children:i.children},r,0,null),(o=Nc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ms(t,e.child,null,a),t.child.memoizedState=Da(a),t.memoizedState=Na,o);if(0===(1&t.mode))return Oa(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Oa(e,t,a,i=oa(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),fa||l){if(null!==(i=Tl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ps(e,r),Jl(i,e,r,-1))}return hc(),Oa(e,t,a,i=oa(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=wc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,$r=sr(r.nextSibling),Jr=t,es=!0,ts=null,null!==e&&(Gr[jr++]=Wr,Gr[jr++]=Xr,Gr[jr++]=Hr,Wr=e.id,Xr=e.overflow,Hr=t),t=Ia(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Rc(i,a):(a=Nc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Na,r}return e=(a=e.child).sibling,r=Rc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Ia(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Oa(e,t,n,i){return null!==i&&us(i),ms(t,e.child,null,n),(e=Ia(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ka(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ss(e.return,t,n)}function Ba(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Fa(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(ma(e,t,i.children,n),0!==(2&(i=Qs.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ka(e,n,t);else if(19===e.tag)ka(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(_r(Qs,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Ks(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ba(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Ks(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ba(t,!0,n,null,s);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ua(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function za(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!es)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Va(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ga(e,t,n){var i=t.pendingProps;switch(Zr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Va(t),null;case 1:case 17:return Cr(t.type)&&Rr(),Va(t),null;case 3:return i=t.stateNode,Ws(),xr(Tr),xr(Sr),Js(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(as(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ts&&(nc(ts),ts=null))),Ca(e,t),Va(t),null;case 5:Ys(t);var r=js(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Ra(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Va(t),null}if(e=js(qs.current),as(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[lr]=t,i[cr]=o,e=0!==(1&t.mode),n){case"dialog":Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":case"embed":Oi("load",i);break;case"video":case"audio":for(r=0;r<Ni.length;r++)Oi(Ni[r],i);break;case"source":Oi("error",i);break;case"img":case"image":case"link":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"input":K(i,o),Oi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Oi("invalid",i);break;case"textarea":re(i,o),Oi("invalid",i)}for(var l in ge(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Yi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Yi(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Oi("scroll",i)}switch(n){case"input":W(i),$(i,o,!0);break;case"textarea":W(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Qi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[lr]=t,e[cr]=i,Ea(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,i),n){case"dialog":Oi("cancel",e),Oi("close",e),r=i;break;case"iframe":case"object":case"embed":Oi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Ni.length;r++)Oi(Ni[r],e);r=i;break;case"source":Oi("error",e),r=i;break;case"img":case"image":case"link":Oi("error",e),Oi("load",e),r=i;break;case"details":Oi("toggle",e),r=i;break;case"input":K(e,i),r=Q(e,i),Oi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=B({},i,{value:void 0}),Oi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Oi("invalid",e)}for(o in ge(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?fe(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&ue(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Oi("scroll",e):null!=u&&y(e,o,u,l))}switch(n){case"input":W(e),$(e,i,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+j(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Va(t),null;case 6:if(e&&null!=t.stateNode)Pa(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=js(Gs.current),js(qs.current),as(t)){if(i=t.stateNode,n=t.memoizedProps,i[lr]=t,(o=i.nodeValue!==n)&&null!==(e=Jr))switch(e.tag){case 3:Yi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[lr]=t,t.stateNode=i}return Va(t),null;case 13:if(xr(Qs),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(es&&null!==$r&&0!==(1&t.mode)&&0===(128&t.flags))ls(),cs(),t.flags|=98560,o=!1;else if(o=as(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[lr]=t}else cs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Va(t),o=!1}else null!==ts&&(nc(ts),ts=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qs.current)?0===Pl&&(Pl=3):hc())),null!==t.updateQueue&&(t.flags|=4),Va(t),null);case 4:return Ws(),Ca(e,t),null===e&&Fi(t.stateNode.containerInfo),Va(t),null;case 10:return ws(t.type._context),Va(t),null;case 19:if(xr(Qs),null===(o=t.memoizedState))return Va(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)qa(o,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=Ks(e))){for(t.flags|=128,qa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _r(Qs,1&Qs.current|2),t.child}e=e.sibling}null!==o.tail&&Ke()>Fl&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Ks(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!es)return Va(t),null}else 2*Ke()-o.renderingStartTime>Fl&&1073741824!==n&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ke(),t.sibling=null,n=Qs.current,_r(Qs,i?1&n|2:1&n),t):(Va(t),null);case 22:case 23:return ac(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Cl)&&(Va(t),6&t.subtreeFlags&&(t.flags|=8192)):Va(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function ja(e,t){switch(Zr(t),t.tag){case 1:return Cr(t.type)&&Rr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ws(),xr(Tr),xr(Sr),Js(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ys(t),null;case 13:if(xr(Qs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));cs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xr(Qs),null;case 4:return Ws(),null;case 10:return ws(t.type._context),null;case 22:case 23:return ac(),null;default:return null}}Ea=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ca=function(){},Ra=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,js(qs.current);var s,o=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),o=[];break;case"select":r=B({},r,{value:void 0}),i=B({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Qi)}for(u in ge(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Oi("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Pa=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ha=!1,Wa=!1,Xa="function"===typeof WeakSet?WeakSet:Set,Ya=null;function Qa(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){bc(e,t,i)}else n.current=null}function Ka(e,t,n){try{n()}catch(i){bc(e,t,i)}}var Za=!1;function Ja(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&Ka(t,n,s)}r=r.next}while(r!==i)}}function $a(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function el(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function tl(e){var t=e.alternate;null!==t&&(e.alternate=null,tl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[lr],delete t[cr],delete t[hr],delete t[dr],delete t[pr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function rl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qi));else if(4!==i&&null!==(e=e.child))for(rl(e,t,n),e=e.sibling;null!==e;)rl(e,t,n),e=e.sibling}function sl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(sl(e,t,n),e=e.sibling;null!==e;)sl(e,t,n),e=e.sibling}var ol=null,al=!1;function ll(e,t,n){for(n=n.child;null!==n;)cl(e,t,n),n=n.sibling}function cl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Wa||Qa(n,t);case 6:var i=ol,r=al;ol=null,ll(e,t,n),al=r,null!==(ol=i)&&(al?(e=ol,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ol.removeChild(n.stateNode));break;case 18:null!==ol&&(al?(e=ol,n=n.stateNode,8===e.nodeType?rr(e.parentNode,n):1===e.nodeType&&rr(e,n),qt(e)):rr(ol,n.stateNode));break;case 4:i=ol,r=al,ol=n.stateNode.containerInfo,al=!0,ll(e,t,n),ol=i,al=r;break;case 0:case 11:case 14:case 15:if(!Wa&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&Ka(n,t,o),r=r.next}while(r!==i)}ll(e,t,n);break;case 1:if(!Wa&&(Qa(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){bc(n,t,a)}ll(e,t,n);break;case 21:ll(e,t,n);break;case 22:1&n.mode?(Wa=(i=Wa)||null!==n.memoizedState,ll(e,t,n),Wa=i):ll(e,t,n);break;default:ll(e,t,n)}}function ul(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach((function(t){var i=Sc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function hl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ol=l.stateNode,al=!1;break e;case 3:case 4:ol=l.stateNode.containerInfo,al=!0;break e}l=l.return}if(null===ol)throw Error(s(160));cl(o,a,r),ol=null,al=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){bc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)dl(t,e),t=t.sibling}function dl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hl(t,e),pl(e),4&i){try{Ja(3,e,e.return),$a(3,e)}catch(m){bc(e,e.return,m)}try{Ja(5,e,e.return)}catch(m){bc(e,e.return,m)}}break;case 1:hl(t,e),pl(e),512&i&&null!==n&&Qa(n,n.return);break;case 5:if(hl(t,e),pl(e),512&i&&null!==n&&Qa(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(m){bc(e,e.return,m)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Z(r,o),ve(l,a);var u=ve(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?fe(r,d):"dangerouslySetInnerHTML"===h?ue(r,d):"children"===h?he(r,d):y(r,h,d,u)}switch(l){case"input":J(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var A=o.value;null!=A?ne(r,!!o.multiple,A,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[cr]=o}catch(m){bc(e,e.return,m)}}break;case 6:if(hl(t,e),pl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(m){bc(e,e.return,m)}}break;case 3:if(hl(t,e),pl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(m){bc(e,e.return,m)}break;case 4:default:hl(t,e),pl(e);break;case 13:hl(t,e),pl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Bl=Ke())),4&i&&ul(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Wa=(u=Wa)||h,hl(t,e),Wa=u):hl(t,e),pl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Ya=e,h=e.child;null!==h;){for(d=Ya=h;null!==Ya;){switch(A=(p=Ya).child,p.tag){case 0:case 11:case 14:case 15:Ja(4,p,p.return);break;case 1:Qa(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){i=p,n=p.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){bc(i,n,m)}}break;case 5:Qa(p,p.return);break;case 22:if(null!==p.memoizedState){gl(d);continue}}null!==A?(A.return=p,Ya=A):gl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=Ae("display",a))}catch(m){bc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){bc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:hl(t,e),pl(e),4&i&&ul(e);case 21:}}function pl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(nl(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),sl(e,il(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;rl(e,il(e),o);break;default:throw Error(s(161))}}catch(a){bc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Al(e,t,n){Ya=e,fl(e,t,n)}function fl(e,t,n){for(var i=0!==(1&e.mode);null!==Ya;){var r=Ya,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Ha;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Wa;a=Ha;var c=Wa;if(Ha=o,(Wa=l)&&!c)for(Ya=r;null!==Ya;)l=(o=Ya).child,22===o.tag&&null!==o.memoizedState?vl(r):null!==l?(l.return=o,Ya=l):vl(r);for(;null!==s;)Ya=s,fl(s,t,n),s=s.sibling;Ya=r,Ha=a,Wa=c}ml(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Ya=s):ml(e)}}function ml(e){for(;null!==Ya;){var t=Ya;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Wa||$a(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Wa)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:Jo(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Us(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Us(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&qt(d)}}}break;default:throw Error(s(163))}Wa||512&t.flags&&el(t)}catch(p){bc(t,t.return,p)}}if(t===e){Ya=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ya=n;break}Ya=t.return}}function gl(e){for(;null!==Ya;){var t=Ya;if(t===e){Ya=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ya=n;break}Ya=t.return}}function vl(e){for(;null!==Ya;){var t=Ya;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{$a(4,t)}catch(l){bc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){bc(t,r,l)}}var s=t.return;try{el(t)}catch(l){bc(t,s,l)}break;case 5:var o=t.return;try{el(t)}catch(l){bc(t,o,l)}}}catch(l){bc(t,t.return,l)}if(t===e){Ya=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ya=a;break}Ya=t.return}}var yl,bl=Math.ceil,xl=b.ReactCurrentDispatcher,_l=b.ReactCurrentOwner,wl=b.ReactCurrentBatchConfig,Sl=0,Tl=null,Ml=null,El=0,Cl=0,Rl=br(0),Pl=0,Nl=null,Dl=0,Ll=0,Il=0,Ol=null,kl=null,Bl=0,Fl=1/0,Ul=null,zl=!1,ql=null,Vl=null,Gl=!1,jl=null,Hl=0,Wl=0,Xl=null,Yl=-1,Ql=0;function Kl(){return 0!==(6&Sl)?Ke():-1!==Yl?Yl:Yl=Ke()}function Zl(e){return 0===(1&e.mode)?1:0!==(2&Sl)&&0!==El?El&-El:null!==hs.transition?(0===Ql&&(Ql=At()),Ql):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function Jl(e,t,n,i){if(50<Wl)throw Wl=0,Xl=null,Error(s(185));mt(e,n,i),0!==(2&Sl)&&e===Tl||(e===Tl&&(0===(2&Sl)&&(Ll|=n),4===Pl&&ic(e,El)),$l(e,i),1===n&&0===Sl&&0===(1&t.mode)&&(Fl=Ke()+500,Or&&Fr()))}function $l(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-st(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=dt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=ht(e,e===Tl?El:0);if(0===i)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Or=!0,Br(e)}(rc.bind(null,e)):Br(rc.bind(null,e)),nr((function(){0===(6&Sl)&&Fr()})),n=null;else{switch(yt(i)){case 1:n=Je;break;case 4:n=$e;break;case 16:default:n=et;break;case 536870912:n=nt}n=Tc(n,ec.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ec(e,t){if(Yl=-1,Ql=0,0!==(6&Sl))throw Error(s(327));var n=e.callbackNode;if(vc()&&e.callbackNode!==n)return null;var i=ht(e,e===Tl?El:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=dc(e,i);else{t=i;var r=Sl;Sl|=2;var o=uc();for(Tl===e&&El===t||(Ul=null,Fl=Ke()+500,lc(e,t));;)try{Ac();break}catch(l){cc(e,l)}_s(),xl.current=o,Sl=r,null!==Ml?t=0:(Tl=null,El=0,t=Pl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=tc(e,r))),1===t)throw n=Nl,lc(e,0),ic(e,i),$l(e,Ke()),n;if(6===t)ic(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ii(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=dc(e,i))&&(0!==(o=pt(e))&&(i=o,t=tc(e,o))),1===t))throw n=Nl,lc(e,0),ic(e,i),$l(e,Ke()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:gc(e,kl,Ul);break;case 3:if(ic(e,i),(130023424&i)===i&&10<(t=Bl+500-Ke())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){Kl(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=$i(gc.bind(null,e,kl,Ul),t);break}gc(e,kl,Ul);break;case 4:if(ic(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-st(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Ke()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*bl(i/1960))-i)){e.timeoutHandle=$i(gc.bind(null,e,kl,Ul),i);break}gc(e,kl,Ul);break;default:throw Error(s(329))}}}return $l(e,Ke()),e.callbackNode===n?ec.bind(null,e):null}function tc(e,t){var n=Ol;return e.current.memoizedState.isDehydrated&&(lc(e,t).flags|=256),2!==(e=dc(e,t))&&(t=kl,kl=n,null!==t&&nc(t)),e}function nc(e){null===kl?kl=e:kl.push.apply(kl,e)}function ic(e,t){for(t&=~Il,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),i=1<<n;e[n]=-1,t&=~i}}function rc(e){if(0!==(6&Sl))throw Error(s(327));vc();var t=ht(e,0);if(0===(1&t))return $l(e,Ke()),null;var n=dc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=tc(e,i))}if(1===n)throw n=Nl,lc(e,0),ic(e,t),$l(e,Ke()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gc(e,kl,Ul),$l(e,Ke()),null}function sc(e,t){var n=Sl;Sl|=1;try{return e(t)}finally{0===(Sl=n)&&(Fl=Ke()+500,Or&&Fr())}}function oc(e){null!==jl&&0===jl.tag&&0===(6&Sl)&&vc();var t=Sl;Sl|=1;var n=wl.transition,i=vt;try{if(wl.transition=null,vt=1,e)return e()}finally{vt=i,wl.transition=n,0===(6&(Sl=t))&&Fr()}}function ac(){Cl=Rl.current,xr(Rl)}function lc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,er(n)),null!==Ml)for(n=Ml.return;null!==n;){var i=n;switch(Zr(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rr();break;case 3:Ws(),xr(Tr),xr(Sr),Js();break;case 5:Ys(i);break;case 4:Ws();break;case 13:case 19:xr(Qs);break;case 10:ws(i.type._context);break;case 22:case 23:ac()}n=n.return}if(Tl=e,Ml=e=Rc(e.current,null),El=Cl=t,Pl=0,Nl=null,Il=Ll=Dl=0,kl=Ol=null,null!==Es){for(t=0;t<Es.length;t++)if(null!==(i=(n=Es[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Es=null}return e}function cc(e,t){for(;;){var n=Ml;try{if(_s(),$s.current=Yo,so){for(var i=no.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}so=!1}if(to=0,ro=io=no=null,oo=!1,ao=0,_l.current=null,null===n||null===n.return){Pl=1,Nl=t,Ml=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=El,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var A=da(a);if(null!==A){A.flags&=-257,pa(A,a,l,0,t),1&A.mode&&ha(o,u,t),c=u;var f=(t=A).updateQueue;if(null===f){var m=new Set;m.add(c),t.updateQueue=m}else f.add(c);break e}if(0===(1&t)){ha(o,u,t),hc();break e}c=Error(s(426))}else if(es&&1&l.mode){var g=da(a);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),pa(g,a,l,0,t),us(sa(c,l));break e}}o=c=sa(c,l),4!==Pl&&(Pl=2),null===Ol?Ol=[o]:Ol.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,ca(0,c,t));break e;case 1:l=c;var v=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Vl||!Vl.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,ua(o,l,t));break e}}o=o.return}while(null!==o)}mc(n)}catch(b){t=b,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function uc(){var e=xl.current;return xl.current=Yo,null===e?Yo:e}function hc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Tl||0===(268435455&Dl)&&0===(268435455&Ll)||ic(Tl,El)}function dc(e,t){var n=Sl;Sl|=2;var i=uc();for(Tl===e&&El===t||(Ul=null,lc(e,t));;)try{pc();break}catch(r){cc(e,r)}if(_s(),Sl=n,xl.current=i,null!==Ml)throw Error(s(261));return Tl=null,El=0,Pl}function pc(){for(;null!==Ml;)fc(Ml)}function Ac(){for(;null!==Ml&&!Ye();)fc(Ml)}function fc(e){var t=yl(e.alternate,e,Cl);e.memoizedProps=e.pendingProps,null===t?mc(e):Ml=t,_l.current=null}function mc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Cl)))return void(Ml=n)}else{if(null!==(n=ja(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return Pl=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===Pl&&(Pl=5)}function gc(e,t,n){var i=vt,r=wl.transition;try{wl.transition=null,vt=1,function(e,t,n,i){do{vc()}while(null!==jl);if(0!==(6&Sl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Tl&&(Ml=Tl=null,El=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Tc(et,(function(){return vc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=wl.transition,wl.transition=null;var a=vt;vt=1;var l=Sl;Sl|=4,_l.current=null,function(e,t){if(Ki=Gt,ci(e=li())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var A;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(A=d.firstChild);)p=d,d=A;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=a),p===o&&++h===i&&(c=a),null!==(A=d.nextSibling))break;p=(d=p).parentNode}d=A}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zi={focusedElem:e,selectionRange:n},Gt=!1,Ya=t;null!==Ya;)if(e=(t=Ya).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ya=e;else for(;null!==Ya;){t=Ya;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,g=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:Jo(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(x){bc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Ya=e;break}Ya=t.return}f=Za,Za=!1}(e,n),dl(n,e),ui(Zi),Gt=!!Ki,Zi=Ki=null,e.current=n,Al(n,e,r),Qe(),Sl=l,vt=a,wl.transition=o}else e.current=n;if(Gl&&(Gl=!1,jl=e,Hl=r),o=e.pendingLanes,0===o&&(Vl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),$l(e,Ke()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(zl)throw zl=!1,e=ql,ql=null,e;0!==(1&Hl)&&0!==e.tag&&vc(),o=e.pendingLanes,0!==(1&o)?e===Xl?Wl++:(Wl=0,Xl=e):Wl=0,Fr()}(e,t,n,i)}finally{wl.transition=r,vt=i}return null}function vc(){if(null!==jl){var e=yt(Hl),t=wl.transition,n=vt;try{if(wl.transition=null,vt=16>e?16:e,null===jl)var i=!1;else{if(e=jl,jl=null,Hl=0,0!==(6&Sl))throw Error(s(331));var r=Sl;for(Sl|=4,Ya=e.current;null!==Ya;){var o=Ya,a=o.child;if(0!==(16&Ya.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ya=u;null!==Ya;){var h=Ya;switch(h.tag){case 0:case 11:case 15:Ja(8,h,o)}var d=h.child;if(null!==d)d.return=h,Ya=d;else for(;null!==Ya;){var p=(h=Ya).sibling,A=h.return;if(tl(h),h===u){Ya=null;break}if(null!==p){p.return=A,Ya=p;break}Ya=A}}}var f=o.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Ya=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Ya=a;else e:for(;null!==Ya;){if(0!==(2048&(o=Ya).flags))switch(o.tag){case 0:case 11:case 15:Ja(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Ya=v;break e}Ya=o.return}}var y=e.current;for(Ya=y;null!==Ya;){var b=(a=Ya).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,Ya=b;else e:for(a=y;null!==Ya;){if(0!==(2048&(l=Ya).flags))try{switch(l.tag){case 0:case 11:case 15:$a(9,l)}}catch(_){bc(l,l.return,_)}if(l===a){Ya=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Ya=x;break e}Ya=l.return}}if(Sl=r,Fr(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(it,e)}catch(_){}i=!0}return i}finally{vt=n,wl.transition=t}}return!1}function yc(e,t,n){e=Os(e,t=ca(0,t=sa(n,t),1),1),t=Kl(),null!==e&&(mt(e,1,t),$l(e,t))}function bc(e,t,n){if(3===e.tag)yc(e,e,n);else for(;null!==t;){if(3===t.tag){yc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Vl||!Vl.has(i))){t=Os(t,e=ua(t,e=sa(n,e),1),1),e=Kl(),null!==t&&(mt(t,1,e),$l(t,e));break}}t=t.return}}function xc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=Kl(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(El&n)===n&&(4===Pl||3===Pl&&(130023424&El)===El&&500>Ke()-Bl?lc(e,0):Il|=n),$l(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=Kl();null!==(e=Ps(e,t))&&(mt(e,t,n),$l(e,n))}function wc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_c(e,n)}function Sc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),_c(e,n)}function Tc(e,t){return We(e,t)}function Mc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ec(e,t,n,i){return new Mc(e,t,n,i)}function Cc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Ec(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Cc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case w:return Nc(n.children,r,o,t);case S:a=8,r|=8;break;case T:return(e=Ec(12,n,t,2|r)).elementType=T,e.lanes=o,e;case R:return(e=Ec(13,n,t,r)).elementType=R,e.lanes=o,e;case P:return(e=Ec(19,n,t,r)).elementType=P,e.lanes=o,e;case L:return Dc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case M:a=10;break e;case E:a=9;break e;case C:a=11;break e;case N:a=14;break e;case D:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ec(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Nc(e,t,n,i){return(e=Ec(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=Ec(22,e,i,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ec(6,e,null,t)).lanes=n,e}function Ic(e,t,n){return(t=Ec(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Oc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function kc(e,t,n,i,r,s,o,a,l){return e=new Oc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ec(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ds(s),e}function Bc(e){if(!e)return wr;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Cr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Cr(n))return Nr(e,n,t)}return t}function Fc(e,t,n,i,r,s,o,a,l){return(e=kc(n,i,!0,e,0,s,0,a,l)).context=Bc(null),n=e.current,(s=Is(i=Kl(),r=Zl(n))).callback=void 0!==t&&null!==t?t:null,Os(n,s,r),e.current.lanes=r,mt(e,r,i),$l(e,i),e}function Uc(e,t,n,i){var r=t.current,s=Kl(),o=Zl(r);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Is(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Os(r,t,o))&&(Jl(e,r,o,s),ks(e,r,o)),o}function zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}yl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Tr.current)fa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return fa=!1,function(e,t,n){switch(t.tag){case 3:Ta(t),cs();break;case 5:Xs(t);break;case 1:Cr(t.type)&&Dr(t);break;case 4:Hs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;_r(vs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(_r(Qs,1&Qs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?La(e,t,n):(_r(Qs,1&Qs.current),null!==(e=za(e,t,n))?e.sibling:null);_r(Qs,1&Qs.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Fa(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),_r(Qs,Qs.current),i)break;return null;case 22:case 23:return t.lanes=0,ba(e,t,n)}return za(e,t,n)}(e,t,n);fa=0!==(131072&e.flags)}else fa=!1,es&&0!==(1048576&t.flags)&&Qr(t,Vr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ua(e,t),e=t.pendingProps;var r=Er(t,Sr.current);Ts(t,n),r=ho(null,t,i,e,r,n);var o=po();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Cr(i)?(o=!0,Dr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ds(t),r.updater=ea,t.stateNode=r,r._reactInternals=t,ra(t,i,e,n),t=Sa(null,t,i,!0,o,n)):(t.tag=0,es&&o&&Kr(t),ma(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ua(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Cc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===N)return 14}return 2}(i),e=Jo(i,e),r){case 0:t=_a(null,t,i,e,n);break e;case 1:t=wa(null,t,i,e,n);break e;case 11:t=ga(null,t,i,e,n);break e;case 14:t=va(null,t,i,Jo(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,_a(e,t,i,r=t.elementType===i?r:Jo(i,r),n);case 1:return i=t.type,r=t.pendingProps,wa(e,t,i,r=t.elementType===i?r:Jo(i,r),n);case 3:e:{if(Ta(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ls(e,t),Fs(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ma(e,t,i,n,r=sa(Error(s(423)),t));break e}if(i!==r){t=Ma(e,t,i,n,r=sa(Error(s(424)),t));break e}for($r=sr(t.stateNode.containerInfo.firstChild),Jr=t,es=!0,ts=null,n=gs(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(cs(),i===r){t=za(e,t,n);break e}ma(e,t,i,n)}t=t.child}return t;case 5:return Xs(t),null===e&&ss(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,Ji(i,r)?a=null:null!==o&&Ji(i,o)&&(t.flags|=32),xa(e,t),ma(e,t,a,n),t.child;case 6:return null===e&&ss(t),null;case 13:return La(e,t,n);case 4:return Hs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ms(t,null,i,n):ma(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,ga(e,t,i,r=t.elementType===i?r:Jo(i,r),n);case 7:return ma(e,t,t.pendingProps,n),t.child;case 8:case 12:return ma(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,_r(vs,i._currentValue),i._currentValue=a,null!==o)if(ii(o.value,a)){if(o.children===r.children&&!Tr.current){t=za(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Is(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ss(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ss(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ma(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ts(t,n),i=i(r=Ms(r)),t.flags|=1,ma(e,t,i,n),t.child;case 14:return r=Jo(i=t.type,t.pendingProps),va(e,t,i,r=Jo(i.type,r),n);case 15:return ya(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Jo(i,r),Ua(e,t),t.tag=1,Cr(i)?(e=!0,Dr(t)):e=!1,Ts(t,n),na(t,i,r),ra(t,i,r,n),Sa(null,t,i,!0,e,n);case 19:return Fa(e,t,n);case 22:return ba(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function jc(e){this._internalRoot=e}function Hc(e){this._internalRoot=e}function Wc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function Qc(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=zc(o);a.call(e)}}Uc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=zc(o);s.call(e)}}var o=Fc(t,i,e,0,null,!1,0,"",Yc);return e._reactRootContainer=o,e[ur]=o.current,Fi(8===e.nodeType?e.parentNode:e),oc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=zc(l);a.call(e)}}var l=kc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=l,e[ur]=l.current,Fi(8===e.nodeType?e.parentNode:e),oc((function(){Uc(t,l,n,i)})),l}(n,t,e,r,i);return zc(o)}Hc.prototype.render=jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Uc(e,t,null,null)},Hc.prototype.unmount=jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;oc((function(){Uc(null,e,null,null)})),t[ur]=null}},Hc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&kt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(gt(t,1|n),$l(t,Ke()),0===(6&Sl)&&(Fl=Ke()+500,Fr()))}break;case 13:oc((function(){var t=Ps(e,1);if(null!==t){var n=Kl();Jl(t,e,1,n)}})),Vc(e,1)}},xt=function(e){if(13===e.tag){var t=Ps(e,134217728);if(null!==t)Jl(t,e,134217728,Kl());Vc(e,134217728)}},_t=function(e){if(13===e.tag){var t=Zl(e),n=Ps(e,t);if(null!==n)Jl(n,e,t,Kl());Vc(e,t)}},wt=function(){return vt},St=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},xe=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=gr(i);if(!r)throw Error(s(90));X(i),J(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=sc,Ce=oc;var Kc={usingClientEntryPoint:!1,Events:[fr,mr,gr,Te,Me,sc]},Zc={findFiberByHostInstance:Ar,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jc={bundleType:Zc.bundleType,version:Zc.version,rendererPackageName:Zc.rendererPackageName,rendererConfig:Zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:Zc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{it=$c.inject(Jc),rt=$c}catch(eu){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Wc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Wc(e))throw Error(s(299));var n=!1,i="",r=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=kc(e,1,!1,null,0,n,0,i,r),e[ur]=t.current,Fi(8===e.nodeType?e.parentNode:e),new jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return oc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Wc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Fc(t,null,e,1,null!=n?n:null,r,0,o,a),e[ur]=t.current,Fi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Hc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(oc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[ur]=null}))})),!0)},t.unstable_batchedUpdates=sc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Qc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||A}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||A}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var b=y.prototype=new v;b.constructor=y,f(b,g.prototype),b.isPureReactComponent=!0;var x=Array.isArray,_=Object.prototype.hasOwnProperty,w={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,r)&&!S.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:w.current}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,x(o)?(r="",null!=e&&(r=e.replace(E,"$&/")+"/"),R(o,t,r,"",(function(e){return e}))):null!=o&&(M(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+C(a=e[c],c);l+=R(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=R(a=a.value,t,r,u=s+C(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var i=[],r=0;return R(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},L={transition:null},I={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:L,ReactCurrentOwner:w};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=r,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.act=O,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=w.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,A=!1,f=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function x(e){if(m=!1,b(e),!f)if(null!==i(c))f=!0,L(_);else{var t=i(u);null!==t&&I(x,t.startTime-e)}}function _(e,n){f=!1,m&&(m=!1,v(M),M=-1),A=!0;var s=p;try{for(b(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!R());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),b(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(x,h.startTime-n),l=!1}return l}finally{d=null,p=s,A=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,S=!1,T=null,M=-1,E=5,C=-1;function R(){return!(t.unstable_now()-C<E)}function P(){if(null!==T){var e=t.unstable_now();C=e;var n=!0;try{n=T(!0,e)}finally{n?w():(S=!1,T=null)}}else S=!1}if("function"===typeof y)w=function(){y(P)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,D=N.port2;N.port1.onmessage=P,w=function(){D.postMessage(null)}}else w=function(){g(P,0)};function L(e){T=e,S||(S=!0,w())}function I(e,n){M=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||A||(f=!0,L(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(v(M),M=-1):m=!0,I(x,s-o))):(e.sortIndex=a,n(c,e),f||A||(f=!0,L(_))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},901:(e,t,n)=>{var i=n(67),r=n(761),s=new i,o=n(120);e.exports=function(e){e=e||{};var t,n,a=[],l={initAsync:function(e,i){u(e);var r=h(e);function s(t,n){r.insert(n,e,0)}function a(){n=e,t=r,"function"===typeof i&&i(l)}o(e,s,a,{step:3})},init:function(e){u(e),n=e,t=h(e);for(var i=0;i<e.length;i+=3)t.insert(i,n,0)},bounds:function(){return t?t.bounds:s},intersectRay:function(e,i,r,s){if(!t)return a;void 0===r&&(r=0);void 0===s&&(s=Number.POSITIVE_INFINITY);r*=r,s*=s;var o=[];return t.query(o,n,l,c),o.sort(u);function l(t){var n,r=t.half,o=(t.x-r-e.x)/i.x,a=(t.x+r-e.x)/i.x,l=(t.y+r-e.y)/i.y,c=(t.y-r-e.y)/i.y,u=(t.z-r-e.z)/i.z,h=(t.z+r-e.z)/i.z,d=Math.min(Math.min(Math.max(o,a),Math.max(l,c)),Math.max(u,h));return!(d<0)&&((n=Math.max(Math.max(Math.min(o,a),Math.min(l,c)),Math.min(u,h)))<=d&&n<=s)}function c(t,n,i){var o=(t-e.x)*(t-e.x)+(n-e.y)*(n-e.y)+(i-e.z)*(i-e.z);return r<=o&&o<=s}function u(t,n){var i=e[t],r=e[t+1],s=e[t+2],o=(i-e.x)*(i-e.x)+(r-e.y)*(r-e.y)+(s-e.z)*(s-e.z),a=e[n],l=e[n+1],c=e[n+2];return o-((a-e.x)*(a-e.x)+(l-e.y)*(l-e.y)+(c-e.z)*(c-e.z))}},intersectSphere:function(e,i,r,s){if(!t)return a;var o=[],l=s*s;return t.query(o,n,u,h),o;function u(t){var n=l,s=t.half;return e<t.x-s?n-=c(e-(t.x-s)):e>t.x+s&&(n-=c(e-(t.x+s))),i<t.y-s?n-=c(i-(t.y-s)):i>t.y+s&&(n-=c(i-(t.y+s))),r<t.z-s?n-=c(r-(t.z-s)):r>t.z+s&&(n-=c(r-(t.z+s))),n>0}function h(t,n,s){return c(t-e)+c(n-i)+c(s-r)<l}},getRoot:function(){return t}};return l;function c(e){return e*e}function u(e){if(!e)throw new Error("Points array is required for quadtree to work");if("number"!==typeof e.length)throw new Error("Points should be array-like object");if(e.length%3!==0)throw new Error("Points array should consist of series of x,y,z coordinates and be multiple of 3")}function h(e){if(0===e.length){var t=new i;return new r(t)}for(var n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=0;u<e.length;u+=3){var h=e[u],d=e[u+1],p=e[u+2];h<n&&(n=h),h>a&&(a=h),d<s&&(s=d),d>l&&(l=d),p<o&&(o=p),p>c&&(c=p)}var A=Math.max(Math.max(a-n,l-s),c-o),f=(A+=2)/2,m=new i((n-=1)+f,(s-=1)+f,(o-=1)+f,f);return new r(m)}}},67:e=>{function t(e,t,n,i){this.x="number"===typeof e?e:0,this.y="number"===typeof t?t:0,this.z="number"===typeof n?n:0,this.half="number"===typeof i?i:0}e.exports=t,t.prototype.contains=function(e,t,n){var i=this.half;return this.x-i<=e&&e<this.x+i&&this.y-i<=t&&t<this.y+i&&this.z-i<=n&&n<this.z+i}},761:(e,t,n)=>{var i=n(67);function r(e){this.bounds=e,this.q0=null,this.q1=null,this.q2=null,this.q3=null,this.q4=null,this.q5=null,this.q6=null,this.q7=null,this.items=null}e.exports=r,r.prototype.subdivide=function(){var e=this.bounds,t=e.half/2;this.q0=new r(new i(e.x-t,e.y-t,e.z-t,t)),this.q1=new r(new i(e.x+t,e.y-t,e.z-t,t)),this.q2=new r(new i(e.x-t,e.y+t,e.z-t,t)),this.q3=new r(new i(e.x+t,e.y+t,e.z-t,t)),this.q4=new r(new i(e.x-t,e.y-t,e.z+t,t)),this.q5=new r(new i(e.x+t,e.y-t,e.z+t,t)),this.q6=new r(new i(e.x-t,e.y+t,e.z+t,t)),this.q7=new r(new i(e.x+t,e.y+t,e.z+t,t))},r.prototype.insert=function(e,t,n){if(null===this.q0){if(null===this.items?this.items=[e]:this.items.push(e),this.items.length>=4&&n<16){this.subdivide();for(var i=0;i<this.items.length;++i)this.insert(this.items[i],t,n+1);this.items=null}}else{var r=t[e],s=t[e+1],o=t[e+2],a=this.bounds,l=0;r>a.x&&(l+=1),s>a.y&&(l+=2),o>a.z&&(l+=4);var c=function(e,t){if(0===t)return e.q0;if(1===t)return e.q1;if(2===t)return e.q2;if(3===t)return e.q3;if(4===t)return e.q4;if(5===t)return e.q5;if(6===t)return e.q6;if(7===t)return e.q7}(this,l);c.insert(e,t,n+1)}},r.prototype.query=function(e,t,n,i){if(n(this.bounds)){var r=this.items,s="function"===typeof i;if(r)for(var o=0;o<r.length;++o){var a=r[o];s?i(t[a],t[a+1],t[a+2])&&e.push(a):e.push(a)}this.q0&&(this.q0.query(e,t,n,i),this.q1.query(e,t,n,i),this.q2.query(e,t,n,i),this.q3.query(e,t,n,i),this.q4.query(e,t,n,i),this.q5.query(e,t,n,i),this.q6.query(e,t,n,i),this.q7.query(e,t,n,i))}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".8aa52779.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="domain-checker:";n.l=(i,r,s,o)=>{if(e[i])e[i].push(r);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=i),e[i]=[r];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,s,o=i[0],a=i[1],l=i[2],c=0;if(o.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(i);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkdomain_checker=self.webpackChunkdomain_checker||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{computeMikkTSpaceTangents:()=>Sb,computeMorphedAttributes:()=>Ib,deepCloneAttribute:()=>Eb,deinterleaveAttribute:()=>Rb,deinterleaveGeometry:()=>Pb,estimateBytesUsed:()=>Nb,interleaveAttributes:()=>Cb,mergeAttributes:()=>Mb,mergeGeometries:()=>Tb,mergeGroups:()=>Ob,mergeVertices:()=>Db,toCreasedNormals:()=>kb,toTrianglesDrawMode:()=>Lb});var t=n(43),i=n(391),r=n(579);const s=(0,t.createContext)(null);function o(e){const n=(0,t.useRef)(null);return null===n.current&&(n.current=e()),n.current}const a=(0,t.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class l extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function c(e){let{children:n,isPresent:i}=e;const s=(0,t.useId)(),o=(0,t.useRef)(null),c=(0,t.useRef)({width:0,height:0,top:0,left:0}),{nonce:u}=(0,t.useContext)(a);return(0,t.useInsertionEffect)((()=>{const{width:e,height:t,top:n,left:r}=c.current;if(i||!o.current||!e||!t)return;o.current.dataset.motionPopId=s;const a=document.createElement("style");return u&&(a.nonce=u),document.head.appendChild(a),a.sheet&&a.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(r,"px !important;\n          }\n        ")),()=>{document.head.removeChild(a)}}),[i]),(0,r.jsx)(l,{isPresent:i,childRef:o,sizeRef:c,children:t.cloneElement(n,{ref:o})})}const u=e=>{let{children:n,initial:i,isPresent:a,onExitComplete:l,custom:u,presenceAffectsLayout:d,mode:p}=e;const A=o(h),f=(0,t.useId)(),m=(0,t.useCallback)((e=>{A.set(e,!0);for(const t of A.values())if(!t)return;l&&l()}),[A,l]),g=(0,t.useMemo)((()=>({id:f,initial:i,isPresent:a,custom:u,onExitComplete:m,register:e=>(A.set(e,!1),()=>A.delete(e))})),d?[Math.random(),m]:[a,m]);return(0,t.useMemo)((()=>{A.forEach(((e,t)=>A.set(t,!1)))}),[a]),t.useEffect((()=>{!a&&!A.size&&l&&l()}),[a]),"popLayout"===p&&(n=(0,r.jsx)(c,{isPresent:a,children:n})),(0,r.jsx)(s.Provider,{value:g,children:n})};function h(){return new Map}const d=(0,t.createContext)({}),p=e=>e;let A=p,f=p;const m=e=>e.key||"";function g(e){const n=[];return t.Children.forEach(e,(e=>{(0,t.isValidElement)(e)&&n.push(e)})),n}const v="undefined"!==typeof window,y=v?t.useLayoutEffect:t.useEffect,b=e=>{let{children:n,exitBeforeEnter:i,custom:s,initial:a=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:h="sync"}=e;f(!i,"Replace exitBeforeEnter with mode='wait'");const p=(0,t.useMemo)((()=>g(n)),[n]),A=p.map(m),v=(0,t.useRef)(!0),b=(0,t.useRef)(p),x=o((()=>new Map)),[_,w]=(0,t.useState)(p),[S,T]=(0,t.useState)(p);y((()=>{v.current=!1,b.current=p;for(let e=0;e<S.length;e++){const t=m(S[e]);A.includes(t)?x.delete(t):!0!==x.get(t)&&x.set(t,!1)}}),[S,A.length,A.join("-")]);const M=[];if(p!==_){let e=[...p];for(let t=0;t<S.length;t++){const n=S[t],i=m(n);A.includes(i)||(e.splice(t,0,n),M.push(n))}return"wait"===h&&M.length&&(e=M),T(g(e)),void w(p)}const{forceRender:E}=(0,t.useContext)(d);return(0,r.jsx)(r.Fragment,{children:S.map((e=>{const t=m(e),n=p===S||A.includes(t);return(0,r.jsx)(u,{isPresent:n,initial:!(v.current&&!a)&&void 0,custom:n?void 0:s,presenceAffectsLayout:c,mode:h,onExitComplete:n?void 0:()=>{if(!x.has(t))return;x.set(t,!0);let e=!0;x.forEach((t=>{t||(e=!1)})),e&&(null===E||void 0===E||E(),T(b.current),l&&l())},children:e},t)}))})};function x(e){if("undefined"===typeof Proxy)return e;const t=new Map;return new Proxy((function(){return e(...arguments)}),{get:(n,i)=>"create"===i?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function w(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=_(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}function S(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function C(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const R=e=>Array.isArray(e);function P(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function N(e){return"string"===typeof e||Array.isArray(e)}function D(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach(((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()})),t}function L(e,t,n,i){if("function"===typeof t){const[r,s]=D(i);t=t(void 0!==n?n:e.custom,r,s)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[r,s]=D(i);t=t(void 0!==n?n:e.custom,r,s)}return t}function I(e,t,n){const i=e.getProps();return L(i,t,void 0!==n?n:i.custom,e)}const O=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],k=["initial",...O],B=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],F=new Set(B),U=e=>1e3*e,z=e=>e/1e3,q={type:"spring",stiffness:500,damping:25,restSpeed:10},V={type:"keyframes",duration:.8},G={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},j=(e,t)=>{let{keyframes:n}=t;return n.length>2?V:F.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:q:G};function H(e,t){return e?e[t]||e.default||e:void 0}const W=!1,X=!1,Y=!1,Q=e=>null!==e;function K(e,t,n){let{repeat:i,repeatType:r="loop"}=t;const s=e.filter(Q),o=i&&"loop"!==r&&i%2===1?0:s.length-1;return o&&void 0!==n?n:s[o]}const Z=["read","resolveKeyframes","update","preRender","render","postRender"];function J(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=Z.reduce(((e,t)=>(e[t]=function(e){let t=new Set,n=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(t){s.has(t)&&(l.schedule(t),e()),t(o)}const l={schedule:function(e){const r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&i?t:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&s.add(e),r.has(e)||r.add(e),e},cancel:e=>{n.delete(e),s.delete(e)},process:e=>{o=e,i?r=!0:(i=!0,[t,n]=[n,t],n.clear(),t.forEach(a),i=!1,r&&(r=!1,l.process(e)))}};return l}(s),e)),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=o,p=()=>{const s=X?r.timestamp:performance.now();n=!1,r.delta=i?1e3/60:Math.max(Math.min(s-r.timestamp,40),1),r.timestamp=s,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),h.process(r),d.process(r),r.isProcessing=!1,n&&t&&(i=!1,e(p))},A=Z.reduce(((t,s)=>{const a=o[s];return t[s]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,i=!0,r.isProcessing||e(p)),a.schedule(t,s,o)},t}),{});return{schedule:A,cancel:e=>{for(let t=0;t<Z.length;t++)o[Z[t]].cancel(e)},state:r,steps:o}}const{schedule:$,cancel:ee,state:te,steps:ne}=J("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:p,!0),ie=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function re(e,t,n,i){if(e===t&&n===i)return p;const r=t=>function(e,t,n,i,r){let s,o,a=0;do{o=t+(n-t)/2,s=ie(o,i,r)-e,s>0?n=o:t=o}while(Math.abs(s)>1e-7&&++a<12);return o}(t,0,1,e,n);return e=>0===e||1===e?e:ie(r(e),t,i)}const se=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,oe=e=>t=>1-e(1-t),ae=re(.33,1.53,.69,.99),le=oe(ae),ce=se(le),ue=e=>(e*=2)<1?.5*le(e):.5*(2-Math.pow(2,-10*(e-1))),he=e=>1-Math.sin(Math.acos(e)),de=oe(he),pe=se(he),Ae=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function fe(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||Ae(e))}const me=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),ge=e=>t=>"string"===typeof t&&t.startsWith(e),ve=ge("--"),ye=ge("var(--"),be=e=>!!ye(e)&&xe.test(e.split("/*")[0].trim()),xe=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i,_e=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function we(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;f(n<=4,'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.'));const[i,r]=function(e){const t=_e.exec(e);if(!t)return[,];const[,n,i,r]=t;return["--".concat(null!==n&&void 0!==n?n:i),r]}(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const e=s.trim();return me(e)?parseFloat(e):e}return be(r)?we(r,t,n+1):r}const Se=(e,t,n)=>n>t?t:n<e?e:n,Te={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},Me=M(M({},Te),{},{transform:e=>Se(0,1,e)}),Ee=M(M({},Te),{},{default:1}),Ce=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),Re=Ce("deg"),Pe=Ce("%"),Ne=Ce("px"),De=Ce("vh"),Le=Ce("vw"),Ie=M(M({},Pe),{},{parse:e=>Pe.parse(e)/100,transform:e=>Pe.transform(100*e)}),Oe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ke=e=>e===Te||e===Ne,Be=(e,t)=>parseFloat(e.split(", ")[t]),Fe=(e,t)=>(n,i)=>{let{transform:r}=i;if("none"===r||!r)return 0;const s=r.match(/^matrix3d\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)\)$/);if(s)return Be(s[1],t);{const t=r.match(/^matrix\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)\)$/);return t?Be(t[1],e):0}},Ue=new Set(["x","y","z"]),ze=B.filter((e=>!Ue.has(e)));const qe={width:(e,t)=>{let{x:n}=e,{paddingLeft:i="0",paddingRight:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},height:(e,t)=>{let{y:n}=e,{paddingTop:i="0",paddingBottom:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:i}=t;return parseFloat(i)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:i}=t;return parseFloat(i)+(n.max-n.min)},x:Fe(4,13),y:Fe(5,14)};qe.translateX=qe.x,qe.translateY=qe.y;const Ve=e=>t=>t.test(e),Ge=[Te,Ne,Pe,Re,Le,De,{test:e=>"auto"===e,parse:e=>e}],je=e=>Ge.find(Ve(e)),He=new Set;let We=!1,Xe=!1;function Ye(){if(Xe){const e=Array.from(He).filter((e=>e.needsMeasurement)),t=new Set(e.map((e=>e.element))),n=new Map;t.forEach((e=>{const t=function(e){const t=[];return ze.forEach((n=>{const i=e.getValue(n);void 0!==i&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))})),t}(e);t.length&&(n.set(e,t),e.render())})),e.forEach((e=>e.measureInitialState())),t.forEach((e=>{e.render();const t=n.get(e);t&&t.forEach((t=>{let[n,i]=t;var r;null===(r=e.getValue(n))||void 0===r||r.set(i)}))})),e.forEach((e=>e.measureEndState())),e.forEach((e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)}))}Xe=!1,We=!1,He.forEach((e=>e.complete())),He.clear()}function Qe(){He.forEach((e=>{e.readKeyframes(),e.needsMeasurement&&(Xe=!0)}))}class Ke{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=r,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?(He.add(this),We||(We=!0,$.read(Qe),$.resolveKeyframes(Ye))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;for(let r=0;r<e.length;r++)if(null===e[r])if(0===r){const r=null===i||void 0===i?void 0:i.get(),s=e[e.length-1];if(void 0!==r)e[0]=r;else if(n&&t){const i=n.readValue(t,s);void 0!==i&&null!==i&&(e[0]=i)}void 0===e[0]&&(e[0]=s),i&&void 0===r&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),He.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,He.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Ze=e=>Math.round(1e5*e)/1e5,Je=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const $e=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,et=(e,t)=>n=>Boolean("string"===typeof n&&$e.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),tt=(e,t,n)=>i=>{if("string"!==typeof i)return i;const[r,s,o,a]=i.match(Je);return{[e]:parseFloat(r),[t]:parseFloat(s),[n]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},nt=M(M({},Te),{},{transform:e=>Math.round((e=>Se(0,255,e))(e))}),it={test:et("rgb","red"),parse:tt("red","green","blue"),transform:e=>{let{red:t,green:n,blue:i,alpha:r=1}=e;return"rgba("+nt.transform(t)+", "+nt.transform(n)+", "+nt.transform(i)+", "+Ze(Me.transform(r))+")"}};const rt={test:et("#"),parse:function(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}},transform:it.transform},st={test:et("hsl","hue"),parse:tt("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:i,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+Pe.transform(Ze(n))+", "+Pe.transform(Ze(i))+", "+Ze(Me.transform(r))+")"}},ot={test:e=>it.test(e)||rt.test(e)||st.test(e),parse:e=>it.test(e)?it.parse(e):st.test(e)?st.parse(e):rt.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?it.transform(e):st.transform(e)},at=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const lt="number",ct="color",ut=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function ht(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const o=t.replace(ut,(e=>(ot.test(e)?(i.color.push(s),r.push(ct),n.push(ot.parse(e))):e.startsWith("var(")?(i.var.push(s),r.push("var"),n.push(e)):(i.number.push(s),r.push(lt),n.push(parseFloat(e))),++s,"${}"))).split("${}");return{values:n,split:o,indexes:i,types:r}}function dt(e){return ht(e).values}function pt(e){const{split:t,types:n}=ht(e),i=t.length;return e=>{let r="";for(let s=0;s<i;s++)if(r+=t[s],void 0!==e[s]){const t=n[s];r+=t===lt?Ze(e[s]):t===ct?ot.transform(e[s]):e[s]}return r}}const At=e=>"number"===typeof e?0:e;const ft={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(Je))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(at))||void 0===n?void 0:n.length)||0)>0},parse:dt,createTransformer:pt,getAnimatableNone:function(e){const t=dt(e);return pt(e)(t.map(At))}},mt=new Set(["brightness","contrast","saturate","opacity"]);function gt(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[i]=n.match(Je)||[];if(!i)return e;const r=n.replace(i,"");let s=mt.has(t)?1:0;return i!==n&&(s*=100),t+"("+s+r+")"}const vt=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,yt=M(M({},ft),{},{getAnimatableNone:e=>{const t=e.match(vt);return t?t.map(gt).join(" "):e}}),bt={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},xt={rotate:Re,rotateX:Re,rotateY:Re,rotateZ:Re,scale:Ee,scaleX:Ee,scaleY:Ee,scaleZ:Ee,skew:Re,skewX:Re,skewY:Re,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:Me,originX:Ie,originY:Ie,originZ:Ne},_t=M(M({},Te),{},{transform:Math.round}),wt=M(M(M({},bt),xt),{},{zIndex:_t,size:Ne,fillOpacity:Me,strokeOpacity:Me,numOctaves:_t}),St=M(M({},wt),{},{color:ot,backgroundColor:ot,outlineColor:ot,fill:ot,stroke:ot,borderColor:ot,borderTopColor:ot,borderRightColor:ot,borderBottomColor:ot,borderLeftColor:ot,filter:yt,WebkitFilter:yt}),Tt=e=>St[e];function Mt(e,t){let n=Tt(e);return n!==yt&&(n=ft),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Et=new Set(["auto","none","0"]);class Ct extends Ke{constructor(e,t,n,i,r){super(e,t,n,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let a=0;a<e.length;a++){let n=e[a];if("string"===typeof n&&(n=n.trim(),be(n))){const i=we(n,t.current);void 0!==i&&(e[a]=i),a===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!Oe.has(n)||2!==e.length)return;const[i,r]=e,s=je(i),o=je(r);if(s!==o)if(ke(s)&&ke(o))for(let a=0;a<e.length;a++){const t=e[a];"string"===typeof t&&(e[a]=parseFloat(t))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let i=0;i<e.length;i++)fe(e[i])&&n.push(i);n.length&&function(e,t,n){let i,r=0;for(;r<e.length&&!i;){const t=e[r];"string"===typeof t&&!Et.has(t)&&ht(t).values.length&&(i=e[r]),r++}if(i&&n)for(const s of t)e[s]=Mt(n,i)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qe[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];void 0!==i&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=qe[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),(null===(e=this.removedTransforms)||void 0===e?void 0:e.length)&&this.removedTransforms.forEach((e=>{let[n,i]=e;t.getValue(n).set(i)})),this.resolveNoneKeyframes()}}function Rt(e){return"function"===typeof e}let Pt;function Nt(){Pt=void 0}const Dt={now:()=>(void 0===Pt&&Dt.set(te.isProcessing||X?te.timestamp:performance.now()),Pt),set:e=>{Pt=e,queueMicrotask(Nt)}},Lt=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!ft.test(e)&&"0"!==e||e.startsWith("url(")));function It(e,t,n,i){const r=e[0];if(null===r)return!1;if("display"===t||"visibility"===t)return!0;const s=e[e.length-1],o=Lt(r,t),a=Lt(s,t);return A(o===a,"You are trying to animate ".concat(t,' from "').concat(r,'" to "').concat(s,'". ').concat(r," is not an animatable value - to enable this animation set ").concat(r," to a value animatable to ").concat(s," via the `style` property.")),!(!o||!a)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||Rt(n))&&i)}const Ot=["autoplay","delay","type","repeat","repeatDelay","repeatType"];class kt{constructor(e){let{autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop"}=e,a=C(e,Ot);this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Dt.now(),this.options=M({autoplay:t,delay:n,type:i,repeat:r,repeatDelay:s,repeatType:o},a),this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(Qe(),Ye()),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Dt.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:r,delay:s,onComplete:o,onUpdate:a,isGenerator:l}=this.options;if(!l&&!It(e,n,i,r)){if(Y||!s)return null===a||void 0===a||a(K(e,this.options,t)),null===o||void 0===o||o(),void this.resolveFinishedPromise();this.options.duration=0}const c=this.initPlayback(e,t);!1!==c&&(this._resolved=M({keyframes:e,finalKeyframe:t},c),this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise((e=>{this.resolveFinishedPromise=e}))}}const Bt=(e,t,n)=>{const i=t-e;return 0===i?1:(n-e)/i},Ft=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i="";const r=Math.max(Math.round(t/n),2);for(let s=0;s<r;s++)i+=e(Bt(0,r-1,s))+", ";return"linear(".concat(i.substring(0,i.length-2),")")};function Ut(e,t){return t?e*(1e3/t):0}function zt(e,t,n){const i=Math.max(t-5,0);return Ut(n-e(i),t-i)}const qt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Vt=.001;function Gt(e){let t,n,{duration:i=qt.duration,bounce:r=qt.bounce,velocity:s=qt.velocity,mass:o=qt.mass}=e;A(i<=U(qt.maxDuration),"Spring duration must be 10 seconds or less");let a=1-r;a=Se(qt.minDamping,qt.maxDamping,a),i=Se(qt.minDuration,qt.maxDuration,z(i)),a<1?(t=e=>{const t=e*a,n=t*i,r=t-s,o=Ht(e,a),l=Math.exp(-n);return Vt-r/o*l},n=e=>{const n=e*a*i,r=n*s+s,o=Math.pow(a,2)*Math.pow(e,2)*i,l=Math.exp(-n),c=Ht(Math.pow(e,2),a);return(-t(e)+Vt>0?-1:1)*((r-o)*l)/c}):(t=e=>Math.exp(-e*i)*((e-s)*i+1)-.001,n=e=>Math.exp(-e*i)*(i*i*(s-e)));const l=function(e,t,n){let i=n;for(let r=1;r<jt;r++)i-=e(i)/t(i);return i}(t,n,5/i);if(i=U(i),isNaN(l))return{stiffness:qt.stiffness,damping:qt.damping,duration:i};{const e=Math.pow(l,2)*o;return{stiffness:e,damping:2*a*Math.sqrt(o*e),duration:i}}}const jt=12;function Ht(e,t){return e*Math.sqrt(1-t*t)}const Wt=2e4;function Xt(e){let t=0;let n=e.next(t);for(;!n.done&&t<Wt;)t+=50,n=e.next(t);return t>=Wt?1/0:t}const Yt=["duration","bounce"],Qt=["stiffness","damping","mass"];function Kt(e,t){return t.some((t=>void 0!==e[t]))}function Zt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:h,velocity:d,isResolvedFromDuration:p}=function(e){let t=M({velocity:qt.velocity,stiffness:qt.stiffness,damping:qt.damping,mass:qt.mass,isResolvedFromDuration:!1},e);if(!Kt(e,Qt)&&Kt(e,Yt))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(1.2*n),r=i*i,s=2*Se(.05,1,1-e.bounce)*Math.sqrt(r);t=M(M({},t),{},{mass:qt.mass,stiffness:r,damping:s})}else{const n=Gt(e);t=M(M(M({},t),n),{},{mass:qt.mass}),t.isResolvedFromDuration=!0}return t}(M(M({},n),{},{velocity:-z(n.velocity||0)})),A=d||0,f=c/(2*Math.sqrt(l*u)),m=o-s,g=z(Math.sqrt(l/u)),v=Math.abs(m)<5;let y;if(i||(i=v?qt.restSpeed.granular:qt.restSpeed.default),r||(r=v?qt.restDelta.granular:qt.restDelta.default),f<1){const e=Ht(g,f);y=t=>{const n=Math.exp(-f*g*t);return o-n*((A+f*g*m)/e*Math.sin(e*t)+m*Math.cos(e*t))}}else if(1===f)y=e=>o-Math.exp(-g*e)*(m+(A+g*m)*e);else{const e=g*Math.sqrt(f*f-1);y=t=>{const n=Math.exp(-f*g*t),i=Math.min(e*t,300);return o-n*((A+f*g*m)*Math.sinh(i)+e*m*Math.cosh(i))/e}}const b={calculatedDuration:p&&h||null,next:e=>{const t=y(e);if(p)a.done=e>=h;else{let n=0;f<1&&(n=0===e?U(A):zt(y,e,t));const s=Math.abs(n)<=i,l=Math.abs(o-t)<=r;a.done=s&&l}return a.value=a.done?o:t,a},toString:()=>{const e=Math.min(Xt(b),Wt),t=Ft((t=>b.next(e*t).value),e,30);return e+"ms "+t}};return b}function Jt(e){let{keyframes:t,velocity:n=0,power:i=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:h}=e;const d=t[0],p={done:!1,value:d},A=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let f=i*n;const m=d+f,g=void 0===a?m:a(m);g!==m&&(f=g-d);const v=e=>-f*Math.exp(-e/r),y=e=>g+v(e),b=e=>{const t=v(e),n=y(e);p.done=Math.abs(t)<=u,p.value=p.done?g:n};let x,_;const w=e=>{(e=>void 0!==l&&e<l||void 0!==c&&e>c)(p.value)&&(x=e,_=Zt({keyframes:[p.value,A(p.value)],velocity:zt(y,e,p.value),damping:s,stiffness:o,restDelta:u,restSpeed:h}))};return w(0),{calculatedDuration:null,next:e=>{let t=!1;return _||void 0!==x||(t=!0,b(e),w(e)),void 0!==x&&e>=x?_.next(e-x):(!t&&b(e),p)}}}const $t=re(.42,0,1,1),en=re(0,0,.58,1),tn=re(.42,0,.58,1),nn=e=>Array.isArray(e)&&"number"===typeof e[0],rn={linear:p,easeIn:$t,easeInOut:tn,easeOut:en,circIn:he,circInOut:pe,circOut:de,backIn:le,backInOut:ce,backOut:ae,anticipate:ue},sn=e=>{if(nn(e)){f(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,n,i,r]=e;return re(t,n,i,r)}return"string"===typeof e?(f(void 0!==rn[e],"Invalid easing type '".concat(e,"'")),rn[e]):e},on=(e,t)=>n=>t(e(n)),an=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(on)},ln=(e,t,n)=>e+(t-e)*n;function cn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function un(e,t){return n=>n>0?t:e}const hn=(e,t,n)=>{const i=e*e,r=n*(t*t-i)+i;return r<0?0:Math.sqrt(r)},dn=[rt,it,st];function pn(e){const t=(e=>dn.find((t=>t.test(e))))(e);if(A(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead.")),!Boolean(t))return!1;let n=t.parse(e);return t===st&&(n=function(e){let{hue:t,saturation:n,lightness:i,alpha:r}=e;t/=360,n/=100,i/=100;let s=0,o=0,a=0;if(n){const e=i<.5?i*(1+n):i+n-i*n,r=2*i-e;s=cn(r,e,t+1/3),o=cn(r,e,t),a=cn(r,e,t-1/3)}else s=o=a=i;return{red:Math.round(255*s),green:Math.round(255*o),blue:Math.round(255*a),alpha:r}}(n)),n}const An=(e,t)=>{const n=pn(e),i=pn(t);if(!n||!i)return un(e,t);const r=M({},n);return e=>(r.red=hn(n.red,i.red,e),r.green=hn(n.green,i.green,e),r.blue=hn(n.blue,i.blue,e),r.alpha=ln(n.alpha,i.alpha,e),it.transform(r))},fn=new Set(["none","hidden"]);function mn(e,t){return n=>ln(e,t,n)}function gn(e){return"number"===typeof e?mn:"string"===typeof e?be(e)?un:ot.test(e)?An:bn:Array.isArray(e)?vn:"object"===typeof e?ot.test(e)?An:yn:un}function vn(e,t){const n=[...e],i=n.length,r=e.map(((e,n)=>gn(e)(e,t[n])));return e=>{for(let t=0;t<i;t++)n[t]=r[t](e);return n}}function yn(e,t){const n=M(M({},e),t),i={};for(const r in n)void 0!==e[r]&&void 0!==t[r]&&(i[r]=gn(e[r])(e[r],t[r]));return e=>{for(const t in i)n[t]=i[t](e);return n}}const bn=(e,t)=>{const n=ft.createTransformer(t),i=ht(e),r=ht(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?fn.has(e)&&!r.values.length||fn.has(t)&&!i.values.length?function(e,t){return fn.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):an(vn(function(e,t){var n;const i=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const o=t.types[s],a=e.indexes[o][r[o]],l=null!==(n=e.values[a])&&void 0!==n?n:0;i[s]=l,r[o]++}return i}(i,r),r.values),n):(A(!0,"Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.")),un(e,t))};function xn(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return ln(e,t,n);return gn(e)(e,t)}function _n(e,t){let{clamp:n=!0,ease:i,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(f(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];if(2===s&&e[0]===e[1])return()=>t[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,n){const i=[],r=n||xn,s=e.length-1;for(let o=0;o<s;o++){let n=r(e[o],e[o+1]);if(t){const e=Array.isArray(t)?t[o]||p:t;n=an(e,n)}i.push(n)}return i}(t,i,r),a=o.length,l=t=>{let n=0;if(a>1)for(;n<e.length-2&&!(t<e[n+1]);n++);const i=Bt(e[n],e[n+1],t);return o[n](i)};return n?t=>l(Se(e[0],e[s-1],t)):l}function wn(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=Bt(0,t,i);e.push(ln(n,1,r))}}(t,e.length-1),t}function Sn(e){let{duration:t=300,keyframes:n,times:i,ease:r="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(r)?r.map(sn):sn(r),o={done:!1,value:n[0]},a=function(e,t){return e.map((e=>e*t))}(i&&i.length===n.length?i:wn(n),t),l=_n(a,n,{ease:Array.isArray(s)?s:(c=n,u=s,c.map((()=>u||tn)).splice(0,c.length-1))});var c,u;return{calculatedDuration:t,next:e=>(o.value=l(e),o.done=e>=t,o)}}const Tn=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:()=>$.update(t,!0),stop:()=>ee(t),now:()=>te.isProcessing?te.timestamp:Dt.now()}},Mn={decay:Jt,inertia:Jt,tween:Sn,keyframes:Sn,spring:Zt},En=e=>e/100;class Cn extends kt{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();const{onStop:e}=this.options;e&&e()};const{name:t,motionValue:n,element:i,keyframes:r}=this.options,s=(null===i||void 0===i?void 0:i.KeyframeResolver)||Ke;this.resolver=new s(r,((e,t)=>this.onKeyframesResolved(e,t)),t,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:r,velocity:s=0}=this.options,o=Rt(t)?t:Mn[t]||Sn;let a,l;o!==Sn&&"number"!==typeof e[0]&&(a=an(En,xn(e[0],e[1])),e=[0,100]);const c=o(M(M({},this.options),{},{keyframes:e}));"mirror"===r&&(l=o(M(M({},this.options),{},{keyframes:[...e].reverse(),velocity:-s}))),null===c.calculatedDuration&&(c.calculatedDuration=Xt(c));const{calculatedDuration:u}=c,h=u+i;return{generator:c,mirroredGenerator:l,mapPercentToKeyframes:a,calculatedDuration:u,resolvedDuration:h,totalDuration:h*(n+1)-i}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&e?this.state=this.pendingPlayState:this.pause()}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{resolved:n}=this;if(!n){const{keyframes:e}=this.options;return{done:!0,value:e[e.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:s,mapPercentToKeyframes:o,keyframes:a,calculatedDuration:l,totalDuration:c,resolvedDuration:u}=n;if(null===this.startTime)return r.next(0);const{delay:h,repeat:d,repeatType:p,repeatDelay:A,onUpdate:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const m=this.currentTime-h*(this.speed>=0?1:-1),g=this.speed>=0?m<0:m>c;this.currentTime=Math.max(m,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let v=this.currentTime,y=r;if(d){const e=Math.min(this.currentTime,c)/u;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===p?(n=1-n,A&&(n-=A/u)):"mirror"===p&&(y=s)),v=Se(0,1,n)*u}const b=g?{done:!1,value:a[0]}:y.next(v);o&&(b.value=o(b.value));let{done:x}=b;g||null===l||(x=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const _=null===this.holdTime&&("finished"===this.state||"running"===this.state&&x);return _&&void 0!==i&&(b.value=K(a,this.options,i)),f&&f(b.value),_&&this.finish(),b}get duration(){const{resolved:e}=this;return e?z(e.calculatedDuration):0}get time(){return z(this.currentTime)}set time(e){e=U(e),this.currentTime=e,null!==this.holdTime||0===this.speed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=z(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved)return void(this.pendingPlayState="running");if(this.isStopped)return;const{driver:e=Tn,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e((e=>this.tick(e)))),t&&t();const i=this.driver.now();null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=i):this.startTime=null!==n&&void 0!==n?n:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;this._resolved?(this.state="paused",this.holdTime=null!==(e=this.currentTime)&&void 0!==e?e:0):this.pendingPlayState="paused"}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Rn=new Set(["opacity","clipPath","filter","transform"]);function Pn(e){let t;return()=>(void 0===t&&(t=e()),t)}const Nn={linearEasing:void 0};function Dn(e,t){const n=Pn(e);return()=>{var e;return null!==(e=Nn[t])&&void 0!==e?e:n()}}const Ln=Dn((()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}),"linearEasing");function In(e){return Boolean("function"===typeof e&&Ln()||!e||"string"===typeof e&&(e in kn||Ln())||nn(e)||Array.isArray(e)&&e.every(In))}const On=e=>{let[t,n,i,r]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(i,", ").concat(r,")")},kn={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:On([0,.65,.55,1]),circOut:On([.55,0,1,.45]),backIn:On([.31,.01,.66,-.59]),backOut:On([.33,1.53,.69,.99])};function Bn(e,t){return e?"function"===typeof e&&Ln()?Ft(e,t):nn(e)?On(e):Array.isArray(e)?e.map((e=>Bn(e,t)||kn.easeOut)):kn[e]:void 0}function Fn(e,t,n){let{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[t]:n};l&&(c.offset=l);const u=Bn(a,r);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===o?"alternate":"normal"})}function Un(e,t){e.timeline=t,e.onfinish=null}const zn=Pn((()=>Object.hasOwnProperty.call(Element.prototype,"animate"))),qn=["onComplete","onUpdate","motionValue","element"],Vn=["motionValue","onUpdate","onComplete","element"];const Gn={anticipate:ue,backInOut:ce,circInOut:pe};class jn extends kt{constructor(e){super(e);const{name:t,motionValue:n,element:i,keyframes:r}=this.options;this.resolver=new Ct(r,((e,t)=>this.onKeyframesResolved(e,t)),t,n,i),this.resolver.scheduleResolve()}initPlayback(e,t){var n;let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!(null===(n=a.owner)||void 0===n?void 0:n.current))return!1;var u;if("string"===typeof s&&Ln()&&s in Gn&&(s=Gn[s]),Rt((u=this.options).type)||"spring"===u.type||!In(u.ease)){const t=this.options,{onComplete:n,onUpdate:a,motionValue:l,element:c}=t,u=C(t,qn),h=function(e,t){const n=new Cn(M(M({},t),{},{keyframes:e,repeat:0,delay:0,isGenerator:!0}));let i={done:!1,value:e[0]};const r=[];let s=0;for(;!i.done&&s<2e4;)i=n.sample(s),r.push(i.value),s+=10;return{times:void 0,keyframes:r,duration:s-10,ease:"linear"}}(e,u);1===(e=h.keyframes).length&&(e[1]=e[0]),i=h.duration,r=h.times,s=h.ease,o="keyframes"}const h=Fn(a.owner.current,l,e,M(M({},this.options),{},{duration:i,times:r,ease:s}));return h.startTime=null!==c&&void 0!==c?c:this.calcStartTime(),this.pendingTimeline?(Un(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:n}=this.options;a.set(K(e,this.options,t)),n&&n(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return z(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return z(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=U(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(this._resolved){const{resolved:t}=this;if(!t)return p;const{animation:n}=t;Un(n,e)}else this.pendingTimeline=e;return p}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;"finished"===t.playState&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:i,type:r,ease:s,times:o}=e;if("idle"===t.playState||"finished"===t.playState)return;if(this.time){const e=this.options,{motionValue:t,onUpdate:a,onComplete:l,element:c}=e,u=C(e,Vn),h=new Cn(M(M({},u),{},{keyframes:n,duration:i,type:r,ease:s,times:o,isGenerator:!0})),d=U(this.time);t.setWithVelocity(h.sample(d-10).value,h.sample(d).value,10)}const{onStop:a}=this.options;a&&a(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:s,type:o}=e;return zn()&&n&&Rn.has(n)&&t&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate&&!i&&"mirror"!==r&&0!==s&&"inertia"!==o}}const Hn=Pn((()=>void 0!==window.ScrollTimeline));class Wn{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,t){return Promise.all(this.animations).then(e).catch(t)}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map((n=>Hn()&&n.attachTimeline?n.attachTimeline(e):t(n)));return()=>{n.forEach(((e,t)=>{e&&e(),this.animations[t].stop()}))}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach((t=>t[e]()))}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const Xn=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const Yn=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return o=>{const a=H(i,e)||{},l=a.delay||i.delay||0;let{elapsed:c=0}=i;c-=U(l);let u=M(M({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},a),{},{delay:-c,onUpdate:e=>{t.set(e),a.onUpdate&&a.onUpdate(e)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:s?void 0:r});(function(e){let{when:t,delay:n,delayChildren:i,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:l,from:c,elapsed:u}=e,h=C(e,Xn);return!!Object.keys(h).length})(a)||(u=M(M({},u),j(e,u))),u.duration&&(u.duration=U(u.duration)),u.repeatDelay&&(u.repeatDelay=U(u.repeatDelay)),void 0!==u.from&&(u.keyframes[0]=u.from);let h=!1;if((!1===u.type||0===u.duration&&!u.repeatDelay)&&(u.duration=0,0===u.delay&&(h=!0)),(Y||W)&&(h=!0,u.duration=0,u.delay=0),h&&!s&&void 0!==t.get()){const e=K(u.keyframes,a);if(void 0!==e)return $.update((()=>{u.onUpdate(e),u.onComplete()})),new Wn([])}return!s&&jn.supports(u)?new jn(u):new Cn(u)}},Qn=e=>R(e)?e[e.length-1]||0:e;function Kn(e,t){-1===e.indexOf(t)&&e.push(t)}function Zn(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Jn{constructor(){this.subscriptions=[]}add(e){return Kn(this.subscriptions,e),()=>Zn(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(1===i)this.subscriptions[0](e,t,n);else for(let r=0;r<i;r++){const i=this.subscriptions[r];i&&i(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const $n={current:void 0};class ei{constructor(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.version="11.13.5",this.canTrackVelocity=null,this.events={},this.updateAndNotify=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=Dt.now();t.updatedAt!==i&&t.setPrevFrameValue(),t.prev=t.current,t.setCurrent(e),t.current!==t.prev&&t.events.change&&t.events.change.notify(t.current),n&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Dt.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(e=>!isNaN(parseFloat(e)))(this.current))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Jn);const n=this.events[e].add(t);return"change"===e?()=>{n(),$.read((()=>{this.events.change.getSize()||this.stop()}))}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return $n.current&&$n.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Dt.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Ut(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise((t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ti(e,t){return new ei(e,t)}const ni=["transitionEnd","transition"];function ii(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,ti(n))}const ri=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),si="data-"+ri("framerAppearId");function oi(e){return e.props[si]}const ai=e=>Boolean(e&&e.getVelocity);function li(e,t){const n=e.getValue("willChange");if(function(e){return Boolean(ai(e)&&e.add)}(n))return n.add(t)}const ci=["transition","transitionEnd"];function ui(e,t){let{protectedKeys:n,needsAnimating:i}=e;const r=n.hasOwnProperty(t)&&!0!==i[t];return i[t]=!1,r}function hi(e,t){let{delay:n=0,transitionOverride:i,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s;let{transition:o=e.getDefaultTransition(),transitionEnd:a}=t,l=C(t,ci);i&&(o=i);const c=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const h in l){const t=e.getValue(h,null!==(s=e.latestValues[h])&&void 0!==s?s:null),i=l[h];if(void 0===i||u&&ui(u,h))continue;const r=M({delay:n},H(o||{},h));let a=!1;if(window.MotionHandoffAnimation){const t=oi(e);if(t){const e=window.MotionHandoffAnimation(t,h,$);null!==e&&(r.startTime=e,a=!0)}}li(e,h),t.start(Yn(h,t,i,e.shouldReduceMotion&&F.has(h)?{type:!1}:r,e,a));const d=t.animation;d&&c.push(d)}return a&&Promise.all(c).then((()=>{$.update((()=>{a&&function(e,t){let n=I(e,t)||{},{transitionEnd:i={},transition:r={}}=n,s=C(n,ni);s=M(M({},s),i);for(const o in s)ii(e,o,Qn(s[o]))}(e,a)}))})),c}function di(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;const r=I(e,t,"exit"===n.type?null===(i=e.presenceContext)||void 0===i?void 0:i.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const o=r?()=>Promise.all(hi(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:r=0,staggerChildren:o,staggerDirection:a}=s;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5?arguments[5]:void 0;const o=[],a=(e.variantChildren.size-1)*i,l=1===r?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i}:function(){return a-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i};return Array.from(e.variantChildren).sort(pi).forEach(((e,i)=>{e.notify("AnimationStart",t),o.push(di(e,t,M(M({},s),{},{delay:n+l(i)})).then((()=>e.notify("AnimationComplete",t))))})),Promise.all(o)}(e,t,r+i,o,a,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[e,t]="beforeChildren"===l?[o,a]:[a,o];return e().then((()=>t()))}return Promise.all([o(),a(n.delay)])}function pi(e,t){return e.sortNodePosition(t)}const Ai=k.length;function fi(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&fi(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<Ai;n++){const i=k[n],r=e.props[i];(N(r)||!1===r)&&(t[i]=r)}return t}const mi=["transition","transitionEnd"],gi=[...O].reverse(),vi=O.length;function yi(e){return t=>Promise.all(t.map((t=>{let{animation:n,options:i}=t;return function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const r=t.map((t=>di(e,t,i)));n=Promise.all(r)}else if("string"===typeof t)n=di(e,t,i);else{const r="function"===typeof t?I(e,t,i.custom):t;n=Promise.all(hi(e,r,i))}return n.then((()=>{e.notify("AnimationComplete",t)}))}(e,n,i)})))}function bi(e){let t=yi(e),n=wi(),i=!0;const r=t=>(n,i)=>{var r;const s=I(e,i,"exit"===t?null===(r=e.presenceContext)||void 0===r?void 0:r.custom:void 0);if(s){const{transition:e,transitionEnd:t}=s,i=C(s,mi);n=M(M(M({},n),i),t)}return n};function s(s){const{props:o}=e,a=fi(e.parent)||{},l=[],c=new Set;let u={},h=1/0;for(let t=0;t<vi;t++){const d=gi[t],p=n[d],A=void 0!==o[d]?o[d]:a[d],f=N(A),m=d===s?p.isActive:null;!1===m&&(h=t);let g=A===a[d]&&A!==o[d]&&f;if(g&&i&&e.manuallyAnimateOnMount&&(g=!1),p.protectedKeys=M({},u),!p.isActive&&null===m||!A&&!p.prevProp||E(A)||"boolean"===typeof A)continue;const v=xi(p.prevProp,A);let y=v||d===s&&p.isActive&&!g&&f||t>h&&f,b=!1;const x=Array.isArray(A)?A:[A];let _=x.reduce(r(d),{});!1===m&&(_={});const{prevResolvedValues:w={}}=p,S=M(M({},w),_),T=t=>{y=!0,c.has(t)&&(b=!0,c.delete(t)),p.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in S){const t=_[e],n=w[e];if(u.hasOwnProperty(e))continue;let i=!1;i=R(t)&&R(n)?!P(t,n):t!==n,i?void 0!==t&&null!==t?T(e):c.add(e):void 0!==t&&c.has(e)?T(e):p.protectedKeys[e]=!0}p.prevProp=A,p.prevResolvedValues=_,p.isActive&&(u=M(M({},u),_)),i&&e.blockInitialAnimation&&(y=!1);y&&(!(g&&v)||b)&&l.push(...x.map((e=>({animation:e,options:{type:d}}))))}if(c.size){const t={};c.forEach((n=>{const i=e.getBaseTarget(n),r=e.getValue(n);r&&(r.liveStyle=!0),t[n]=null!==i&&void 0!==i?i:null})),l.push({animation:t})}let d=Boolean(l.length);return!i||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(d=!1),i=!1,d?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,i){var r;if(n[t].isActive===i)return Promise.resolve();null===(r=e.variantChildren)||void 0===r||r.forEach((e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,i)})),n[t].isActive=i;const o=s(t);for(const e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=wi(),i=!0}}}function xi(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!P(t,e)}function _i(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wi(){return{animate:_i(!0),whileInView:_i(),whileHover:_i(),whileTap:_i(),whileDrag:_i(),whileFocus:_i(),exit:_i()}}class Si{constructor(e){this.isMounted=!1,this.node=e}update(){}}let Ti=0;const Mi={animation:{Feature:class extends Si{constructor(e){super(e),e.animationState||(e.animationState=bi(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();E(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends Si{constructor(){super(...arguments),this.id=Ti++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then((()=>t(this.id)))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}}};const Ei={x:!1,y:!1};function Ci(){return Ei.x||Ei.y}function Ri(e){return t=>{"touch"===t.pointerType||Ci()||e(t)}}function Pi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new AbortController,r=M(M({passive:!0},n),{},{signal:i.signal}),s=Ri((e=>{const{target:n}=e,i=t(e);if(!i||!n)return;const s=Ri((e=>{i(e),n.removeEventListener("pointerleave",s)}));n.addEventListener("pointerleave",s,r)}));return function(e,t,n){var i;if(e instanceof Element)return[e];if("string"===typeof e){let r=document;t&&(r=t.current);const s=null!==(i=null===n||void 0===n?void 0:n[e])&&void 0!==i?i:r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}(e).forEach((e=>{e.addEventListener("pointerenter",s,r)})),()=>i.abort()}const Ni=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function Di(e){return{point:{x:e.pageX,y:e.pageY}}}function Li(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}function Ii(e,t,n,i){return Li(e,t,(e=>t=>Ni(t)&&e(t,Di(t)))(n),i)}const Oi=(e,t)=>Math.abs(e-t);class ki{constructor(e,t){let{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=Ui(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=Oi(e.x,t.x),i=Oi(e.y,t.y);return Math.sqrt(n**2+i**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;const{point:i}=e,{timestamp:r}=te;this.history.push(M(M({},i),{},{timestamp:r}));const{onStart:s,onMove:o}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=Bi(t,this.transformPagePoint),$.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:i,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=Ui("pointercancel"===e.type?this.lastMoveEventInfo:Bi(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),i&&i(e,s)},!Ni(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const s=Bi(Di(e),this.transformPagePoint),{point:o}=s,{timestamp:a}=te;this.history=[M(M({},o),{},{timestamp:a})];const{onSessionStart:l}=t;l&&l(e,Ui(s,this.history)),this.removeListeners=an(Ii(this.contextWindow,"pointermove",this.handlePointerMove),Ii(this.contextWindow,"pointerup",this.handlePointerUp),Ii(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ee(this.updatePoint)}}function Bi(e,t){return t?{point:t(e.point)}:e}function Fi(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ui(e,t){let{point:n}=e;return{point:n,delta:Fi(n,qi(t)),offset:Fi(n,zi(t)),velocity:Vi(t,.1)}}function zi(e){return e[0]}function qi(e){return e[e.length-1]}function Vi(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=qi(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>U(t)));)n--;if(!i)return{x:0,y:0};const s=z(r.timestamp-i.timestamp);if(0===s)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Gi(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function ji(e){return e.max-e.min}function Hi(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=i,e.originPoint=ln(t.min,t.max,e.origin),e.scale=ji(n)/ji(t),e.translate=ln(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function Wi(e,t,n,i){Hi(e.x,t.x,n.x,i?i.originX:void 0),Hi(e.y,t.y,n.y,i?i.originY:void 0)}function Xi(e,t,n){e.min=n.min+t.min,e.max=e.min+ji(t)}function Yi(e,t,n){e.min=t.min-n.min,e.max=e.min+ji(t)}function Qi(e,t,n){Yi(e.x,t.x,n.x),Yi(e.y,t.y,n.y)}function Ki(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function Zi(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}const Ji=.35;function $i(e,t,n){return{min:er(e,t),max:er(e,n)}}function er(e,t){return"number"===typeof e?e:e[t]||0}const tr=()=>({x:{min:0,max:0},y:{min:0,max:0}});function nr(e){return[e("x"),e("y")]}function ir(e){let{top:t,left:n,right:i,bottom:r}=e;return{x:{min:n,max:i},y:{min:t,max:r}}}function rr(e){return void 0===e||1===e}function sr(e){let{scale:t,scaleX:n,scaleY:i}=e;return!rr(t)||!rr(n)||!rr(i)}function or(e){return sr(e)||ar(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ar(e){return lr(e.x)||lr(e.y)}function lr(e){return e&&"0%"!==e}function cr(e,t,n){return n+t*(e-n)}function ur(e,t,n,i,r){return void 0!==r&&(e=cr(e,r,i)),cr(e,n,i)+t}function hr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=ur(e.min,t,n,i,r),e.max=ur(e.max,t,n,i,r)}function dr(e,t){let{x:n,y:i}=t;hr(e.x,n.translate,n.scale,n.originPoint),hr(e.y,i.translate,i.scale,i.originPoint)}const pr=.999999999999,Ar=1.0000000000001;function fr(e,t){e.min=e.min+t,e.max=e.max+t}function mr(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;hr(e,t,n,ln(e.min,e.max,r),i)}function gr(e,t){mr(e.x,t.x,t.scaleX,t.scale,t.originX),mr(e.y,t.y,t.scaleY,t.scale,t.originY)}function vr(e,t){return ir(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}(e.getBoundingClientRect(),t))}const yr=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},br=new WeakMap;class xr{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:i}=this.getProps();this.panSession=new ki(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Di(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:i,onDragStart:r}=this.getProps();if(n&&!i&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(s=n)||"y"===s?Ei[s]?null:(Ei[s]=!0,()=>{Ei[s]=!1}):Ei.x||Ei.y?null:(Ei.x=Ei.y=!0,()=>{Ei.x=Ei.y=!1}),!this.openDragLock))return;var s;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),nr((e=>{let t=this.getAxisMotionValue(e).get()||0;if(Pe.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const i=n.layout.layoutBox[e];if(i){t=ji(i)*(parseFloat(t)/100)}}}this.originPoint[e]=t})),r&&$.postRender((()=>r(e,t))),li(this.visualElement,"transform");const{animationState:o}=this.visualElement;o&&o.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:n,dragDirectionLock:i,onDirectionLock:r,onDrag:s}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:o}=t;if(i&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(o),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",t.point,o),this.updateAxis("y",t.point,o),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>nr((e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:yr(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&$.postRender((()=>r(e,t)))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!_r(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,t,n){let{min:i,max:r}=t;return void 0!==i&&e<i?e=n?ln(i,e,n.min):Math.max(e,i):void 0!==r&&e>r&&(e=n?ln(r,e,n.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),r.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,r=this.constraints;t&&Gi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!i)&&function(e,t){let{top:n,left:i,bottom:r,right:s}=t;return{x:Ki(e.x,i,s),y:Ki(e.y,n,r)}}(i.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ji;return!1===e?e=0:!0===e&&(e=Ji),{x:$i(e,"left","right"),y:$i(e,"top","bottom")}}(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&nr((e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(i.layoutBox[e],this.constraints[e]))}))}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Gi(e))return!1;const n=e.current;f(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=function(e,t,n){const i=vr(e,n),{scroll:r}=t;return r&&(fr(i.x,r.offset.x),fr(i.y,r.offset.y)),i}(n,i.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:Zi(e.x,t.x),y:Zi(e.y,t.y)}}(i.layout.layoutBox,r);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=ir(e))}return s}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},l=nr((o=>{if(!_r(o,t,this.currentDirection))return;let l=a&&a[o]||{};s&&(l={min:0,max:0});const c=i?200:1e6,u=i?40:1e7,h=M(M({type:"inertia",velocity:n?e[o]:0,bounceStiffness:c,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10},r),l);return this.startAxisValueAnimation(o,h)}));return Promise.all(l).then(o)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return li(this.visualElement,e),n.start(Yn(e,n,0,t,this.visualElement,!1))}stopAnimation(){nr((e=>this.getAxisMotionValue(e).stop()))}pauseAnimation(){nr((e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()}))}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){nr((t=>{const{drag:n}=this.getProps();if(!_r(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(t);if(i&&i.layout){const{min:n,max:s}=i.layout.layoutBox[t];r.set(e[t]-ln(n,s,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Gi(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};nr((e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();i[e]=function(e,t){let n=.5;const i=ji(e),r=ji(t);return r>i?n=Bt(t.min,t.max-i,e.min):i>r&&(n=Bt(e.min,e.max-r,t.min)),Se(0,1,n)}({min:n,max:n},this.constraints[e])}}));const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),nr((t=>{if(!_r(t,e,null))return;const n=this.getAxisMotionValue(t),{min:r,max:s}=this.constraints[t];n.set(ln(r,s,i[t]))}))}addListeners(){if(!this.visualElement.current)return;br.set(this.visualElement,this);const e=Ii(this.visualElement.current,"pointerdown",(e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)})),t=()=>{const{dragConstraints:e}=this.getProps();Gi(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),$.read(t);const r=Li(window,"resize",(()=>this.scalePositionWithinConstraints())),s=n.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(nr((e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))})),this.visualElement.render())}));return()=>{r(),e(),i(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:s=Ji,dragMomentum:o=!0}=e;return M(M({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:s,dragMomentum:o})}}function _r(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const wr=e=>(t,n)=>{e&&$.postRender((()=>e(t,n)))};const Sr=(0,t.createContext)({}),Tr={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Mr(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Er={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!Ne.test(e))return e;e=parseFloat(e)}const n=Mr(e,t.target.x),i=Mr(e,t.target.y);return"".concat(n,"% ").concat(i,"%")}},Cr={correct:(e,t)=>{let{treeScale:n,projectionDelta:i}=t;const r=e,s=ft.parse(e);if(s.length>5)return r;const o=ft.createTransformer(e),a="number"!==typeof s[0]?1:0,l=i.x.scale*n.x,c=i.y.scale*n.y;s[0+a]/=l,s[1+a]/=c;const u=ln(l,c,.5);return"number"===typeof s[2+a]&&(s[2+a]/=u),"number"===typeof s[3+a]&&(s[3+a]/=u),o(s)}},Rr={};const{schedule:Pr,cancel:Nr}=J(queueMicrotask,!1);class Dr extends t.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=e;var s;s=Ir,Object.assign(Rr,s),r&&(t.group&&t.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",(()=>{this.safeToRemove()})),r.setOptions(M(M({},r.options),{},{onExitComplete:()=>this.safeToRemove()}))),Tr.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:r}=this.props,s=n.projection;return s?(s.isPresent=r,i||e.layoutDependency!==t||void 0===t?s.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?s.promote():s.relegate()||$.postRender((()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Pr.postRender((()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Lr(e){const[n,i]=function(){const e=(0,t.useContext)(s);if(null===e)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=e,o=(0,t.useId)();(0,t.useEffect)((()=>r(o)),[]);const a=(0,t.useCallback)((()=>i&&i(o)),[o,i]);return!n&&i?[!1,a]:[!0]}(),o=(0,t.useContext)(d);return(0,r.jsx)(Dr,M(M({},e),{},{layoutGroup:o,switchLayoutGroup:(0,t.useContext)(Sr),isPresent:n,safeToRemove:i}))}const Ir={borderRadius:M(M({},Er),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Er,borderTopRightRadius:Er,borderBottomLeftRadius:Er,borderBottomRightRadius:Er,boxShadow:Cr},Or=["TopLeft","TopRight","BottomLeft","BottomRight"],kr=Or.length,Br=e=>"string"===typeof e?parseFloat(e):e,Fr=e=>"number"===typeof e||Ne.test(e);function Ur(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const zr=Vr(0,.5,de),qr=Vr(.5,.95,p);function Vr(e,t,n){return i=>i<e?0:i>t?1:n(Bt(e,t,i))}function Gr(e,t){e.min=t.min,e.max=t.max}function jr(e,t){Gr(e.x,t.x),Gr(e.y,t.y)}function Hr(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Wr(e,t,n,i,r){return e=cr(e-=t,1/n,i),void 0!==r&&(e=cr(e,1/r,i)),e}function Xr(e,t,n,i,r){let[s,o,a]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;Pe.test(t)&&(t=parseFloat(t),t=ln(o.min,o.max,t/100)-o.min);if("number"!==typeof t)return;let a=ln(s.min,s.max,i);e===s&&(a-=t),e.min=Wr(e.min,t,n,a,r),e.max=Wr(e.max,t,n,a,r)}(e,t[s],t[o],t[a],t.scale,i,r)}const Yr=["x","scaleX","originX"],Qr=["y","scaleY","originY"];function Kr(e,t,n,i){Xr(e.x,t,Yr,n?n.x:void 0,i?i.x:void 0),Xr(e.y,t,Qr,n?n.y:void 0,i?i.y:void 0)}function Zr(e){return 0===e.translate&&1===e.scale}function Jr(e){return Zr(e.x)&&Zr(e.y)}function $r(e,t){return e.min===t.min&&e.max===t.max}function es(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function ts(e,t){return es(e.x,t.x)&&es(e.y,t.y)}function ns(e){return ji(e.x)/ji(e.y)}function is(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class rs{constructor(){this.members=[]}add(e){Kn(this.members,e),e.scheduleRender()}remove(e){if(Zn(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex((t=>e===t));if(0===t)return!1;let n;for(let i=t;i>=0;i--){const e=this.members[i];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;!1===i&&n.hide()}}exitAnimationComplete(){this.members.forEach((e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()}))}scheduleRender(){this.members.forEach((e=>{e.instance&&e.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const ss=(e,t)=>e.depth-t.depth;class os{constructor(){this.children=[],this.isDirty=!1}add(e){Kn(this.children,e),this.isDirty=!0}remove(e){Zn(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ss),this.isDirty=!1,this.children.forEach(e)}}function as(e){const t=ai(e)?e.get():e;return(e=>Boolean(e&&"object"===typeof e&&e.mix&&e.toValue))(t)?t.toValue():t}function ls(e,t){const n=Dt.now(),i=r=>{let{timestamp:s}=r;const o=s-n;o>=t&&(ee(i),e(o-t))};return $.read(i,!0),()=>ee(i)}const cs={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},us="undefined"!==typeof window&&void 0!==window.MotionDebug,hs=["","X","Y","Z"],ds={visibility:"hidden"};let ps=0;function As(e,t,n,i){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),i&&(i[e]=0))}function fs(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=oi(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",$,!(t||i))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&fs(i)}function ms(e){let{attachResizeListener:t,defaultParent:n,measureScroll:i,checkIsScrollRoot:r,resetTransform:s}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=ps++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,us&&(cs.totalNodes=cs.resolvedTargetDeltas=cs.recalculatedProjection=0),this.nodes.forEach(ys),this.nodes.forEach(Ms),this.nodes.forEach(Es),this.nodes.forEach(bs),us&&window.MotionDebug.record(cs)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new os)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Jn),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&t.notify(...i)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var i;this.isSVG=(i=e)instanceof SVGElement&&"svg"!==i.tagName,this.instance=e;const{layoutId:r,layout:s,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(s||r)&&(this.isLayoutDirty=!0),t){let n;const i=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,n&&n(),n=ls(i,250),Tr.hasAnimatedSinceResize&&(Tr.hasAnimatedSinceResize=!1,this.nodes.forEach(Ts))}))}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&o&&(r||s)&&this.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n,hasRelativeTargetChanged:i,layout:r}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const s=this.options.transition||o.getDefaultTransition()||Ls,{onLayoutAnimationStart:a,onLayoutAnimationComplete:l}=o.getProps(),c=!this.targetLayout||!ts(this.targetLayout,r)||i,u=!n&&i;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||u||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,u);const e=M(M({},H(s,"layout")),{},{onPlay:a,onComplete:l});(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else n||Ts(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ee(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Cs),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&fs(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let r=0;r<this.path.length;r++){const e=this.path[r];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(_s);this.isUpdating||this.nodes.forEach(ws),this.isUpdating=!1,this.nodes.forEach(Ss),this.nodes.forEach(gs),this.nodes.forEach(vs),this.clearAllSnapshots();const e=Dt.now();te.delta=Se(0,1e3/60,e-te.timestamp),te.timestamp=e,te.isProcessing=!0,ne.update.process(te),ne.preRender.process(te),ne.render.process(te),te.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Pr.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xs),this.sharedNodes.forEach(Rs)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t){const t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!s)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!Jr(this.projectionDelta),n=this.getTransformTemplate(),i=n?n(this.latestValues,""):void 0,r=i!==this.prevTransformTemplateValue;e&&(t||or(this.latestValues)||r)&&(s(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var i;return e&&(n=this.removeTransform(n)),ks((i=n).x),ks(i.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(Fs))){const{scroll:e}=this.root;e&&(fr(n.x,e.offset.x),fr(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(jr(n,e),null===(t=this.scroll)||void 0===t?void 0:t.wasRoot)return n;for(let i=0;i<this.path.length;i++){const t=this.path[i],{scroll:r,options:s}=t;t!==this.root&&r&&s.layoutScroll&&(r.wasRoot&&jr(n,e),fr(n.x,r.offset.x),fr(n.y,r.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};jr(n,e);for(let i=0;i<this.path.length;i++){const e=this.path[i];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&gr(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),or(e.latestValues)&&gr(n,e.latestValues)}return or(this.latestValues)&&gr(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};jr(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!or(e.latestValues))continue;sr(e.latestValues)&&e.updateSnapshot();const i={x:{min:0,max:0},y:{min:0,max:0}};jr(i,e.measurePageBox()),Kr(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,i)}return or(this.latestValues)&&Kr(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=M(M(M({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==te.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const i=Boolean(this.resumingFrom)||this!==n;if(!(e||i&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:r,layoutId:s}=this.options;if(this.layout&&(r||s)){if(this.resolvedRelativeTargetAt=te.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Qi(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),jr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),function(e,t,n){Xi(e.x,t.x,n.x),Xi(e.y,t.y,n.y)}(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):jr(this.target,this.layout.layoutBox),dr(this.target,this.targetDelta)):jr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Qi(this.relativeTargetOrigin,this.target,e.target),jr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}us&&cs.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!sr(this.parent.latestValues)&&!ar(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let i=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(i=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===te.timestamp&&(i=!1),i)return;const{layout:r,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!s)return;jr(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=n.length;if(!r)return;let s,o;t.x=t.y=1;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const{visualElement:r}=s.options;r&&r.props.style&&"contents"===r.props.style.display||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&gr(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,dr(e,o)),i&&or(s.latestValues)&&gr(e,s.latestValues))}t.x<Ar&&t.x>pr&&(t.x=1),t.y<Ar&&t.y>pr&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(Hr(this.prevProjectionDelta.x,this.projectionDelta.x),Hr(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),Wi(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===o&&this.treeScale.y===a&&is(this.projectionDelta.x,this.prevProjectionDelta.x)&&is(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),us&&cs.recalculatedProjection++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t;if(null===(t=this.options.visualElement)||void 0===t||t.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,i=n?n.latestValues:{},r=M({},this.latestValues),s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const o={x:{min:0,max:0},y:{min:0,max:0}},a=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,u=Boolean(a&&!c&&!0===this.options.crossfade&&!this.path.some(Ds));let h;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;Ps(s.x,e.x,n),Ps(s.y,e.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qi(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,n,i){Ns(e.x,t.x,n.x,i),Ns(e.y,t.y,n.y,i)}(this.relativeTarget,this.relativeTargetOrigin,o,n),h&&function(e,t){return $r(e.x,t.x)&&$r(e.y,t.y)}(this.relativeTarget,h)&&(this.isProjectionDirty=!1),h||(h={x:{min:0,max:0},y:{min:0,max:0}}),jr(h,this.relativeTarget)),a&&(this.animationValues=r,function(e,t,n,i,r,s){r?(e.opacity=ln(0,void 0!==n.opacity?n.opacity:1,zr(i)),e.opacityExit=ln(void 0!==t.opacity?t.opacity:1,0,qr(i))):s&&(e.opacity=ln(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,i));for(let o=0;o<kr;o++){const r="border".concat(Or[o],"Radius");let s=Ur(t,r),a=Ur(n,r);void 0===s&&void 0===a||(s||(s=0),a||(a=0),0===s||0===a||Fr(s)===Fr(a)?(e[r]=Math.max(ln(Br(s),Br(a),i),0),(Pe.test(a)||Pe.test(s))&&(e[r]+="%")):e[r]=a)}(t.rotate||n.rotate)&&(e.rotate=ln(t.rotate||0,n.rotate||0,i))}(r,i,this.latestValues,n,u,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ee(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$.update((()=>{Tr.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,n){const i=ai(e)?e:ti(e);return i.start(Yn("",i,t,n)),i.animation}(0,1e3,M(M({},e),{},{onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:i,latestValues:r}=e;if(t&&n&&i){if(this!==e&&this.layout&&i&&Bs(this.options.animationType,this.layout.layoutBox,i.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=ji(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const i=ji(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+i}jr(t,n),gr(t,r),Wi(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new rs);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this.getStack();i&&i.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const i={};n.z&&As("z",e,i,this.animationValues);for(let r=0;r<hs.length;r++)As("rotate".concat(hs[r]),e,i,this.animationValues),As("skew".concat(hs[r]),e,i,this.animationValues);e.render();for(const r in i)e.setStaticValue(r,i[r]),this.animationValues&&(this.animationValues[r]=i[r]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return ds;const i={visibility:""},r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=as(null===e||void 0===e?void 0:e.pointerEvents)||"",i.transform=r?r(this.latestValues,""):"none",i;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=as(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!or(this.latestValues)&&(t.transform=r?r({},""):"none",this.hasProjected=!1),t}const o=s.animationValues||s.latestValues;this.applyTransformsToTarget(),i.transform=function(e,t,n){let i="";const r=e.x.translate/t.x,s=e.y.translate/t.y,o=(null===n||void 0===n?void 0:n.z)||0;if((r||s||o)&&(i="translate3d(".concat(r,"px, ").concat(s,"px, ").concat(o,"px) ")),1===t.x&&1===t.y||(i+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:r,rotateY:s,skewX:o,skewY:a}=n;e&&(i="perspective(".concat(e,"px) ").concat(i)),t&&(i+="rotate(".concat(t,"deg) ")),r&&(i+="rotateX(".concat(r,"deg) ")),s&&(i+="rotateY(".concat(s,"deg) ")),o&&(i+="skewX(".concat(o,"deg) ")),a&&(i+="skewY(".concat(a,"deg) "))}const a=e.x.scale*t.x,l=e.y.scale*t.y;return 1===a&&1===l||(i+="scale(".concat(a,", ").concat(l,")")),i||"none"}(this.projectionDeltaWithTransform,this.treeScale,o),r&&(i.transform=r(o,i.transform));const{x:a,y:l}=this.projectionDelta;i.transformOrigin="".concat(100*a.origin,"% ").concat(100*l.origin,"% 0"),s.animationValues?i.opacity=s===this?null!==(n=null!==(t=o.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:i.opacity=s===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const c in Rr){if(void 0===o[c])continue;const{correct:e,applyTo:t}=Rr[c],n="none"===i.transform?o[c]:e(o[c],s);if(t){const e=t.length;for(let r=0;r<e;r++)i[t[r]]=n}else i[c]=n}return this.options.layoutId&&(i.pointerEvents=s===this?as(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()})),this.root.nodes.forEach(_s),this.root.sharedNodes.clear()}}}function gs(e){e.updateLayout()}function vs(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:i}=e.layout,{animationType:r}=e.options,s=n.source!==e.layout.source;"size"===r?nr((e=>{const i=s?n.measuredBox[e]:n.layoutBox[e],r=ji(i);i.min=t[e].min,i.max=i.min+r})):Bs(r,n.layoutBox,t)&&nr((i=>{const r=s?n.measuredBox[i]:n.layoutBox[i],o=ji(t[i]);r.max=r.min+o,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[i].max=e.relativeTarget[i].min+o)}));const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};Wi(o,t,n.layoutBox);const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?Wi(a,e.applyTransform(i,!0),n.measuredBox):Wi(a,t,n.layoutBox);const l=!Jr(o);let c=!1;if(!e.resumeFrom){const i=e.getClosestProjectingParent();if(i&&!i.resumeFrom){const{snapshot:r,layout:s}=i;if(r&&s){const o={x:{min:0,max:0},y:{min:0,max:0}};Qi(o,n.layoutBox,r.layoutBox);const a={x:{min:0,max:0},y:{min:0,max:0}};Qi(a,t,s.layoutBox),ts(o,a)||(c=!0),i.options.layoutRoot&&(e.relativeTarget=a,e.relativeTargetOrigin=o,e.relativeParent=i)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function ys(e){us&&cs.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function bs(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function xs(e){e.clearSnapshot()}function _s(e){e.clearMeasurements()}function ws(e){e.isLayoutDirty=!1}function Ss(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ts(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ms(e){e.resolveTargetDelta()}function Es(e){e.calcProjection()}function Cs(e){e.resetSkewAndRotation()}function Rs(e){e.removeLeadSnapshot()}function Ps(e,t,n){e.translate=ln(t.translate,0,n),e.scale=ln(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Ns(e,t,n,i){e.min=ln(t.min,n.min,i),e.max=ln(t.max,n.max,i)}function Ds(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const Ls={duration:.45,ease:[.4,0,.1,1]},Is=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Os=Is("applewebkit/")&&!Is("chrome/")?Math.round:p;function ks(e){e.min=Os(e.min),e.max=Os(e.max)}function Bs(e,t,n){return"position"===e||"preserve-aspect"===e&&!function(e,t,n){return Math.abs(e-t)<=n}(ns(t),ns(n),.2)}function Fs(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const Us=ms({attachResizeListener:(e,t)=>Li(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),zs={current:void 0},qs=ms({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!zs.current){const e=new Us({});e.mount(window),e.setOptions({layoutScroll:!0}),zs.current=e}return zs.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),Vs={pan:{Feature:class extends Si{constructor(){super(...arguments),this.removePointerDownListener=p}onPointerDown(e){this.session=new ki(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:yr(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:wr(e),onStart:wr(t),onMove:n,onEnd:(e,t)=>{delete this.session,i&&$.postRender((()=>i(e,t)))}}}mount(){this.removePointerDownListener=Ii(this.node.current,"pointerdown",(e=>this.onPointerDown(e)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Si{constructor(e){super(e),this.removeGroupControls=p,this.removeListeners=p,this.controls=new xr(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||p}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:qs,MeasureLayout:Lr}};function Gs(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover","Start"===n);const r=i["onHover"+n];r&&$.postRender((()=>r(t,Di(t))))}const js=(e,t)=>!!t&&(e===t||js(e,t.parentElement));function Hs(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,Di(n))}const Ws=["root"],Xs=new WeakMap,Ys=new WeakMap,Qs=e=>{const t=Xs.get(e.target);t&&t(e)},Ks=e=>{e.forEach(Qs)};function Zs(e,t,n){const i=function(e){let{root:t}=e,n=C(e,Ws);const i=t||document;Ys.has(i)||Ys.set(i,{});const r=Ys.get(i),s=JSON.stringify(n);return r[s]||(r[s]=new IntersectionObserver(Ks,M({root:t},n))),r[s]}(t);return Xs.set(e,n),i.observe(e),()=>{Xs.delete(e),i.unobserve(e)}}const Js={some:0,all:1};const $s={inView:{Feature:class extends Si{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:r}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof i?i:Js[i]};return Zs(this.node.current,s,(e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,r&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:i}=this.node.getProps(),s=t?n:i;s&&s(e)}))}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Si{constructor(){super(...arguments),this.removeStartListeners=p,this.removeEndListeners=p,this.removeAccessibleListeners=p,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Ii(window,"pointerup",((e,t)=>{if(!this.checkPressEnd())return;const{onTap:n,onTapCancel:i,globalTapTarget:r}=this.node.getProps(),s=r||js(this.node.current,e.target)?n:i;s&&$.update((()=>s(e,t)))}),{passive:!(n.onTap||n.onPointerUp)}),r=Ii(window,"pointercancel",((e,t)=>this.cancelPress(e,t)),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=an(i,r),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=Li(this.node.current,"keydown",(e=>{if("Enter"!==e.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=Li(this.node.current,"keyup",(e=>{"Enter"===e.key&&this.checkPressEnd()&&Hs("up",((e,t)=>{const{onTap:n}=this.node.getProps();n&&$.postRender((()=>n(e,t)))}))})),Hs("down",((e,t)=>{this.startPress(e,t)}))})),t=Li(this.node.current,"blur",(()=>{this.isPressing&&Hs("cancel",((e,t)=>this.cancelPress(e,t)))}));this.removeAccessibleListeners=an(e,t)}}startPress(e,t){this.isPressing=!0;const{onTapStart:n,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&$.postRender((()=>n(e,t)))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Ci()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&$.postRender((()=>n(e,t)))}mount(){const e=this.node.getProps(),t=Ii(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=Li(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=an(t,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends Si{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=an(Li(this.node.current,"focus",(()=>this.onFocus())),Li(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends Si{mount(){const{current:e}=this.node;e&&(this.unmount=Pi(e,(e=>(Gs(this.node,e,"Start"),e=>Gs(this.node,e,"End")))))}unmount(){}}}},eo={layout:{ProjectionNode:qs,MeasureLayout:Lr}},to=(0,t.createContext)({}),no=(0,t.createContext)({strict:!1});function io(e,n,i,r,o){var l,c;const{visualElement:u}=(0,t.useContext)(to),h=(0,t.useContext)(no),d=(0,t.useContext)(s),p=(0,t.useContext)(a).reducedMotion,A=(0,t.useRef)(null);r=r||h.renderer,!A.current&&r&&(A.current=r(e,{visualState:n,parent:u,props:i,presenceContext:d,blockInitialAnimation:!!d&&!1===d.initial,reducedMotionConfig:p}));const f=A.current,m=(0,t.useContext)(Sr);!f||f.projection||!o||"html"!==f.type&&"svg"!==f.type||function(e,t,n,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:ro(e.parent)),e.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:Boolean(o)||a&&Gi(a),visualElement:e,animationType:"string"===typeof s?s:"both",initialPromotionConfig:i,layoutScroll:l,layoutRoot:c})}(A.current,i,o,m);const g=(0,t.useRef)(!1);(0,t.useInsertionEffect)((()=>{f&&g.current&&f.update(i,d)}));const v=i[si],b=(0,t.useRef)(Boolean(v)&&!(null===(l=window.MotionHandoffIsComplete)||void 0===l?void 0:l.call(window,v))&&(null===(c=window.MotionHasOptimisedAnimation)||void 0===c?void 0:c.call(window,v)));return y((()=>{f&&(g.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),Pr.render(f.render),b.current&&f.animationState&&f.animationState.animateChanges())})),(0,t.useEffect)((()=>{f&&(!b.current&&f.animationState&&f.animationState.animateChanges(),b.current&&(queueMicrotask((()=>{var e;null===(e=window.MotionHandoffMarkAsComplete)||void 0===e||e.call(window,v)})),b.current=!1))})),f}function ro(e){if(e)return!1!==e.options.allowProjection?e.projection:ro(e.parent)}function so(e,n,i){return(0,t.useCallback)((t=>{t&&e.mount&&e.mount(t),n&&(t?n.mount(t):n.unmount()),i&&("function"===typeof i?i(t):Gi(i)&&(i.current=t))}),[n])}function oo(e){return E(e.animate)||k.some((t=>N(e[t])))}function ao(e){return Boolean(oo(e)||e.variants)}function lo(e){const{initial:n,animate:i}=function(e,t){if(oo(e)){const{initial:t,animate:n}=e;return{initial:!1===t||N(t)?t:void 0,animate:N(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,t.useContext)(to));return(0,t.useMemo)((()=>({initial:n,animate:i})),[co(n),co(i)])}function co(e){return Array.isArray(e)?e.join(" "):e}const uo={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ho={};for(const n in uo)ho[n]={isEnabled:e=>uo[n].some((t=>!!e[t]))};const po=Symbol.for("motionComponentSymbol");function Ao(e){let{preloadedFeatures:n,createVisualElement:i,useRender:s,useVisualState:o,Component:l}=e;n&&function(e){for(const t in e)ho[t]=M(M({},ho[t]),e[t])}(n);const c=(0,t.forwardRef)((function(e,n){let c;const u=M(M(M({},(0,t.useContext)(a)),e),{},{layoutId:fo(e)}),{isStatic:h}=u,d=lo(e),p=o(e,h);if(!h&&v){!function(){(0,t.useContext)(no).strict;0}();const e=function(e){const{drag:t,layout:n}=ho;if(!t&&!n)return{};const i=M(M({},t),n);return{MeasureLayout:(null===t||void 0===t?void 0:t.isEnabled(e))||(null===n||void 0===n?void 0:n.isEnabled(e))?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}(u);c=e.MeasureLayout,d.visualElement=io(l,p,u,i,e.ProjectionNode)}return(0,r.jsxs)(to.Provider,{value:d,children:[c&&d.visualElement?(0,r.jsx)(c,M({visualElement:d.visualElement},u)):null,s(l,e,so(p,d.visualElement,n),p,h,d.visualElement)]})}));return c[po]=l,c}function fo(e){let{layoutId:n}=e;const i=(0,t.useContext)(d).id;return i&&void 0!==n?i+"-"+n:n}const mo=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function go(e){return"string"===typeof e&&!e.includes("-")&&!!(mo.indexOf(e)>-1||/[A-Z]/.test(e))}function vo(e,t,n,i){let{style:r,vars:s}=t;Object.assign(e.style,r,i&&i.getProjectionStyles(n));for(const o in s)e.style.setProperty(o,s[o])}const yo=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function bo(e,t,n,i){vo(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(yo.has(r)?r:ri(r),t.attrs[r])}function xo(e,t){let{layout:n,layoutId:i}=t;return F.has(e)||e.startsWith("origin")||(n||void 0!==i)&&(!!Rr[e]||"opacity"===e)}function _o(e,t,n){var i;const{style:r}=e,s={};for(const o in r)(ai(r[o])||t.style&&ai(t.style[o])||xo(o,e)||void 0!==(null===(i=null===n||void 0===n?void 0:n.getValue(o))||void 0===i?void 0:i.liveStyle))&&(s[o]=r[o]);return s}function wo(e,t,n){const i=_o(e,t,n);for(const r in e)if(ai(e[r])||ai(t[r])){i[-1!==B.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]}return i}const So=["transitionEnd","transition"];const To=e=>(n,i)=>{const r=(0,t.useContext)(to),a=(0,t.useContext)(s),l=()=>function(e,t,n,i){let{scrapeMotionValuesFromProps:r,createRenderState:s,onMount:o}=e;const a={latestValues:Mo(t,n,i,r),renderState:s()};return o&&(a.mount=e=>o(t,e,a)),a}(e,n,r,a);return i?l():o(l)};function Mo(e,t,n,i){const r={},s=i(e,{});for(const d in s)r[d]=as(s[d]);let{initial:o,animate:a}=e;const l=oo(e),c=ao(e);t&&c&&!l&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===a&&(a=t.animate));let u=!!n&&!1===n.initial;u=u||!1===o;const h=u?a:o;if(h&&"boolean"!==typeof h&&!E(h)){const t=Array.isArray(h)?h:[h];for(let n=0;n<t.length;n++){const i=L(e,t[n]);if(i){const{transitionEnd:e,transition:t}=i,n=C(i,So);for(const i in n){let e=n[i];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(r[i]=e)}for(const i in e)r[i]=e[i]}}}return r}const Eo=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Co=()=>M(M({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}}),Ro=(e,t)=>t&&"number"===typeof e?t.transform(e):e,Po={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},No=B.length;function Do(e,t,n){const{style:i,vars:r,transformOrigin:s}=e;let o=!1,a=!1;for(const l in t){const e=t[l];if(F.has(l))o=!0;else if(ve(l))r[l]=e;else{const t=Ro(e,wt[l]);l.startsWith("origin")?(a=!0,s[l]=t):i[l]=t}}if(t.transform||(o||n?i.transform=function(e,t,n){let i="",r=!0;for(let s=0;s<No;s++){const o=B[s],a=e[o];if(void 0===a)continue;let l=!0;if(l="number"===typeof a?a===(o.startsWith("scale")?1:0):0===parseFloat(a),!l||n){const e=Ro(a,wt[o]);l||(r=!1,i+="".concat(Po[o]||o,"(").concat(e,") ")),n&&(t[o]=e)}}return i=i.trim(),n?i=n(t,r?"":i):r&&(i="none"),i}(t,e.transform,n):i.transform&&(i.transform="none")),a){const{originX:e="50%",originY:t="50%",originZ:n=0}=s;i.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function Lo(e,t,n){return"string"===typeof e?e:Ne.transform(t+n*e)}const Io={offset:"stroke-dashoffset",array:"stroke-dasharray"},Oo={offset:"strokeDashoffset",array:"strokeDasharray"};const ko=["attrX","attrY","attrScale","originX","originY","pathLength","pathSpacing","pathOffset"];function Bo(e,t,n,i){let{attrX:r,attrY:s,attrScale:o,originX:a,originY:l,pathLength:c,pathSpacing:u=1,pathOffset:h=0}=t;if(Do(e,C(t,ko),i),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:d,style:p,dimensions:A}=e;d.transform&&(A&&(p.transform=d.transform),delete d.transform),A&&(void 0!==a||void 0!==l||p.transform)&&(p.transformOrigin=function(e,t,n){const i=Lo(t,e.x,e.width),r=Lo(n,e.y,e.height);return"".concat(i," ").concat(r)}(A,void 0!==a?a:.5,void 0!==l?l:.5)),void 0!==r&&(d.x=r),void 0!==s&&(d.y=s),void 0!==o&&(d.scale=o),void 0!==c&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=r?Io:Oo;e[s.offset]=Ne.transform(-i);const o=Ne.transform(t),a=Ne.transform(n);e[s.array]="".concat(o," ").concat(a)}(d,c,u,h,!1)}const Fo=e=>"string"===typeof e&&"svg"===e.toLowerCase(),Uo={useVisualState:To({scrapeMotionValuesFromProps:wo,createRenderState:Co,onMount:(e,t,n)=>{let{renderState:i,latestValues:r}=n;$.read((()=>{try{i.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(e){i.dimensions={x:0,y:0,width:0,height:0}}})),$.render((()=>{Bo(i,r,Fo(t.tagName),e.transformTemplate),bo(t,i)}))}})},zo={useVisualState:To({scrapeMotionValuesFromProps:_o,createRenderState:Eo})};function qo(e,t,n){for(const i in t)ai(t[i])||xo(i,n)||(e[i]=t[i])}function Vo(e,n){const i={};return qo(i,e.style||{},e),Object.assign(i,function(e,n){let{transformTemplate:i}=e;return(0,t.useMemo)((()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return Do(e,n,i),Object.assign({},e.vars,e.style)}),[n])}(e,n)),i}function Go(e,t){const n={},i=Vo(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const jo=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ho(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||jo.has(e)}let Wo=e=>!Ho(e);try{(Xo=require("@emotion/is-prop-valid").default)&&(Wo=e=>e.startsWith("on")?!Ho(e):Xo(e))}catch(rv){}var Xo;function Yo(e,n,i,r){const s=(0,t.useMemo)((()=>{const t=Co();return Bo(t,n,Fo(r),e.transformTemplate),M(M({},t.attrs),{},{style:M({},t.style)})}),[n]);if(e.style){const t={};qo(t,e.style,e),s.style=M(M({},t),s.style)}return s}function Qo(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(n,i,r,s,o)=>{let{latestValues:a}=s;const l=(go(n)?Yo:Go)(i,a,o,n),c=function(e,t,n){const i={};for(const r in e)"values"===r&&"object"===typeof e.values||(Wo(r)||!0===n&&Ho(r)||!t&&!Ho(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}(i,"string"===typeof n,e),u=n!==t.Fragment?M(M(M({},c),l),{},{ref:r}):{},{children:h}=i,d=(0,t.useMemo)((()=>ai(h)?h.get():h),[h]);return(0,t.createElement)(n,M(M({},u),{},{children:d}))}}function Ko(e,t){return function(n){let{forwardMotionProps:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{forwardMotionProps:!1};return Ao(M(M({},go(n)?Uo:zo),{},{preloadedFeatures:e,useRender:Qo(i),createVisualElement:t,Component:n}))}}const Zo={current:null},Jo={current:!1};const $o=new WeakMap,ea=[...Ge,ot,ft],ta=["willChange"],na=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ia{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ke,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=Dt.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,$.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget=M({},l),this.initialValues=n.initial?M({},l):{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=Boolean(s),this.isControllingVariants=oo(n),this.isVariantNode=ao(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const u=this.scrapeMotionValuesFromProps(n,{},this),{willChange:h}=u,d=C(u,ta);for(const p in d){const e=d[p];void 0!==l[p]&&ai(e)&&e.set(l[p],!1)}}mount(e){this.current=e,$o.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((e,t)=>this.bindToMotionValue(t,e))),Jo.current||function(){if(Jo.current=!0,v)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Zo.current=e.matches;e.addListener(t),t()}else Zo.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||Zo.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){$o.delete(this.current),this.projection&&this.projection.unmount(),ee(this.notifyUpdate),ee(this.render),this.valueSubscriptions.forEach((e=>e())),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=F.has(e),i=t.on("change",(t=>{this.latestValues[e]=t,this.props.onUpdate&&$.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)})),r=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,(()=>{i(),r(),s&&s(),t.owner&&t.stop()}))}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in ho){const t=ho[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<na.length;n++){const t=na[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const i=e["on"+t];i&&(this.propEventSubscriptions[t]=this.on(t,i))}this.prevMotionValues=function(e,t,n){for(const i in t){const r=t[i],s=n[i];if(ai(r))e.addValue(i,r);else if(ai(s))e.addValue(i,ti(r,{owner:e}));else if(s!==r)if(e.hasValue(i)){const t=e.getValue(i);!0===t.liveStyle?t.jump(r):t.hasAnimated||t.set(r)}else{const t=e.getStaticValue(i);e.addValue(i,ti(void 0!==t?t:r,{owner:e}))}}for(const i in n)void 0===t[i]&&e.removeValue(i);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=ti(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let i=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return void 0!==i&&null!==i&&("string"===typeof i&&(me(i)||Ae(i))?i=parseFloat(i):!(e=>ea.find(Ve(e)))(i)&&ft.test(t)&&(i=Mt(e,t)),this.setBaseTarget(e,ai(i)?i.get():i)),ai(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let i;if("string"===typeof n||"object"===typeof n){const r=L(this.props,n,null===(t=this.presenceContext)||void 0===t?void 0:t.custom);r&&(i=r[e])}if(n&&void 0!==i)return i;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||ai(r)?void 0!==this.initialValues[e]&&void 0===i?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new Jn),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.events[e].notify(...n)}}}class ra extends ia{constructor(){super(...arguments),this.KeyframeResolver=Ct}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:i}=t;delete n[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ai(e)&&(this.childSubscription=e.on("change",(e=>{this.current&&(this.current.textContent="".concat(e))})))}}class sa extends ra{constructor(){super(...arguments),this.type="html",this.renderInstance=vo}readValueFromInstance(e,t){if(F.has(t)){const e=Tt(t);return e&&e.default||0}{const i=(n=e,window.getComputedStyle(n)),r=(ve(t)?i.getPropertyValue(t):i[t])||0;return"string"===typeof r?r.trim():r}var n}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return vr(e,n)}build(e,t,n){Do(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return _o(e,t,n)}}class oa extends ra{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=tr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(F.has(t)){const e=Tt(t);return e&&e.default||0}return t=yo.has(t)?t:ri(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return wo(e,t,n)}build(e,t,n){Bo(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,i){bo(e,t,0,i)}mount(e){this.isSVGTag=Fo(e.tagName),super.mount(e)}}const aa=(e,n)=>go(e)?new oa(n):new sa(n,{allowProjection:e!==t.Fragment}),la=x(Ko(M(M(M(M({},Mi),$s),Vs),eo),aa));function ca(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ua(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||da(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ha(e){return function(e){if(Array.isArray(e))return pa(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||da(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function da(e,t){if(e){if("string"===typeof e)return pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pa(e,t):void 0}}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function fa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t);else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||ga(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ma(e){return function(e){if(Array.isArray(e))return Aa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ga(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ga(e,t){if(e){if("string"==typeof e)return Aa(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Aa(e,t):void 0}}function va(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.useEffect,i=(0,t.useRef)(),r=(0,t.useRef)(!1),s=(0,t.useRef)(!1),o=fa((0,t.useState)(0),2);o[0];var a=o[1];r.current&&(s.current=!0),n((function(){return r.current||(i.current=e(),r.current=!0),a((function(e){return e+1})),function(){s.current&&i.current&&i.current()}}),[])}const ya="168",ba={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},xa=0,_a=1,wa=2,Sa=3,Ta=0,Ma=1,Ea=2,Ca=100,Ra=101,Pa=102,Na=200,Da=201,La=202,Ia=203,Oa=204,ka=205,Ba=206,Fa=207,Ua=208,za=209,qa=210,Va=211,Ga=212,ja=213,Ha=214,Wa=301,Xa=302,Ya=303,Qa=304,Ka=306,Za=1e3,Ja=1001,$a=1002,el=1003,tl=1004,nl=1005,il=1006,rl=1007,sl=1008,ol=1009,al=1010,ll=1011,cl=1012,ul=1013,hl=1014,dl=1015,pl=1016,Al=1017,fl=1018,ml=1020,gl=35902,vl=1023,yl=1026,bl=1027,xl=1028,_l=1029,wl=1031,Sl=1033,Tl=33776,Ml=33777,El=33778,Cl=33779,Rl=35840,Pl=35841,Nl=35842,Dl=35843,Ll=36196,Il=37492,Ol=37496,kl=37808,Bl=37809,Fl=37810,Ul=37811,zl=37812,ql=37813,Vl=37814,Gl=37815,jl=37816,Hl=37817,Wl=37818,Xl=37819,Yl=37820,Ql=37821,Kl=36492,Zl=36494,Jl=36495,$l=36284,ec=36285,tc=36286,nc=2300,ic=2301,rc=2302,sc=2400,oc=2401,ac=2402,lc=0,cc=1,uc=2,hc="",dc="srgb",pc="srgb-linear",Ac="display-p3",fc="display-p3-linear",mc="linear",gc="srgb",vc="rec709",yc="p3",bc=7680,xc=512,_c=513,wc=514,Sc=515,Tc=516,Mc=517,Ec=518,Cc=519,Rc=35044,Pc="300 es",Nc=2e3,Dc=2001;class Lc{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const Ic=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Oc=1234567;const kc=Math.PI/180,Bc=180/Math.PI;function Fc(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Ic[255&e]+Ic[e>>8&255]+Ic[e>>16&255]+Ic[e>>24&255]+"-"+Ic[255&t]+Ic[t>>8&255]+"-"+Ic[t>>16&15|64]+Ic[t>>24&255]+"-"+Ic[63&n|128]+Ic[n>>8&255]+"-"+Ic[n>>16&255]+Ic[n>>24&255]+Ic[255&i]+Ic[i>>8&255]+Ic[i>>16&255]+Ic[i>>24&255]).toLowerCase()}function Uc(e,t,n){return Math.max(t,Math.min(n,e))}function zc(e,t){return(e%t+t)%t}function qc(e,t,n){return(1-n)*e+n*t}function Vc(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Gc(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const jc={DEG2RAD:kc,RAD2DEG:Bc,generateUUID:Fc,clamp:Uc,euclideanModulo:zc,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:qc,damp:function(e,t,n,i){return qc(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(zc(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Oc=e);let t=Oc+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*kc},radToDeg:function(e){return e*Bc},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((t+i)/2),u=o((t+i)/2),h=s((t-i)/2),d=o((t-i)/2),p=s((i-t)/2),A=o((i-t)/2);switch(r){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*A,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*A,a*c);break;case"ZYZ":e.set(l*A,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Gc,denormalize:Vc};class Hc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Hc.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Uc(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Wc{constructor(e,t,n,i,r,s,o,a,l){Wc.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l)}set(e,t,n,i,r,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],A=i[0],f=i[3],m=i[6],g=i[1],v=i[4],y=i[7],b=i[2],x=i[5],_=i[8];return r[0]=s*A+o*g+a*b,r[3]=s*f+o*v+a*x,r[6]=s*m+o*y+a*_,r[1]=l*A+c*g+u*b,r[4]=l*f+c*v+u*x,r[7]=l*m+c*y+u*_,r[2]=h*A+d*g+p*b,r[5]=h*f+d*v+p*x,r[8]=h*m+d*y+p*_,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const A=1/p;return e[0]=u*A,e[1]=(i*l-c*n)*A,e[2]=(o*n-i*s)*A,e[3]=h*A,e[4]=(c*t-i*a)*A,e[5]=(i*r-o*t)*A,e[6]=d*A,e[7]=(n*a-l*t)*A,e[8]=(s*t-n*r)*A,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(Xc.makeScale(e,t)),this}rotate(e){return this.premultiply(Xc.makeRotation(-e)),this}translate(e,t){return this.premultiply(Xc.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Xc=new Wc;function Yc(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Qc(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Kc(){const e=Qc("canvas");return e.style.display="block",e}const Zc={};function Jc(e){e in Zc||(Zc[e]=!0,console.warn(e))}const $c=(new Wc).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),eu=(new Wc).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),tu={[pc]:{transfer:mc,primaries:vc,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[dc]:{transfer:gc,primaries:vc,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[fc]:{transfer:mc,primaries:yc,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(eu),fromReference:e=>e.applyMatrix3($c)},[Ac]:{transfer:gc,primaries:yc,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(eu),fromReference:e=>e.applyMatrix3($c).convertLinearToSRGB()}},nu=new Set([pc,fc]),iu={enabled:!0,_workingColorSpace:pc,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!nu.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const i=tu[t].toReference;return(0,tu[n].fromReference)(i(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return tu[e].primaries},getTransfer:function(e){return e===hc?mc:tu[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._workingColorSpace;return e.fromArray(tu[t].luminanceCoefficients)}};function ru(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function su(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let ou;class au{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ou&&(ou=Qc("canvas")),ou.width=e.width,ou.height=e.height;const n=ou.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ou}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=Qc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*ru(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*ru(t[e]/255)):t[e]=ru(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let lu=0;class cu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:lu++}),this.uuid=Fc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(uu(i[t].image)):e.push(uu(i[t]))}else e=uu(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function uu(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?au.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let hu=0;class du extends Lc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:du.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:du.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ja,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ja,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:il,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:sl,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:vl,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:ol,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:du.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:hc;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:hu++}),this.uuid=Fc(),this.name="",this.source=new cu(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Hc(0,0),this.repeat=new Hc(1,1),this.center=new Hc(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Za:e.x=e.x-Math.floor(e.x);break;case Ja:e.x=e.x<0?0:1;break;case $a:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Za:e.y=e.y-Math.floor(e.y);break;case Ja:e.y=e.y<0?0:1;break;case $a:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}du.DEFAULT_IMAGE=null,du.DEFAULT_MAPPING=300,du.DEFAULT_ANISOTROPY=1;class pu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;pu.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],A=a[2],f=a[6],m=a[10];if(Math.abs(c-h)<s&&Math.abs(u-A)<s&&Math.abs(p-f)<s){if(Math.abs(c+h)<o&&Math.abs(u+A)<o&&Math.abs(p+f)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,g=(m+1)/2,v=(c+h)/4,y=(u+A)/4,b=(p+f)/4;return e>a&&e>g?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=v/n,r=y/n):a>g?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=v/i,r=b/i):g<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=y/r,i=b/r),this.set(n,i,r,t),this}let g=Math.sqrt((f-p)*(f-p)+(u-A)*(u-A)+(h-c)*(h-c));return Math.abs(g)<.001&&(g=1),this.x=(f-p)/g,this.y=(u-A)/g,this.z=(h-c)/g,this.w=Math.acos((l+d+m-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Au extends Lc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new pu(0,0,e,t),this.scissorTest=!1,this.viewport=new pu(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:il,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new du(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const s=n.count;for(let o=0;o<s;o++)this.textures[o]=r.clone(),this.textures[o].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new cu(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class fu extends Au{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class mu extends du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=el,this.minFilter=el,this.wrapR=Ja,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class gu extends du{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=el,this.minFilter=el,this.wrapR=Ja,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],A=r[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=A);if(u!==A||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*A,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+A*r,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Uc(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class yu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;yu.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(xu.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(xu.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=2*(s*i-o*n),c=2*(o*t-r*i),u=2*(r*n-s*t);return this.x=t+a*l+s*u-o*c,this.y=n+a*c+o*l-r*u,this.z=i+a*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return bu.copy(this).projectOnVector(e),this.sub(bu)}reflect(e){return this.sub(bu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Uc(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bu=new yu,xu=new vu;class _u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Su.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Su.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Su.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Su):Su.fromBufferAttribute(i,t),Su.applyMatrix4(e.matrixWorld),this.expandByPoint(Su);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Tu.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Tu.copy(n.boundingBox)),Tu.applyMatrix4(e.matrixWorld),this.union(Tu)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Su),Su.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Du),Lu.subVectors(this.max,Du),Mu.subVectors(e.a,Du),Eu.subVectors(e.b,Du),Cu.subVectors(e.c,Du),Ru.subVectors(Eu,Mu),Pu.subVectors(Cu,Eu),Nu.subVectors(Mu,Cu);let t=[0,-Ru.z,Ru.y,0,-Pu.z,Pu.y,0,-Nu.z,Nu.y,Ru.z,0,-Ru.x,Pu.z,0,-Pu.x,Nu.z,0,-Nu.x,-Ru.y,Ru.x,0,-Pu.y,Pu.x,0,-Nu.y,Nu.x,0];return!!ku(t,Mu,Eu,Cu,Lu)&&(t=[1,0,0,0,1,0,0,0,1],!!ku(t,Mu,Eu,Cu,Lu)&&(Iu.crossVectors(Ru,Pu),t=[Iu.x,Iu.y,Iu.z],ku(t,Mu,Eu,Cu,Lu)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Su).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Su).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(wu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wu)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wu=[new yu,new yu,new yu,new yu,new yu,new yu,new yu,new yu],Su=new yu,Tu=new _u,Mu=new yu,Eu=new yu,Cu=new yu,Ru=new yu,Pu=new yu,Nu=new yu,Du=new yu,Lu=new yu,Iu=new yu,Ou=new yu;function ku(e,t,n,i,r){for(let s=0,o=e.length-3;s<=o;s+=3){Ou.fromArray(e,s);const o=r.x*Math.abs(Ou.x)+r.y*Math.abs(Ou.y)+r.z*Math.abs(Ou.z),a=t.dot(Ou),l=n.dot(Ou),c=i.dot(Ou);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Bu=new _u,Fu=new yu,Uu=new yu;class zu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Bu.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Fu.subVectors(e,this.center);const t=Fu.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Fu,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Uu.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Fu.copy(e.center).add(Uu)),this.expandByPoint(Fu.copy(e.center).sub(Uu))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const qu=new yu,Vu=new yu,Gu=new yu,ju=new yu,Hu=new yu,Wu=new yu,Xu=new yu;class Yu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,qu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=qu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(qu.copy(this.origin).addScaledVector(this.direction,t),qu.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Vu.copy(e).add(t).multiplyScalar(.5),Gu.copy(t).sub(e).normalize(),ju.copy(this.origin).sub(Vu);const r=.5*e.distanceTo(t),s=-this.direction.dot(Gu),o=ju.dot(this.direction),a=-ju.dot(Gu),l=ju.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(Vu).addScaledVector(Gu,h),d}intersectSphere(e,t){qu.subVectors(e.center,this.origin);const n=qu.dot(this.direction),i=qu.dot(qu)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||o>i?null:((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,qu)}intersectTriangle(e,t,n,i,r){Hu.subVectors(t,e),Wu.subVectors(n,e),Xu.crossVectors(Hu,Wu);let s,o=this.direction.dot(Xu);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}ju.subVectors(this.origin,e);const a=s*this.direction.dot(Wu.crossVectors(ju,Wu));if(a<0)return null;const l=s*this.direction.dot(Hu.cross(ju));if(l<0)return null;if(a+l>o)return null;const c=-s*ju.dot(Xu);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Qu{constructor(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f){Qu.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f)}set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f){const m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=i,m[1]=r,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=d,m[7]=p,m[11]=A,m[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Qu).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Ku.setFromMatrixColumn(e,0).length(),r=1/Ku.setFromMatrixColumn(e,1).length(),s=1/Ku.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*a,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e+r*o,t[4]=i*o-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e-r*o,t[4]=-s*u,t[8]=i+n*o,t[1]=n+i*o,t[5]=s*c,t[9]=r-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=a*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=o*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ju,e,$u)}lookAt(e,t,n){const i=this.elements;return nh.subVectors(e,t),0===nh.lengthSq()&&(nh.z=1),nh.normalize(),eh.crossVectors(n,nh),0===eh.lengthSq()&&(1===Math.abs(n.z)?nh.x+=1e-4:nh.z+=1e-4,nh.normalize(),eh.crossVectors(n,nh)),eh.normalize(),th.crossVectors(nh,eh),i[0]=eh.x,i[4]=th.x,i[8]=nh.x,i[1]=eh.y,i[5]=th.y,i[9]=nh.y,i[2]=eh.z,i[6]=th.z,i[10]=nh.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],A=n[6],f=n[10],m=n[14],g=n[3],v=n[7],y=n[11],b=n[15],x=i[0],_=i[4],w=i[8],S=i[12],T=i[1],M=i[5],E=i[9],C=i[13],R=i[2],P=i[6],N=i[10],D=i[14],L=i[3],I=i[7],O=i[11],k=i[15];return r[0]=s*x+o*T+a*R+l*L,r[4]=s*_+o*M+a*P+l*I,r[8]=s*w+o*E+a*N+l*O,r[12]=s*S+o*C+a*D+l*k,r[1]=c*x+u*T+h*R+d*L,r[5]=c*_+u*M+h*P+d*I,r[9]=c*w+u*E+h*N+d*O,r[13]=c*S+u*C+h*D+d*k,r[2]=p*x+A*T+f*R+m*L,r[6]=p*_+A*M+f*P+m*I,r[10]=p*w+A*E+f*N+m*O,r[14]=p*S+A*C+f*D+m*k,r[3]=g*x+v*T+y*R+b*L,r[7]=g*_+v*M+y*P+b*I,r[11]=g*w+v*E+y*N+b*O,r[15]=g*S+v*C+y*D+b*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+e[7]*(+t*a*d-t*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+e[11]*(+t*l*u-t*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+e[15]*(-i*o*c-t*a*u+t*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],A=e[13],f=e[14],m=e[15],g=u*f*l-A*h*l+A*a*d-o*f*d-u*a*m+o*h*m,v=p*h*l-c*f*l-p*a*d+s*f*d+c*a*m-s*h*m,y=c*A*l-p*u*l+p*o*d-s*A*d-c*o*m+s*u*m,b=p*u*a-c*A*a-p*o*h+s*A*h+c*o*f-s*u*f,x=t*g+n*v+i*y+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=g*_,e[1]=(A*h*r-u*f*r-A*i*d+n*f*d+u*i*m-n*h*m)*_,e[2]=(o*f*r-A*a*r+A*i*l-n*f*l-o*i*m+n*a*m)*_,e[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*_,e[4]=v*_,e[5]=(c*f*r-p*h*r+p*i*d-t*f*d-c*i*m+t*h*m)*_,e[6]=(p*a*r-s*f*r-p*i*l+t*f*l+s*i*m-t*a*m)*_,e[7]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*d+t*a*d)*_,e[8]=y*_,e[9]=(p*u*r-c*A*r-p*n*d+t*A*d+c*n*m-t*u*m)*_,e[10]=(s*A*r-p*o*r+p*n*l-t*A*l-s*n*m+t*o*m)*_,e[11]=(c*o*r-s*u*r-c*n*l+t*u*l+s*n*d-t*o*d)*_,e[12]=b*_,e[13]=(c*A*i-p*u*i+p*n*h-t*A*h-c*n*f+t*u*f)*_,e[14]=(p*o*i-s*A*i-p*n*a+t*A*a+s*n*f-t*o*f)*_,e[15]=(s*u*i-c*o*i+c*n*a-t*u*a-s*n*h+t*o*h)*_,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,A=s*c,f=s*u,m=o*u,g=a*l,v=a*c,y=a*u,b=n.x,x=n.y,_=n.z;return i[0]=(1-(A+m))*b,i[1]=(d+y)*b,i[2]=(p-v)*b,i[3]=0,i[4]=(d-y)*x,i[5]=(1-(h+m))*x,i[6]=(f+g)*x,i[7]=0,i[8]=(p+v)*_,i[9]=(f-g)*_,i[10]=(1-(h+A))*_,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=Ku.set(i[0],i[1],i[2]).length();const s=Ku.set(i[4],i[5],i[6]).length(),o=Ku.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Zu.copy(this);const a=1/r,l=1/s,c=1/o;return Zu.elements[0]*=a,Zu.elements[1]*=a,Zu.elements[2]*=a,Zu.elements[4]*=l,Zu.elements[5]*=l,Zu.elements[6]*=l,Zu.elements[8]*=c,Zu.elements[9]*=c,Zu.elements[10]*=c,t.setFromRotationMatrix(Zu),n.x=r,n.y=s,n.z=o,this}makePerspective(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Nc;const a=this.elements,l=2*r/(t-e),c=2*r/(n-i),u=(t+e)/(t-e),h=(n+i)/(n-i);let d,p;if(o===Nc)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(o!==Dc)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-s/(s-r),p=-s*r/(s-r)}return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Nc;const a=this.elements,l=1/(t-e),c=1/(n-i),u=1/(s-r),h=(t+e)*l,d=(n+i)*c;let p,A;if(o===Nc)p=(s+r)*u,A=-2*u;else{if(o!==Dc)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=r*u,A=-1*u}return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=A,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Ku=new yu,Zu=new Qu,Ju=new yu(0,0,0),$u=new yu(1,1,1),eh=new yu,th=new yu,nh=new yu,ih=new Qu,rh=new vu;class sh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sh.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Uc(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Uc(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Uc(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Uc(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Uc(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Uc(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return ih.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ih,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return rh.setFromEuler(this),this.setFromQuaternion(rh,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}sh.DEFAULT_ORDER="XYZ";class oh{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let ah=0;const lh=new yu,ch=new vu,uh=new Qu,hh=new yu,dh=new yu,ph=new yu,Ah=new vu,fh=new yu(1,0,0),mh=new yu(0,1,0),gh=new yu(0,0,1),vh={type:"added"},yh={type:"removed"},bh={type:"childadded",child:null},xh={type:"childremoved",child:null};class _h extends Lc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ah++}),this.uuid=Fc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_h.DEFAULT_UP.clone();const e=new yu,t=new sh,n=new vu,i=new yu(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Qu},normalMatrix:{value:new Wc}}),this.matrix=new Qu,this.matrixWorld=new Qu,this.matrixAutoUpdate=_h.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=_h.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new oh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ch.setFromAxisAngle(e,t),this.quaternion.multiply(ch),this}rotateOnWorldAxis(e,t){return ch.setFromAxisAngle(e,t),this.quaternion.premultiply(ch),this}rotateX(e){return this.rotateOnAxis(fh,e)}rotateY(e){return this.rotateOnAxis(mh,e)}rotateZ(e){return this.rotateOnAxis(gh,e)}translateOnAxis(e,t){return lh.copy(e).applyQuaternion(this.quaternion),this.position.add(lh.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(fh,e)}translateY(e){return this.translateOnAxis(mh,e)}translateZ(e){return this.translateOnAxis(gh,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(uh.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?hh.copy(e):hh.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),dh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?uh.lookAt(dh,hh,this.up):uh.lookAt(hh,dh,this.up),this.quaternion.setFromRotationMatrix(uh),i&&(uh.extractRotation(i.matrixWorld),ch.setFromRotationMatrix(uh),this.quaternion.premultiply(ch.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(vh),bh.child=e,this.dispatchEvent(bh),bh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(yh),xh.child=e,this.dispatchEvent(xh),xh.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),uh.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),uh.multiply(e.parent.matrixWorld)),e.applyMatrix4(uh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(vh),bh.child=e,this.dispatchEvent(bh),bh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dh,e,ph),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dh,Ah,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}_h.DEFAULT_UP=new yu(0,1,0),_h.DEFAULT_MATRIX_AUTO_UPDATE=!0,_h.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const wh=new yu,Sh=new yu,Th=new yu,Mh=new yu,Eh=new yu,Ch=new yu,Rh=new yu,Ph=new yu,Nh=new yu,Dh=new yu;class Lh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yu;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),wh.subVectors(e,t),i.cross(wh);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){wh.subVectors(i,t),Sh.subVectors(n,t),Th.subVectors(e,t);const s=wh.dot(wh),o=wh.dot(Sh),a=wh.dot(Th),l=Sh.dot(Sh),c=Sh.dot(Th),u=s*l-o*o;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,Mh)&&(Mh.x>=0&&Mh.y>=0&&Mh.x+Mh.y<=1)}static getInterpolation(e,t,n,i,r,s,o,a){return null===this.getBarycoord(e,t,n,i,Mh)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(r,Mh.x),a.addScaledVector(s,Mh.y),a.addScaledVector(o,Mh.z),a)}static isFrontFacing(e,t,n,i){return wh.subVectors(n,t),Sh.subVectors(e,t),wh.cross(Sh).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return wh.subVectors(this.c,this.b),Sh.subVectors(this.a,this.b),.5*wh.cross(Sh).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Lh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Lh.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return Lh.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Lh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Lh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,o;Eh.subVectors(i,n),Ch.subVectors(r,n),Ph.subVectors(e,n);const a=Eh.dot(Ph),l=Ch.dot(Ph);if(a<=0&&l<=0)return t.copy(n);Nh.subVectors(e,i);const c=Eh.dot(Nh),u=Ch.dot(Nh);if(c>=0&&u<=c)return t.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(n).addScaledVector(Eh,s);Dh.subVectors(e,r);const d=Eh.dot(Dh),p=Ch.dot(Dh);if(p>=0&&d<=p)return t.copy(r);const A=d*l-a*p;if(A<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(Ch,o);const f=c*p-d*u;if(f<=0&&u-c>=0&&d-p>=0)return Rh.subVectors(r,i),o=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(Rh,o);const m=1/(f+A+h);return s=A*m,o=h*m,t.copy(n).addScaledVector(Eh,s).addScaledVector(Ch,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Ih={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oh={h:0,s:0,l:0},kh={h:0,s:0,l:0};function Bh(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Fh{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dc;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,iu.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:iu.workingColorSpace;return this.r=e,this.g=t,this.b=n,iu.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:iu.workingColorSpace;if(e=zc(e,1),t=Uc(t,0,1),n=Uc(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=Bh(r,i,e+1/3),this.g=Bh(r,i,e),this.b=Bh(r,i,e-1/3)}return iu.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dc;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],o=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dc;const n=Ih[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ru(e.r),this.g=ru(e.g),this.b=ru(e.b),this}copyLinearToSRGB(e){return this.r=su(e.r),this.g=su(e.g),this.b=su(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dc;return iu.fromWorkingColorSpace(Uh.copy(this),e),65536*Math.round(Uc(255*Uh.r,0,255))+256*Math.round(Uc(255*Uh.g,0,255))+Math.round(Uc(255*Uh.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dc;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iu.workingColorSpace;iu.fromWorkingColorSpace(Uh.copy(this),t);const n=Uh.r,i=Uh.g,r=Uh.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case n:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-n)/e+2;break;case r:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iu.workingColorSpace;return iu.fromWorkingColorSpace(Uh.copy(this),t),e.r=Uh.r,e.g=Uh.g,e.b=Uh.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dc;iu.fromWorkingColorSpace(Uh.copy(this),e);const t=Uh.r,n=Uh.g,i=Uh.b;return e!==dc?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(Oh),this.setHSL(Oh.h+e,Oh.s+t,Oh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Oh),e.getHSL(kh);const n=qc(Oh.h,kh.h,t),i=qc(Oh.s,kh.s,t),r=qc(Oh.l,kh.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Uh=new Fh;Fh.NAMES=Ih;let zh=0;class qh extends Lc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:zh++}),this.uuid=Fc(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Ca,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Fh(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bc,this.stencilZFail=bc,this.stencilZPass=bc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==Ca&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==bc&&(n.stencilFail=this.stencilFail),this.stencilZFail!==bc&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==bc&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Vh extends qh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Fh(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new sh,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Gh=new yu,jh=new Hc;class Hh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Rc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=dl,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return Jc("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)jh.fromBufferAttribute(this,t),jh.applyMatrix3(e),this.setXY(t,jh.x,jh.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Gh.fromBufferAttribute(this,t),Gh.applyMatrix3(e),this.setXYZ(t,Gh.x,Gh.y,Gh.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Gh.fromBufferAttribute(this,t),Gh.applyMatrix4(e),this.setXYZ(t,Gh.x,Gh.y,Gh.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Gh.fromBufferAttribute(this,t),Gh.applyNormalMatrix(e),this.setXYZ(t,Gh.x,Gh.y,Gh.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Gh.fromBufferAttribute(this,t),Gh.transformDirection(e),this.setXYZ(t,Gh.x,Gh.y,Gh.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Vc(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Gc(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Gc(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Gc(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Gc(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Gc(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array),i=Gc(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array),i=Gc(i,this.array),r=Gc(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Rc&&(e.usage=this.usage),e}}class Wh extends Hh{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Xh extends Hh{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Yh extends Hh{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Qh=0;const Kh=new Qu,Zh=new _h,Jh=new yu,$h=new _u,ed=new _u,td=new yu;class nd extends Lc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Qh++}),this.uuid=Fc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Yc(e)?Xh:Wh)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Wc).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Kh.makeRotationFromQuaternion(e),this.applyMatrix4(Kh),this}rotateX(e){return Kh.makeRotationX(e),this.applyMatrix4(Kh),this}rotateY(e){return Kh.makeRotationY(e),this.applyMatrix4(Kh),this}rotateZ(e){return Kh.makeRotationZ(e),this.applyMatrix4(Kh),this}translate(e,t,n){return Kh.makeTranslation(e,t,n),this.applyMatrix4(Kh),this}scale(e,t,n){return Kh.makeScale(e,t,n),this.applyMatrix4(Kh),this}lookAt(e){return Zh.lookAt(e),Zh.updateMatrix(),this.applyMatrix4(Zh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jh).negate(),this.translate(Jh.x,Jh.y,Jh.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Yh(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new _u);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new yu(-1/0,-1/0,-1/0),new yu(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];$h.setFromBufferAttribute(e),this.morphTargetsRelative?(td.addVectors(this.boundingBox.min,$h.min),this.boundingBox.expandByPoint(td),td.addVectors(this.boundingBox.max,$h.max),this.boundingBox.expandByPoint(td)):(this.boundingBox.expandByPoint($h.min),this.boundingBox.expandByPoint($h.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new zu);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new yu,1/0);if(e){const n=this.boundingSphere.center;if($h.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];ed.setFromBufferAttribute(n),this.morphTargetsRelative?(td.addVectors($h.min,ed.min),$h.expandByPoint(td),td.addVectors($h.max,ed.max),$h.expandByPoint(td)):($h.expandByPoint(ed.min),$h.expandByPoint(ed.max))}$h.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)td.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(td));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],o=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)td.fromBufferAttribute(s,t),o&&(Jh.fromBufferAttribute(e,t),td.add(Jh)),i=Math.max(i,n.distanceToSquared(td))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Hh(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),o=[],a=[];for(let w=0;w<n.count;w++)o[w]=new yu,a[w]=new yu;const l=new yu,c=new yu,u=new yu,h=new Hc,d=new Hc,p=new Hc,A=new yu,f=new yu;function m(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,e),d.fromBufferAttribute(r,t),p.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const s=1/(d.x*p.y-p.x*d.y);isFinite(s)&&(A.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(s),f.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(s),o[e].add(A),o[t].add(A),o[i].add(A),a[e].add(f),a[t].add(f),a[i].add(f))}let g=this.groups;0===g.length&&(g=[{start:0,count:e.count}]);for(let w=0,S=g.length;w<S;++w){const t=g[w],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)m(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const v=new yu,y=new yu,b=new yu,x=new yu;function _(e){b.fromBufferAttribute(i,e),x.copy(b);const t=o[e];v.copy(t),v.sub(b.multiplyScalar(b.dot(t))).normalize(),y.crossVectors(x,t);const n=y.dot(a[e])<0?-1:1;s.setXYZW(e,v.x,v.y,v.z,n)}for(let w=0,S=g.length;w<S;++w){const t=g[w],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)_(e.getX(i+0)),_(e.getX(i+1)),_(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Hh(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new yu,r=new yu,s=new yu,o=new yu,a=new yu,l=new yu,c=new yu,u=new yu;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),A=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,A),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,A),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(A,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)td.fromBufferAttribute(e,t),td.normalize(),e.setXYZ(t,td.x,td.y,td.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let o=0,a=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[a++]=n[o++]}return new Hh(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new nd,n=this.index.array,i=this.attributes;for(const o in i){const r=e(i[o],n);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[o]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const e=s[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const i={};let r=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[a]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const id=new Qu,rd=new Yu,sd=new zu,od=new yu,ad=new yu,ld=new yu,cd=new yu,ud=new yu,hd=new yu,dd=new Hc,pd=new Hc,Ad=new Hc,fd=new yu,md=new yu,gd=new yu,vd=new yu,yd=new yu;class bd extends _h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nd,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Vh;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(r&&o){hd.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=o[n],a=r[n];0!==i&&(ud.fromBufferAttribute(a,e),s?hd.addScaledVector(ud,i):hd.addScaledVector(ud.sub(t),i))}t.add(hd)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),sd.copy(n.boundingSphere),sd.applyMatrix4(r),rd.copy(e.ray).recast(e.near),!1===sd.containsPoint(rd.origin)){if(null===rd.intersectSphere(sd,od))return;if(rd.origin.distanceToSquared(od)>(e.far-e.near)**2)return}id.copy(r).invert(),rd.copy(e.ray).applyMatrix4(id),null!==n.boundingBox&&!1===rd.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,rd)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==o)if(Array.isArray(s))for(let p=0,A=h.length;p<A;p++){const r=h[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=xd(this,a,e,n,l,c,u,o.getX(s),o.getX(s+1),o.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=xd(this,s,e,n,l,c,u,o.getX(r),o.getX(r+1),o.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==a)if(Array.isArray(s))for(let p=0,A=h.length;p<A;p++){const r=h[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=xd(this,o,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=xd(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function xd(e,t,n,i,r,s,o,a,l,c){e.getVertexPosition(a,ad),e.getVertexPosition(l,ld),e.getVertexPosition(c,cd);const u=function(e,t,n,i,r,s,o,a){let l;if(l=1===t.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===t.side,a),null===l)return null;yd.copy(a),yd.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(yd);return c<n.near||c>n.far?null:{distance:c,point:yd.clone(),object:e}}(e,t,n,i,ad,ld,cd,vd);if(u){r&&(dd.fromBufferAttribute(r,a),pd.fromBufferAttribute(r,l),Ad.fromBufferAttribute(r,c),u.uv=Lh.getInterpolation(vd,ad,ld,cd,dd,pd,Ad,new Hc)),s&&(dd.fromBufferAttribute(s,a),pd.fromBufferAttribute(s,l),Ad.fromBufferAttribute(s,c),u.uv1=Lh.getInterpolation(vd,ad,ld,cd,dd,pd,Ad,new Hc)),o&&(fd.fromBufferAttribute(o,a),md.fromBufferAttribute(o,l),gd.fromBufferAttribute(o,c),u.normal=Lh.getInterpolation(vd,ad,ld,cd,fd,md,gd,new yu),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const e={a:a,b:l,c:c,normal:new yu,materialIndex:0};Lh.getNormal(ad,ld,cd,e.normal),u.face=e}return u}class _d extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,i,r,s,p,A,f,m,g){const v=s/f,y=p/m,b=s/2,x=p/2,_=A/2,w=f+1,S=m+1;let T=0,M=0;const E=new yu;for(let o=0;o<S;o++){const s=o*y-x;for(let a=0;a<w;a++){const h=a*v-b;E[e]=h*i,E[t]=s*r,E[n]=_,l.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=A>0?1:-1,c.push(E.x,E.y,E.z),u.push(a/f),u.push(1-o/m),T+=1}}for(let o=0;o<m;o++)for(let e=0;e<f;e++){const t=h+e+w*o,n=h+e+w*(o+1),i=h+(e+1)+w*(o+1),r=h+(e+1)+w*o;a.push(t,n,r),a.push(n,i,r),M+=6}o.addGroup(d,M,g),d+=M,h+=T}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new Yh(l,3)),this.setAttribute("normal",new Yh(c,3)),this.setAttribute("uv",new Yh(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _d(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function wd(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Sd(e){const t={};for(let n=0;n<e.length;n++){const i=wd(e[n]);for(const e in i)t[e]=i[e]}return t}function Td(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:iu.workingColorSpace}const Md={clone:wd,merge:Sd};class Ed extends qh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=wd(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Cd extends _h{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qu,this.projectionMatrix=new Qu,this.projectionMatrixInverse=new Qu,this.coordinateSystem=Nc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Rd=new yu,Pd=new Hc,Nd=new Hc;class Dd extends Cd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Bc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*kc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Bc*Math.atan(Math.tan(.5*kc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Rd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Rd.x,Rd.y).multiplyScalar(-e/Rd.z),Rd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Rd.x,Rd.y).multiplyScalar(-e/Rd.z)}getViewSize(e,t){return this.getViewBounds(e,Pd,Nd),t.subVectors(Nd,Pd)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*kc*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/o,i*=s.width/e,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ld=-90;class Id extends _h{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Dd(Ld,1,e,t);i.layers=this.layers,this.add(i);const r=new Dd(Ld,1,e,t);r.layers=this.layers,this.add(r);const s=new Dd(Ld,1,e,t);s.layers=this.layers,this.add(s);const o=new Dd(Ld,1,e,t);o.layers=this.layers,this.add(o);const a=new Dd(Ld,1,e,t);a.layers=this.layers,this.add(a);const l=new Dd(Ld,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,o,a]=t;for(const l of t)this.remove(l);if(e===Nc)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==Dc)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const A=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,o),e.setRenderTarget(n,3,i),e.render(t,a),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=A,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class Od extends du{constructor(e,t,n,i,r,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:Wa,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class kd extends fu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Od(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:il}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new _d(5,5,5),o=new Ed({name:"CubemapFromEquirect",uniforms:wd(n),vertexShader:i,fragmentShader:r,side:1,blending:0});o.uniforms.tEquirect.value=t;const a=new bd(s,o),l=t.minFilter;t.minFilter===sl&&(t.minFilter=il);return new Id(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}const Bd=new yu,Fd=new yu,Ud=new Wc;class zd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Bd.subVectors(n,t).cross(Fd.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Bd),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ud.getNormalMatrix(e),i=this.coplanarPoint(Bd).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const qd=new zu,Vd=new yu;class Gd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zd,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new zd,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new zd,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new zd,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new zd,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new zd;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nc;const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=i[9],A=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];if(n[0].setComponents(a-r,h-l,f-d,y-m).normalize(),n[1].setComponents(a+r,h+l,f+d,y+m).normalize(),n[2].setComponents(a+s,h+c,f+p,y+g).normalize(),n[3].setComponents(a-s,h-c,f-p,y-g).normalize(),n[4].setComponents(a-o,h-u,f-A,y-v).normalize(),t===Nc)n[5].setComponents(a+o,h+u,f+A,y+v).normalize();else{if(t!==Dc)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,u,A,v).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),qd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),qd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(qd)}intersectsSprite(e){return qd.center.set(0,0,0),qd.radius=.7071067811865476,qd.applyMatrix4(e.matrixWorld),this.intersectsSphere(qd)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Vd.x=i.normal.x>0?e.max.x:e.min.x,Vd.y=i.normal.y>0?e.max.y:e.min.y,Vd.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Vd)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function jd(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Hd(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=t.get(n);i&&(e.deleteBuffer(i.buffer),t.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=t.get(n);if(void 0===r)t.set(n,function(t,n){const i=t.array,r=t.usage,s=i.byteLength,o=e.createBuffer();let a;if(e.bindBuffer(n,o),e.bufferData(n,i,r),t.onUploadCallback(),i instanceof Float32Array)a=e.FLOAT;else if(i instanceof Uint16Array)a=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)a=e.SHORT;else if(i instanceof Uint32Array)a=e.UNSIGNED_INT;else if(i instanceof Int32Array)a=e.INT;else if(i instanceof Int8Array)a=e.BYTE;else if(i instanceof Uint8Array)a=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=e.UNSIGNED_BYTE}return{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,i){const r=n.array,s=n._updateRange,o=n.updateRanges;if(e.bindBuffer(i,t),-1===s.count&&0===o.length&&e.bufferSubData(i,0,r),0!==o.length){for(let t=0,n=o.length;t<n;t++){const n=o[t];e.bufferSubData(i,n.start*r.BYTES_PER_ELEMENT,r,n.start,n.count)}n.clearUpdateRanges()}-1!==s.count&&(e.bufferSubData(i,s.offset*r.BYTES_PER_ELEMENT,r,s.offset,s.count),s.count=-1),n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}class Wd extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,u=e/o,h=t/a,d=[],p=[],A=[],f=[];for(let m=0;m<c;m++){const e=m*h-s;for(let t=0;t<l;t++){const n=t*u-r;p.push(n,-e,0),A.push(0,0,1),f.push(t/o),f.push(1-m/a)}}for(let m=0;m<a;m++)for(let e=0;e<o;e++){const t=e+l*m,n=e+l*(m+1),i=e+1+l*(m+1),r=e+1+l*m;d.push(t,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new Yh(p,3)),this.setAttribute("normal",new Yh(A,3)),this.setAttribute("uv",new Yh(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wd(e.width,e.height,e.widthSegments,e.heightSegments)}}const Xd={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Yd={common:{diffuse:{value:new Fh(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Wc},alphaMap:{value:null},alphaMapTransform:{value:new Wc},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Wc}},envmap:{envMap:{value:null},envMapRotation:{value:new Wc},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Wc}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Wc}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Wc},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Wc},normalScale:{value:new Hc(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Wc},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Wc}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Wc}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Wc}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fh(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Fh(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Wc},alphaTest:{value:0},uvTransform:{value:new Wc}},sprite:{diffuse:{value:new Fh(16777215)},opacity:{value:1},center:{value:new Hc(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Wc},alphaMap:{value:null},alphaMapTransform:{value:new Wc},alphaTest:{value:0}}},Qd={basic:{uniforms:Sd([Yd.common,Yd.specularmap,Yd.envmap,Yd.aomap,Yd.lightmap,Yd.fog]),vertexShader:Xd.meshbasic_vert,fragmentShader:Xd.meshbasic_frag},lambert:{uniforms:Sd([Yd.common,Yd.specularmap,Yd.envmap,Yd.aomap,Yd.lightmap,Yd.emissivemap,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,Yd.fog,Yd.lights,{emissive:{value:new Fh(0)}}]),vertexShader:Xd.meshlambert_vert,fragmentShader:Xd.meshlambert_frag},phong:{uniforms:Sd([Yd.common,Yd.specularmap,Yd.envmap,Yd.aomap,Yd.lightmap,Yd.emissivemap,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,Yd.fog,Yd.lights,{emissive:{value:new Fh(0)},specular:{value:new Fh(1118481)},shininess:{value:30}}]),vertexShader:Xd.meshphong_vert,fragmentShader:Xd.meshphong_frag},standard:{uniforms:Sd([Yd.common,Yd.envmap,Yd.aomap,Yd.lightmap,Yd.emissivemap,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,Yd.roughnessmap,Yd.metalnessmap,Yd.fog,Yd.lights,{emissive:{value:new Fh(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xd.meshphysical_vert,fragmentShader:Xd.meshphysical_frag},toon:{uniforms:Sd([Yd.common,Yd.aomap,Yd.lightmap,Yd.emissivemap,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,Yd.gradientmap,Yd.fog,Yd.lights,{emissive:{value:new Fh(0)}}]),vertexShader:Xd.meshtoon_vert,fragmentShader:Xd.meshtoon_frag},matcap:{uniforms:Sd([Yd.common,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,Yd.fog,{matcap:{value:null}}]),vertexShader:Xd.meshmatcap_vert,fragmentShader:Xd.meshmatcap_frag},points:{uniforms:Sd([Yd.points,Yd.fog]),vertexShader:Xd.points_vert,fragmentShader:Xd.points_frag},dashed:{uniforms:Sd([Yd.common,Yd.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xd.linedashed_vert,fragmentShader:Xd.linedashed_frag},depth:{uniforms:Sd([Yd.common,Yd.displacementmap]),vertexShader:Xd.depth_vert,fragmentShader:Xd.depth_frag},normal:{uniforms:Sd([Yd.common,Yd.bumpmap,Yd.normalmap,Yd.displacementmap,{opacity:{value:1}}]),vertexShader:Xd.meshnormal_vert,fragmentShader:Xd.meshnormal_frag},sprite:{uniforms:Sd([Yd.sprite,Yd.fog]),vertexShader:Xd.sprite_vert,fragmentShader:Xd.sprite_frag},background:{uniforms:{uvTransform:{value:new Wc},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Xd.background_vert,fragmentShader:Xd.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Wc}},vertexShader:Xd.backgroundCube_vert,fragmentShader:Xd.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Xd.cube_vert,fragmentShader:Xd.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xd.equirect_vert,fragmentShader:Xd.equirect_frag},distanceRGBA:{uniforms:Sd([Yd.common,Yd.displacementmap,{referencePosition:{value:new yu},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xd.distanceRGBA_vert,fragmentShader:Xd.distanceRGBA_frag},shadow:{uniforms:Sd([Yd.lights,Yd.fog,{color:{value:new Fh(0)},opacity:{value:1}}]),vertexShader:Xd.shadow_vert,fragmentShader:Xd.shadow_frag}};Qd.physical={uniforms:Sd([Qd.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Wc},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Wc},clearcoatNormalScale:{value:new Hc(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Wc},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Wc},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Wc},sheen:{value:0},sheenColor:{value:new Fh(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Wc},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Wc},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Wc},transmissionSamplerSize:{value:new Hc},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Wc},attenuationDistance:{value:0},attenuationColor:{value:new Fh(0)},specularColor:{value:new Fh(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Wc},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Wc},anisotropyVector:{value:new Hc},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Wc}}]),vertexShader:Xd.meshphysical_vert,fragmentShader:Xd.meshphysical_frag};const Kd={r:0,b:0,g:0},Zd=new sh,Jd=new Qu;function $d(e,t,n,i,r,s,o){const a=new Fh(0);let l,c,u=!0===s?0:1,h=null,d=0,p=null;function A(e){let i=!0===e.isScene?e.background:null;if(i&&i.isTexture){i=(e.backgroundBlurriness>0?n:t).get(i)}return i}function f(t,n){t.getRGB(Kd,Td(e)),i.buffers.color.setClear(Kd.r,Kd.g,Kd.b,n,o)}return{getClearColor:function(){return a},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a.set(e),u=t,f(a,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,f(a,u)},render:function(t){let n=!1;const r=A(t);null===r?f(a,u):r&&r.isColor&&(f(r,1),n=!0);const s=e.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,o),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const i=A(n);i&&(i.isCubeTexture||i.mapping===Ka)?(void 0===c&&(c=new bd(new _d(1,1,1),new Ed({name:"BackgroundCubeMaterial",uniforms:wd(Qd.backgroundCube.uniforms),vertexShader:Qd.backgroundCube.vertexShader,fragmentShader:Qd.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),Zd.copy(n.backgroundRotation),Zd.x*=-1,Zd.y*=-1,Zd.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(Zd.y*=-1,Zd.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(Jd.makeRotationFromEuler(Zd)),c.material.toneMapped=iu.getTransfer(i.colorSpace)!==gc,h===i&&d===i.version&&p===e.toneMapping||(c.material.needsUpdate=!0,h=i,d=i.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new bd(new Wd(2,2),new Ed({name:"BackgroundMaterial",uniforms:wd(Qd.background.uniforms),vertexShader:Qd.background.vertexShader,fragmentShader:Qd.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=iu.getTransfer(i.colorSpace)!==gc,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),h===i&&d===i.version&&p===e.toneMapping||(l.material.needsUpdate=!0,h=i,d=i.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))}}}function ep(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,o=!1;function a(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],i=[],r=[];for(let s=0;s<n;s++)t[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function u(){const e=s.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function h(e){d(e,0)}function d(t,n){const i=s.newAttributes,r=s.enabledAttributes,o=s.attributeDivisors;i[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function p(){const t=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function A(t,n,i,r,s,o,a){!0===a?e.vertexAttribIPointer(t,n,i,s,o):e.vertexAttribPointer(t,n,i,r,s,o)}function f(){m(),o=!0,s!==r&&(s=r,a(s.object))}function m(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,f,m){let g=!1;const v=function(t,n,r){const s=!0===r.wireframe;let o=i[t.id];void 0===o&&(o={},i[t.id]=o);let a=o[n.id];void 0===a&&(a={},o[n.id]=a);let l=a[s];void 0===l&&(l=c(e.createVertexArray()),a[s]=l);return l}(f,l,r);s!==v&&(s=v,a(s.object)),g=function(e,t,n,i){const r=s.attributes,o=t.attributes;let a=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const t=r[s];let n=o[s];if(void 0===n&&("instanceMatrix"===s&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;a++}}return s.attributesNum!==a||s.index!==i}(n,f,l,m),g&&function(e,t,n,i){const r={},o=t.attributes;let a=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let t=o[s];void 0===t&&("instanceMatrix"===s&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[s]=n,a++}}s.attributes=r,s.attributesNum=a,s.index=i}(n,f,l,m),null!==m&&t.update(m,e.ELEMENT_ARRAY_BUFFER),(g||o)&&(o=!1,function(n,i,r,s){u();const o=s.attributes,a=r.getAttributes(),l=i.defaultAttributeValues;for(const c in a){const i=a[c];if(i.location>=0){let r=o[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const o=r.normalized,a=r.itemSize,l=t.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,f=u===e.INT||u===e.UNSIGNED_INT||r.gpuType===ul;if(r.isInterleavedBufferAttribute){const t=r.data,l=t.stride,m=r.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)d(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)A(i.location+e,a/i.locationSize,u,o,l*p,(m+a/i.locationSize*e)*p,f)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)d(i.location+e,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)A(i.location+e,a/i.locationSize,u,o,a*p,a/i.locationSize*e*p,f)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}p()}(n,r,l,f),null!==m&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(m).buffer))},reset:f,resetDefaultState:m,dispose:function(){f();for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete i[e]}},releaseStatesOfGeometry:function(e){if(void 0===i[e.id])return;const t=i[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete i[e.id]},releaseStatesOfProgram:function(e){for(const t in i){const n=i[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)l(r[e].object),delete r[e];delete n[e.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:p}}function tp(e,t,n){let i;function r(t,r,s){0!==s&&(e.drawArraysInstanced(i,t,r,s),n.update(r,i,s))}this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(e,r,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,e,0,r,0,s);let o=0;for(let t=0;t<s;t++)o+=r[t];n.update(o,i,1)},this.renderMultiDrawInstances=function(e,s,o,a){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)r(e[t],s[t],a[t]);else{l.multiDrawArraysInstancedWEBGL(i,e,0,s,0,a,0,o);let t=0;for(let e=0;e<o;e++)t+=s[e];for(let e=0;e<a.length;e++)n.update(t,i,a[e])}}}function np(e,t,n,i){let r;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=void 0!==n.precision?n.precision:"highp";const a=s(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(t){return t===vl||i.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===pl&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==ol&&i.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==dl&&!r)},precision:o,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:u,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:u>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function ip(e){const t=this;let n=null,i=0,r=!1,s=!1;const o=new zd,a=new Wc,l={value:null,needsUpdate:!1};function c(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)o.copy(e[n]).applyMatrix4(r,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(o,a,u){const h=o.clippingPlanes,d=o.clipIntersection,p=o.clipShadows,A=e.get(o);if(!r||null===h||0===h.length||s&&!p)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=s?0:i,t=4*e;let r=A.clippingState||null;l.value=r,r=c(h,a,t,u);for(let i=0;i!==t;++i)r[i]=n[i];A.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function rp(e){let t=new WeakMap;function n(e,t){return t===Ya?e.mapping=Wa:t===Qa&&(e.mapping=Xa),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===Ya||s===Qa){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new kd(s.height);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}class sp extends Cd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const op=[.125,.215,.35,.446,.526,.582],ap=20,lp=new sp,cp=new Fh;let up=null,hp=0,dp=0,pp=!1;const Ap=(1+Math.sqrt(5))/2,fp=1/Ap,mp=[new yu(-Ap,fp,0),new yu(Ap,fp,0),new yu(-fp,0,Ap),new yu(fp,0,Ap),new yu(0,Ap,-fp),new yu(0,Ap,fp),new yu(-1,1,-1),new yu(1,1,-1),new yu(-1,1,1),new yu(1,1,1)];class gp{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;up=this._renderer.getRenderTarget(),hp=this._renderer.getActiveCubeFace(),dp=this._renderer.getActiveMipmapLevel(),pp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=xp(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=bp(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(up,hp,dp),this._renderer.xr.enabled=pp,e.scissorTest=!1,yp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Wa||e.mapping===Xa?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),up=this._renderer.getRenderTarget(),hp=this._renderer.getActiveCubeFace(),dp=this._renderer.getActiveMipmapLevel(),pp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:il,minFilter:il,generateMipmaps:!1,type:pl,format:vl,colorSpace:pc,depthBuffer:!1},i=vp(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=vp(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+op.length;for(let o=0;o<s;o++){const s=Math.pow(2,r);n.push(s);let a=1/s;o>e-4?a=op[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,A=3,f=2,m=1,g=new Float32Array(A*p*d),v=new Float32Array(f*p*d),y=new Float32Array(m*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(i,A*p*e),v.set(h,f*p*e);const r=[e,e,e,e,e,e];y.set(r,m*p*e)}const b=new nd;b.setAttribute("position",new Hh(g,A)),b.setAttribute("uv",new Hh(v,f)),b.setAttribute("faceIndex",new Hh(y,m)),t.push(b),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(ap),r=new yu(0,1,0),s=new Ed({name:"SphericalGaussianBlur",defines:{n:ap,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,e,t)}return i}_compileMaterial(e){const t=new bd(this._lodPlanes[0],e);this._renderer.compile(t,lp)}_sceneToCubeUV(e,t,n,i){const r=new Dd(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(cp),a.toneMapping=0,a.autoClear=!1;const u=new Vh({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new bd(new _d,u);let d=!1;const p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(cp),d=!0);for(let A=0;A<6;A++){const t=A%3;0===t?(r.up.set(0,s[A],0),r.lookAt(o[A],0,0)):1===t?(r.up.set(0,0,s[A]),r.lookAt(0,o[A],0)):(r.up.set(0,s[A],0),r.lookAt(0,0,o[A]));const n=this._cubeSize;yp(i,t*n,A>2?n:0,n,n),a.setRenderTarget(i),d&&a.render(h,r),a.render(e,r)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Wa||e.mapping===Xa;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=xp()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=bp());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new bd(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const o=this._cubeSize;yp(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(s,lp)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=mp[(i-r-1)%mp.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new bd(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,A=isFinite(r)?1+Math.floor(3*p):ap;A>ap&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(A," samples when the maximum is set to ").concat(ap));const f=[];let m=0;for(let y=0;y<ap;++y){const e=y/p,t=Math.exp(-e*e/2);f.push(t),0===y?m+=t:y<A&&(m+=2*t)}for(let y=0;y<f.length;y++)f[y]=f[y]/m;u.envMap.value=e.texture,u.samples.value=A,u.weights.value=f,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:g}=this;u.dTheta.value=d,u.mipInt.value=g-n;const v=this._sizeLods[i];yp(t,3*v*(i>g-4?i-g+4:0),4*(this._cubeSize-v),3*v,2*v),a.setRenderTarget(t),a.render(c,lp)}}function vp(e,t,n){const i=new fu(e,t,n);return i.texture.mapping=Ka,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function yp(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function bp(){return new Ed({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function xp(){return new Ed({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function _p(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,o=s===Ya||s===Qa,a=s===Wa||s===Xa;if(o||a){let s=t.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new gp(e)),s=o?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return o&&l&&l.height>0||a&&l&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(l)?(null===n&&(n=new gp(e)),s=o?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function wp(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&Jc("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Sp(e,t,n,i){const r={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const n in a.attributes)t.remove(a.attributes[n]);for(const n in a.morphAttributes){const e=a.morphAttributes[n];for(let n=0,i=e.length;n<i;n++)t.remove(e[n])}a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],i=e.index,r=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const e=r.array;o=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}}const a=new(Yc(n)?Xh:Wh)(n,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const s in i)t.update(i[s],e.ARRAY_BUFFER);const r=n.morphAttributes;for(const s in r){const n=r[s];for(let i=0,r=n.length;i<r;i++)t.update(n[i],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return s.get(e)}}}function Tp(e,t,n){let i,r,s;function o(t,o,a){0!==a&&(e.drawElementsInstanced(i,o,r,t*s,a),n.update(o,i,a))}this.setMode=function(e){i=e},this.setIndex=function(e){r=e.type,s=e.bytesPerElement},this.render=function(t,o){e.drawElements(i,o,r,t*s),n.update(o,i,1)},this.renderInstances=o,this.renderMultiDraw=function(e,s,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,e,0,o);let a=0;for(let t=0;t<o;t++)a+=s[t];n.update(a,i,1)},this.renderMultiDrawInstances=function(e,a,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/s,a[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(i,a,0,r,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=a[e];for(let e=0;e<c.length;e++)n.update(t,i,c[e])}}}function Mp(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function Ep(e,t,n){const i=new WeakMap,r=new pu;return{update:function(s,o,a){const l=s.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,u=void 0!==c?c.length:0;let h=i.get(o);if(void 0===h||h.count!==u){void 0!==h&&h.texture.dispose();const d=void 0!==o.morphAttributes.position,p=void 0!==o.morphAttributes.normal,A=void 0!==o.morphAttributes.color,f=o.morphAttributes.position||[],m=o.morphAttributes.normal||[],g=o.morphAttributes.color||[];let v=0;!0===d&&(v=1),!0===p&&(v=2),!0===A&&(v=3);let y=o.attributes.position.count*v,b=1;y>t.maxTextureSize&&(b=Math.ceil(y/t.maxTextureSize),y=t.maxTextureSize);const x=new Float32Array(y*b*4*u),_=new mu(x,y,b,u);_.type=dl,_.needsUpdate=!0;const w=4*v;for(let T=0;T<u;T++){const M=f[T],E=m[T],C=g[T],R=y*b*4*T;for(let P=0;P<M.count;P++){const N=P*w;!0===d&&(r.fromBufferAttribute(M,P),x[R+N+0]=r.x,x[R+N+1]=r.y,x[R+N+2]=r.z,x[R+N+3]=0),!0===p&&(r.fromBufferAttribute(E,P),x[R+N+4]=r.x,x[R+N+5]=r.y,x[R+N+6]=r.z,x[R+N+7]=0),!0===A&&(r.fromBufferAttribute(C,P),x[R+N+8]=r.x,x[R+N+9]=r.y,x[R+N+10]=r.z,x[R+N+11]=4===C.itemSize?r.w:1)}}function S(){_.dispose(),i.delete(o),o.removeEventListener("dispose",S)}h={count:u,texture:_,size:new Hc(y,b)},i.set(o,h),o.addEventListener("dispose",S)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)a.getUniforms().setValue(e,"morphTexture",s.morphTexture,n);else{let D=0;for(let I=0;I<l.length;I++)D+=l[I];const L=o.morphTargetsRelative?1:1-D;a.getUniforms().setValue(e,"morphTargetBaseInfluence",L),a.getUniforms().setValue(e,"morphTargetInfluences",l)}a.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),a.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function Cp(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const a=i.render.frame,l=o.geometry,c=t.get(o,l);if(r.get(c)!==a&&(t.update(c),r.set(c,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",s)&&o.addEventListener("dispose",s),r.get(o)!==a&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),r.set(o,a))),o.isSkinnedMesh){const e=o.skeleton;r.get(e)!==a&&(e.update(),r.set(e,a))}return c},dispose:function(){r=new WeakMap}}}class Rp extends du{constructor(e,t,n,i,r,s,o,a,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:yl;if(c!==yl&&c!==bl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===yl&&(n=hl),void 0===n&&c===bl&&(n=ml),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:el,this.minFilter=void 0!==a?a:el,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const Pp=new du,Np=new Rp(1,1),Dp=new mu,Lp=new gu,Ip=new Od,Op=[],kp=[],Bp=new Float32Array(16),Fp=new Float32Array(9),Up=new Float32Array(4);function zp(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=Op[r];if(void 0===s&&(s=new Float32Array(r),Op[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function qp(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Vp(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function Gp(e,t){let n=kp[t];void 0===n&&(n=new Int32Array(t),kp[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function jp(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Hp(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(qp(n,t))return;e.uniform2fv(this.addr,t),Vp(n,t)}}function Wp(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(qp(n,t))return;e.uniform3fv(this.addr,t),Vp(n,t)}}function Xp(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(qp(n,t))return;e.uniform4fv(this.addr,t),Vp(n,t)}}function Yp(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(qp(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Vp(n,t)}else{if(qp(n,i))return;Up.set(i),e.uniformMatrix2fv(this.addr,!1,Up),Vp(n,i)}}function Qp(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(qp(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Vp(n,t)}else{if(qp(n,i))return;Fp.set(i),e.uniformMatrix3fv(this.addr,!1,Fp),Vp(n,i)}}function Kp(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(qp(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Vp(n,t)}else{if(qp(n,i))return;Bp.set(i),e.uniformMatrix4fv(this.addr,!1,Bp),Vp(n,i)}}function Zp(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Jp(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(qp(n,t))return;e.uniform2iv(this.addr,t),Vp(n,t)}}function $p(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(qp(n,t))return;e.uniform3iv(this.addr,t),Vp(n,t)}}function eA(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(qp(n,t))return;e.uniform4iv(this.addr,t),Vp(n,t)}}function tA(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function nA(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(qp(n,t))return;e.uniform2uiv(this.addr,t),Vp(n,t)}}function iA(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(qp(n,t))return;e.uniform3uiv(this.addr,t),Vp(n,t)}}function rA(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(qp(n,t))return;e.uniform4uiv(this.addr,t),Vp(n,t)}}function sA(e,t,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),this.type===e.SAMPLER_2D_SHADOW?(Np.compareFunction=515,s=Np):s=Pp,n.setTexture2D(t||s,r)}function oA(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||Lp,r)}function aA(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||Ip,r)}function lA(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Dp,r)}function cA(e,t){e.uniform1fv(this.addr,t)}function uA(e,t){const n=zp(t,this.size,2);e.uniform2fv(this.addr,n)}function hA(e,t){const n=zp(t,this.size,3);e.uniform3fv(this.addr,n)}function dA(e,t){const n=zp(t,this.size,4);e.uniform4fv(this.addr,n)}function pA(e,t){const n=zp(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function AA(e,t){const n=zp(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function fA(e,t){const n=zp(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function mA(e,t){e.uniform1iv(this.addr,t)}function gA(e,t){e.uniform2iv(this.addr,t)}function vA(e,t){e.uniform3iv(this.addr,t)}function yA(e,t){e.uniform4iv(this.addr,t)}function bA(e,t){e.uniform1uiv(this.addr,t)}function xA(e,t){e.uniform2uiv(this.addr,t)}function _A(e,t){e.uniform3uiv(this.addr,t)}function wA(e,t){e.uniform4uiv(this.addr,t)}function SA(e,t,n){const i=this.cache,r=t.length,s=Gp(n,r);qp(i,s)||(e.uniform1iv(this.addr,s),Vp(i,s));for(let o=0;o!==r;++o)n.setTexture2D(t[o]||Pp,s[o])}function TA(e,t,n){const i=this.cache,r=t.length,s=Gp(n,r);qp(i,s)||(e.uniform1iv(this.addr,s),Vp(i,s));for(let o=0;o!==r;++o)n.setTexture3D(t[o]||Lp,s[o])}function MA(e,t,n){const i=this.cache,r=t.length,s=Gp(n,r);qp(i,s)||(e.uniform1iv(this.addr,s),Vp(i,s));for(let o=0;o!==r;++o)n.setTextureCube(t[o]||Ip,s[o])}function EA(e,t,n){const i=this.cache,r=t.length,s=Gp(n,r);qp(i,s)||(e.uniform1iv(this.addr,s),Vp(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(t[o]||Dp,s[o])}class CA{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return jp;case 35664:return Hp;case 35665:return Wp;case 35666:return Xp;case 35674:return Yp;case 35675:return Qp;case 35676:return Kp;case 5124:case 35670:return Zp;case 35667:case 35671:return Jp;case 35668:case 35672:return $p;case 35669:case 35673:return eA;case 5125:return tA;case 36294:return nA;case 36295:return iA;case 36296:return rA;case 35678:case 36198:case 36298:case 36306:case 35682:return sA;case 35679:case 36299:case 36307:return oA;case 35680:case 36300:case 36308:case 36293:return aA;case 36289:case 36303:case 36311:case 36292:return lA}}(t.type)}}class RA{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return cA;case 35664:return uA;case 35665:return hA;case 35666:return dA;case 35674:return pA;case 35675:return AA;case 35676:return fA;case 5124:case 35670:return mA;case 35667:case 35671:return gA;case 35668:case 35672:return vA;case 35669:case 35673:return yA;case 5125:return bA;case 36294:return xA;case 36295:return _A;case 36296:return wA;case 35678:case 36198:case 36298:case 36306:case 35682:return SA;case 35679:case 36299:case 36307:return TA;case 35680:case 36300:case 36308:case 36293:return MA;case 36289:case 36303:case 36311:case 36292:return EA}}(t.type)}}class PA{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const NA=/(\w+)(\])?(\[|\.)?/g;function DA(e,t){e.seq.push(t),e.map[t.id]=t}function LA(e,t,n){const i=e.name,r=i.length;for(NA.lastIndex=0;;){const s=NA.exec(i),o=NA.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===r){DA(n,void 0===c?new CA(a,e,t):new RA(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new PA(a),DA(n,e)),n=e}}}class IA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);LA(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function OA(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}let kA=0;function BA(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let o=r;o<s;o++){const e=o+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[o]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function FA(e,t){const n=function(e){const t=iu.getPrimaries(iu.workingColorSpace),n=iu.getPrimaries(e);let i;switch(t===n?i="":t===yc&&n===vc?i="LinearDisplayP3ToLinearSRGB":t===vc&&n===yc&&(i="LinearSRGBToLinearDisplayP3"),e){case pc:case fc:return[i,"LinearTransferOETF"];case dc:case Ac:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[i,"LinearTransferOETF"]}}(t);return"vec4 ".concat(e,"( vec4 value ) { return ").concat(n[0],"( ").concat(n[1],"( value ) ); }")}function UA(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const zA=new yu;function qA(){iu.getLuminanceCoefficients(zA);const e=zA.x.toFixed(4),t=zA.y.toFixed(4),n=zA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function VA(e){return""!==e}function GA(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function jA(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const HA=/^[ \t]*#include +<([\w\d./]+)>/gm;function WA(e){return e.replace(HA,YA)}const XA=new Map;function YA(e,t){let n=Xd[t];if(void 0===n){const e=XA.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=Xd[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return WA(n)}const QA=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function KA(e){return e.replace(QA,ZA)}function ZA(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function JA(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function $A(e,t,n,i){const r=e.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Wa:case Xa:t="ENVMAP_TYPE_CUBE";break;case Ka:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===Xa&&(t="ENVMAP_MODE_REFRACTION");return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),d=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(VA).join("\n")}(n),A=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),f=r.createProgram();let m,g,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(m=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(VA).join("\n"),m.length>0&&(m+="\n"),g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(VA).join("\n"),g.length>0&&(g+="\n")):(m=[JA(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(VA).join("\n"),g=[JA(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Xd.tonemapping_pars_fragment:"",0!==n.toneMapping?UA("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Xd.colorspace_pars_fragment,FA("linearToOutputTexel",n.outputColorSpace),qA(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(VA).join("\n")),o=WA(o),o=GA(o,n),o=jA(o,n),a=WA(a),a=GA(a,n),a=jA(a,n),o=KA(o),a=KA(a),!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",m=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",n.glslVersion===Pc?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Pc?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const y=v+m+o,b=v+g+a,x=OA(r,r.VERTEX_SHADER,y),_=OA(r,r.FRAGMENT_SHADER,b);function w(t){if(e.debug.checkShaderErrors){const n=r.getProgramInfoLog(f).trim(),i=r.getShaderInfoLog(x).trim(),s=r.getShaderInfoLog(_).trim();let o=!0,a=!0;if(!1===r.getProgramParameter(f,r.LINK_STATUS))if(o=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(r,f,x,_);else{const e=BA(r,x,"vertex"),i=BA(r,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(f,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+i)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==i&&""!==s||(a=!1);a&&(t.diagnostics={runnable:o,programLog:n,vertexShader:{log:i,prefix:m},fragmentShader:{log:s,prefix:g}})}r.deleteShader(x),r.deleteShader(_),S=new IA(r,f),T=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let o=1;i.type===e.FLOAT_MAT2&&(o=2),i.type===e.FLOAT_MAT3&&(o=3),i.type===e.FLOAT_MAT4&&(o=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return n}(r,f)}let S,T;r.attachShader(f,x),r.attachShader(f,_),void 0!==n.index0AttributeName?r.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(f,0,"position"),r.linkProgram(f),this.getUniforms=function(){return void 0===S&&w(this),S},this.getAttributes=function(){return void 0===T&&w(this),T};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=r.getProgramParameter(f,37297)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(f),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=kA++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=x,this.fragmentShader=_,this}let ef=0;class tf{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new nf(e),t.set(e,n)),n}}class nf{constructor(e){this.id=ef++,this.code=e,this.usedTimes=0}}function rf(e,t,n,i,r,s,o){const a=new oh,l=new tf,c=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function f(e){return c.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(s,a,u,m,g){const v=m.fog,y=g.geometry,b=s.isMeshStandardMaterial?m.environment:null,x=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),_=x&&x.mapping===Ka?x.image.height:null,w=A[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));const S=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,T=void 0!==S?S.length:0;let M,E,C,R,P=0;if(void 0!==y.morphAttributes.position&&(P=1),void 0!==y.morphAttributes.normal&&(P=2),void 0!==y.morphAttributes.color&&(P=3),w){const e=Qd[w];M=e.vertexShader,E=e.fragmentShader}else M=s.vertexShader,E=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const N=e.getRenderTarget(),D=!0===g.isInstancedMesh,L=!0===g.isBatchedMesh,I=!!s.map,O=!!s.matcap,k=!!x,B=!!s.aoMap,F=!!s.lightMap,U=!!s.bumpMap,z=!!s.normalMap,q=!!s.displacementMap,V=!!s.emissiveMap,G=!!s.metalnessMap,j=!!s.roughnessMap,H=s.anisotropy>0,W=s.clearcoat>0,X=s.dispersion>0,Y=s.iridescence>0,Q=s.sheen>0,K=s.transmission>0,Z=H&&!!s.anisotropyMap,J=W&&!!s.clearcoatMap,$=W&&!!s.clearcoatNormalMap,ee=W&&!!s.clearcoatRoughnessMap,te=Y&&!!s.iridescenceMap,ne=Y&&!!s.iridescenceThicknessMap,ie=Q&&!!s.sheenColorMap,re=Q&&!!s.sheenRoughnessMap,se=!!s.specularMap,oe=!!s.specularColorMap,ae=!!s.specularIntensityMap,le=K&&!!s.transmissionMap,ce=K&&!!s.thicknessMap,ue=!!s.gradientMap,he=!!s.alphaMap,de=s.alphaTest>0,pe=!!s.alphaHash,Ae=!!s.extensions;let fe=0;s.toneMapped&&(null!==N&&!0!==N.isXRRenderTarget||(fe=e.toneMapping));const me={shaderID:w,shaderType:s.type,shaderName:s.name,vertexShader:M,fragmentShader:E,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,batching:L,batchingColor:L&&null!==g._colorsTexture,instancing:D,instancingColor:D&&null!==g.instanceColor,instancingMorph:D&&null!==g.morphTexture,supportsVertexTextures:d,outputColorSpace:null===N?e.outputColorSpace:!0===N.isXRRenderTarget?N.texture.colorSpace:pc,alphaToCoverage:!!s.alphaToCoverage,map:I,matcap:O,envMap:k,envMapMode:k&&x.mapping,envMapCubeUVHeight:_,aoMap:B,lightMap:F,bumpMap:U,normalMap:z,displacementMap:d&&q,emissiveMap:V,normalMapObjectSpace:z&&1===s.normalMapType,normalMapTangentSpace:z&&0===s.normalMapType,metalnessMap:G,roughnessMap:j,anisotropy:H,anisotropyMap:Z,clearcoat:W,clearcoatMap:J,clearcoatNormalMap:$,clearcoatRoughnessMap:ee,dispersion:X,iridescence:Y,iridescenceMap:te,iridescenceThicknessMap:ne,sheen:Q,sheenColorMap:ie,sheenRoughnessMap:re,specularMap:se,specularColorMap:oe,specularIntensityMap:ae,transmission:K,transmissionMap:le,thicknessMap:ce,gradientMap:ue,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:he,alphaTest:de,alphaHash:pe,combine:s.combine,mapUv:I&&f(s.map.channel),aoMapUv:B&&f(s.aoMap.channel),lightMapUv:F&&f(s.lightMap.channel),bumpMapUv:U&&f(s.bumpMap.channel),normalMapUv:z&&f(s.normalMap.channel),displacementMapUv:q&&f(s.displacementMap.channel),emissiveMapUv:V&&f(s.emissiveMap.channel),metalnessMapUv:G&&f(s.metalnessMap.channel),roughnessMapUv:j&&f(s.roughnessMap.channel),anisotropyMapUv:Z&&f(s.anisotropyMap.channel),clearcoatMapUv:J&&f(s.clearcoatMap.channel),clearcoatNormalMapUv:$&&f(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&f(s.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&f(s.iridescenceMap.channel),iridescenceThicknessMapUv:ne&&f(s.iridescenceThicknessMap.channel),sheenColorMapUv:ie&&f(s.sheenColorMap.channel),sheenRoughnessMapUv:re&&f(s.sheenRoughnessMap.channel),specularMapUv:se&&f(s.specularMap.channel),specularColorMapUv:oe&&f(s.specularColorMap.channel),specularIntensityMapUv:ae&&f(s.specularIntensityMap.channel),transmissionMapUv:le&&f(s.transmissionMap.channel),thicknessMapUv:ce&&f(s.thicknessMap.channel),alphaMapUv:he&&f(s.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||H),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===g.isPoints&&!!y.attributes.uv&&(I||he),fog:!!v,useFog:!0===s.fog,fogExp2:!!v&&v.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:T,morphTextureStride:P,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numLightProbes:a.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:fe,decodeVideoTexture:I&&!0===s.map.isVideoTexture&&iu.getTransfer(s.map.colorSpace)===gc,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:Ae&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ae&&!0===s.extensions.multiDraw||L)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return me.vertexUv1s=c.has(1),me.vertexUv2s=c.has(2),me.vertexUv3s=c.has(3),c.clear(),me},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.supportsVertexTextures&&a.enable(0);t.instancing&&a.enable(1);t.instancingColor&&a.enable(2);t.instancingMorph&&a.enable(3);t.matcap&&a.enable(4);t.envMap&&a.enable(5);t.normalMapObjectSpace&&a.enable(6);t.normalMapTangentSpace&&a.enable(7);t.clearcoat&&a.enable(8);t.iridescence&&a.enable(9);t.alphaTest&&a.enable(10);t.vertexColors&&a.enable(11);t.vertexAlphas&&a.enable(12);t.vertexUv1s&&a.enable(13);t.vertexUv2s&&a.enable(14);t.vertexUv3s&&a.enable(15);t.vertexTangents&&a.enable(16);t.anisotropy&&a.enable(17);t.alphaHash&&a.enable(18);t.batching&&a.enable(19);t.dispersion&&a.enable(20);t.batchingColor&&a.enable(21);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.skinning&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.doubleSided&&a.enable(10);t.flipSided&&a.enable(11);t.useDepthPacking&&a.enable(12);t.dithering&&a.enable(13);t.transmission&&a.enable(14);t.sheen&&a.enable(15);t.opaque&&a.enable(16);t.pointsUvs&&a.enable(17);t.decodeVideoTexture&&a.enable(18);t.alphaToCoverage&&a.enable(19);e.push(a.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=A[e.type];let n;if(t){const e=Qd[t];n=Md.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=u.length;e<r;e++){const t=u[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new $A(e,n,t,s),u.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function sf(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function of(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function af(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function lf(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,o,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.push(u):!0===o.transparent?r.push(u):n.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||of),i.length>1&&i.sort(t||af),r.length>1&&r.sort(t||af)}}}function cf(){let e=new WeakMap;return{get:function(t,n){const i=e.get(t);let r;return void 0===i?(r=new lf,e.set(t,[r])):n>=i.length?(r=new lf,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function uf(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new yu,color:new Fh};break;case"SpotLight":n={position:new yu,direction:new yu,color:new Fh,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new yu,color:new Fh,distance:0,decay:0};break;case"HemisphereLight":n={direction:new yu,skyColor:new Fh,groundColor:new Fh};break;case"RectAreaLight":n={color:new Fh,position:new yu,halfWidth:new yu,halfHeight:new yu}}return e[t.id]=n,n}}}let hf=0;function df(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function pf(e){const t=new uf,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hc};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hc,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let a=0;a<9;a++)i.probe.push(new yu);const r=new yu,s=new Qu,o=new Qu;return{setup:function(r){let s=0,o=0,a=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0;r.sort(df);for(let e=0,b=r.length;e<b;e++){const y=r[e],b=y.color,x=y.intensity,_=y.distance,w=y.shadow&&y.shadow.map?y.shadow.map.texture:null;if(y.isAmbientLight)s+=b.r*x,o+=b.g*x,a+=b.b*x;else if(y.isLightProbe){for(let e=0;e<9;e++)i.probe[e].addScaledVector(y.sh.coefficients[e],x);v++}else if(y.isDirectionalLight){const e=t.get(y);if(e.color.copy(y.color).multiplyScalar(y.intensity),y.castShadow){const e=y.shadow,t=n.get(y);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,i.directionalShadow[l]=t,i.directionalShadowMap[l]=w,i.directionalShadowMatrix[l]=y.shadow.matrix,p++}i.directional[l]=e,l++}else if(y.isSpotLight){const e=t.get(y);e.position.setFromMatrixPosition(y.matrixWorld),e.color.copy(b).multiplyScalar(x),e.distance=_,e.coneCos=Math.cos(y.angle),e.penumbraCos=Math.cos(y.angle*(1-y.penumbra)),e.decay=y.decay,i.spot[u]=e;const r=y.shadow;if(y.map&&(i.spotLightMap[m]=y.map,m++,r.updateMatrices(y),y.castShadow&&g++),i.spotLightMatrix[u]=r.matrix,y.castShadow){const e=n.get(y);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,i.spotShadow[u]=e,i.spotShadowMap[u]=w,f++}u++}else if(y.isRectAreaLight){const e=t.get(y);e.color.copy(b).multiplyScalar(x),e.halfWidth.set(.5*y.width,0,0),e.halfHeight.set(0,.5*y.height,0),i.rectArea[h]=e,h++}else if(y.isPointLight){const e=t.get(y);if(e.color.copy(y.color).multiplyScalar(y.intensity),e.distance=y.distance,e.decay=y.decay,y.castShadow){const e=y.shadow,t=n.get(y);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,i.pointShadow[c]=t,i.pointShadowMap[c]=w,i.pointShadowMatrix[c]=y.shadow.matrix,A++}i.point[c]=e,c++}else if(y.isHemisphereLight){const e=t.get(y);e.skyColor.copy(y.color).multiplyScalar(x),e.groundColor.copy(y.groundColor).multiplyScalar(x),i.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Yd.LTC_FLOAT_1,i.rectAreaLTC2=Yd.LTC_FLOAT_2):(i.rectAreaLTC1=Yd.LTC_HALF_1,i.rectAreaLTC2=Yd.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=o,i.ambient[2]=a;const y=i.hash;y.directionalLength===l&&y.pointLength===c&&y.spotLength===u&&y.rectAreaLength===h&&y.hemiLength===d&&y.numDirectionalShadows===p&&y.numPointShadows===A&&y.numSpotShadows===f&&y.numSpotMaps===m&&y.numLightProbes===v||(i.directional.length=l,i.spot.length=u,i.rectArea.length=h,i.point.length=c,i.hemi.length=d,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=A,i.pointShadowMap.length=A,i.spotShadow.length=f,i.spotShadowMap.length=f,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=A,i.spotLightMatrix.length=f+m-g,i.spotLightMap.length=m,i.numSpotLightShadowsWithMaps=g,i.numLightProbes=v,y.directionalLength=l,y.pointLength=c,y.spotLength=u,y.rectAreaLength=h,y.hemiLength=d,y.numDirectionalShadows=p,y.numPointShadows=A,y.numSpotShadows=f,y.numSpotMaps=m,y.numLightProbes=v,i.version=hf++)},setupView:function(e,t){let n=0,a=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){const t=e[d];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o.identity(),s.copy(t.matrixWorld),s.premultiply(h),o.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){const e=i.point[a];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),a++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function Af(e){const t=new pf(e),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){r.camera=e,n.length=0,i.length=0},state:r,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function ff(e){let t=new WeakMap;return{get:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=t.get(n);let s;return void 0===r?(s=new Af(e),t.set(n,[s])):i>=r.length?(s=new Af(e),r.push(s)):s=r[i],s},dispose:function(){t=new WeakMap}}}class mf extends qh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class gf extends qh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function vf(e,t,n){let i=new Gd;const r=new Hc,s=new Hc,o=new pu,a=new mf({depthPacking:3201}),l=new gf,c={},u=n.maxTextureSize,h={[Ta]:1,[Ma]:0,[Ea]:2},d=new Ed({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Hc},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const A=new nd;A.setAttribute("position",new Hh(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new bd(A,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let g=this.type;function v(n,i){const s=t.update(f);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new fu(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,d,f,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,p,f,null)}function y(t,n,i,r){let s=null;const o=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)s=o;else if(s=!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=s.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=s.clone(),i[t]=r,n.addEventListener("dispose",x)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=3===r?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],s.alphaMap=n.alphaMap,s.alphaTest=n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=i}return s}function b(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),l=n.material;if(Array.isArray(l)){const t=i.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=l[u.materialIndex];if(h&&h.visible){const t=y(n,h,o,a);n.onBeforeShadow(e,n,r,s,i,t,u),e.renderBufferDirect(s,null,i,t,n,u),n.onAfterShadow(e,n,r,s,i,t,u)}}}else if(l.visible){const t=y(n,l,o,a);n.onBeforeShadow(e,n,r,s,i,t,null),e.renderBufferDirect(s,null,i,t,n,null),n.onAfterShadow(e,n,r,s,i,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,s,o,a)}function x(e){e.target.removeEventListener("dispose",x);for(const t in c){const n=c[t],i=e.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(t,n,a){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=3!==g&&3===this.type,A=3===g&&3!==this.type;for(let f=0,m=t.length;f<m;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const h=c.getFrameExtents();if(r.multiply(h),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/h.x),r.x=s.x*h.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/h.y),r.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map||!0===p||!0===A){const e=3!==this.type?{minFilter:el,magFilter:el}:{};null!==c.map&&c.map.dispose(),c.map=new fu(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const m=c.getViewportCount();for(let e=0;e<m;e++){const t=c.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(o),c.updateMatrices(l,e),i=c.getFrustum(),b(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&v(c,a),c.needsUpdate=!1}g=this.type,m.needsUpdate=!1,e.setRenderTarget(l,c,h)}}function yf(e){const t=new function(){let t=!1;const n=new pu;let i=null;const r=new pu(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,o,a){!0===a&&(t*=o,i*=o,s*=o),n.set(t,i,s,o),!1===r.equals(n)&&(e.clearColor(t,i,s,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},n=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(t){t?U(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},i=new function(){let t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(n){t||(n?U(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&r===n&&s===o||(e.stencilFunc(t,n,o),i=t,r=n,s=o)},setOp:function(t,n,i){o===t&&a===n&&l===i||(e.stencilOp(t,n,i),o=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}},r=new WeakMap,s=new WeakMap;let o={},a={},l=new WeakMap,c=[],u=null,h=!1,d=null,p=null,A=null,f=null,m=null,g=null,v=null,y=new Fh(0,0,0),b=0,x=!1,_=null,w=null,S=null,T=null,M=null;const E=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let C=!1,R=0;const P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(P)[1]),C=R>=1):-1!==P.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),C=R>=2);let N=null,D={};const L=e.getParameter(e.SCISSOR_BOX),I=e.getParameter(e.VIEWPORT),O=(new pu).fromArray(L),k=(new pu).fromArray(I);function B(t,n,i,r){const s=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let a=0;a<i;a++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,r,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return o}const F={};function U(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function z(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}F[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),F[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),F[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),F[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),t.setClear(0,0,0,1),n.setClear(1),i.setClear(0),U(e.DEPTH_TEST),n.setFunc(3),j(!1),H(1),U(e.CULL_FACE),G(0);const q={[Ca]:e.FUNC_ADD,[Ra]:e.FUNC_SUBTRACT,[Pa]:e.FUNC_REVERSE_SUBTRACT};q[103]=e.MIN,q[104]=e.MAX;const V={[Na]:e.ZERO,[Da]:e.ONE,[La]:e.SRC_COLOR,[Oa]:e.SRC_ALPHA,[qa]:e.SRC_ALPHA_SATURATE,[Ua]:e.DST_COLOR,[Ba]:e.DST_ALPHA,[Ia]:e.ONE_MINUS_SRC_COLOR,[ka]:e.ONE_MINUS_SRC_ALPHA,[za]:e.ONE_MINUS_DST_COLOR,[Fa]:e.ONE_MINUS_DST_ALPHA,[Va]:e.CONSTANT_COLOR,[Ga]:e.ONE_MINUS_CONSTANT_COLOR,[ja]:e.CONSTANT_ALPHA,[Ha]:e.ONE_MINUS_CONSTANT_ALPHA};function G(t,n,i,r,s,o,a,l,c,u){if(0!==t){if(!1===h&&(U(e.BLEND),h=!0),5===t)s=s||n,o=o||i,a=a||r,n===p&&s===m||(e.blendEquationSeparate(q[n],q[s]),p=n,m=s),i===A&&r===f&&o===g&&a===v||(e.blendFuncSeparate(V[i],V[r],V[o],V[a]),A=i,f=r,g=o,v=a),!1!==l.equals(y)&&c===b||(e.blendColor(l.r,l.g,l.b,c),y.copy(l),b=c),d=t,x=!1;else if(t!==d||u!==x){if(p===Ca&&m===Ca||(e.blendEquation(e.FUNC_ADD),p=Ca,m=Ca),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}A=null,f=null,g=null,v=null,y.set(0,0,0),b=0,d=t,x=u}}else!0===h&&(z(e.BLEND),h=!1)}function j(t){_!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),_=t)}function H(t){0!==t?(U(e.CULL_FACE),t!==w&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),w=t}function W(t,n,i){t?(U(e.POLYGON_OFFSET_FILL),T===n&&M===i||(e.polygonOffset(n,i),T=n,M=i)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:t,depth:n,stencil:i},enable:U,disable:z,bindFramebuffer:function(t,n){return a[t]!==n&&(e.bindFramebuffer(t,n),a[t]=n,t===e.DRAW_FRAMEBUFFER&&(a[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(a[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let i=c,r=!1;if(t){i=l.get(n),void 0===i&&(i=[],l.set(n,i));const s=t.textures;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=s.length;t<n;t++)i[t]=e.COLOR_ATTACHMENT0+t;i.length=s.length,r=!0}}else i[0]!==e.BACK&&(i[0]=e.BACK,r=!0);r&&e.drawBuffers(i)},useProgram:function(t){return u!==t&&(e.useProgram(t),u=t,!0)},setBlending:G,setMaterial:function(r,s){2===r.side?z(e.CULL_FACE):U(e.CULL_FACE);let o=1===r.side;s&&(o=!o),j(o),1===r.blending&&!1===r.transparent?G(0):G(r.blending,r.blendEquation,r.blendSrc,r.blendDst,r.blendEquationAlpha,r.blendSrcAlpha,r.blendDstAlpha,r.blendColor,r.blendAlpha,r.premultipliedAlpha),n.setFunc(r.depthFunc),n.setTest(r.depthTest),n.setMask(r.depthWrite),t.setMask(r.colorWrite);const a=r.stencilWrite;i.setTest(a),a&&(i.setMask(r.stencilWriteMask),i.setFunc(r.stencilFunc,r.stencilRef,r.stencilFuncMask),i.setOp(r.stencilFail,r.stencilZFail,r.stencilZPass)),W(r.polygonOffset,r.polygonOffsetFactor,r.polygonOffsetUnits),!0===r.alphaToCoverage?U(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:H,setLineWidth:function(t){t!==S&&(C&&e.lineWidth(t),S=t)},setPolygonOffset:W,setScissorTest:function(t){t?U(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+E-1),N!==t&&(e.activeTexture(t),N=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===N?e.TEXTURE0+E-1:N);let r=D[i];void 0===r&&(r={type:void 0,texture:void 0},D[i]=r),r.type===t&&r.texture===n||(N!==i&&(e.activeTexture(i),N=i),e.bindTexture(t,n||F[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=D[N];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let i=s.get(n);void 0===i&&(i=new WeakMap,s.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=s.get(n).get(t);r.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),r.set(n,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===O.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),O.copy(t))},viewport:function(t){!1===k.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},N=null,D={},a={},l=new WeakMap,c=[],u=null,h=!1,d=null,p=null,A=null,f=null,m=null,g=null,v=null,y=new Fh(0,0,0),b=0,x=!1,_=null,w=null,S=null,T=null,M=null,O.set(0,0,e.canvas.width,e.canvas.height),k.set(0,0,e.canvas.width,e.canvas.height),t.reset(),n.reset(),i.reset()}}}function bf(e,t,n,i){const r=function(e){switch(e){case ol:case al:return{byteLength:1,components:1};case cl:case ll:case pl:return{byteLength:2,components:1};case Al:case fl:return{byteLength:2,components:4};case hl:case ul:case dl:return{byteLength:4,components:1};case gl:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(i);switch(n){case 1021:case 1024:return e*t;case 1025:return e*t*2;case xl:case _l:return e*t/r.components*r.byteLength;case 1030:case wl:return e*t*2/r.components*r.byteLength;case 1022:return e*t*3/r.components*r.byteLength;case vl:case Sl:return e*t*4/r.components*r.byteLength;case Tl:case Ml:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case El:case Cl:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Pl:case Dl:return Math.max(e,16)*Math.max(t,8)/4;case Rl:case Nl:return Math.max(e,8)*Math.max(t,8)/2;case Ll:case Il:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Ol:case kl:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Bl:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case Fl:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case Ul:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case zl:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case ql:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case Vl:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Gl:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case jl:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case Hl:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Wl:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case Xl:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case Yl:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case Ql:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case Kl:case Zl:case Jl:return Math.ceil(e/4)*Math.ceil(t/4)*16;case 36283:case $l:return Math.ceil(e/4)*Math.ceil(t/4)*8;case ec:case tc:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}function xf(e,t,n,i,r,s,o){const a=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new Hc,u=new WeakMap;let h;const d=new WeakMap;let p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(q){}function A(e,t){return p?new OffscreenCanvas(e,t):Qc("canvas")}function f(e,t,n){let i=1;const r=z(e);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===h&&(h=A(n,s));const o=t?A(n,s):h;o.width=n,o.height=s;return o.getContext("2d").drawImage(e,0,0,n,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+n+"x"+s+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),e}return e}function m(e){return e.generateMipmaps&&e.minFilter!==el&&e.minFilter!==il}function g(t){e.generateMipmap(t)}function v(n,i,r,s){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;if(i===e.RED&&(r===e.FLOAT&&(a=e.R32F),r===e.HALF_FLOAT&&(a=e.R16F),r===e.UNSIGNED_BYTE&&(a=e.R8)),i===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.R8UI),r===e.UNSIGNED_SHORT&&(a=e.R16UI),r===e.UNSIGNED_INT&&(a=e.R32UI),r===e.BYTE&&(a=e.R8I),r===e.SHORT&&(a=e.R16I),r===e.INT&&(a=e.R32I)),i===e.RG&&(r===e.FLOAT&&(a=e.RG32F),r===e.HALF_FLOAT&&(a=e.RG16F),r===e.UNSIGNED_BYTE&&(a=e.RG8)),i===e.RG_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.RG8UI),r===e.UNSIGNED_SHORT&&(a=e.RG16UI),r===e.UNSIGNED_INT&&(a=e.RG32UI),r===e.BYTE&&(a=e.RG8I),r===e.SHORT&&(a=e.RG16I),r===e.INT&&(a=e.RG32I)),i===e.RGB&&r===e.UNSIGNED_INT_5_9_9_9_REV&&(a=e.RGB9_E5),i===e.RGBA){const t=o?mc:iu.getTransfer(s);r===e.FLOAT&&(a=e.RGBA32F),r===e.HALF_FLOAT&&(a=e.RGBA16F),r===e.UNSIGNED_BYTE&&(a=t===gc?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(a=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(a=e.RGB5_A1)}return a!==e.R16F&&a!==e.R32F&&a!==e.RG16F&&a!==e.RG32F&&a!==e.RGBA16F&&a!==e.RGBA32F||t.get("EXT_color_buffer_float"),a}function y(t,n){let i;return t?null===n||n===hl||n===ml?i=e.DEPTH24_STENCIL8:n===dl?i=e.DEPTH32F_STENCIL8:n===cl&&(i=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===hl||n===ml?i=e.DEPTH_COMPONENT24:n===dl?i=e.DEPTH_COMPONENT32F:n===cl&&(i=e.DEPTH_COMPONENT16),i}function b(e,t){return!0===m(e)||e.isFramebufferTexture&&e.minFilter!==el&&e.minFilter!==il?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function x(e){const t=e.target;t.removeEventListener("dispose",x),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=d.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&w(e),0===Object.keys(r).length&&d.delete(n)}i.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function _(t){const n=t.target;n.removeEventListener("dispose",_),function(t){const n=i.get(t);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let t=0;t<n.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[i][t]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let s=0,a=r.length;s<a;s++){const t=i.get(r[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),i.remove(r[s])}i.remove(t)}(n)}function w(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete d.get(r)[n.__cacheKey],o.memory.textures--}let S=0;function T(t,r){const s=i.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void N(s,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const M={[Za]:e.REPEAT,[Ja]:e.CLAMP_TO_EDGE,[$a]:e.MIRRORED_REPEAT},E={[el]:e.NEAREST,[tl]:e.NEAREST_MIPMAP_NEAREST,[nl]:e.NEAREST_MIPMAP_LINEAR,[il]:e.LINEAR,[rl]:e.LINEAR_MIPMAP_NEAREST,[sl]:e.LINEAR_MIPMAP_LINEAR},C={[xc]:e.NEVER,[Cc]:e.ALWAYS,[_c]:e.LESS,[Sc]:e.LEQUAL,[wc]:e.EQUAL,[Ec]:e.GEQUAL,[Tc]:e.GREATER,[Mc]:e.NOTEQUAL};function R(n,s){if(s.type!==dl||!1!==t.has("OES_texture_float_linear")||s.magFilter!==il&&s.magFilter!==rl&&s.magFilter!==nl&&s.magFilter!==sl&&s.minFilter!==il&&s.minFilter!==rl&&s.minFilter!==nl&&s.minFilter!==sl||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,M[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,M[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,M[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,E[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,E[s.minFilter]),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,C[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(s.magFilter===el)return;if(s.minFilter!==nl&&s.minFilter!==sl)return;if(s.type===dl&&!1===t.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function P(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",x));const r=n.source;let s=d.get(r);void 0===s&&(s={},d.set(r,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),s[a].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&w(n)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return i}function N(t,o,a){let l=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(l=e.TEXTURE_3D);const c=P(t,o),u=o.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+a);const h=i.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+a);const t=iu.getPrimaries(iu.workingColorSpace),i=o.colorSpace===hc?null:iu.getPrimaries(o.colorSpace),d=o.colorSpace===hc||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let p=f(o.image,!1,r.maxTextureSize);p=U(o,p);const A=s.convert(o.format,o.colorSpace),x=s.convert(o.type);let _,w=v(o.internalFormat,A,x,o.colorSpace,o.isVideoTexture);R(l,o);const S=o.mipmaps,T=!0!==o.isVideoTexture,M=void 0===h.__version||!0===c,E=u.dataReady,C=b(o,p);if(o.isDepthTexture)w=y(o.format===bl,o.type),M&&(T?n.texStorage2D(e.TEXTURE_2D,1,w,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,w,p.width,p.height,0,A,x,null));else if(o.isDataTexture)if(S.length>0){T&&M&&n.texStorage2D(e.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let t=0,i=S.length;t<i;t++)_=S[t],T?E&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,A,x,_.data):n.texImage2D(e.TEXTURE_2D,t,w,_.width,_.height,0,A,x,_.data);o.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,C,w,p.width,p.height),E&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p.width,p.height,A,x,p.data)):n.texImage2D(e.TEXTURE_2D,0,w,p.width,p.height,0,A,x,p.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){T&&M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,w,S[0].width,S[0].height,p.depth);for(let t=0,i=S.length;t<i;t++)if(_=S[t],o.format!==vl)if(null!==A)if(T){if(E)if(o.layerUpdates.size>0){const i=bf(_.width,_.height,o.format,o.type);for(const r of o.layerUpdates){const s=_.data.subarray(r*i/_.data.BYTES_PER_ELEMENT,(r+1)*i/_.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,_.width,_.height,1,A,s,0,0)}o.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,_.width,_.height,p.depth,A,_.data,0,0)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,w,_.width,_.height,p.depth,0,_.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?E&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,_.width,_.height,p.depth,A,x,_.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,w,_.width,_.height,p.depth,0,A,x,_.data)}else{T&&M&&n.texStorage2D(e.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let t=0,i=S.length;t<i;t++)_=S[t],o.format!==vl?null!==A?T?E&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,A,_.data):n.compressedTexImage2D(e.TEXTURE_2D,t,w,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?E&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,A,x,_.data):n.texImage2D(e.TEXTURE_2D,t,w,_.width,_.height,0,A,x,_.data)}else if(o.isDataArrayTexture)if(T){if(M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,w,p.width,p.height,p.depth),E)if(o.layerUpdates.size>0){const t=bf(p.width,p.height,o.format,o.type);for(const i of o.layerUpdates){const r=p.data.subarray(i*t/p.data.BYTES_PER_ELEMENT,(i+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,p.width,p.height,1,A,x,r)}o.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,A,x,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,w,p.width,p.height,p.depth,0,A,x,p.data);else if(o.isData3DTexture)T?(M&&n.texStorage3D(e.TEXTURE_3D,C,w,p.width,p.height,p.depth),E&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,A,x,p.data)):n.texImage3D(e.TEXTURE_3D,0,w,p.width,p.height,p.depth,0,A,x,p.data);else if(o.isFramebufferTexture){if(M)if(T)n.texStorage2D(e.TEXTURE_2D,C,w,p.width,p.height);else{let t=p.width,i=p.height;for(let r=0;r<C;r++)n.texImage2D(e.TEXTURE_2D,r,w,t,i,0,A,x,null),t>>=1,i>>=1}}else if(S.length>0){if(T&&M){const t=z(S[0]);n.texStorage2D(e.TEXTURE_2D,C,w,t.width,t.height)}for(let t=0,i=S.length;t<i;t++)_=S[t],T?E&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,A,x,_):n.texImage2D(e.TEXTURE_2D,t,w,A,x,_);o.generateMipmaps=!1}else if(T){if(M){const t=z(p);n.texStorage2D(e.TEXTURE_2D,C,w,t.width,t.height)}E&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,A,x,p)}else n.texImage2D(e.TEXTURE_2D,0,w,A,x,p);m(o)&&g(l),h.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function D(t,r,o,l,c,u){const h=s.convert(o.format,o.colorSpace),d=s.convert(o.type),p=v(o.internalFormat,h,d,o.colorSpace);if(!i.get(r).__hasExternalTextures){const t=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,p,t,i,r.depth,0,h,d,null):n.texImage2D(c,u,p,t,i,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),F(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,i.get(o).__webglTexture,0,B(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,i.get(o).__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function L(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,o=y(n.stencilBuffer,s),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=B(n);F(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,n.width,n.height):i?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let r=0;r<t.length;r++){const o=t[r],l=s.convert(o.format,o.colorSpace),c=s.convert(o.type),u=v(o.internalFormat,l,c,o.colorSpace),h=B(n);i&&!1===F(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,u,n.width,n.height):F(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function I(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),T(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture,o=B(r);if(r.depthTexture.format===yl)F(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(r.depthTexture.format!==bl)throw new Error("Unknown depthTexture format");F(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=e.createRenderbuffer(),L(r.__webglDepthbuffer[i],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,s),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,s)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),L(r.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}n.bindFramebuffer(e.FRAMEBUFFER,null)}const O=[],k=[];function B(e){return Math.min(r.maxSamples,e.samples)}function F(e){const n=i.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function U(e,t){const n=e.colorSpace,i=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==pc&&n!==hc&&(iu.getTransfer(n)===gc?i===vl&&r===ol||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function z(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=S;return e>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=T,this.setTexture2DArray=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?N(s,t,r):n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?N(s,t,r):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,o){const a=i.get(t);t.version>0&&a.__version!==t.version?function(t,o,a){if(6!==o.image.length)return;const l=P(t,o),c=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+a);const u=i.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+a);const t=iu.getPrimaries(iu.workingColorSpace),i=o.colorSpace===hc?null:iu.getPrimaries(o.colorSpace),h=o.colorSpace===hc||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=o.isCompressedTexture||o.image[0].isCompressedTexture,p=o.image[0]&&o.image[0].isDataTexture,A=[];for(let e=0;e<6;e++)A[e]=d||p?p?o.image[e].image:o.image[e]:f(o.image[e],!0,r.maxCubemapSize),A[e]=U(o,A[e]);const y=A[0],x=s.convert(o.format,o.colorSpace),_=s.convert(o.type),w=v(o.internalFormat,x,_,o.colorSpace),S=!0!==o.isVideoTexture,T=void 0===u.__version||!0===l,M=c.dataReady;let E,C=b(o,y);if(R(e.TEXTURE_CUBE_MAP,o),d){S&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,w,y.width,y.height);for(let t=0;t<6;t++){E=A[t].mipmaps;for(let i=0;i<E.length;i++){const r=E[i];o.format!==vl?null!==x?S?M&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,x,r.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,w,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):S?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,x,_,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,w,r.width,r.height,0,x,_,r.data)}}}else{if(E=o.mipmaps,S&&T){E.length>0&&C++;const t=z(A[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,C,w,t.width,t.height)}for(let t=0;t<6;t++)if(p){S?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,A[t].width,A[t].height,x,_,A[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,w,A[t].width,A[t].height,0,x,_,A[t].data);for(let i=0;i<E.length;i++){const r=E[i].image[t].image;S?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,r.width,r.height,x,_,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,w,r.width,r.height,0,x,_,r.data)}}else{S?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,x,_,A[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,w,x,_,A[t]);for(let i=0;i<E.length;i++){const r=E[i];S?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,x,_,r.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,w,x,_,r.image[t])}}}m(o)&&g(e.TEXTURE_CUBE_MAP),u.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(a,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,r){const s=i.get(t);void 0!==n&&D(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&I(t)},this.setupRenderTarget=function(t){const r=t.texture,a=i.get(t),l=i.get(r);t.addEventListener("dispose",_);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,o.memory.textures++),u){a.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer[t]=[];for(let n=0;n<r.mipmaps.length;n++)a.__webglFramebuffer[t][n]=e.createFramebuffer()}else a.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)a.__webglFramebuffer[t]=e.createFramebuffer()}else a.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===F(t)){a.__webglMultisampledFramebuffer=e.createFramebuffer(),a.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,a.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];a.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),o=s.convert(i.type),l=v(i.internalFormat,r,o,i.colorSpace,!0===t.isXRRenderTarget),u=B(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,a.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(a.__webglDepthRenderbuffer=e.createRenderbuffer(),L(a.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),R(e.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)D(a.__webglFramebuffer[n][i],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else D(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);m(r)&&g(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let r=0,s=c.length;r<s;r++){const s=c[r],o=i.get(s);n.bindTexture(e.TEXTURE_2D,o.__webglTexture),R(e.TEXTURE_2D,s),D(a.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+r,e.TEXTURE_2D,0),m(s)&&g(e.TEXTURE_2D)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),R(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)D(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,i,n);else D(a.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,i,0);m(r)&&g(i),n.unbindTexture()}t.depthBuffer&&I(t)},this.updateRenderTargetMipmap=function(t){const r=t.textures;for(let s=0,o=r.length;s<o;s++){const o=r[s];if(m(o)){const r=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=i.get(o).__webglTexture;n.bindTexture(r,s),g(r),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===F(t)){const r=t.textures,s=t.width,o=t.height;let a=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),h=r.length>1;if(h)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,e.NEAREST),!0===l&&(O.length=0,k.length=0,O.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(O.push(c),k.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,k)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,O))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=I,this.setupFrameBufferTexture=D,this.useMultisampledRTT=F}function _f(e,t){return{convert:function(n){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hc;const s=iu.getTransfer(r);if(n===ol)return e.UNSIGNED_BYTE;if(n===Al)return e.UNSIGNED_SHORT_4_4_4_4;if(n===fl)return e.UNSIGNED_SHORT_5_5_5_1;if(n===gl)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===al)return e.BYTE;if(n===ll)return e.SHORT;if(n===cl)return e.UNSIGNED_SHORT;if(n===ul)return e.INT;if(n===hl)return e.UNSIGNED_INT;if(n===dl)return e.FLOAT;if(n===pl)return e.HALF_FLOAT;if(1021===n)return e.ALPHA;if(1022===n)return e.RGB;if(n===vl)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(n===yl)return e.DEPTH_COMPONENT;if(n===bl)return e.DEPTH_STENCIL;if(n===xl)return e.RED;if(n===_l)return e.RED_INTEGER;if(1030===n)return e.RG;if(n===wl)return e.RG_INTEGER;if(n===Sl)return e.RGBA_INTEGER;if(n===Tl||n===Ml||n===El||n===Cl)if(s===gc){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===Tl)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ml)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===El)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Cl)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===Tl)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ml)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===El)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Cl)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Rl||n===Pl||n===Nl||n===Dl){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===Rl)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Pl)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Nl)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Dl)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Ll||n===Il||n===Ol){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Ll||n===Il)return s===gc?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Ol)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===kl||n===Bl||n===Fl||n===Ul||n===zl||n===ql||n===Vl||n===Gl||n===jl||n===Hl||n===Wl||n===Xl||n===Yl||n===Ql){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===kl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Bl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Fl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Ul)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===zl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ql)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Vl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Gl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===jl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Hl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Wl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Xl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Yl)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Ql)return s===gc?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Kl||n===Zl||n===Jl){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===Kl)return s===gc?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Zl)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Jl)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===n||n===$l||n===ec||n===tc){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===Kl)return i.COMPRESSED_RED_RGTC1_EXT;if(n===$l)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ec)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===tc)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===ml?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class wf extends Dd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}}class Sf extends _h{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Tf={type:"move"};class Mf{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Sf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Sf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new yu,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new yu),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Sf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new yu,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new yu),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Tf)))}return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Sf;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Ef{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const i=new du;e.properties.get(i).__webglTexture=t.texture,t.depthNear==n.depthNear&&t.depthFar==n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new Ed({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new bd(new Wd(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Cf extends Lc{constructor(e,t){super();const n=this;let i=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,u=null,h=null,d=null,p=null;const A=new Ef,f=t.getContextAttributes();let m=null,g=null;const v=[],y=[],b=new Hc;let x=null;const _=new Dd;_.layers.enable(1),_.viewport=new pu;const w=new Dd;w.layers.enable(2),w.viewport=new pu;const S=[_,w],T=new wf;T.layers.enable(1),T.layers.enable(2);let M=null,E=null;function C(e){const t=y.indexOf(e.inputSource);if(-1===t)return;const n=v[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function R(){i.removeEventListener("select",C),i.removeEventListener("selectstart",C),i.removeEventListener("selectend",C),i.removeEventListener("squeeze",C),i.removeEventListener("squeezestart",C),i.removeEventListener("squeezeend",C),i.removeEventListener("end",R),i.removeEventListener("inputsourceschange",P);for(let e=0;e<v.length;e++){const t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}M=null,E=null,A.reset(),e.setRenderTarget(m),d=null,h=null,u=null,i=null,g=null,O.stop(),n.isPresenting=!1,e.setPixelRatio(x),e.setSize(b.width,b.height,!1),n.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=y.indexOf(n);i>=0&&(y[i]=null,v[i].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=y.indexOf(n);if(-1===i){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(n),i=e;break}if(null===y[e]){y[e]=n,i=e;break}}if(-1===i)break}const r=v[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new Mf,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new Mf,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new Mf,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){if(m=e.getRenderTarget(),i.addEventListener("select",C),i.addEventListener("selectstart",C),i.addEventListener("selectend",C),i.addEventListener("squeeze",C),i.addEventListener("squeezestart",C),i.addEventListener("squeezeend",C),i.addEventListener("end",R),i.addEventListener("inputsourceschange",P),!0!==f.xrCompatible&&await t.makeXRCompatible(),x=e.getPixelRatio(),e.getSize(b),void 0===i.renderState.layers){const n={antialias:f.antialias,alpha:!0,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),g=new fu(d.framebufferWidth,d.framebufferHeight,{format:vl,type:ol,colorSpace:e.outputColorSpace,stencilBuffer:f.stencil})}else{let n=null,s=null,o=null;f.depth&&(o=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=f.stencil?bl:yl,s=f.stencil?ml:hl);const a={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:r};u=new XRWebGLBinding(i,t),h=u.createProjectionLayer(a),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),g=new fu(h.textureWidth,h.textureHeight,{format:vl,type:ol,depthTexture:new Rp(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,colorSpace:e.outputColorSpace,samples:f.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues})}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await i.requestReferenceSpace(o),O.setContext(i),O.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return A.getDepthTexture()};const N=new yu,D=new yu;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;let t=e.near,n=e.far;null!==A.texture&&(A.depthNear>0&&(t=A.depthNear),A.depthFar>0&&(n=A.depthFar)),T.near=w.near=_.near=t,T.far=w.far=_.far=n,M===T.near&&E===T.far||(i.updateRenderState({depthNear:T.near,depthFar:T.far}),M=T.near,E=T.far);const r=e.parent,s=T.cameras;L(T,r);for(let i=0;i<s.length;i++)L(s[i],r);2===s.length?function(e,t,n){N.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const i=N.distanceTo(D),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,A=i/(-u+h),f=A*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(A),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===r[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+A,n=a+A,r=d-f,s=p+(i-f),u=l*a/n*t,h=c*a/n*t;e.projectionMatrix.makePerspective(r,s,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(T,_,w):T.projectionMatrix.copy(_.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Bc*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,T,r)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==h||null!==d)return a},this.setFoveation=function(e){a=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==A.texture},this.getDepthSensingMesh=function(){return A.getMesh(T)};let I=null;const O=new jd;O.setAnimationLoop((function(t,r){if(c=r.getViewerPose(l||s),p=r,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const r=t[i];let s=null;if(null!==d)s=d.getViewport(r);else{const t=u.getViewSubImage(h,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(g,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let o=S[i];void 0===o&&(o=new Dd,o.layers.enable(i),o.viewport=new pu,S[i]=o),o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(r.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&(T.matrix.copy(o.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===n&&T.cameras.push(o)}const r=i.enabledFeatures;if(r&&r.includes("depth-sensing")){const n=u.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&A.init(e,n,i.renderState)}}for(let e=0;e<v.length;e++){const t=y[e],n=v[e];null!==t&&void 0!==n&&n.update(t,r,l||s)}I&&I(t,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),p=null})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}}const Rf=new sh,Pf=new Qu;function Nf(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map,n(i.map,e.mapTransform)),i.alphaMap&&(e.alphaMap.value=i.alphaMap,n(i.alphaMap,e.alphaMapTransform)),i.bumpMap&&(e.bumpMap.value=i.bumpMap,n(i.bumpMap,e.bumpMapTransform),e.bumpScale.value=i.bumpScale,1===i.side&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,n(i.normalMap,e.normalMapTransform),e.normalScale.value.copy(i.normalScale),1===i.side&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,n(i.displacementMap,e.displacementMapTransform),e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,e.emissiveMapTransform)),i.specularMap&&(e.specularMap.value=i.specularMap,n(i.specularMap,e.specularMapTransform)),i.alphaTest>0&&(e.alphaTest.value=i.alphaTest);const r=t.get(i),s=r.envMap,o=r.envMapRotation;s&&(e.envMap.value=s,Rf.copy(o),Rf.x*=-1,Rf.y*=-1,Rf.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(Rf.y*=-1,Rf.z*=-1),e.envMapRotation.value.setFromMatrix4(Pf.makeRotationFromEuler(Rf)),e.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,e.reflectivity.value=i.reflectivity,e.ior.value=i.ior,e.refractionRatio.value=i.refractionRatio),i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,e.lightMapTransform)),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Td(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,r,s,o,a){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(e,r):r.isMeshToonMaterial?(i(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(i(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(i(e,r),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,a)):r.isMeshMatcapMaterial?(i(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?i(e,r):r.isMeshDistanceMaterial?(i(e,r),function(e,n){const i=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?i(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,i,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*r,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Df(e,t,n,i){let r={},s={},o=[];const a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,i){const r=e.value,s=t+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const e=i[s];if("number"===typeof r||"boolean"===typeof r){if(e!==r)return i[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const i=o.indexOf(n.__bindingPointIndex);o.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,h){let d=r[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const i=16;for(let s=0,o=t.length;s<o;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),o=n%i,a=o%t.boundary,l=o+a;n+=a,0!==l&&i-l<t.storage&&(n+=i-l),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=t.storage}}}const r=n%i;r>0&&(n+=i-r);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",u));const p=h.program;i.updateUBOMapping(n,p);const A=t.render.frame;s[n.id]!==A&&(!function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let r=0,o=i.length;r<o;r++){const t=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!0===l(i,r,n,s)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const o=n[s],a=c(o);"number"===typeof o||"boolean"===typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,r),r+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=A)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);o=[],r={},s={}}}}class Lf extends _h{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new sh,this.environmentIntensity=1,this.environmentRotation=new sh,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class If{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Rc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Fc()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return Jc("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fc()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fc()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Of=new yu;class kf{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Of.fromBufferAttribute(this,t),Of.applyMatrix4(e),this.setXYZ(t,Of.x,Of.y,Of.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Of.fromBufferAttribute(this,t),Of.applyNormalMatrix(e),this.setXYZ(t,Of.x,Of.y,Of.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Of.fromBufferAttribute(this,t),Of.transformDirection(e),this.setXYZ(t,Of.x,Of.y,Of.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Vc(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Gc(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Gc(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Gc(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Gc(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Gc(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Vc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Vc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Vc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Vc(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array),i=Gc(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gc(t,this.array),n=Gc(n,this.array),i=Gc(i,this.array),r=Gc(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Hh(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new kf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Bf extends Hh{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class Ff extends qh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Fh(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Uf=new yu,zf=new yu,qf=new Qu,Vf=new Yu,Gf=new zu,jf=new yu,Hf=new yu;class Wf extends _h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nd,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ff;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)Uf.fromBufferAttribute(t,e-1),zf.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Uf.distanceTo(zf);e.setAttribute("lineDistance",new Yh(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Gf.copy(n.boundingSphere),Gf.applyMatrix4(i),Gf.radius+=r,!1===e.ray.intersectsSphere(Gf))return;qf.copy(i).invert(),Vf.copy(e.ray).applyMatrix4(qf);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=c.getX(r),i=c.getX(r+1),s=Xf(this,e,Vf,a,n,i);s&&t.push(s)}if(this.isLineLoop){const r=c.getX(i-1),s=c.getX(n),o=Xf(this,e,Vf,a,r,s);o&&t.push(o)}}else{const n=Math.max(0,s.start),i=Math.min(u.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=Xf(this,e,Vf,a,r,r+1);n&&t.push(n)}if(this.isLineLoop){const r=Xf(this,e,Vf,a,i-1,n);r&&t.push(r)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Xf(e,t,n,i,r,s){const o=e.geometry.attributes.position;Uf.fromBufferAttribute(o,r),zf.fromBufferAttribute(o,s);if(n.distanceSqToSegment(Uf,zf,jf,Hf)>i)return;jf.applyMatrix4(e.matrixWorld);const a=t.ray.origin.distanceTo(jf);return a<t.near||a>t.far?void 0:{distance:a,point:Hf.clone().applyMatrix4(e.matrixWorld),index:r,face:null,faceIndex:null,object:e}}const Yf=new yu,Qf=new yu;class Kf extends Wf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)Yf.fromBufferAttribute(t,e),Qf.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Yf.distanceTo(Qf);e.setAttribute("lineDistance",new Yh(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Zf extends qh{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Fh(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Jf=new Qu,$f=new Yu,em=new zu,tm=new yu;class nm extends _h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nd,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Zf;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),em.copy(n.boundingSphere),em.applyMatrix4(i),em.radius+=r,!1===e.ray.intersectsSphere(em))return;Jf.copy(i).invert(),$f.copy(e.ray).applyMatrix4(Jf);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);tm.fromBufferAttribute(c,r),im(tm,r,a,i,e,t,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)tm.fromBufferAttribute(c,n),im(tm,n,a,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function im(e,t,n,i,r,s,o){const a=$f.distanceSqToPoint(e);if(a<n){const n=new yu;$f.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:o})}}class rm{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){const n=1e-4;let i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=t||(s.isVector2?new Hc:new yu);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new yu,i=[],r=[],s=[],o=new yu,a=new Qu;for(let d=0;d<=e;d++){const t=d/e;i[d]=this.getTangentAt(t,new yu)}r[0]=new yu,s[0]=new yu;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Uc(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,e))}s[d].crossVectors(i[d],r[d])}if(!0===t){let t=Math.acos(Uc(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class sm extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const r=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),!0!==this.aClockwise||r||(i===n?i=-n:i-=n);const s=this.aStartAngle+e*i;let o=this.aX+this.xRadius*Math.cos(s),a=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,i=a-this.aY;o=n*e-i*t+this.aX,a=n*t+i*e+this.aY}return t.set(o,a)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function om(){let e=0,t=0,n=0,i=0;function r(r,s,o,a){e=r,t=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,o,a){let l=(t-e)/s-(n-e)/(s+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l*=o,c*=o,r(t,n,l,c)},calc:function(r){const s=r*r;return e+t*r+n*s+i*(s*r)}}}const am=new yu,lm=new om,cm=new om,um=new om;function hm(e,t,n,i,r){const s=.5*(i-t),o=.5*(r-n),a=e*e;return(2*n-2*i+s+o)*(e*a)+(-3*n+3*i-2*s-o)*a+s*e+n}function dm(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function pm(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}class Am extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hc,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Hc,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Hc;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(pm(e,n.x,i.x,r.x,s.x),pm(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fm extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yu,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new yu;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(pm(e,n.x,i.x,r.x,s.x),pm(e,n.y,i.y,r.y,s.y),pm(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mm extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hc,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gm extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hc,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Hc;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=this.v0,i=this.v1,r=this.v2;return t.set(dm(e,n.x,i.x,r.x),dm(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vm extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yu;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=this.v0,i=this.v1,r=this.v2;return t.set(dm(e,n.x,i.x,r.x),dm(e,n.y,i.y,r.y),dm(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ym extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hc,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,o=n[0===r?r:r-1],a=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set(hm(s,o.x,a.x,l.x,c.x),hm(s,o.y,a.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Hc).fromArray(n))}return this}}var bm=Object.freeze({__proto__:null,ArcCurve:class extends sm{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu,n=this.points,i=n.length,r=(i-(this.closed?0:1))*e;let s,o,a=Math.floor(r),l=r-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:0===l&&a===i-1&&(a=i-2,l=1),this.closed||a>0?s=n[(a-1)%i]:(am.subVectors(n[0],n[1]).add(n[0]),s=am);const c=n[a%i],u=n[(a+1)%i];if(this.closed||a+2<i?o=n[(a+2)%i]:(am.subVectors(n[i-1],n[i-2]).add(n[i-1]),o=am),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),lm.initNonuniformCatmullRom(s.x,c.x,u.x,o.x,t,n,i),cm.initNonuniformCatmullRom(s.y,c.y,u.y,o.y,t,n,i),um.initNonuniformCatmullRom(s.z,c.z,u.z,o.z,t,n,i)}else"catmullrom"===this.curveType&&(lm.initCatmullRom(s.x,c.x,u.x,o.x,this.tension),cm.initCatmullRom(s.y,c.y,u.y,o.y,this.tension),um.initCatmullRom(s.z,c.z,u.z,o.z,this.tension));return t.set(lm.calc(l),cm.calc(l),um.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new yu).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:Am,CubicBezierCurve3:fm,EllipseCurve:sm,LineCurve:mm,LineCurve3:class extends rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:gm,QuadraticBezierCurve3:vm,SplineCurve:ym});class xm extends rm{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new bm[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const e=i[r]-n,s=this.curves[r],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new bm[n.type]).fromJSON(n))}return this}}class _m extends xm{constructor(e){super(),this.type="Path",this.currentPoint=new Hc,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new mm(this.currentPoint.clone(),new Hc(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new gm(this.currentPoint.clone(),new Hc(e,t),new Hc(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const o=new Am(this.currentPoint.clone(),new Hc(e,t),new Hc(n,i),new Hc(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new ym(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,o,a),this}absellipse(e,t,n,i,r,s,o,a){const l=new sm(e,t,n,i,r,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class wm extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],o=[],a=[],l=new yu,c=new Hc;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const r=n+u/t*i;l.x=e*Math.cos(r),l.y=e*Math.sin(r),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[h]/e+1)/2,c.y=(s[h+1]/e+1)/2,a.push(c.x,c.y)}for(let u=1;u<=t;u++)r.push(u,u+1,0);this.setIndex(r),this.setAttribute("position",new Yh(s,3)),this.setAttribute("normal",new Yh(o,3)),this.setAttribute("uv",new Yh(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wm(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Sm extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],u=[],h=[],d=[];let p=0;const A=[],f=n/2;let m=0;function g(n){const r=p,s=new Hc,A=new yu;let g=0;const v=!0===n?e:t,y=!0===n?1:-1;for(let e=1;e<=i;e++)u.push(0,f*y,0),h.push(0,y,0),d.push(.5,.5),p++;const b=p;for(let e=0;e<=i;e++){const t=e/i*a+o,n=Math.cos(t),r=Math.sin(t);A.x=v*r,A.y=f*y,A.z=v*n,u.push(A.x,A.y,A.z),h.push(0,y,0),s.x=.5*n+.5,s.y=.5*r*y+.5,d.push(s.x,s.y),p++}for(let e=0;e<i;e++){const t=r+e,i=b+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),g+=3}l.addGroup(m,g,!0===n?1:2),m+=g}!function(){const s=new yu,g=new yu;let v=0;const y=(t-e)/n;for(let l=0;l<=r;l++){const c=[],m=l/r,v=m*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*a+o,l=Math.sin(r),A=Math.cos(r);g.x=v*l,g.y=-m*n+f,g.z=v*A,u.push(g.x,g.y,g.z),s.set(l,y,A).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-m),c.push(p++)}A.push(c)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=A[t][e],i=A[t+1][e],r=A[t+1][e+1],s=A[t][e+1];c.push(n,i,s),c.push(i,r,s),v+=6}l.addGroup(m,v,0),m+=v}(),!1===s&&(e>0&&g(!0),t>0&&g(!1)),this.setIndex(c),this.setAttribute("position",new Yh(u,3)),this.setAttribute("normal",new Yh(h,3)),this.setAttribute("uv",new Yh(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sm(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Tm extends _m{constructor(e){super(e),this.uuid=Fc(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new _m).fromJSON(n))}return this}}const Mm=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=Em(e,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(i&&(s=function(e,t,n,i){const r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*i,l=s<o-1?t[s+1]*i:e.length,c=Em(e,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Fm(c));for(r.sort(Im),s=0;s<r.length;s++)n=Om(r[s],n);return n}(e,t,s,n)),e.length>80*n){a=c=e[0],l=u=e[1];for(let t=n;t<r;t+=n)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?32767/p:0}return Rm(s,o,n,a,l,p,0),o};function Em(e,t,n,i,r){let s,o;if(r===function(e,t,n,i){let r=0;for(let s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}(e,t,n,i)>0)for(s=t;s<n;s+=i)o=Ym(s,e[s],e[s+1],o);else for(s=n-i;s>=t;s-=i)o=Ym(s,e[s],e[s+1],o);return o&&Vm(o,o.next)&&(Qm(o),o=o.next),o}function Cm(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Vm(i,i.next)&&0!==qm(i.prev,i,i.next))i=i.next;else{if(Qm(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function Rm(e,t,n,i,r,s,o){if(!e)return;!o&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=Bm(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,s,o,a,l,c=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ,i);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(e,i,r,s);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,s?Nm(e,i,r,s):Pm(e))t.push(a.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),Qm(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?Rm(e=Dm(Cm(e),t,n),t,n,i,r,s,2):2===o&&Lm(e,t,n,i,r,s):Rm(Cm(e),t,n,i,r,s,1);break}}function Pm(e){const t=e.prev,n=e,i=e.next;if(qm(t,n,i)>=0)return!1;const r=t.x,s=n.x,o=i.x,a=t.y,l=n.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c;let A=i.next;for(;A!==t;){if(A.x>=u&&A.x<=d&&A.y>=h&&A.y<=p&&Um(r,a,s,l,o,c,A.x,A.y)&&qm(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function Nm(e,t,n,i){const r=e.prev,s=e,o=e.next;if(qm(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,A=u<h?u<d?u:d:h<d?h:d,f=a>l?a>c?a:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,g=Bm(p,A,t,n,i),v=Bm(f,m,t,n,i);let y=e.prevZ,b=e.nextZ;for(;y&&y.z>=g&&b&&b.z<=v;){if(y.x>=p&&y.x<=f&&y.y>=A&&y.y<=m&&y!==r&&y!==o&&Um(a,u,l,h,c,d,y.x,y.y)&&qm(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=f&&b.y>=A&&b.y<=m&&b!==r&&b!==o&&Um(a,u,l,h,c,d,b.x,b.y)&&qm(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=g;){if(y.x>=p&&y.x<=f&&y.y>=A&&y.y<=m&&y!==r&&y!==o&&Um(a,u,l,h,c,d,y.x,y.y)&&qm(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=f&&b.y>=A&&b.y<=m&&b!==r&&b!==o&&Um(a,u,l,h,c,d,b.x,b.y)&&qm(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Dm(e,t,n){let i=e;do{const r=i.prev,s=i.next.next;!Vm(r,s)&&Gm(r,i,i.next,s)&&Wm(r,s)&&Wm(s,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(s.i/n|0),Qm(i),Qm(i.next),i=e=s),i=i.next}while(i!==e);return Cm(i)}function Lm(e,t,n,i,r,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&zm(o,e)){let a=Xm(o,e);return o=Cm(o,o.next),a=Cm(a,a.next),Rm(o,t,n,i,r,s,0),void Rm(a,t,n,i,r,s,0)}e=e.next}o=o.next}while(o!==e)}function Im(e,t){return e.x-t.x}function Om(e,t){const n=function(e,t){let n,i=t,r=-1/0;const s=e.x,o=e.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const e=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=s&&e>r&&(r=e,n=i.x<i.next.x?i:i.next,e===s))return n}i=i.next}while(i!==t);if(!n)return null;const a=n,l=n.x,c=n.y;let u,h=1/0;i=n;do{s>=i.x&&i.x>=l&&s!==i.x&&Um(o<c?s:r,o,l,c,o<c?r:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),Wm(i,e)&&(u<h||u===h&&(i.x>n.x||i.x===n.x&&km(n,i)))&&(n=i,h=u)),i=i.next}while(i!==a);return n}(e,t);if(!n)return t;const i=Xm(n,e);return Cm(i,i.next),Cm(n,n.next)}function km(e,t){return qm(e.prev,e,t.prev)<0&&qm(t.next,e,e.next)<0}function Bm(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fm(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Um(e,t,n,i,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function zm(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Gm(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Wm(e,t)&&Wm(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(qm(e.prev,e,t.prev)||qm(e,t.prev,t))||Vm(e,t)&&qm(e.prev,e,e.next)>0&&qm(t.prev,t,t.next)>0)}function qm(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Vm(e,t){return e.x===t.x&&e.y===t.y}function Gm(e,t,n,i){const r=Hm(qm(e,t,n)),s=Hm(qm(e,t,i)),o=Hm(qm(n,i,e)),a=Hm(qm(n,i,t));return r!==s&&o!==a||(!(0!==r||!jm(e,n,t))||(!(0!==s||!jm(e,i,t))||(!(0!==o||!jm(n,e,i))||!(0!==a||!jm(n,t,i)))))}function jm(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Hm(e){return e>0?1:e<0?-1:0}function Wm(e,t){return qm(e.prev,e,e.next)<0?qm(e,t,e.next)>=0&&qm(e,e.prev,t)>=0:qm(e,t,e.prev)<0||qm(e,e.next,t)<0}function Xm(e,t){const n=new Km(e.i,e.x,e.y),i=new Km(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Ym(e,t,n,i){const r=new Km(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Qm(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Km(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Zm{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return Zm.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];Jm(e),$m(n,e);let s=e.length;t.forEach(Jm);for(let a=0;a<t.length;a++)i.push(s),s+=t[a].length,$m(n,t[a]);const o=Mm(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function Jm(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function $m(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class eg extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Tm([new Hc(.5,.5),new Hc(-.5,.5),new Hc(-.5,-.5),new Hc(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let o=0,a=e.length;o<a;o++){s(e[o])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const A=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:tg;let m,g,v,y,b,x=!1;A&&(m=A.getSpacedPoints(a),x=!0,c=!1,g=A.computeFrenetFrames(a,!1),v=new yu,y=new yu,b=new yu),c||(p=0,u=0,h=0,d=0);const _=e.extractPoints(o);let w=_.shape;const S=_.holes;if(!Zm.isClockWise(w)){w=w.reverse();for(let e=0,t=S.length;e<t;e++){const t=S[e];Zm.isClockWise(t)&&(S[e]=t.reverse())}}const T=Zm.triangulateShape(w,S),M=w;for(let t=0,n=S.length;t<n;t++){const e=S[t];w=w.concat(e)}function E(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const C=w.length,R=T.length;function P(e,t,n){let i,r,s;const o=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,A=t.y+o/h,f=((n.x-c/d-p)*c-(n.y+l/d-A)*l)/(o*c-a*l);i=p+o*f-e.x,r=A+a*f-e.y;const m=i*i+r*r;if(m<=2)return new Hc(i,r);s=Math.sqrt(m/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,r=o,s=Math.sqrt(u)):(i=o,r=a,s=Math.sqrt(u/2))}return new Hc(i/s,r/s)}const N=[];for(let t=0,n=M.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),N[t]=P(M[t],M[i],M[r]);const D=[];let L,I=N.concat();for(let t=0,n=S.length;t<n;t++){const e=S[t];L=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),L[t]=P(e[t],e[i],e[r]);D.push(L),I=I.concat(L)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,r=M.length;t<r;t++){const e=E(M[t],N[t],i);B(e.x,e.y,-n)}for(let t=0,r=S.length;t<r;t++){const e=S[t];L=D[t];for(let t=0,r=e.length;t<r;t++){const r=E(e[t],L[t],i);B(r.x,r.y,-n)}}}const O=h+d;for(let t=0;t<C;t++){const e=c?E(w[t],I[t],O):w[t];x?(y.copy(g.normals[0]).multiplyScalar(e.x),v.copy(g.binormals[0]).multiplyScalar(e.y),b.copy(m[0]).add(y).add(v),B(b.x,b.y,b.z)):B(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<C;e++){const n=c?E(w[e],I[e],O):w[e];x?(y.copy(g.normals[t]).multiplyScalar(n.x),v.copy(g.binormals[t]).multiplyScalar(n.y),b.copy(m[t]).add(y).add(v),B(b.x,b.y,b.z)):B(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,r=M.length;t<r;t++){const e=E(M[t],N[t],i);B(e.x,e.y,l+n)}for(let t=0,r=S.length;t<r;t++){const e=S[t];L=D[t];for(let t=0,r=e.length;t<r;t++){const r=E(e[t],L[t],i);x?B(r.x,r.y+m[a-1].y,m[a-1].x+n):B(r.x,r.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=C*e,s=C*(e+1);U(t+i+n,t+r+n,t+r+s,t+i+s)}}}function B(e,t,n){s.push(e),s.push(t),s.push(n)}function F(e,t,r){z(e),z(t),z(r);const s=i.length/3,o=f.generateTopUV(n,i,s-3,s-2,s-1);q(o[0]),q(o[1]),q(o[2])}function U(e,t,r,s){z(e),z(t),z(s),z(t),z(r),z(s);const o=i.length/3,a=f.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);q(a[0]),q(a[1]),q(a[3]),q(a[1]),q(a[2]),q(a[3])}function z(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function q(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=C*e;for(let n=0;n<R;n++){const e=T[n];F(e[2]+t,e[1]+t,e[0]+t)}e=a+2*p,t=C*e;for(let n=0;n<R;n++){const e=T[n];F(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<R;e++){const t=T[e];F(t[2],t[1],t[0])}for(let e=0;e<R;e++){const t=T[e];F(t[0]+C*a,t[1]+C*a,t[2]+C*a)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;k(M,t),t+=M.length;for(let n=0,i=S.length;n<i;n++){const e=S[n];k(e,t),t+=e.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new Yh(i,3)),this.setAttribute("uv",new Yh(r,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){const t=e[i];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const i=t[e.shapes[r]];n.push(i)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new bm[i.type]).fromJSON(i)),new eg(n,e.options)}}const tg={generateTopUV:function(e,t,n,i,r){const s=t[3*n],o=t[3*n+1],a=t[3*i],l=t[3*i+1],c=t[3*r],u=t[3*r+1];return[new Hc(s,o),new Hc(a,l),new Hc(c,u)]},generateSideWallUV:function(e,t,n,i,r,s){const o=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],A=t[3*r+2],f=t[3*s],m=t[3*s+1],g=t[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Hc(o,1-l),new Hc(c,1-h),new Hc(d,1-A),new Hc(f,1-g)]:[new Hc(a,1-l),new Hc(u,1-h),new Hc(p,1-A),new Hc(m,1-g)]}};class ng extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new yu,h=new yu,d=[],p=[],A=[],f=[];for(let m=0;m<=n;m++){const d=[],g=m/n;let v=0;0===m&&0===s?v=.5/t:m===n&&a===Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(i+a*r)*Math.sin(s+g*o),u.y=e*Math.cos(s+g*o),u.z=e*Math.sin(i+a*r)*Math.sin(s+g*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),A.push(h.x,h.y,h.z),f.push(a+v,1-g),d.push(l++)}c.push(d)}for(let m=0;m<n;m++)for(let e=0;e<t;e++){const t=c[m][e+1],i=c[m][e],r=c[m+1][e],o=c[m+1][e+1];(0!==m||s>0)&&d.push(t,i,o),(m!==n-1||a<Math.PI)&&d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new Yh(p,3)),this.setAttribute("normal",new Yh(A,3)),this.setAttribute("uv",new Yh(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ng(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ig extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vm(new yu(-1,-1,0),new yu(-1,1,0),new yu(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new yu,a=new yu,l=new Hc;let c=new yu;const u=[],h=[],d=[],p=[];function A(r){c=e.getPointAt(r/t,c);const l=s.normals[r],d=s.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+r*d.x,a.y=s*l.y+r*d.y,a.z=s*l.z+r*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,u.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)A(e);A(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;p.push(n,r,o),p.push(r,s,o)}}()}(),this.setIndex(p),this.setAttribute("position",new Yh(u,3)),this.setAttribute("normal",new Yh(h,3)),this.setAttribute("uv",new Yh(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ig((new bm[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class rg extends nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new yu,r=new yu;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let l=0;l<3;l++){const a=o.getX(e+l),c=o.getX(e+(l+1)%3);i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,c),!0===sg(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let a=0;a<3;a++){const o=3*e+a,l=3*e+(a+1)%3;i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,l),!0===sg(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Yh(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function sg(e,t,n){const i="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),r="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}class og extends qh{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Fh(16777215),this.specular=new Fh(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fh(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new sh,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ag extends qh{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Fh(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fh(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new sh,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function lg(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function cg(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class ug{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class hg extends ug{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:sc,endingEnd:sc}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case oc:r=e,o=2*t-n;break;case ac:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case oc:s=e,a=2*n-t;break;case ac:s=1,a=n+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),A=p*p,f=A*p,m=-h*f+2*h*A-h*p,g=(1+h)*f+(-1.5-2*h)*A+(-.5+h)*p+1,v=(-1-d)*f+(1.5+d)*A+.5*p,y=d*f-d*A;for(let b=0;b!==o;++b)r[b]=m*s[c+b]+g*s[l+b]+v*s[a+b]+y*s[u+b];return r}}class dg extends ug{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),u=1-c;for(let h=0;h!==o;++h)r[h]=s[l+h]*u+s[a+h]*c;return r}}class pg extends ug{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ag{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=lg(t,this.TimeBufferType),this.values=lg(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:lg(e.times,Array),values:lg(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new pg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new dg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hg(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case nc:t=this.InterpolantFactoryMethodDiscrete;break;case ic:t=this.InterpolantFactoryMethodLinear;break;case rc:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nc;case this.InterpolantFactoryMethodLinear:return ic;case this.InterpolantFactoryMethodSmooth:return rc}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const t=n[o];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,s),e=!1;break}s=t}if(void 0!==i&&cg(i))for(let o=0,a=i.length;o!==a;++o){const t=i[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===rc,r=e.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)r=!0;else{const e=o*n,i=e-n,s=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[s+o]){r=!0;break}}}if(r){if(o!==s){e[s]=e[o];const i=o*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,o=0;o!==n;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Ag.prototype.TimeBufferType=Float32Array,Ag.prototype.ValueBufferType=Float32Array,Ag.prototype.DefaultInterpolation=ic;class fg extends Ag{constructor(e,t,n){super(e,t,n)}}fg.prototype.ValueTypeName="bool",fg.prototype.ValueBufferType=Array,fg.prototype.DefaultInterpolation=nc,fg.prototype.InterpolantFactoryMethodLinear=void 0,fg.prototype.InterpolantFactoryMethodSmooth=void 0;class mg extends Ag{}mg.prototype.ValueTypeName="color";class gg extends Ag{}gg.prototype.ValueTypeName="number";class vg extends ug{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let c=l+o;l!==c;l+=4)vu.slerpFlat(r,0,s,l-o,s,l,a);return r}}class yg extends Ag{InterpolantFactoryMethodLinear(e){return new vg(this.times,this.values,this.getValueSize(),e)}}yg.prototype.ValueTypeName="quaternion",yg.prototype.InterpolantFactoryMethodSmooth=void 0;class bg extends Ag{constructor(e,t,n){super(e,t,n)}}bg.prototype.ValueTypeName="string",bg.prototype.ValueBufferType=Array,bg.prototype.DefaultInterpolation=nc,bg.prototype.InterpolantFactoryMethodLinear=void 0,bg.prototype.InterpolantFactoryMethodSmooth=void 0;class xg extends Ag{}xg.prototype.ValueTypeName="vector";const _g={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class wg{constructor(e,t,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const Sg=new wg;class Tg{constructor(e){this.manager=void 0!==e?e:Sg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Tg.DEFAULT_MATERIAL_NAME="__DEFAULT";Error;class Mg extends Tg{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=_g.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;const o=Qc("img");function a(){c(),_g.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class Eg extends Tg{constructor(e){super(e)}load(e,t,n,i){const r=new du,s=new Mg(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}class Cg extends _h{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new Fh(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}const Rg=new Qu,Pg=new yu,Ng=new yu;class Dg{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Hc(512,512),this.map=null,this.mapPass=null,this.matrix=new Qu,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Gd,this._frameExtents=new Hc(1,1),this._viewportCount=1,this._viewports=[new pu(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Pg.setFromMatrixPosition(e.matrixWorld),t.position.copy(Pg),Ng.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Ng),t.updateMatrixWorld(),Rg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Rg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Rg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Lg extends Dg{constructor(){super(new sp(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ig extends Cg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(_h.DEFAULT_UP),this.updateMatrix(),this.target=new _h,this.shadow=new Lg}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Og extends Cg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class kg extends nd{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Bg{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Fg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Fg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Fg(){return("undefined"===typeof performance?Date:performance).now()}const Ug="\\[\\]\\.:\\/",zg=new RegExp("["+Ug+"]","g"),qg="[^"+Ug+"]",Vg="[^"+Ug.replace("\\.","")+"]",Gg=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",qg)+/(WCOD+)?/.source.replace("WCOD",Vg)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",qg)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",qg)+"$"),jg=["material","materials","bones","map"];class Hg{constructor(e,t,n){this.path=t,this.parsedPath=n||Hg.parseTrackName(t),this.node=Hg.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Hg.Composite(e,t,n):new Hg(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(zg,"")}static parseTrackName(e){const t=Gg.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==jg.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=Hg.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Hg.Composite=class{constructor(e,t,n){const i=n||Hg.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Hg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Hg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Hg.prototype.GetterByBindingType=[Hg.prototype._getValue_direct,Hg.prototype._getValue_array,Hg.prototype._getValue_arrayElement,Hg.prototype._getValue_toArray],Hg.prototype.SetterByBindingTypeAndVersioning=[[Hg.prototype._setValue_direct,Hg.prototype._setValue_direct_setNeedsUpdate,Hg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Hg.prototype._setValue_array,Hg.prototype._setValue_array_setNeedsUpdate,Hg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Hg.prototype._setValue_arrayElement,Hg.prototype._setValue_arrayElement_setNeedsUpdate,Hg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Hg.prototype._setValue_fromArray,Hg.prototype._setValue_fromArray_setNeedsUpdate,Hg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class Wg extends If{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const Xg=new Qu;function Yg(e,t){return e.distance-t.distance}function Qg(e,t,n,i){let r=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(r=!1)}if(!0===r&&!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)Qg(i[e],t,n,!0)}}class Kg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Uc(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Zg=new yu,Jg=new yu;class $g{constructor(){this.type="ShapePath",this.color=new Fh,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new _m,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=t[r],o=t[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],a=-a,o=t[r],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const n=Zm.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,o;const a=[];if(1===i.length)return s=i[0],o=new Tm,o.curves=s.curves,a.push(o),a;let l=!n(i[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,p=[],A=0;u[A]=void 0,p[A]=[];for(let f=0,m=i.length;f<m;f++)s=i[f],h=s.getPoints(),r=n(h),r=e?!r:r,r?(!l&&u[A]&&A++,u[A]={s:new Tm,p:h},u[A].s.curves=s.curves,l&&A++,p[A]=[]):p[A].push({h:s,p:h[0]});if(!u[0])return function(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new Tm;r.curves=i.curves,t.push(r)}return t}(i);if(u.length>1){let e=!1,n=0;for(let t=0,i=u.length;t<i;t++)c[t]=[];for(let i=0,r=u.length;i<r;i++){const r=p[i];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<u.length;r++)t(o.p,u[r].p)&&(i!==r&&n++,a?(a=!1,c[r].push(o)):e=!0);a&&c[i].push(o)}}n>0&&!1===e&&(p=c)}for(let f=0,m=u.length;f<m;f++){o=u[f].s,a.push(o),d=p[f];for(let e=0,t=d.length;e<t;e++)o.holes.push(d[e].h)}return a}}class ev extends Lc{constructor(e,t){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ya}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ya);const tv=new yu,nv=new Qu,iv=new Qu,rv=new yu,sv=new yu;const ov=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const av="object"==typeof global&&global&&global.Object===Object&&global;var lv="object"==typeof self&&self&&self.Object===Object&&self;const cv=av||lv||Function("return this")();const uv=function(){return cv.Date.now()};var hv=/\s/;const dv=function(e){for(var t=e.length;t--&&hv.test(e.charAt(t)););return t};var pv=/^\s+/;const Av=function(e){return e?e.slice(0,dv(e)+1).replace(pv,""):e};const fv=cv.Symbol;var mv=Object.prototype,gv=mv.hasOwnProperty,vv=mv.toString,yv=fv?fv.toStringTag:void 0;const bv=function(e){var t=gv.call(e,yv),n=e[yv];try{e[yv]=void 0;var i=!0}catch(s){}var r=vv.call(e);return i&&(t?e[yv]=n:delete e[yv]),r};var xv=Object.prototype.toString;const _v=function(e){return xv.call(e)};var wv=fv?fv.toStringTag:void 0;const Sv=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":wv&&wv in Object(e)?bv(e):_v(e)};const Tv=function(e){return null!=e&&"object"==typeof e};const Mv=function(e){return"symbol"==typeof e||Tv(e)&&"[object Symbol]"==Sv(e)};var Ev=/^[-+]0x[0-9a-f]+$/i,Cv=/^0b[01]+$/i,Rv=/^0o[0-7]+$/i,Pv=parseInt;const Nv=function(e){if("number"==typeof e)return e;if(Mv(e))return NaN;if(ov(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ov(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Av(e);var n=Cv.test(e);return n||Rv.test(e)?Pv(e.slice(2),n?2:8):Ev.test(e)?NaN:+e};var Dv=Math.max,Lv=Math.min;const Iv=function(e,t,n){var i,r,s,o,a,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=i,s=r;return i=r=void 0,c=t,o=e.apply(s,n)}function A(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-c>=s}function f(){var e=uv();if(A(e))return m(e);a=setTimeout(f,function(e){var n=t-(e-l);return h?Lv(n,s-(e-c)):n}(e))}function m(e){return a=void 0,d&&i?p(e):(i=r=void 0,o)}function g(){var e=uv(),n=A(e);if(i=arguments,r=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(f,t),u?p(e):o}(l);if(h)return clearTimeout(a),a=setTimeout(f,t),p(l)}return void 0===a&&(a=setTimeout(f,t)),o}return t=Nv(t)||0,ov(n)&&(u=!!n.leading,s=(h="maxWait"in n)?Dv(Nv(n.maxWait)||0,t):s,d="trailing"in n?!!n.trailing:d),g.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=r=a=void 0},g.flush=function(){return void 0===a?o:m(uv())},g};function Ov(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function kv(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}function Bv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t);else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ov(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ov(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Fv=kv((function e(t,n){var i=n.default,r=void 0===i?null:i,s=n.triggerUpdate,o=void 0===s||s,a=n.onChange,l=void 0===a?function(e,t){}:a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.defaultVal=r,this.triggerUpdate=o,this.onChange=l}));function Uv(e){var t=e.stateInit,n=void 0===t?function(){return{}}:t,i=e.props,r=void 0===i?{}:i,s=e.methods,o=void 0===s?{}:s,a=e.aliases,l=void 0===a?{}:a,c=e.init,u=void 0===c?function(){}:c,h=e.update,d=void 0===h?function(){}:h,p=Object.keys(r).map((function(e){return new Fv(e,r[e])}));return function e(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=!!(this instanceof e?this.constructor:void 0),a=s?i.shift():void 0,c=i[0],h=void 0===c?{}:c,A=Object.assign({},n instanceof Function?n(h):n,{initialised:!1}),f={};function m(e){return g(e,h),v(),m}var g=function(e,t){u.call(m,e,A,t),A.initialised=!0},v=Iv((function(){A.initialised&&(d.call(m,A,f),f={})}),1);return p.forEach((function(e){m[e.name]=function(e){var t=e.name,n=e.triggerUpdate,i=void 0!==n&&n,r=e.onChange,s=void 0===r?function(e,t){}:r,o=e.defaultVal,a=void 0===o?null:o;return function(e){var n=A[t];if(!arguments.length)return n;var r=void 0===e?a:e;return A[t]=r,s.call(m,r,A,n),!f.hasOwnProperty(t)&&(f[t]=n),i&&v(),m}}(e)})),Object.keys(o).forEach((function(e){m[e]=function(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=o[e]).call.apply(t,[m,A].concat(i))}})),Object.entries(l).forEach((function(e){var t=Bv(e,2),n=t[0],i=t[1];return m[n]=m[i]})),m.resetProps=function(){return p.forEach((function(e){m[e.name](e.defaultVal)})),m},m.resetProps(),A._rerender=v,s&&a&&m(a),m}}var zv=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-zv.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*zv.Bounce.In(2*e):.5*zv.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),qv=function(){return performance.now()},Vv=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=0,r=t;i<r.length;i++){var s=r[i];null===(e=s._group)||void 0===e||e.remove(s),s._group=this,this._tweens[s.getId()]=s,this._tweensAddedDuringUpdate[s.getId()]=s}},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++){var r=i[n];r._group=void 0,delete this._tweens[r.getId()],delete this._tweensAddedDuringUpdate[r.getId()]}},e.prototype.allStopped=function(){return this.getAll().every((function(e){return!e.isPlaying()}))},e.prototype.update=function(e,t){void 0===e&&(e=qv()),void 0===t&&(t=!0);var n=Object.keys(this._tweens);if(0!==n.length)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var r=this._tweens[n[i]],s=!t;r&&!1===r.update(e,s)&&!t&&this.remove(r)}n=Object.keys(this._tweensAddedDuringUpdate)}},e}(),Gv={Linear:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),s=Gv.Utils.Linear;return t<0?s(e[0],e[1],i):t>1?s(e[n],e[n-1],n-i):s(e[r],e[r+1>n?n:r+1],i-r)},Bezier:function(e,t){for(var n=0,i=e.length-1,r=Math.pow,s=Gv.Utils.Bernstein,o=0;o<=i;o++)n+=r(1-t,i-o)*r(t,o)*e[o]*s(i,o);return n},CatmullRom:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),s=Gv.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(r=Math.floor(i=n*(1+t))),s(e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n],i-r)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(s(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):s(e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2],i-r)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=Gv.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var i=t;i>1;i--)n*=i;return e[t]=n,n}}(),CatmullRom:function(e,t,n,i,r){var s=.5*(n-e),o=.5*(i-t),a=r*r;return(2*t-2*n+s+o)*(r*a)+(-3*t+3*n-2*s-o)*a+s*r+t}}},jv=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),Hv=new Vv,Wv=function(){function e(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=zv.Linear.None,this._interpolationFunction=Gv.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=jv.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,"object"===typeof t?(this._group=t,t.add(this)):!0===t&&(this._group=Hv,Hv.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=qv()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed)for(var n in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var r in this._valuesEnd)i[r]=this._valuesEnd[r];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,n,i,r){for(var s in n){var o=e[s],a=Array.isArray(o),l=a?"array":typeof o,c=!a&&Array.isArray(n[s]);if("undefined"!==l&&"function"!==l){if(c){if(0===(m=n[s]).length)continue;for(var u=[o],h=0,d=m.length;h<d;h+=1){var p=this._handleRelativeValue(o,m[h]);if(isNaN(p)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}u.push(p)}c&&(n[s]=u)}if("object"!==l&&!a||!o||c)("undefined"===typeof t[s]||r)&&(t[s]=o),a||(t[s]*=1),i[s]=c?n[s].slice().reverse():t[s]||0;else{t[s]=a?[]:{};var A=o;for(var f in A)t[s][f]=A[f];i[s]=a?[]:{};var m=n[s];if(!this._isDynamic){var g={};for(var f in m)g[f]=m[f];n[s]=m=g}this._setupProperties(A,t[s],m,i[s],r)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(e){return void 0===e&&(e=qv()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e),this},e.prototype.resume=function(e){return void 0===e&&(e=qv()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var e;return null===(e=this._group)||void 0===e||e.remove(this),this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=zv.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=Gv.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(t,n){var i,r,s=this;if(void 0===t&&(t=qv()),void 0===n&&(n=e.autoStartOnUpdate),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(!n)return!1;this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=t-this._startTime,a=this._duration+(null!==(i=this._repeatDelayTime)&&void 0!==i?i:this._delayTime),l=this._duration+this._repeat*a,c=function(){if(0===s._duration)return 1;if(o>l)return 1;var e=Math.trunc(o/a),t=o-e*a,n=Math.min(t/s._duration,1);return 0===n&&o===s._duration?1:n}(),u=this._easingFunction(c);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),this._onUpdateCallback&&this._onUpdateCallback(this._object,c),0===this._duration||o>=this._duration){if(this._repeat>0){var h=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);for(r in isFinite(this._repeat)&&(this._repeat-=h),this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*h,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var d=0,p=this._chainedTweens.length;d<p;d++)this._chainedTweens[d].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,i){for(var r in n)if(void 0!==t[r]){var s=t[r]||0,o=n[r],a=Array.isArray(e[r]),l=Array.isArray(o);!a&&l?e[r]=this._interpolationFunction(o,i):"object"===typeof o&&o?this._updateProperties(e[r],s,o,i):"number"===typeof(o=this._handleRelativeValue(s,o))&&(e[r]=s+(o-s)*i)}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e.autoStartOnUpdate=!1,e}(),Xv=(jv.nextId,Hv);Xv.getAll.bind(Xv),Xv.removeAll.bind(Xv),Xv.add.bind(Xv),Xv.remove.bind(Xv),Xv.update.bind(Xv);function Yv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=Qv(e,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c;if(i&&(s=function(e,t,n,i){const r=[];for(let s=0,o=t.length;s<o;s++){const n=Qv(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1);n===n.next&&(n.steiner=!0),r.push(oy(n))}r.sort(ny);for(let s=0;s<r.length;s++)n=iy(r[s],n);return n}(e,t,s,n)),e.length>80*n){a=1/0,l=1/0;let t=-1/0,i=-1/0;for(let s=n;s<r;s+=n){const n=e[s],r=e[s+1];n<a&&(a=n),r<l&&(l=r),n>t&&(t=n),r>i&&(i=r)}c=Math.max(t-a,i-l),c=0!==c?32767/c:0}return Zv(s,o,n,a,l,c,0),o}function Qv(e,t,n,i,r){let s;if(r===yy(e,t,n,i)>0)for(let o=t;o<n;o+=i)s=my(o/i|0,e[o],e[o+1],s);else for(let o=n-i;o>=t;o-=i)s=my(o/i|0,e[o],e[o+1],s);return s&&uy(s,s.next)&&(gy(s),s=s.next),s}function Kv(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!uy(i,i.next)&&0!==cy(i.prev,i,i.next))i=i.next;else{if(gy(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function Zv(e,t,n,i,r,s,o){if(!e)return;!o&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=sy(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n=1;do{let i,r=e;e=null;let s=null;for(t=0;r;){t++;let o=r,a=0;for(let e=0;e<n&&(a++,o=o.nextZ,o);e++);let l=n;for(;a>0||l>0&&o;)0!==a&&(0===l||!o||r.z<=o.z)?(i=r,r=r.nextZ,a--):(i=o,o=o.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=o}s.nextZ=null,n*=2}while(t>1)}(r)}(e,i,r,s);let a=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(s?$v(e,i,r,s):Jv(e))t.push(l.i,e.i,c.i),gy(e),e=c.next,a=c.next;else if((e=c)===a){o?1===o?Zv(e=ey(Kv(e),t),t,n,i,r,s,2):2===o&&ty(e,t,n,i,r,s):Zv(Kv(e),t,n,i,r,s,1);break}}}function Jv(e){const t=e.prev,n=e,i=e.next;if(cy(t,n,i)>=0)return!1;const r=t.x,s=n.x,o=i.x,a=t.y,l=n.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c;let A=i.next;for(;A!==t;){if(A.x>=u&&A.x<=d&&A.y>=h&&A.y<=p&&ay(r,a,s,l,o,c,A.x,A.y)&&cy(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function $v(e,t,n,i){const r=e.prev,s=e,o=e.next;if(cy(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,A=u<h?u<d?u:d:h<d?h:d,f=a>l?a>c?a:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,g=sy(p,A,t,n,i),v=sy(f,m,t,n,i);let y=e.prevZ,b=e.nextZ;for(;y&&y.z>=g&&b&&b.z<=v;){if(y.x>=p&&y.x<=f&&y.y>=A&&y.y<=m&&y!==r&&y!==o&&ay(a,u,l,h,c,d,y.x,y.y)&&cy(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=f&&b.y>=A&&b.y<=m&&b!==r&&b!==o&&ay(a,u,l,h,c,d,b.x,b.y)&&cy(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=g;){if(y.x>=p&&y.x<=f&&y.y>=A&&y.y<=m&&y!==r&&y!==o&&ay(a,u,l,h,c,d,y.x,y.y)&&cy(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=f&&b.y>=A&&b.y<=m&&b!==r&&b!==o&&ay(a,u,l,h,c,d,b.x,b.y)&&cy(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function ey(e,t){let n=e;do{const i=n.prev,r=n.next.next;!uy(i,r)&&hy(i,n,n.next,r)&&Ay(i,r)&&Ay(r,i)&&(t.push(i.i,n.i,r.i),gy(n),gy(n.next),n=e=r),n=n.next}while(n!==e);return Kv(n)}function ty(e,t,n,i,r,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&ly(o,e)){let a=fy(o,e);return o=Kv(o,o.next),a=Kv(a,a.next),Zv(o,t,n,i,r,s,0),void Zv(a,t,n,i,r,s,0)}e=e.next}o=o.next}while(o!==e)}function ny(e,t){return e.x-t.x}function iy(e,t){const n=function(e,t){let n=t;const i=e.x,r=e.y;let s,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const e=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>o&&(o=e,s=n.x<n.next.x?n:n.next,e===i))return s}n=n.next}while(n!==t);if(!s)return null;const a=s,l=s.x,c=s.y;let u=1/0;n=s;do{if(i>=n.x&&n.x>=l&&i!==n.x&&ay(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)){const t=Math.abs(r-n.y)/(i-n.x);Ay(n,e)&&(t<u||t===u&&(n.x>s.x||n.x===s.x&&ry(s,n)))&&(s=n,u=t)}n=n.next}while(n!==a);return s}(e,t);if(!n)return t;const i=fy(n,e);return Kv(i,i.next),Kv(n,n.next)}function ry(e,t){return cy(e.prev,e,t.prev)<0&&cy(t.next,e,e.next)<0}function sy(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function oy(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function ay(e,t,n,i,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function ly(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&hy(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Ay(e,t)&&Ay(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(cy(e.prev,e,t.prev)||cy(e,t.prev,t))||uy(e,t)&&cy(e.prev,e,e.next)>0&&cy(t.prev,t,t.next)>0)}function cy(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function uy(e,t){return e.x===t.x&&e.y===t.y}function hy(e,t,n,i){const r=py(cy(e,t,n)),s=py(cy(e,t,i)),o=py(cy(n,i,e)),a=py(cy(n,i,t));return r!==s&&o!==a||(!(0!==r||!dy(e,n,t))||(!(0!==s||!dy(e,i,t))||(!(0!==o||!dy(n,e,i))||!(0!==a||!dy(n,t,i)))))}function dy(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function py(e){return e>0?1:e<0?-1:0}function Ay(e,t){return cy(e.prev,e,e.next)<0?cy(e,t,e.next)>=0&&cy(e,e.prev,t)>=0:cy(e,t,e.prev)<0||cy(e,e.next,t)<0}function fy(e,t){const n=vy(e.i,e.x,e.y),i=vy(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function my(e,t,n,i){const r=vy(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function gy(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function vy(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yy(e,t,n,i){let r=0;for(let s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}function by(e){const t=[],n=[],i=e[0][0].length;let r=0,s=0;for(const o of e){for(const e of o)for(let n=0;n<i;n++)t.push(e[n]);s&&(r+=s,n.push(r)),s=o.length}return{vertices:t,holes:n,dimensions:i}}class xy{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=t[i],s=e+r,o=Math.abs(e)<Math.abs(r)?e-(s-r):r-(s-e);o&&(t[n++]=o),e=s}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,i,r=this._n,s=0;if(r>0){for(s=e[--r];r>0&&(t=s,n=e[--r],s=t+n,i=n-(s-t),!i););r>0&&(i<0&&e[r-1]<0||i>0&&e[r-1]>0)&&(n=2*i,t=s+n,n==t-s&&(s=t))}return s}}var _y=1e-6,wy=1e-12,Sy=Math.PI,Ty=Sy/2,My=Sy/4,Ey=2*Sy,Cy=180/Sy,Ry=Sy/180,Py=Math.abs,Ny=Math.atan,Dy=Math.atan2,Ly=Math.cos,Iy=Math.ceil,Oy=(Math.exp,Math.floor,Math.hypot),ky=(Math.log,Math.pow,Math.sin),By=Math.sign||function(e){return e>0?1:e<0?-1:0},Fy=Math.sqrt;Math.tan;function Uy(e){return e>1?Ty:e<-1?-Ty:Math.asin(e)}function zy(e){return(e=ky(e/2))*e}function qy(){}function Vy(e,t){e&&Yy.hasOwnProperty(e.type)&&Yy[e.type](e,t)}var Gy,jy,Hy,Wy,Xy={Feature:function(e,t){Vy(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Vy(n[i].geometry,t)}},Yy={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Qy(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Qy(n[i],t,0)},Polygon:function(e,t){Ky(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Ky(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Vy(n[i],t)}};function Qy(e,t,n){var i,r=-1,s=e.length-n;for(t.lineStart();++r<s;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function Ky(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Qy(e[n],t,1);t.polygonEnd()}function Zy(e,t){e&&Xy.hasOwnProperty(e.type)?Xy[e.type](e,t):Vy(e,t)}var Jy={sphere:qy,point:qy,lineStart:function(){Jy.point=eb,Jy.lineEnd=$y},lineEnd:qy,polygonStart:qy,polygonEnd:qy};function $y(){Jy.point=Jy.lineEnd=qy}function eb(e,t){jy=e*=Ry,Hy=ky(t*=Ry),Wy=Ly(t),Jy.point=tb}function tb(e,t){e*=Ry;var n=ky(t*=Ry),i=Ly(t),r=Py(e-jy),s=Ly(r),o=i*ky(r),a=Wy*n-Hy*i*s,l=Hy*n+Wy*i*s;Gy.add(Dy(Fy(o*o+a*a),l)),jy=e,Hy=n,Wy=i}var nb=[null,null],ib={type:"LineString",coordinates:nb};function rb(e,t){return nb[0]=e,nb[1]=t,function(e){return Gy=new xy,Zy(e,Jy),+Gy}(ib)}function sb(e,t){var n=e[0]*Ry,i=e[1]*Ry,r=t[0]*Ry,s=t[1]*Ry,o=Ly(i),a=ky(i),l=Ly(s),c=ky(s),u=o*Ly(n),h=o*ky(n),d=l*Ly(r),p=l*ky(r),A=2*Uy(Fy(zy(s-i)+o*l*zy(r-n))),f=ky(A),m=A?function(e){var t=ky(e*=A)/f,n=ky(A-e)/f,i=n*u+t*d,r=n*h+t*p,s=n*a+t*c;return[Dy(r,i)*Cy,Dy(s,Fy(i*i+r*r))*Cy]}:function(){return[n*Cy,i*Cy]};return m.distance=A,m}function ob(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function ab(e,t,n){return t=lb(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cb()?Reflect.construct(t,[],lb(e).constructor):t.apply(e,n))}function lb(e){return lb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lb(e)}function cb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cb=function(){return!!e})()}function ub(e,t){return ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ub(e,t)}function hb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||db(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function db(e,t){if(e){if("string"==typeof e)return ob(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ob(e,t):void 0}}var pb=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=[],n=null;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(i){if(n){var r=180*rb(i,n)/Math.PI;if(r>e)for(var s=sb(n,i),o=1/Math.ceil(r/e),a=o;a<1;)t.push(s(a)),a+=o}t.push(n=i)})),t},Ab="undefined"!==typeof window&&window.THREE?window.THREE:{BufferGeometry:nd,Float32BufferAttribute:Yh},fb=(new Ab.BufferGeometry).setAttribute?"setAttribute":"addAttribute",mb=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ab(this,t)).type="GeoJsonGeometry",n.parameters={geoJson:e,radius:i,resolution:r};var s=({Point:c,MultiPoint:function(e,t){var n={vertices:[],indices:[]};return e.map((function(e){return c(e,t)})).forEach((function(e){var t=hb(e,1)[0];gb(n,t)})),[n]},LineString:u,MultiLineString:function(e,t){var n={vertices:[],indices:[]};return e.map((function(e){return u(e,t)})).forEach((function(e){var t=hb(e,1)[0];gb(n,t)})),[n]},Polygon:h,MultiPolygon:function(e,t){var n={vertices:[],indices:[]},i={vertices:[],indices:[]};e.map((function(e){return h(e,t)})).forEach((function(e){var t=hb(e,2),r=t[0],s=t[1];gb(n,r),s&&gb(i,s)}));var r=[n];return i.vertices.length&&r.push(i),r}}[e.type]||function(){return[]})(e.coordinates,i),o=[],a=[],l=0;function c(e,t){return[{vertices:yb(e[1],e[0],t),indices:[]}]}function u(e,t){for(var n=by([pb(e,r).map((function(e){var n=hb(e,2),i=n[0];return yb(n[1],i,t)}))]).vertices,i=Math.round(n.length/3),s=[],o=1;o<i;o++)s.push(o-1,o);return[{vertices:n,indices:s}]}function h(e,t){for(var n=by(e.map((function(e){return pb(e,r).map((function(e){var n=hb(e,2),i=n[0];return yb(n[1],i,t)}))}))),i=n.vertices,s=n.holes,o=s[0]||1/0,a=i.slice(0,3*o),l=i.slice(3*o),c=new Set(s),u=Math.round(i.length/3),h=[],d=[],p=1;p<u;p++)c.has(p)||(p<o?h.push(p-1,p):d.push(p-1-o,p-o));var A=[{indices:h,vertices:a}];return s.length&&A.push({indices:d,vertices:l}),A}return s.forEach((function(e){var t=o.length;gb({indices:o,vertices:a},e),n.addGroup(t,o.length-t,l++)})),o.length&&n.setIndex(o),a.length&&n[fb]("position",new Ab.Float32BufferAttribute(a,3)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ub(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(Ab.BufferGeometry);function gb(e,t){var n=Math.round(e.vertices.length/3);vb(e.vertices,t.vertices),vb(e.indices,t.indices.map((function(e){return e+n})))}function vb(e,t){var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=db(e))||t){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.push(r)}}catch(s){i.e(s)}finally{i.f()}}function yb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=(90-e)*Math.PI/180,r=(90-t)*Math.PI/180;return[n*Math.sin(i)*Math.cos(r),n*Math.cos(i),n*Math.sin(i)*Math.sin(r)]}function bb(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(r);++i<r;)s[i]=e+i*n;return s}function xb(e,t,n){var i=bb(e,t-_y,n).concat(t);return function(e){return i.map((function(t){return[e,t]}))}}function _b(e,t,n){var i=bb(e,t-_y,n).concat(t);return function(e){return i.map((function(t){return[t,e]}))}}function wb(){return function(){var e,t,n,i,r,s,o,a,l,c,u,h,d=10,p=d,A=90,f=360,m=2.5;function g(){return{type:"MultiLineString",coordinates:v()}}function v(){return bb(Iy(i/A)*A,n,A).map(u).concat(bb(Iy(a/f)*f,o,f).map(h)).concat(bb(Iy(t/d)*d,e,d).filter((function(e){return Py(e%A)>_y})).map(l)).concat(bb(Iy(s/p)*p,r,p).filter((function(e){return Py(e%f)>_y})).map(c))}return g.lines=function(){return v().map((function(e){return{type:"LineString",coordinates:e}}))},g.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(h(o).slice(1),u(n).reverse().slice(1),h(a).reverse().slice(1))]}},g.extent=function(e){return arguments.length?g.extentMajor(e).extentMinor(e):g.extentMinor()},g.extentMajor=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],a=+e[0][1],o=+e[1][1],i>n&&(e=i,i=n,n=e),a>o&&(e=a,a=o,o=e),g.precision(m)):[[i,a],[n,o]]},g.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],s=+n[0][1],r=+n[1][1],t>e&&(n=t,t=e,e=n),s>r&&(n=s,s=r,r=n),g.precision(m)):[[t,s],[e,r]]},g.step=function(e){return arguments.length?g.stepMajor(e).stepMinor(e):g.stepMinor()},g.stepMajor=function(e){return arguments.length?(A=+e[0],f=+e[1],g):[A,f]},g.stepMinor=function(e){return arguments.length?(d=+e[0],p=+e[1],g):[d,p]},g.precision=function(d){return arguments.length?(m=+d,l=xb(s,r,90),c=_b(t,e,m),u=xb(a,o,90),h=_b(i,n,m),g):m},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()()}function Sb(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||!t.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!e.hasAttribute("position")||!e.hasAttribute("normal")||!e.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function i(e){if(e.normalized||e.isInterleavedBufferAttribute){const t=new Float32Array(e.count*e.itemSize);for(let n=0,i=0;n<e.count;n++)t[i++]=e.getX(n),t[i++]=e.getY(n),e.itemSize>2&&(t[i++]=e.getZ(n));return t}return e.array instanceof Float32Array?e.array:new Float32Array(e.array)}const r=e.index?e.toNonIndexed():e,s=t.generateTangents(i(r.attributes.position),i(r.attributes.normal),i(r.attributes.uv));if(n)for(let o=3;o<s.length;o+=4)s[o]*=-1;return r.setAttribute("tangent",new Hh(s,4)),e!==r&&e.copy(r),e}function Tb(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},o={},a=e[0].morphTargetsRelative,l=new nd;let c=0;for(let u=0;u<e.length;++u){const h=e[u];let d=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const e in h.attributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.attributes[e]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const e in h.morphAttributes){if(!r.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[e]&&(o[e]=[]),o[e].push(h.morphAttributes[e])}if(t){let e;if(n)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(c,e,u),c+=e}}if(n){let t=0;const n=[];for(let i=0;i<e.length;++i){const r=e[i].index;for(let e=0;e<r.count;++e)n.push(r.getX(e)+t);t+=e[i].attributes.position.count}l.setIndex(n)}for(const u in s){const e=Mb(s[u]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,e)}for(const u in o){const e=o[u][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let t=0;t<e;++t){const e=[];for(let i=0;i<o[u].length;++i)e.push(o[u][i][t]);const n=Mb(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(n)}}return l}function Mb(e){let t,n,i,r=-1,s=0;for(let c=0;c<e.length;++c){const o=e[c];if(void 0===t&&(t=o.array.constructor),t!==o.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=o.itemSize),n!==o.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=o.normalized),i!==o.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===r&&(r=o.gpuType),r!==o.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=o.count*n}const o=new t(s),a=new Hh(o,n,i);let l=0;for(let c=0;c<e.length;++c){const t=e[c];if(t.isInterleavedBufferAttribute){const e=l/n;for(let i=0,r=t.count;i<r;i++)for(let s=0;s<n;s++){const n=t.getComponent(i,s);a.setComponent(i+e,s,n)}}else o.set(t.array,l);l+=t.count*n}return void 0!==r&&(a.gpuType=r),a}function Eb(e){return e.isInstancedInterleavedBufferAttribute||e.isInterleavedBufferAttribute?Rb(e):e.isInstancedBufferAttribute?(new Bf).copy(e):(new Hh).copy(e)}function Cb(e){let t,n=0,i=0;for(let c=0,u=e.length;c<u;++c){const r=e[c];if(void 0===t&&(t=r.array.constructor),t!==r.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=r.array.length,i+=r.itemSize}const r=new If(new t(n),i);let s=0;const o=[],a=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let c=0,u=e.length;c<u;c++){const t=e[c],n=t.itemSize,i=t.count,u=new kf(r,n,s,t.normalized);o.push(u),s+=n;for(let e=0;e<i;e++)for(let i=0;i<n;i++)u[l[i]](e,t[a[i]](e))}return o}function Rb(e){const t=e.data.array.constructor,n=e.count,i=e.itemSize,r=e.normalized,s=new t(n*i);let o;o=e.isInstancedInterleavedBufferAttribute?new Bf(s,i,r,e.meshPerAttribute):new Hh(s,i,r);for(let a=0;a<n;a++)o.setX(a,e.getX(a)),i>=2&&o.setY(a,e.getY(a)),i>=3&&o.setZ(a,e.getZ(a)),i>=4&&o.setW(a,e.getW(a));return o}function Pb(e){const t=e.attributes,n=e.morphTargets,i=new Map;for(const r in t){const e=t[r];e.isInterleavedBufferAttribute&&(i.has(e)||i.set(e,Rb(e)),t[r]=i.get(e))}for(const r in n){const e=n[r];e.isInterleavedBufferAttribute&&(i.has(e)||i.set(e,Rb(e)),n[r]=i.get(e))}}function Nb(e){let t=0;for(const i in e.attributes){const n=e.getAttribute(i);t+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}const n=e.getIndex();return t+=n?n.count*n.itemSize*n.array.BYTES_PER_ELEMENT:0,t}function Db(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);const n={},i=e.getIndex(),r=e.getAttribute("position"),s=i?i.count:r.count;let o=0;const a=Object.keys(e.attributes),l={},c={},u=[],h=["getX","getY","getZ","getW"],d=["setX","setY","setZ","setW"];for(let v=0,y=a.length;v<y;v++){const t=a[v],n=e.attributes[t];l[t]=new n.constructor(new n.array.constructor(n.count*n.itemSize),n.itemSize,n.normalized);const i=e.morphAttributes[t];i&&(c[t]||(c[t]=[]),i.forEach(((e,n)=>{const i=new e.array.constructor(e.count*e.itemSize);c[t][n]=new e.constructor(i,e.itemSize,e.normalized)})))}const p=.5*t,A=Math.log10(1/t),f=Math.pow(10,A),m=p*f;for(let v=0;v<s;v++){const t=i?i.getX(v):v;let r="";for(let n=0,i=a.length;n<i;n++){const i=a[n],s=e.getAttribute(i),o=s.itemSize;for(let e=0;e<o;e++)r+="".concat(~~(s[h[e]](t)*f+m),",")}if(r in n)u.push(n[r]);else{for(let n=0,i=a.length;n<i;n++){const i=a[n],r=e.getAttribute(i),s=e.morphAttributes[i],u=r.itemSize,p=l[i],A=c[i];for(let e=0;e<u;e++){const n=h[e],i=d[e];if(p[i](o,r[n](t)),s)for(let e=0,r=s.length;e<r;e++)A[e][i](o,s[e][n](t))}}n[r]=o,u.push(o),o++}}const g=e.clone();for(const v in e.attributes){const e=l[v];if(g.setAttribute(v,new e.constructor(e.array.slice(0,o*e.itemSize),e.itemSize,e.normalized)),v in c)for(let t=0;t<c[v].length;t++){const e=c[v][t];g.morphAttributes[v][t]=new e.constructor(e.array.slice(0,o*e.itemSize),e.itemSize,e.normalized)}}return g.setIndex(u),g}function Lb(e,t){if(t===lc)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===uc||t===cc){let n=e.getIndex();if(null===n){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const i=n.count-2,r=[];if(t===uc)for(let e=1;e<=i;e++)r.push(n.getX(0)),r.push(n.getX(e)),r.push(n.getX(e+1));else for(let e=0;e<i;e++)e%2===0?(r.push(n.getX(e)),r.push(n.getX(e+1)),r.push(n.getX(e+2))):(r.push(n.getX(e+2)),r.push(n.getX(e+1)),r.push(n.getX(e)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function Ib(e){const t=new yu,n=new yu,i=new yu,r=new yu,s=new yu,o=new yu,a=new yu,l=new yu,c=new yu;function u(e,u,h,d,p,A,f,m){t.fromBufferAttribute(u,p),n.fromBufferAttribute(u,A),i.fromBufferAttribute(u,f);const g=e.morphTargetInfluences;if(h&&g){a.set(0,0,0),l.set(0,0,0),c.set(0,0,0);for(let e=0,u=h.length;e<u;e++){const u=g[e],m=h[e];0!==u&&(r.fromBufferAttribute(m,p),s.fromBufferAttribute(m,A),o.fromBufferAttribute(m,f),d?(a.addScaledVector(r,u),l.addScaledVector(s,u),c.addScaledVector(o,u)):(a.addScaledVector(r.sub(t),u),l.addScaledVector(s.sub(n),u),c.addScaledVector(o.sub(i),u)))}t.add(a),n.add(l),i.add(c)}e.isSkinnedMesh&&(e.applyBoneTransform(p,t),e.applyBoneTransform(A,n),e.applyBoneTransform(f,i)),m[3*p+0]=t.x,m[3*p+1]=t.y,m[3*p+2]=t.z,m[3*A+0]=n.x,m[3*A+1]=n.y,m[3*A+2]=n.z,m[3*f+0]=i.x,m[3*f+1]=i.y,m[3*f+2]=i.z}const h=e.geometry,d=e.material;let p,A,f;const m=h.index,g=h.attributes.position,v=h.morphAttributes.position,y=h.morphTargetsRelative,b=h.attributes.normal,x=h.morphAttributes.position,_=h.groups,w=h.drawRange;let S,T,M,E,C,R,P;const N=new Float32Array(g.count*g.itemSize),D=new Float32Array(b.count*b.itemSize);if(null!==m)if(Array.isArray(d))for(S=0,M=_.length;S<M;S++)for(C=_[S],R=Math.max(C.start,w.start),P=Math.min(C.start+C.count,w.start+w.count),T=R,E=P;T<E;T+=3)p=m.getX(T),A=m.getX(T+1),f=m.getX(T+2),u(e,g,v,y,p,A,f,N),u(e,b,x,y,p,A,f,D);else for(R=Math.max(0,w.start),P=Math.min(m.count,w.start+w.count),S=R,M=P;S<M;S+=3)p=m.getX(S),A=m.getX(S+1),f=m.getX(S+2),u(e,g,v,y,p,A,f,N),u(e,b,x,y,p,A,f,D);else if(Array.isArray(d))for(S=0,M=_.length;S<M;S++)for(C=_[S],R=Math.max(C.start,w.start),P=Math.min(C.start+C.count,w.start+w.count),T=R,E=P;T<E;T+=3)p=T,A=T+1,f=T+2,u(e,g,v,y,p,A,f,N),u(e,b,x,y,p,A,f,D);else for(R=Math.max(0,w.start),P=Math.min(g.count,w.start+w.count),S=R,M=P;S<M;S+=3)p=S,A=S+1,f=S+2,u(e,g,v,y,p,A,f,N),u(e,b,x,y,p,A,f,D);return{positionAttribute:g,normalAttribute:b,morphedPositionAttribute:new Yh(N,3),morphedNormalAttribute:new Yh(D,3)}}function Ob(e){if(0===e.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),e;let t=e.groups;if(t=t.sort(((e,t)=>e.materialIndex!==t.materialIndex?e.materialIndex-t.materialIndex:e.start-t.start)),null===e.getIndex()){const t=e.getAttribute("position"),n=[];for(let e=0;e<t.count;e+=3)n.push(e,e+1,e+2);e.setIndex(n)}const n=e.getIndex(),i=[];for(let o=0;o<t.length;o++){const e=t[o],r=e.start,s=r+e.count;for(let t=r;t<s;t++)i.push(n.getX(t))}e.dispose(),e.setIndex(i);let r=0;for(let o=0;o<t.length;o++){const e=t[o];e.start=r,r+=e.count}let s=t[0];e.groups=[s];for(let o=1;o<t.length;o++){const n=t[o];s.materialIndex===n.materialIndex?s.count+=n.count:(s=n,e.groups.push(s))}return e}function kb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/3;const n=Math.cos(t),i=100*(1+1e-10),r=[new yu,new yu,new yu],s=new yu,o=new yu,a=new yu,l=new yu;function c(e){const t=~~(e.x*i),n=~~(e.y*i),r=~~(e.z*i);return"".concat(t,",").concat(n,",").concat(r)}const u=e.index?e.toNonIndexed():e,h=u.attributes.position,d={};for(let f=0,m=h.count/3;f<m;f++){const e=3*f,t=r[0].fromBufferAttribute(h,e+0),n=r[1].fromBufferAttribute(h,e+1),i=r[2].fromBufferAttribute(h,e+2);s.subVectors(i,n),o.subVectors(t,n);const a=(new yu).crossVectors(s,o).normalize();for(let s=0;s<3;s++){const e=c(r[s]);e in d||(d[e]=[]),d[e].push(a)}}const p=new Float32Array(3*h.count),A=new Hh(p,3,!1);for(let f=0,m=h.count/3;f<m;f++){const e=3*f,t=r[0].fromBufferAttribute(h,e+0),i=r[1].fromBufferAttribute(h,e+1),u=r[2].fromBufferAttribute(h,e+2);s.subVectors(u,i),o.subVectors(t,i),a.crossVectors(s,o).normalize();for(let s=0;s<3;s++){const t=d[c(r[s])];l.set(0,0,0);for(let e=0,i=t.length;e<i;e++){const i=t[e];a.dot(i)>n&&l.add(i)}l.normalize(),A.setXYZ(e+s,l.x,l.y,l.z)}}return u.setAttribute("normal",A),u}var Bb=function(e){return"function"===typeof e?e:"string"===typeof e?function(t){return t[e]}:function(t){return e}};function Fb(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ub(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function zb(){}var qb=.7,Vb=1/qb,Gb="\\s*([+-]?\\d+)\\s*",jb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wb=/^#([0-9a-f]{3,8})$/,Xb=new RegExp("^rgb\\(".concat(Gb,",").concat(Gb,",").concat(Gb,"\\)$")),Yb=new RegExp("^rgb\\(".concat(Hb,",").concat(Hb,",").concat(Hb,"\\)$")),Qb=new RegExp("^rgba\\(".concat(Gb,",").concat(Gb,",").concat(Gb,",").concat(jb,"\\)$")),Kb=new RegExp("^rgba\\(".concat(Hb,",").concat(Hb,",").concat(Hb,",").concat(jb,"\\)$")),Zb=new RegExp("^hsl\\(".concat(jb,",").concat(Hb,",").concat(Hb,"\\)$")),Jb=new RegExp("^hsla\\(".concat(jb,",").concat(Hb,",").concat(Hb,",").concat(jb,"\\)$")),$b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ex(){return this.rgb().formatHex()}function tx(){return this.rgb().formatRgb()}function nx(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wb.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ix(t):3===n?new ox(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?rx(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?rx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Xb.exec(e))?new ox(t[1],t[2],t[3],1):(t=Yb.exec(e))?new ox(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Qb.exec(e))?rx(t[1],t[2],t[3],t[4]):(t=Kb.exec(e))?rx(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Zb.exec(e))?dx(t[1],t[2]/100,t[3]/100,1):(t=Jb.exec(e))?dx(t[1],t[2]/100,t[3]/100,t[4]):$b.hasOwnProperty(e)?ix($b[e]):"transparent"===e?new ox(NaN,NaN,NaN,0):null}function ix(e){return new ox(e>>16&255,e>>8&255,255&e,1)}function rx(e,t,n,i){return i<=0&&(e=t=n=NaN),new ox(e,t,n,i)}function sx(e,t,n,i){return 1===arguments.length?function(e){return e instanceof zb||(e=nx(e)),e?new ox((e=e.rgb()).r,e.g,e.b,e.opacity):new ox}(e):new ox(e,t,n,null==i?1:i)}function ox(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function ax(){return"#".concat(hx(this.r)).concat(hx(this.g)).concat(hx(this.b))}function lx(){const e=cx(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(ux(this.r),", ").concat(ux(this.g),", ").concat(ux(this.b)).concat(1===e?")":", ".concat(e,")"))}function cx(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ux(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hx(e){return((e=ux(e))<16?"0":"")+e.toString(16)}function dx(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ax(e,t,n,i)}function px(e){if(e instanceof Ax)return new Ax(e.h,e.s,e.l,e.opacity);if(e instanceof zb||(e=nx(e)),!e)return new Ax;if(e instanceof Ax)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=t===s?(n-i)/a+6*(n<i):n===s?(i-t)/a+2:(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ax(o,a,l,e.opacity)}function Ax(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function fx(e){return(e=(e||0)%360)<0?e+360:e}function mx(e){return Math.max(0,Math.min(1,e||0))}function gx(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function vx(e){return vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vx(e)}Fb(zb,nx,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ex,formatHex:ex,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return px(this).formatHsl()},formatRgb:tx,toString:tx}),Fb(ox,sx,Ub(zb,{brighter(e){return e=null==e?Vb:Math.pow(Vb,e),new ox(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?qb:Math.pow(qb,e),new ox(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ox(ux(this.r),ux(this.g),ux(this.b),cx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ax,formatHex:ax,formatHex8:function(){return"#".concat(hx(this.r)).concat(hx(this.g)).concat(hx(this.b)).concat(hx(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:lx,toString:lx})),Fb(Ax,(function(e,t,n,i){return 1===arguments.length?px(e):new Ax(e,t,n,null==i?1:i)}),Ub(zb,{brighter(e){return e=null==e?Vb:Math.pow(Vb,e),new Ax(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?qb:Math.pow(qb,e),new Ax(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ox(gx(e>=240?e-240:e+120,r,i),gx(e,r,i),gx(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new Ax(fx(this.h),mx(this.s),mx(this.l),cx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cx(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(fx(this.h),", ").concat(100*mx(this.s),"%, ").concat(100*mx(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var yx=/^\s+/,bx=/\s+$/;function xx(e,t){if(t=t||{},(e=e||"")instanceof xx)return e;if(!(this instanceof xx))return new xx(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,i=null,r=null,s=null,o=!1,a=!1;"string"==typeof e&&(e=function(e){e=e.replace(yx,"").replace(bx,"").toLowerCase();var t,n=!1;if(Fx[e])e=Fx[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=Yx.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=Yx.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=Yx.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=Yx.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=Yx.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=Yx.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=Yx.hex8.exec(e))return{r:Gx(t[1]),g:Gx(t[2]),b:Gx(t[3]),a:Xx(t[4]),format:n?"name":"hex8"};if(t=Yx.hex6.exec(e))return{r:Gx(t[1]),g:Gx(t[2]),b:Gx(t[3]),format:n?"name":"hex"};if(t=Yx.hex4.exec(e))return{r:Gx(t[1]+""+t[1]),g:Gx(t[2]+""+t[2]),b:Gx(t[3]+""+t[3]),a:Xx(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=Yx.hex3.exec(e))return{r:Gx(t[1]+""+t[1]),g:Gx(t[2]+""+t[2]),b:Gx(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==vx(e)&&(Qx(e.r)&&Qx(e.g)&&Qx(e.b)?(l=e.r,c=e.g,u=e.b,t={r:255*qx(l,255),g:255*qx(c,255),b:255*qx(u,255)},o=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):Qx(e.h)&&Qx(e.s)&&Qx(e.v)?(i=Hx(e.s),r=Hx(e.v),t=function(e,t,n){e=6*qx(e,360),t=qx(t,100),n=qx(n,100);var i=Math.floor(e),r=e-i,s=n*(1-t),o=n*(1-r*t),a=n*(1-(1-r)*t),l=i%6,c=[n,o,s,s,a,n][l],u=[a,n,n,o,s,s][l],h=[s,s,a,n,n,o][l];return{r:255*c,g:255*u,b:255*h}}(e.h,i,r),o=!0,a="hsv"):Qx(e.h)&&Qx(e.s)&&Qx(e.l)&&(i=Hx(e.s),s=Hx(e.l),t=function(e,t,n){var i,r,s;function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=qx(e,360),t=qx(t,100),n=qx(n,100),0===t)i=r=s=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;i=o(l,a,e+1/3),r=o(l,a,e),s=o(l,a,e-1/3)}return{r:255*i,g:255*r,b:255*s}}(e.h,i,s),o=!0,a="hsl"),e.hasOwnProperty("a")&&(n=e.a));var l,c,u;return n=zx(n),{ok:o,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function _x(e,t,n){e=qx(e,255),t=qx(t,255),n=qx(n,255);var i,r,s=Math.max(e,t,n),o=Math.min(e,t,n),a=(s+o)/2;if(s==o)i=r=0;else{var l=s-o;switch(r=a>.5?l/(2-s-o):l/(s+o),s){case e:i=(t-n)/l+(t<n?6:0);break;case t:i=(n-e)/l+2;break;case n:i=(e-t)/l+4}i/=6}return{h:i,s:r,l:a}}function wx(e,t,n){e=qx(e,255),t=qx(t,255),n=qx(n,255);var i,r,s=Math.max(e,t,n),o=Math.min(e,t,n),a=s,l=s-o;if(r=0===s?0:l/s,s==o)i=0;else{switch(s){case e:i=(t-n)/l+(t<n?6:0);break;case t:i=(n-e)/l+2;break;case n:i=(e-t)/l+4}i/=6}return{h:i,s:r,v:a}}function Sx(e,t,n,i){var r=[jx(Math.round(e).toString(16)),jx(Math.round(t).toString(16)),jx(Math.round(n).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function Tx(e,t,n,i){return[jx(Wx(i)),jx(Math.round(e).toString(16)),jx(Math.round(t).toString(16)),jx(Math.round(n).toString(16))].join("")}function Mx(e,t){t=0===t?0:t||10;var n=xx(e).toHsl();return n.s-=t/100,n.s=Vx(n.s),xx(n)}function Ex(e,t){t=0===t?0:t||10;var n=xx(e).toHsl();return n.s+=t/100,n.s=Vx(n.s),xx(n)}function Cx(e){return xx(e).desaturate(100)}function Rx(e,t){t=0===t?0:t||10;var n=xx(e).toHsl();return n.l+=t/100,n.l=Vx(n.l),xx(n)}function Px(e,t){t=0===t?0:t||10;var n=xx(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),xx(n)}function Nx(e,t){t=0===t?0:t||10;var n=xx(e).toHsl();return n.l-=t/100,n.l=Vx(n.l),xx(n)}function Dx(e,t){var n=xx(e).toHsl(),i=(n.h+t)%360;return n.h=i<0?360+i:i,xx(n)}function Lx(e){var t=xx(e).toHsl();return t.h=(t.h+180)%360,xx(t)}function Ix(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=xx(e).toHsl(),i=[xx(e)],r=360/t,s=1;s<t;s++)i.push(xx({h:(n.h+s*r)%360,s:n.s,l:n.l}));return i}function Ox(e){var t=xx(e).toHsl(),n=t.h;return[xx(e),xx({h:(n+72)%360,s:t.s,l:t.l}),xx({h:(n+216)%360,s:t.s,l:t.l})]}function kx(e,t,n){t=t||6,n=n||30;var i=xx(e).toHsl(),r=360/n,s=[xx(e)];for(i.h=(i.h-(r*t>>1)+720)%360;--t;)i.h=(i.h+r)%360,s.push(xx(i));return s}function Bx(e,t){t=t||6;for(var n=xx(e).toHsv(),i=n.h,r=n.s,s=n.v,o=[],a=1/t;t--;)o.push(xx({h:i,s:r,v:s})),s=(s+a)%1;return o}xx.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,i=this.toRgb();return e=i.r/255,t=i.g/255,n=i.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=zx(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=wx(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=wx(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=_x(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=_x(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return Sx(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,i,r){var s=[jx(Math.round(e).toString(16)),jx(Math.round(t).toString(16)),jx(Math.round(n).toString(16)),jx(Wx(i))];if(r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0);return s.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*qx(this._r,255))+"%",g:Math.round(100*qx(this._g,255))+"%",b:Math.round(100*qx(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*qx(this._r,255))+"%, "+Math.round(100*qx(this._g,255))+"%, "+Math.round(100*qx(this._b,255))+"%)":"rgba("+Math.round(100*qx(this._r,255))+"%, "+Math.round(100*qx(this._g,255))+"%, "+Math.round(100*qx(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(Ux[Sx(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+Tx(this._r,this._g,this._b,this._a),n=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var r=xx(e);n="#"+Tx(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return xx(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(Rx,arguments)},brighten:function(){return this._applyModification(Px,arguments)},darken:function(){return this._applyModification(Nx,arguments)},desaturate:function(){return this._applyModification(Mx,arguments)},saturate:function(){return this._applyModification(Ex,arguments)},greyscale:function(){return this._applyModification(Cx,arguments)},spin:function(){return this._applyModification(Dx,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(kx,arguments)},complement:function(){return this._applyCombination(Lx,arguments)},monochromatic:function(){return this._applyCombination(Bx,arguments)},splitcomplement:function(){return this._applyCombination(Ox,arguments)},triad:function(){return this._applyCombination(Ix,[3])},tetrad:function(){return this._applyCombination(Ix,[4])}},xx.fromRatio=function(e,t){if("object"==vx(e)){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:Hx(e[i]));e=n}return xx(e,t)},xx.equals=function(e,t){return!(!e||!t)&&xx(e).toRgbString()==xx(t).toRgbString()},xx.random=function(){return xx.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},xx.mix=function(e,t,n){n=0===n?0:n||50;var i=xx(e).toRgb(),r=xx(t).toRgb(),s=n/100;return xx({r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a})},xx.readability=function(e,t){var n=xx(e),i=xx(t);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)},xx.isReadable=function(e,t,n){var i,r,s=xx.readability(e,t);switch(r=!1,i=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n),i.level+i.size){case"AAsmall":case"AAAlarge":r=s>=4.5;break;case"AAlarge":r=s>=3;break;case"AAAsmall":r=s>=7}return r},xx.mostReadable=function(e,t,n){var i,r,s,o,a=null,l=0;r=(n=n||{}).includeFallbackColors,s=n.level,o=n.size;for(var c=0;c<t.length;c++)(i=xx.readability(e,t[c]))>l&&(l=i,a=xx(t[c]));return xx.isReadable(e,a,{level:s,size:o})||!r?a:(n.includeFallbackColors=!1,xx.mostReadable(e,["#fff","#000"],n))};var Fx=xx.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Ux=xx.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(Fx);function zx(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function qx(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"===typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function Vx(e){return Math.min(1,Math.max(0,e))}function Gx(e){return parseInt(e,16)}function jx(e){return 1==e.length?"0"+e:""+e}function Hx(e){return e<=1&&(e=100*e+"%"),e}function Wx(e){return Math.round(255*parseFloat(e)).toString(16)}function Xx(e){return Gx(e)/255}var Yx=function(){var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",n="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Qx(e){return!!Yx.CSS_UNIT.exec(e)}function Kx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Zx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t);else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||e_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jx(e){return function(e){if(Array.isArray(e))return Kx(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||e_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $x(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function e_(e,t){if(e){if("string"==typeof e)return Kx(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kx(e,t):void 0}}var t_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=(t instanceof Array?t.length?t:[void 0]:[t]).map((function(e){return{keyAccessor:e,isProp:!(e instanceof Function)}})),s=e.reduce((function(e,t){var i=e,s=t;return r.forEach((function(e,t){var o,a=e.keyAccessor;if(e.isProp){var l=s,c=l[a],u=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(l,[a].map($x));o=c,s=u}else o=a(s,t);t+1<r.length?(i.hasOwnProperty(o)||(i[o]={}),i=i[o]):n?(i.hasOwnProperty(o)||(i[o]=[]),i[o].push(s)):i[o]=s})),e}),{});n instanceof Function&&function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;i===r.length?Object.keys(t).forEach((function(e){return t[e]=n(t[e])})):Object.values(t).forEach((function(t){return e(t,i+1)}))}(s);var o=s;return i&&(o=[],function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.length===r.length?o.push({keys:n,vals:t}):Object.entries(t).forEach((function(t){var i=Zx(t,2),r=i[0],s=i[1];return e(s,[].concat(Jx(n),[r]))}))}(s),t instanceof Array&&0===t.length&&1===o.length&&(o[0].keys=[])),o};function n_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function i_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r_(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s_(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||a_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o_(e){return function(e){if(Array.isArray(e))return l_(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a_(e,t){if(e){if("string"===typeof e)return l_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l_(e,t):void 0}}function l_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var c_=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function u_(e,t,n){var i=n.objBindAttr,r=void 0===i?"__obj":i,s=n.dataBindAttr,o=void 0===s?"__data":s,a=n.idAccessor,l=n.purge,c=void 0!==l&&l,u=function(e){return e.hasOwnProperty(o)},h=t.filter((function(e){return!u(e)})),d=t.filter(u).map((function(e){return e[o]})),p=c?{enter:e,exit:d,update:[]}:function(e,t,n){var i={enter:[],update:[],exit:[]};if(n){var r=t_(e,n,!1),s=t_(t,n,!1),o=Object.assign({},r,s);Object.entries(o).forEach((function(e){var t=s_(e,2),n=t[0],o=t[1],a=r.hasOwnProperty(n)?s.hasOwnProperty(n)?"update":"exit":"enter";i[a].push("update"===a?[r[n],s[n]]:o)}))}else{var a=new Set(e),l=new Set(t);new Set([].concat(o_(a),o_(l))).forEach((function(e){var t=a.has(e)?l.has(e)?"update":"exit":"enter";i[t].push("update"===t?[e,e]:e)}))}return i}(d,e,a);return p.update=p.update.map((function(e){var t=s_(e,2),n=t[0],i=t[1];return n!==i&&(i[r]=n[r],i[r][o]=i),i})),p.exit=p.exit.concat(h.map((function(e){return i_({},r,e)}))),p}function h_(e,t,n,i,r){var s=r.createObj,o=void 0===s?function(e){return{}}:s,a=r.updateObj,l=void 0===a?function(e,t){}:a,c=r.exitObj,u=void 0===c?function(e){}:c,h=r.objBindAttr,d=void 0===h?"__obj":h,p=r.dataBindAttr,A=void 0===p?"__data":p,f=r_(r,c_),m=u_(e,t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?n_(Object(n),!0).forEach((function(t){i_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({objBindAttr:d,dataBindAttr:A},f)),g=m.enter,v=m.update;m.exit.forEach((function(e){var t=e[d];delete e[d],u(t),i(t)}));var y=function(e){var t=[];return e.forEach((function(e){var n=o(e);n&&(n[A]=e,e[d]=n,t.push(n))})),t}(g);!function(e){e.forEach((function(e){var t=e[d];t&&(t[A]=e,l(t,e))}))}([].concat(o_(g),o_(v))),y.forEach(n)}var d_=n(724);const p_=Math.sqrt(50),A_=Math.sqrt(10),f_=Math.sqrt(2);function m_(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=p_?10:s>=A_?5:s>=f_?2:1;let a,l,c;return r<0?(c=Math.pow(10,-r)/o,a=Math.round(e*c),l=Math.round(t*c),a/c<e&&++a,l/c>t&&--l,c=-c):(c=Math.pow(10,r)*o,a=Math.round(e/c),l=Math.round(t/c),a*c<e&&++a,l*c>t&&--l),l<a&&.5<=n&&n<2?m_(e,t,2*n):[a,l,c]}function g_(e,t,n){return m_(e=+e,t=+t,n=+n)[2]}function v_(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function y_(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function b_(e){let t,n,i;function r(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<s){if(0!==t(i,i))return s;do{const t=r+s>>>1;n(e[t],i)<0?r=t+1:s=t}while(r<s)}return r}return 2!==e.length?(t=v_,n=(t,n)=>v_(e(t),n),i=(t,n)=>e(t)-n):(t=e===v_||e===y_?e:x_,n=e,i=e),{left:r,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=r(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return s>n&&i(e[s-1],t)>-i(e[s],t)?s-1:s},right:function(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<s){if(0!==t(i,i))return s;do{const t=r+s>>>1;n(e[t],i)<=0?r=t+1:s=t}while(r<s)}return r}}}function x_(){return 0}const __=b_(v_),w_=__.right,S_=(__.left,b_((function(e){return null===e?NaN:+e})).center,w_);function T_(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}const M_=e=>()=>e;function E_(e,t){return function(n){return e+n*t}}function C_(e){return 1===(e=+e)?R_:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):M_(isNaN(t)?n:t)}}function R_(e,t){var n=t-e;return n?E_(e,n):M_(isNaN(e)?t:e)}const P_=function e(t){var n=C_(t);function i(e,t){var i=n((e=sx(e)).r,(t=sx(t)).r),r=n(e.g,t.g),s=n(e.b,t.b),o=R_(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=s(t),e.opacity=o(t),e+""}}return i.gamma=e,i}(1);function N_(e){return function(t){var n,i,r=t.length,s=new Array(r),o=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=sx(t[n]),s[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return s=e(s),o=e(o),a=e(a),i.opacity=1,function(e){return i.r=s(e),i.g=o(e),i.b=a(e),i+""}}}N_((function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return T_((n-i/t)*t,o,r,s,a)}})),N_((function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return T_((n-i/t)*t,r,s,o,a)}}));function D_(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(s){for(n=0;n<i;++n)r[n]=e[n]*(1-s)+t[n]*s;return r}}function L_(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function I_(e,t){return(L_(t)?D_:O_)(e,t)}function O_(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=V_(e[n],t[n]);for(;n<i;++n)o[n]=t[n];return function(e){for(n=0;n<r;++n)o[n]=s[n](e);return o}}function k_(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function B_(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function F_(e,t){var n,i={},r={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?i[n]=V_(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}var U_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,z_=new RegExp(U_.source,"g");function q_(e,t){var n,i,r,s=U_.lastIndex=z_.lastIndex=0,o=-1,a=[],l=[];for(e+="",t+="";(n=U_.exec(e))&&(i=z_.exec(t));)(r=i.index)>s&&(r=t.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:B_(n,i)})),s=z_.lastIndex;return s<t.length&&(r=t.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)a[(n=l[i]).i]=n.x(e);return a.join("")})}function V_(e,t){var n,i=typeof t;return null==t||"boolean"===i?M_(t):("number"===i?B_:"string"===i?(n=nx(t))?(t=n,P_):q_:t instanceof nx?P_:t instanceof Date?k_:L_(t)?D_:Array.isArray(t)?O_:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?F_:B_)(e,t)}function G_(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function j_(e){return+e}var H_=[0,1];function W_(e){return e}function X_(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Y_(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=X_(r,i),s=n(o,s)):(i=X_(i,r),s=n(s,o)),function(e){return s(i(e))}}function Q_(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=X_(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(t){var n=S_(e,t,1,i)-1;return s[n](r[n](t))}}function K_(){var e,t,n,i,r,s,o=H_,a=H_,l=V_,c=W_;function u(){var e=Math.min(o.length,a.length);return c!==W_&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),i=e>2?Q_:Y_,r=s=null,h}function h(t){return null==t||isNaN(t=+t)?n:(r||(r=i(o.map(e),a,l)))(e(c(t)))}return h.invert=function(n){return c(t((s||(s=i(a,o.map(e),B_)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,j_),u()):o.slice()},h.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},h.rangeRound=function(e){return a=Array.from(e),l=G_,u()},h.clamp=function(e){return arguments.length?(c=!!e||W_,u()):c!==W_},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,i){return e=n,t=i,u()}}function Z_(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var J_,$_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ew(e){if(!(t=$_.exec(e)))throw new Error("invalid format: "+e);var t;return new tw({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function tw(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function nw(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function iw(e){return(e=nw(Math.abs(e)))?e[1]:NaN}function rw(e,t){var n=nw(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}ew.prototype=tw.prototype,tw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const sw={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>rw(100*e,t),r:rw,s:function(e,t){var n=nw(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(J_=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+nw(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ow(e){return e}var aw,lw,cw,uw=Array.prototype.map,hw=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function dw(e){var t,n,i=void 0===e.grouping||void 0===e.thousands?ow:(t=uw.call(e.grouping,Number),n=e.thousands+"",function(e,i){for(var r=e.length,s=[],o=0,a=t[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(e.substring(r-=a,r+a)),!((l+=a+1)>i));)a=t[o=(o+1)%t.length];return s.reverse().join(n)}),r=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?ow:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(uw.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=ew(e)).fill,n=e.align,h=e.sign,d=e.symbol,p=e.zero,A=e.width,f=e.comma,m=e.precision,g=e.trim,v=e.type;"n"===v?(f=!0,v="g"):sw[v]||(void 0===m&&(m=12),g=!0,v="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===d?s:/[%p]/.test(v)?l:"",x=sw[v],_=/[defgprs%]/.test(v);function w(e){var r,s,l,d=y,w=b;if("c"===v)w=x(e)+w,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),m),g&&(e=function(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,w=("s"===v?hw[8+J_/3]:"")+w+(S&&"("===h?")":""),_)for(r=-1,s=e.length;++r<s;)if(48>(l=e.charCodeAt(r))||l>57){w=(46===l?o+e.slice(r+1):e.slice(r))+w,e=e.slice(0,r);break}}f&&!p&&(e=i(e,1/0));var T=d.length+e.length+w.length,M=T<A?new Array(A-T+1).join(t):"";switch(f&&p&&(e=i(M+e,M.length?A-w.length:1/0),M=""),n){case"<":e=d+e+w+M;break;case"=":e=d+M+e+w;break;case"^":e=M.slice(0,T=M.length>>1)+d+e+w+M.slice(T);break;default:e=M+d+e+w}return a(e)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),w.toString=function(){return e+""},w}return{format:h,formatPrefix:function(e,t){var n=h(((e=ew(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(iw(t)/3))),r=Math.pow(10,-i),s=hw[8+i/3];return function(e){return n(r*e)+s}}}}function pw(e,t,n,i){var r,s=function(e,t,n){n=+n;const i=(t=+t)<(e=+e),r=i?g_(t,e,n):g_(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}(e,t,n);switch((i=ew(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(r=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(iw(t)/3)))-iw(Math.abs(e)))}(s,o))||(i.precision=r),cw(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,iw(t)-iw(e))+1}(s,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(e){return Math.max(0,-iw(Math.abs(e)))}(s))||(i.precision=r-2*("%"===i.type))}return lw(i)}function Aw(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const i=t<e,[r,s,o]=i?m_(t,e,n):m_(e,t,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let c=0;c<a;++c)l[c]=(s-c)/-o;else for(let c=0;c<a;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(r+c)/-o;else for(let c=0;c<a;++c)l[c]=(r+c)*o;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var i=t();return pw(i[0],i[i.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r,s=t(),o=0,a=s.length-1,l=s[o],c=s[a],u=10;for(c<l&&(r=l,l=c,c=r,r=o,o=a,a=r);u-- >0;){if((r=g_(l,c,n))===i)return s[o]=l,s[a]=c,t(s);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return e},e}function fw(){var e=K_()(W_,W_);return e.copy=function(){return t=e,fw().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},Z_.apply(e,arguments),Aw(e)}function mw(){var e,t=0,n=1,i=1,r=[.5],s=[0,1];function o(t){return null!=t&&t<=t?s[S_(r,t,0,i)]:e}function a(){var e=-1;for(r=new Array(i);++e<i;)r[e]=((e+1)*n-(e-i)*t)/(i+1);return o}return o.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,a()):[t,n]},o.range=function(e){return arguments.length?(i=(s=Array.from(e)).length-1,a()):s.slice()},o.invertExtent=function(e){var o=s.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,r[0]]:o>=i?[r[i-1],n]:[r[o-1],r[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return r.slice()},o.copy=function(){return mw().domain([t,n]).range(s).unknown(e)},Z_.apply(Aw(o),arguments)}function gw(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function vw(e,t){let n,i;if(void 0===t)for(const r of e)null!=r&&(void 0===n?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let s of e)null!=(s=t(s,++r,e))&&(void 0===n?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}aw=dw({thousands:",",grouping:[3],currency:["$",""]}),lw=aw.format,cw=aw.formatPrefix;const yw=134217729;function bw(e,t,n,i,r){let s,o,a,l,c=t[0],u=i[0],h=0,d=0;u>c===u>-c?(s=c,c=t[++h]):(s=u,u=i[++d]);let p=0;if(h<e&&d<n)for(u>c===u>-c?(o=c+s,a=s-(o-c),c=t[++h]):(o=u+s,a=s-(o-u),u=i[++d]),s=o,0!==a&&(r[p++]=a);h<e&&d<n;)u>c===u>-c?(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++h]):(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=i[++d]),s=o,0!==a&&(r[p++]=a);for(;h<e;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++h],s=o,0!==a&&(r[p++]=a);for(;d<n;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=i[++d],s=o,0!==a&&(r[p++]=a);return 0===s&&0!==p||(r[p++]=s),p}function xw(e){return new Float64Array(e)}const _w=xw(4),ww=xw(8),Sw=xw(12),Tw=xw(16),Mw=xw(4);function Ew(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a,c=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*c?l:-function(e,t,n,i,r,s,o){let a,l,c,u,h,d,p,A,f,m,g,v,y,b,x,_,w,S;const T=e-r,M=n-r,E=t-s,C=i-s;b=T*C,d=yw*T,p=d-(d-T),A=T-p,d=yw*C,f=d-(d-C),m=C-f,x=A*m-(b-p*f-A*f-p*m),_=E*M,d=yw*E,p=d-(d-E),A=E-p,d=yw*M,f=d-(d-M),m=M-f,w=A*m-(_-p*f-A*f-p*m),g=x-w,h=x-g,_w[0]=x-(g+h)+(h-w),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-_,h=y-g,_w[1]=y-(g+h)+(h-_),S=v+g,h=S-v,_w[2]=v-(S-h)+(g-h),_w[3]=S;let R=function(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}(4,_w),P=22204460492503146e-32*o;if(R>=P||-R>=P)return R;if(h=e-T,a=e-(T+h)+(h-r),h=n-M,c=n-(M+h)+(h-r),h=t-E,l=t-(E+h)+(h-s),h=i-C,u=i-(C+h)+(h-s),0===a&&0===l&&0===c&&0===u)return R;if(P=11093356479670487e-47*o+33306690738754706e-32*Math.abs(R),R+=T*u+C*a-(E*c+M*l),R>=P||-R>=P)return R;b=a*C,d=yw*a,p=d-(d-a),A=a-p,d=yw*C,f=d-(d-C),m=C-f,x=A*m-(b-p*f-A*f-p*m),_=l*M,d=yw*l,p=d-(d-l),A=l-p,d=yw*M,f=d-(d-M),m=M-f,w=A*m-(_-p*f-A*f-p*m),g=x-w,h=x-g,Mw[0]=x-(g+h)+(h-w),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-_,h=y-g,Mw[1]=y-(g+h)+(h-_),S=v+g,h=S-v,Mw[2]=v-(S-h)+(g-h),Mw[3]=S;const N=bw(4,_w,4,Mw,ww);b=T*u,d=yw*T,p=d-(d-T),A=T-p,d=yw*u,f=d-(d-u),m=u-f,x=A*m-(b-p*f-A*f-p*m),_=E*c,d=yw*E,p=d-(d-E),A=E-p,d=yw*c,f=d-(d-c),m=c-f,w=A*m-(_-p*f-A*f-p*m),g=x-w,h=x-g,Mw[0]=x-(g+h)+(h-w),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-_,h=y-g,Mw[1]=y-(g+h)+(h-_),S=v+g,h=S-v,Mw[2]=v-(S-h)+(g-h),Mw[3]=S;const D=bw(N,ww,4,Mw,Sw);b=a*u,d=yw*a,p=d-(d-a),A=a-p,d=yw*u,f=d-(d-u),m=u-f,x=A*m-(b-p*f-A*f-p*m),_=l*c,d=yw*l,p=d-(d-l),A=l-p,d=yw*c,f=d-(d-c),m=c-f,w=A*m-(_-p*f-A*f-p*m),g=x-w,h=x-g,Mw[0]=x-(g+h)+(h-w),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-_,h=y-g,Mw[1]=y-(g+h)+(h-_),S=v+g,h=S-v,Mw[2]=v-(S-h)+(g-h),Mw[3]=S;const L=bw(D,Sw,4,Mw,Tw);return Tw[L-1]}(e,t,n,i,r,s,c)}xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(8),xw(8),xw(8),xw(4),xw(8),xw(8),xw(8),xw(12);xw(192),xw(192);xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(8),xw(8),xw(8),xw(8),xw(8),xw(8),xw(8),xw(8),xw(8),xw(4),xw(4),xw(4),xw(8),xw(16),xw(16),xw(16),xw(32),xw(32),xw(48),xw(64);xw(1152),xw(1152);xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(4),xw(24),xw(24),xw(24),xw(24),xw(24),xw(24),xw(24),xw(24),xw(24),xw(24),xw(1152),xw(1152),xw(1152),xw(1152),xw(1152),xw(2304),xw(2304),xw(3456),xw(5760),xw(8),xw(8),xw(8),xw(16),xw(24),xw(48),xw(48),xw(96),xw(192),xw(384),xw(384),xw(384),xw(768);xw(96),xw(96),xw(96),xw(1152);const Cw=Math.pow(2,-52),Rw=new Uint32Array(512);class Pw{static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bw;const i=e.length,r=new Float64Array(2*i);for(let s=0;s<i;s++){const i=e[s];r[2*s]=t(i),r[2*s+1]=n(i)}return new Pw(r)}constructor(e){const t=e.length>>1;if(t>0&&"number"!==typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:r}=this,s=e.length>>1;let o=1/0,a=1/0,l=-1/0,c=-1/0;for(let S=0;S<s;S++){const t=e[2*S],n=e[2*S+1];t<o&&(o=t),n<a&&(a=n),t>l&&(l=t),n>c&&(c=n),this._ids[S]=S}const u=(o+l)/2,h=(a+c)/2;let d,p,A;for(let S=0,T=1/0;S<s;S++){const t=Nw(u,h,e[2*S],e[2*S+1]);t<T&&(d=S,T=t)}const f=e[2*d],m=e[2*d+1];for(let S=0,T=1/0;S<s;S++){if(S===d)continue;const t=Nw(f,m,e[2*S],e[2*S+1]);t<T&&t>0&&(p=S,T=t)}let g=e[2*p],v=e[2*p+1],y=1/0;for(let S=0;S<s;S++){if(S===d||S===p)continue;const t=Lw(f,m,g,v,e[2*S],e[2*S+1]);t<y&&(A=S,y=t)}let b=e[2*A],x=e[2*A+1];if(y===1/0){for(let i=0;i<s;i++)this._dists[i]=e[2*i]-e[0]||e[2*i+1]-e[1];Iw(this._ids,this._dists,0,s-1);const t=new Uint32Array(s);let n=0;for(let e=0,i=-1/0;e<s;e++){const r=this._ids[e],s=this._dists[r];s>i&&(t[n++]=r,i=s)}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Ew(f,m,g,v,b,x)<0){const e=p,t=g,n=v;p=A,g=b,v=x,A=e,b=t,x=n}const _=function(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,c=s-t,u=o*o+a*a,h=l*l+c*c,d=.5/(o*c-a*l),p=e+(c*u-a*h)*d,A=t+(o*h-l*u)*d;return{x:p,y:A}}(f,m,g,v,b,x);this._cx=_.x,this._cy=_.y;for(let S=0;S<s;S++)this._dists[S]=Nw(e[2*S],e[2*S+1],_.x,_.y);Iw(this._ids,this._dists,0,s-1),this._hullStart=d;let w=3;n[d]=t[A]=p,n[p]=t[d]=A,n[A]=t[p]=d,i[d]=0,i[p]=1,i[A]=2,r.fill(-1),r[this._hashKey(f,m)]=d,r[this._hashKey(g,v)]=p,r[this._hashKey(b,x)]=A,this.trianglesLen=0,this._addTriangle(d,p,A,-1,-1,-1);for(let S,T,M=0;M<this._ids.length;M++){const s=this._ids[M],o=e[2*s],a=e[2*s+1];if(M>0&&Math.abs(o-S)<=Cw&&Math.abs(a-T)<=Cw)continue;if(S=o,T=a,s===d||s===p||s===A)continue;let l=0;for(let e=0,t=this._hashKey(o,a);e<this._hashSize&&(l=r[(t+e)%this._hashSize],-1===l||l===n[l]);e++);l=t[l];let c,u=l;for(;c=n[u],Ew(o,a,e[2*u],e[2*u+1],e[2*c],e[2*c+1])>=0;)if(u=c,u===l){u=-1;break}if(-1===u)continue;let h=this._addTriangle(u,s,n[u],-1,-1,i[u]);i[s]=this._legalize(h+2),i[u]=h,w++;let f=n[u];for(;c=n[f],Ew(o,a,e[2*f],e[2*f+1],e[2*c],e[2*c+1])<0;)h=this._addTriangle(f,s,c,i[s],-1,i[f]),i[s]=this._legalize(h+2),n[f]=f,w--,f=c;if(u===l)for(;c=t[u],Ew(o,a,e[2*c],e[2*c+1],e[2*u],e[2*u+1])<0;)h=this._addTriangle(c,s,u,-1,i[u],i[c]),this._legalize(h+2),i[c]=h,n[u]=u,w--,u=c;this._hullStart=t[s]=u,n[u]=t[f]=s,n[s]=f,r[this._hashKey(o,a)]=s,r[this._hashKey(e[2*u],e[2*u+1])]=u}this.hull=new Uint32Array(w);for(let S=0,T=this._hullStart;S<w;S++)this.hull[S]=T,T=n[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let r=0,s=0;for(;;){const o=n[e],a=e-e%3;if(s=a+(e+2)%3,-1===o){if(0===r)break;e=Rw[--r];continue}const l=o-o%3,c=a+(e+1)%3,u=l+(o+2)%3,h=t[s],d=t[e],p=t[c],A=t[u];if(Dw(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*A],i[2*A+1])){t[e]=A,t[o]=h;const i=n[u];if(-1===i){let t=this._hullStart;do{if(this._hullTri[t]===u){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,i),this._link(o,n[s]),this._link(s,u);const a=l+(o+1)%3;r<Rw.length&&(Rw[r++]=a)}else{if(0===r)break;e=Rw[--r]}}return s}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,r,s){const o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,i),this._link(o+1,r),this._link(o+2,s),this.trianglesLen+=3,o}}function Nw(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function Dw(e,t,n,i,r,s,o,a){const l=e-o,c=t-a,u=n-o,h=i-a,d=r-o,p=s-a,A=u*u+h*h,f=d*d+p*p;return l*(h*f-A*p)-c*(u*f-A*d)+(l*l+c*c)*(u*p-h*d)<0}function Lw(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,c=s-t,u=o*o+a*a,h=l*l+c*c,d=.5/(o*c-a*l),p=(c*u-a*h)*d,A=(o*h-l*u)*d;return p*p+A*A}function Iw(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const i=e[r],s=t[i];let o=r-1;for(;o>=n&&t[e[o]]>s;)e[o+1]=e[o--];e[o+1]=i}else{let r=n+1,s=i;Ow(e,n+i>>1,r),t[e[n]]>t[e[i]]&&Ow(e,n,i),t[e[r]]>t[e[i]]&&Ow(e,r,i),t[e[n]]>t[e[r]]&&Ow(e,n,r);const o=e[r],a=t[o];for(;;){do{r++}while(t[e[r]]<a);do{s--}while(t[e[s]]>a);if(s<r)break;Ow(e,r,s)}e[n+1]=e[s],e[s]=o,i-r+1>=s-n?(Iw(e,t,r,i),Iw(e,t,n,s-1)):(Iw(e,t,n,s-1),Iw(e,t,r,i))}}function Ow(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function kw(e){return e[0]}function Bw(e){return e[1]}function Fw(e,t){var n,i,r,s,o,a,l,c,u,h=0,d=e[0],p=e[1],A=t.length;for(n=0;n<A;n++){i=0;var f=t[n],m=f.length-1;if((c=f[0])[0]!==f[m][0]&&c[1]!==f[m][1])throw new Error("First and last coordinates in a ring must be the same");for(s=c[0]-d,o=c[1]-p;i<m;i++){if(a=(u=f[i+1])[0]-d,l=u[1]-p,0===o&&0===l){if(a<=0&&s>=0||s<=0&&a>=0)return 0}else if(l>=0&&o<0||l<0&&o>=0){if(0===(r=Ew(s,a,o,l,0,0)))return 0;(r>0&&l>0&&o<=0||r<0&&l<=0&&o>0)&&h++}c=u,o=l,s=a}}return h%2!==0}var Uw,zw,qw,Vw,Gw,jw,Hw,Ww,Xw,Yw,Qw,Kw,Zw,Jw,$w,eS,tS=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const i=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}(e),r="Feature"===(s=t).type?s.geometry:s;var s;const o=r.type,a=t.bbox;let l=r.coordinates;if(a&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(i,a))return!1;"Polygon"===o&&(l=[l]);let c=!1;for(var u=0;u<l.length;++u){const e=Fw(i,l[u]);if(0===e)return!n.ignoreBoundary;e&&(c=!0)}return c},nS=new xy,iS=new xy,rS={point:qy,lineStart:qy,lineEnd:qy,polygonStart:function(){nS=new xy,rS.lineStart=sS,rS.lineEnd=oS},polygonEnd:function(){var e=+nS;iS.add(e<0?Ey+e:e),this.lineStart=this.lineEnd=this.point=qy},sphere:function(){iS.add(Ey)}};function sS(){rS.point=aS}function oS(){lS(Uw,zw)}function aS(e,t){rS.point=lS,Uw=e,zw=t,qw=e*=Ry,Vw=Ly(t=(t*=Ry)/2+My),Gw=ky(t)}function lS(e,t){var n=(e*=Ry)-qw,i=n>=0?1:-1,r=i*n,s=Ly(t=(t*=Ry)/2+My),o=ky(t),a=Gw*o,l=Vw*s+a*Ly(r),c=a*i*ky(r);nS.add(Dy(c,l)),qw=e,Vw=s,Gw=o}function cS(e){return[Dy(e[1],e[0]),Uy(e[2])]}function uS(e){var t=e[0],n=e[1],i=Ly(n);return[i*Ly(t),i*ky(t),ky(n)]}function hS(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function dS(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function pS(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function AS(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function fS(e){var t=Fy(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var mS={point:gS,lineStart:yS,lineEnd:bS,polygonStart:function(){mS.point=xS,mS.lineStart=_S,mS.lineEnd=wS,Jw=new xy,rS.polygonStart()},polygonEnd:function(){rS.polygonEnd(),mS.point=gS,mS.lineStart=yS,mS.lineEnd=bS,nS<0?(jw=-(Ww=180),Hw=-(Xw=90)):Jw>_y?Xw=90:Jw<-_y&&(Hw=-90),eS[0]=jw,eS[1]=Ww},sphere:function(){jw=-(Ww=180),Hw=-(Xw=90)}};function gS(e,t){$w.push(eS=[jw=e,Ww=e]),t<Hw&&(Hw=t),t>Xw&&(Xw=t)}function vS(e,t){var n=uS([e*Ry,t*Ry]);if(Zw){var i=dS(Zw,n),r=dS([i[1],-i[0],0],i);fS(r),r=cS(r);var s,o=e-Yw,a=o>0?1:-1,l=r[0]*Cy*a,c=Py(o)>180;c^(a*Yw<l&&l<a*e)?(s=r[1]*Cy)>Xw&&(Xw=s):c^(a*Yw<(l=(l+360)%360-180)&&l<a*e)?(s=-r[1]*Cy)<Hw&&(Hw=s):(t<Hw&&(Hw=t),t>Xw&&(Xw=t)),c?e<Yw?SS(jw,e)>SS(jw,Ww)&&(Ww=e):SS(e,Ww)>SS(jw,Ww)&&(jw=e):Ww>=jw?(e<jw&&(jw=e),e>Ww&&(Ww=e)):e>Yw?SS(jw,e)>SS(jw,Ww)&&(Ww=e):SS(e,Ww)>SS(jw,Ww)&&(jw=e)}else $w.push(eS=[jw=e,Ww=e]);t<Hw&&(Hw=t),t>Xw&&(Xw=t),Zw=n,Yw=e}function yS(){mS.point=vS}function bS(){eS[0]=jw,eS[1]=Ww,mS.point=gS,Zw=null}function xS(e,t){if(Zw){var n=e-Yw;Jw.add(Py(n)>180?n+(n>0?360:-360):n)}else Qw=e,Kw=t;rS.point(e,t),vS(e,t)}function _S(){rS.lineStart()}function wS(){xS(Qw,Kw),rS.lineEnd(),Py(Jw)>_y&&(jw=-(Ww=180)),eS[0]=jw,eS[1]=Ww,Zw=null}function SS(e,t){return(t-=e)<0?t+360:t}function TS(e,t){return e[0]-t[0]}function MS(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ES(e){var t,n,i,r,s,o,a;if(Xw=Ww=-(jw=Hw=1/0),$w=[],Zy(e,mS),n=$w.length){for($w.sort(TS),t=1,s=[i=$w[0]];t<n;++t)MS(i,(r=$w[t])[0])||MS(i,r[1])?(SS(i[0],r[1])>SS(i[0],i[1])&&(i[1]=r[1]),SS(r[0],i[1])>SS(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=0,i=s[n=s.length-1];t<=n;i=r,++t)r=s[t],(a=SS(i[1],r[0]))>o&&(o=a,jw=r[0],Ww=i[1])}return $w=eS=null,jw===1/0||Hw===1/0?[[NaN,NaN],[NaN,NaN]]:[[jw,Hw],[Ww,Xw]]}function CS(e){return Py(e[0])<=Sy?e[0]:By(e[0])*((Py(e[0])+Sy)%Ey-Sy)}function RS(e,t){var n=CS(t),i=t[1],r=ky(i),s=[ky(n),-Ly(n),0],o=0,a=0,l=new xy;1===r?i=Ty+_y:-1===r&&(i=-Ty-_y);for(var c=0,u=e.length;c<u;++c)if(d=(h=e[c]).length)for(var h,d,p=h[d-1],A=CS(p),f=p[1]/2+My,m=ky(f),g=Ly(f),v=0;v<d;++v,A=b,m=_,g=w,p=y){var y=h[v],b=CS(y),x=y[1]/2+My,_=ky(x),w=Ly(x),S=b-A,T=S>=0?1:-1,M=T*S,E=M>Sy,C=m*_;if(l.add(Dy(C*T*ky(M),g*w+C*Ly(M))),o+=E?S+T*Ey:S,E^A>=n^b>=n){var R=dS(uS(p),uS(y));fS(R);var P=dS(s,R);fS(P);var N=(E^S>=0?-1:1)*Uy(P[2]);(i>N||i===N&&(R[0]||R[1]))&&(a+=E^S>=0?1:-1)}}return(o<-_y||o<_y&&l<-1e-12)^1&a}var PS,NS,DS,LS,IS,OS,kS,BS,FS,US,zS,qS,VS,GS,jS,HS,WS={Feature:function(e,t){return YS(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)if(YS(n[i].geometry,t))return!0;return!1}},XS={Sphere:function(){return!0},Point:function(e,t){return QS(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)if(QS(n[i],t))return!0;return!1},LineString:function(e,t){return KS(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)if(KS(n[i],t))return!0;return!1},Polygon:function(e,t){return ZS(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)if(ZS(n[i],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)if(YS(n[i],t))return!0;return!1}};function YS(e,t){return!(!e||!XS.hasOwnProperty(e.type))&&XS[e.type](e,t)}function QS(e,t){return 0===rb(e,t)}function KS(e,t){for(var n,i,r,s=0,o=e.length;s<o;s++){if(0===(i=rb(e[s],t)))return!0;if(s>0&&(r=rb(e[s],e[s-1]))>0&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<wy*r)return!0;n=i}return!1}function ZS(e,t){return!!RS(e.map(JS),$S(t))}function JS(e){return(e=e.map($S)).pop(),e}function $S(e){return[e[0]*Ry,e[1]*Ry]}var eT={sphere:qy,point:tT,lineStart:iT,lineEnd:oT,polygonStart:function(){eT.lineStart=aT,eT.lineEnd=lT},polygonEnd:function(){eT.lineStart=iT,eT.lineEnd=oT}};function tT(e,t){e*=Ry;var n=Ly(t*=Ry);nT(n*Ly(e),n*ky(e),ky(t))}function nT(e,t,n){++PS,DS+=(e-DS)/PS,LS+=(t-LS)/PS,IS+=(n-IS)/PS}function iT(){eT.point=rT}function rT(e,t){e*=Ry;var n=Ly(t*=Ry);GS=n*Ly(e),jS=n*ky(e),HS=ky(t),eT.point=sT,nT(GS,jS,HS)}function sT(e,t){e*=Ry;var n=Ly(t*=Ry),i=n*Ly(e),r=n*ky(e),s=ky(t),o=Dy(Fy((o=jS*s-HS*r)*o+(o=HS*i-GS*s)*o+(o=GS*r-jS*i)*o),GS*i+jS*r+HS*s);NS+=o,OS+=o*(GS+(GS=i)),kS+=o*(jS+(jS=r)),BS+=o*(HS+(HS=s)),nT(GS,jS,HS)}function oT(){eT.point=tT}function aT(){eT.point=cT}function lT(){uT(qS,VS),eT.point=tT}function cT(e,t){qS=e,VS=t,e*=Ry,t*=Ry,eT.point=uT;var n=Ly(t);GS=n*Ly(e),jS=n*ky(e),HS=ky(t),nT(GS,jS,HS)}function uT(e,t){e*=Ry;var n=Ly(t*=Ry),i=n*Ly(e),r=n*ky(e),s=ky(t),o=jS*s-HS*r,a=HS*i-GS*s,l=GS*r-jS*i,c=Oy(o,a,l),u=Uy(c),h=c&&-u/c;FS.add(h*o),US.add(h*a),zS.add(h*l),NS+=u,OS+=u*(GS+(GS=i)),kS+=u*(jS+(jS=r)),BS+=u*(HS+(HS=s)),nT(GS,jS,HS)}function hT(e){PS=NS=DS=LS=IS=OS=kS=BS=0,FS=new xy,US=new xy,zS=new xy,Zy(e,eT);var t=+FS,n=+US,i=+zS,r=Oy(t,n,i);return r<wy&&(t=OS,n=kS,i=BS,NS<_y&&(t=DS,n=LS,i=IS),(r=Oy(t,n,i))<wy)?[NaN,NaN]:[Dy(n,t)*Cy,Uy(i/r)*Cy]}const dT=1e-6;class pT{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}arc(e,t,n){const i=(e=+e)+(n=+n),r=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(i,",").concat(r):(Math.abs(this._x1-i)>dT||Math.abs(this._y1-r)>dT)&&(this._+="L"+i+","+r),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=i,",").concat(this._y1=r))}rect(e,t,n,i){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+i,"h").concat(-n,"Z")}value(){return this._||null}}class AT{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class fT{constructor(e){let[t,n,i,r]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((i=+i)>=(t=+t))||!((r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=t,this.ymax=r,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:i}=this;let r,s;const o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let A,f,m=0,g=0,v=n.length;m<v;m+=3,g+=2){const i=2*n[m],a=2*n[m+1],l=2*n[m+2],c=e[i],u=e[i+1],h=e[a],d=e[a+1],p=e[l],v=e[l+1],y=h-c,b=d-u,x=p-c,_=v-u,w=2*(y*_-b*x);if(Math.abs(w)<1e-9){if(void 0===r){r=s=0;for(const n of t)r+=e[2*n],s+=e[2*n+1];r/=t.length,s/=t.length}const n=1e9*Math.sign((r-c)*_-(s-u)*x);A=(c+p)/2-n*_,f=(u+v)/2+n*x}else{const e=1/w,t=y*y+b*b,n=x*x+_*_;A=c+(_*t-b*n)*e,f=u+(y*n-x*t)*e}o[g]=A,o[g+1]=f}let a,l,c,u=t[t.length-1],h=4*u,d=e[2*u],p=e[2*u+1];i.fill(0);for(let A=0;A<t.length;++A)u=t[A],a=h,l=d,c=p,h=4*u,d=e[2*u],p=e[2*u+1],i[a+2]=i[h]=c-p,i[a+3]=i[h+1]=d-l}render(e){const t=null==e?e=new pT:void 0,{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:s,vectors:o}=this;if(r.length<=1)return null;for(let c=0,u=n.length;c<u;++c){const t=n[c];if(t<c)continue;const i=2*Math.floor(c/3),r=2*Math.floor(t/3),o=s[i],a=s[i+1],l=s[r],u=s[r+1];this._renderSegment(o,a,l,u,e)}let a,l=r[r.length-1];for(let c=0;c<r.length;++c){a=l,l=r[c];const t=2*Math.floor(i[l]/3),n=s[t],u=s[t+1],h=4*a,d=this._project(n,u,o[h+2],o[h+3]);d&&this._renderSegment(n,u,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new pT:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new pT:void 0,i=this._clip(e);if(null===i||!i.length)return;t.moveTo(i[0],i[1]);let r=i.length;for(;i[0]===i[r-2]&&i[1]===i[r-1]&&r>1;)r-=2;for(let s=2;s<r;s+=2)i[s]===i[s-2]&&i[s+1]===i[s-1]||t.lineTo(i[s],i[s+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new AT;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,i,r){let s;const o=this._regioncode(e,t),a=this._regioncode(n,i);0===o&&0===a?(r.moveTo(e,t),r.lineTo(n,i)):(s=this._clipSegment(e,t,n,i,o,a))&&(r.moveTo(s[0],s[1]),r.lineTo(s[2],s[3]))}contains(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let i=0,r=t.length;i<r;i+=2)for(let s=0,o=e.length;s<o;s+=2)if(t[i]===e[s]&&t[i+1]===e[s+1]&&t[(i+2)%r]===e[(s+o-2)%o]&&t[(i+3)%r]===e[(s+o-1)%o]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:i,triangles:r}}=this,s=n[e];if(-1===s)return null;const o=[];let a=s;do{const n=Math.floor(a/3);if(o.push(t[2*n],t[2*n+1]),a=a%3===2?a-2:a+1,r[a]!==e)break;a=i[a]}while(a!==s&&-1!==a);return o}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,i=4*e;return this._simplify(n[i]||n[i+1]?this._clipInfinite(e,t,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let i,r,s,o,a=null,l=t[n-2],c=t[n-1],u=this._regioncode(l,c),h=0;for(let d=0;d<n;d+=2)if(i=l,r=c,l=t[d],c=t[d+1],s=u,u=this._regioncode(l,c),0===s&&0===u)o=h,h=0,a?a.push(l,c):a=[l,c];else{let t,n,d,p,A;if(0===s){if(null===(t=this._clipSegment(i,r,l,c,s,u)))continue;[n,d,p,A]=t}else{if(null===(t=this._clipSegment(l,c,i,r,u,s)))continue;[p,A,n,d]=t,o=h,h=this._edgecode(n,d),o&&h&&this._edge(e,o,h,a,a.length),a?a.push(n,d):a=[n,d]}o=h,h=this._edgecode(p,A),o&&h&&this._edge(e,o,h,a,a.length),a?a.push(p,A):a=[p,A]}if(a)o=h,h=this._edgecode(a[0],a[1]),o&&h&&this._edge(e,o,h,a,a.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return a}_clipSegment(e,t,n,i,r,s){const o=r<s;for(o&&([e,t,n,i,r,s]=[n,i,e,t,s,r]);;){if(0===r&&0===s)return o?[n,i,e,t]:[e,t,n,i];if(r&s)return null;let a,l,c=r||s;8&c?(a=e+(n-e)*(this.ymax-t)/(i-t),l=this.ymax):4&c?(a=e+(n-e)*(this.ymin-t)/(i-t),l=this.ymin):2&c?(l=t+(i-t)*(this.xmax-e)/(n-e),a=this.xmax):(l=t+(i-t)*(this.xmin-e)/(n-e),a=this.xmin),r?(e=a,t=l,r=this._regioncode(e,t)):(n=a,i=l,s=this._regioncode(n,i))}}_clipInfinite(e,t,n,i,r,s){let o,a=Array.from(t);if((o=this._project(a[0],a[1],n,i))&&a.unshift(o[0],o[1]),(o=this._project(a[a.length-2],a[a.length-1],r,s))&&a.push(o[0],o[1]),a=this._clipFinite(e,a))for(let l,c=0,u=a.length,h=this._edgecode(a[u-2],a[u-1]);c<u;c+=2)l=h,h=this._edgecode(a[c],a[c+1]),l&&h&&(c=this._edge(e,l,h,a,c),u=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,n,i,r){for(;t!==n;){let n,s;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,s=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,s=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,s=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,s=this.ymin}i[r]===n&&i[r+1]===s||!this.contains(e,n,s)||(i.splice(r,0,n,s),r+=2)}return r}_project(e,t,n,i){let r,s,o,a=1/0;if(i<0){if(t<=this.ymin)return null;(r=(this.ymin-t)/i)<a&&(o=this.ymin,s=e+(a=r)*n)}else if(i>0){if(t>=this.ymax)return null;(r=(this.ymax-t)/i)<a&&(o=this.ymax,s=e+(a=r)*n)}if(n>0){if(e>=this.xmax)return null;(r=(this.xmax-e)/n)<a&&(s=this.xmax,o=t+(a=r)*i)}else if(n<0){if(e<=this.xmin)return null;(r=(this.xmin-e)/n)<a&&(s=this.xmin,o=t+(a=r)*i)}return[s,o]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,i=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[i]||e[t+1]===e[n+1]&&e[n+1]===e[i+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}const mT=2*Math.PI,gT=Math.pow;function vT(e){return e[0]}function yT(e){return e[1]}function bT(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class xT{static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yT,i=arguments.length>3?arguments[3]:void 0;return new xT("length"in e?function(e,t,n,i){const r=e.length,s=new Float64Array(2*r);for(let o=0;o<r;++o){const r=e[o];s[2*o]=t.call(i,r,o,e),s[2*o+1]=n.call(i,r,o,e)}return s}(e,t,n,i):Float64Array.from(function*(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}(e,t,n,i)))}constructor(e){this._delaunator=new Pw(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const e=2*t[i],r=2*t[i+1],s=2*t[i+2];if((n[s]-n[e])*(n[r+1]-n[e+1])-(n[r]-n[e])*(n[s+1]-n[e+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let s=0,o=t.length/2;s<o;++s){const e=bT(t[2*s],t[2*s+1],r);t[2*s]=e[0],t[2*s+1]=e[1]}this._delaunator=new Pw(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let a=0,l=n.length;a<l;++a){const e=r[a%3===2?a-2:a+1];-1!==n[a]&&-1!==s[e]||(s[e]=a)}for(let a=0,l=i.length;a<l;++a)o[i[a]]=a;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,2===i.length&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new fT(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:i,halfedges:r,triangles:s,collinear:o}=this;if(o){const t=o.indexOf(e);return t>0&&(yield o[t-1]),void(t<o.length-1&&(yield o[t+1]))}const a=t[e];if(-1===a)return;let l=a,c=-1;do{if(yield c=s[l],l=l%3===2?l-2:l+1,s[l]!==e)return;if(l=r[l],-1===l){const t=n[(i[e]+1)%n.length];return void(t!==c&&(yield t))}}while(l!==a)}find(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;const i=n;let r;for(;(r=this._step(n,e,t))>=0&&r!==n&&r!==i;)n=r;return r}_step(e,t,n){const{inedges:i,hull:r,_hullIndex:s,halfedges:o,triangles:a,points:l}=this;if(-1===i[e]||!l.length)return(e+1)%(l.length>>1);let c=e,u=gT(t-l[2*e],2)+gT(n-l[2*e+1],2);const h=i[e];let d=h;do{let i=a[d];const h=gT(t-l[2*i],2)+gT(n-l[2*i+1],2);if(h<u&&(u=h,c=i),d=d%3===2?d-2:d+1,a[d]!==e)break;if(d=o[d],-1===d){if(d=r[(s[e]+1)%r.length],d!==i&&gT(t-l[2*d],2)+gT(n-l[2*d+1],2)<u)return d;break}}while(d!==h);return c}render(e){const t=null==e?e=new pT:void 0,{points:n,halfedges:i,triangles:r}=this;for(let s=0,o=i.length;s<o;++s){const t=i[s];if(t<s)continue;const o=2*r[s],a=2*r[t];e.moveTo(n[o],n[o+1]),e.lineTo(n[a],n[a+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&"function"===typeof e.moveTo||(t=e,e=null),t=void 0==t?2:+t;const n=null==e?e=new pT:void 0,{points:i}=this;for(let r=0,s=i.length;r<s;r+=2){const n=i[r],s=i[r+1];e.moveTo(n+t,s),e.arc(n,s,t,0,mT)}return n&&n.value()}renderHull(e){const t=null==e?e=new pT:void 0,{hull:n,points:i}=this,r=2*n[0],s=n.length;e.moveTo(i[r],i[r+1]);for(let o=1;o<s;++o){const t=2*n[o];e.lineTo(i[t],i[t+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new AT;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new pT:void 0,{points:i,triangles:r}=this,s=2*r[e*=3],o=2*r[e+1],a=2*r[e+2];return t.moveTo(i[s],i[s+1]),t.lineTo(i[o],i[o+1]),t.lineTo(i[a],i[a+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new AT;return this.renderTriangle(e,t),t.value()}}function _T(e,t){function n(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,i){return(n=t.invert(n,i))&&e.invert(n[0],n[1])}),n}function wT(e,t){return Py(e)>Sy&&(e-=Math.round(e/Ey)*Ey),[e,t]}function ST(e,t,n){return(e%=Ey)?t||n?_T(MT(e),ET(t,n)):MT(e):t||n?ET(t,n):wT}function TT(e){return function(t,n){return Py(t+=e)>Sy&&(t-=Math.round(t/Ey)*Ey),[t,n]}}function MT(e){var t=TT(e);return t.invert=TT(-e),t}function ET(e,t){var n=Ly(e),i=ky(e),r=Ly(t),s=ky(t);function o(e,t){var o=Ly(t),a=Ly(e)*o,l=ky(e)*o,c=ky(t),u=c*n+a*i;return[Dy(l*r-u*s,a*n-c*i),Uy(u*r+l*s)]}return o.invert=function(e,t){var o=Ly(t),a=Ly(e)*o,l=ky(e)*o,c=ky(t),u=c*r-l*s;return[Dy(l*r+c*s,a*n+u*i),Uy(u*n-a*i)]},o}function CT(){var e,t=[];return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:qy,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function RT(e,t){return Py(e[0]-t[0])<_y&&Py(e[1]-t[1])<_y}function PT(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function NT(e,t,n,i,r){var s,o,a=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,i=e[0],o=e[t];if(RT(i,o)){if(!i[2]&&!o[2]){for(r.lineStart(),s=0;s<t;++s)r.point((i=e[s])[0],i[1]);return void r.lineEnd()}o[0]+=2e-6}a.push(n=new PT(i,e,null,!0)),l.push(n.o=new PT(i,null,n,!1)),a.push(n=new PT(o,e,null,!1)),l.push(n.o=new PT(o,null,n,!0))}})),a.length){for(l.sort(t),DT(a),DT(l),s=0,o=l.length;s<o;++s)l[s].e=n=!n;for(var c,u,h=a[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(s=0,o=c.length;s<o;++s)r.point((u=c[s])[0],u[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(p)for(c=d.p.z,s=c.length-1;s>=0;--s)r.point((u=c[s])[0],u[1]);else i(d.x,d.p.x,-1,r);d=d.p}c=(d=d.o).z,p=!p}while(!d.v);r.lineEnd()}}}function DT(e){if(t=e.length){for(var t,n,i=0,r=e[0];++i<t;)r.n=n=e[i],n.p=r,r=n;r.n=n=e[0],n.p=r}}function LT(e,t,n,i){return function(r){var s,o,a,l=t(r),c=CT(),u=t(c),h=!1,d={point:p,lineStart:f,lineEnd:m,polygonStart:function(){d.point=g,d.lineStart=v,d.lineEnd=y,o=[],s=[]},polygonEnd:function(){d.point=p,d.lineStart=f,d.lineEnd=m,o=gw(o);var e=RS(s,i);o.length?(h||(r.polygonStart(),h=!0),NT(o,OT,e,n,r)):e&&(h||(r.polygonStart(),h=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=s=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(t,n){e(t,n)&&r.point(t,n)}function A(e,t){l.point(e,t)}function f(){d.point=A,l.lineStart()}function m(){d.point=p,l.lineEnd()}function g(e,t){a.push([e,t]),u.point(e,t)}function v(){u.lineStart(),a=[]}function y(){g(a[0][0],a[0][1]),u.lineEnd();var e,t,n,i,l=u.clean(),d=c.result(),p=d.length;if(a.pop(),s.push(a),a=null,p)if(1&l){if((t=(n=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),e=0;e<t;++e)r.point((i=n[e])[0],i[1]);r.lineEnd()}}else p>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(IT))}return d}}function IT(e){return e.length>1}function OT(e,t){return((e=e.x)[0]<0?e[1]-Ty-_y:Ty-e[1])-((t=t.x)[0]<0?t[1]-Ty-_y:Ty-t[1])}wT.invert=wT;const kT=LT((function(){return!0}),(function(e){var t,n=NaN,i=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(s,o){var a=s>0?Sy:-Sy,l=Py(s-n);Py(l-Sy)<_y?(e.point(n,i=(i+o)/2>0?Ty:-Ty),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(a,i),e.point(s,i),t=0):r!==a&&l>=Sy&&(Py(n-r)<_y&&(n-=r*_y),Py(s-a)<_y&&(s-=a*_y),i=function(e,t,n,i){var r,s,o=ky(e-n);return Py(o)>_y?Ny((ky(t)*(s=Ly(i))*ky(n)-ky(i)*(r=Ly(t))*ky(e))/(r*s*o)):(t+i)/2}(n,i,s,o),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(a,i),t=0),e.point(n=s,i=o),r=a},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-t}}}),(function(e,t,n,i){var r;if(null==e)r=n*Ty,i.point(-Sy,r),i.point(0,r),i.point(Sy,r),i.point(Sy,0),i.point(Sy,-r),i.point(0,-r),i.point(-Sy,-r),i.point(-Sy,0),i.point(-Sy,r);else if(Py(e[0]-t[0])>_y){var s=e[0]<t[0]?Sy:-Sy;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}),[-Sy,-Ty]);function BT(e,t,n,i,r,s){if(n){var o=Ly(t),a=ky(t),l=i*n;null==r?(r=t+i*Ey,s=t-l/2):(r=FT(o,r),s=FT(o,s),(i>0?r<s:r>s)&&(r+=i*Ey));for(var c,u=r;i>0?u>s:u<s;u-=l)c=cS([o,-a*Ly(u),-a*ky(u)]),e.point(c[0],c[1])}}function FT(e,t){(t=uS(t))[0]-=e,fS(t);var n,i=(n=-t[1])>1?0:n<-1?Sy:Math.acos(n);return((-t[2]<0?-i:i)+Ey-_y)%Ey}var UT=1e9,zT=-UT;function qT(e,t,n,i){function r(r,s){return e<=r&&r<=n&&t<=s&&s<=i}function s(r,s,a,c){var u=0,h=0;if(null==r||(u=o(r,a))!==(h=o(s,a))||l(r,s)<0^a>0)do{c.point(0===u||3===u?e:n,u>1?i:t)}while((u=(u+a+4)%4)!==h);else c.point(s[0],s[1])}function o(i,r){return Py(i[0]-e)<_y?r>0?0:3:Py(i[0]-n)<_y?r>0?2:1:Py(i[1]-t)<_y?r>0?1:0:r>0?3:2}function a(e,t){return l(e.x,t.x)}function l(e,t){var n=o(e,1),i=o(t,1);return n!==i?n-i:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var l,c,u,h,d,p,A,f,m,g,v,y=o,b=CT(),x={point:_,lineStart:function(){x.point=w,c&&c.push(u=[]);g=!0,m=!1,A=f=NaN},lineEnd:function(){l&&(w(h,d),p&&m&&b.rejoin(),l.push(b.result()));x.point=_,m&&y.lineEnd()},polygonStart:function(){y=b,l=[],c=[],v=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,r=c.length;n<r;++n)for(var s,o,a=c[n],l=1,u=a.length,h=a[0],d=h[0],p=h[1];l<u;++l)s=d,o=p,d=(h=a[l])[0],p=h[1],o<=i?p>i&&(d-s)*(i-o)>(p-o)*(e-s)&&++t:p<=i&&(d-s)*(i-o)<(p-o)*(e-s)&&--t;return t}(),n=v&&t,r=(l=gw(l)).length;(n||r)&&(o.polygonStart(),n&&(o.lineStart(),s(null,null,1,o),o.lineEnd()),r&&NT(l,a,t,s,o),o.polygonEnd());y=o,l=c=u=null}};function _(e,t){r(e,t)&&y.point(e,t)}function w(s,o){var a=r(s,o);if(c&&u.push([s,o]),g)h=s,d=o,p=a,g=!1,a&&(y.lineStart(),y.point(s,o));else if(a&&m)y.point(s,o);else{var l=[A=Math.max(zT,Math.min(UT,A)),f=Math.max(zT,Math.min(UT,f))],b=[s=Math.max(zT,Math.min(UT,s)),o=Math.max(zT,Math.min(UT,o))];!function(e,t,n,i,r,s){var o,a=e[0],l=e[1],c=0,u=1,h=t[0]-a,d=t[1]-l;if(o=n-a,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>c&&(c=o)}if(o=r-a,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<u&&(u=o)}if(o=i-l,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>c&&(c=o)}if(o=s-l,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<u&&(u=o)}return c>0&&(e[0]=a+c*h,e[1]=l+c*d),u<1&&(t[0]=a+u*h,t[1]=l+u*d),!0}}}}}(l,b,e,t,n,i)?a&&(y.lineStart(),y.point(s,o),v=!1):(m||(y.lineStart(),y.point(l[0],l[1])),y.point(b[0],b[1]),a||y.lineEnd(),v=!1)}A=s,f=o,m=a}return x}}const VT=e=>e;function GT(e){return function(t){var n=new jT;for(var i in e)n[i]=e[i];return n.stream=t,n}}function jT(){}jT.prototype={constructor:jT,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var HT=1/0,WT=HT,XT=-HT,YT=XT,QT={point:function(e,t){e<HT&&(HT=e);e>XT&&(XT=e);t<WT&&(WT=t);t>YT&&(YT=t)},lineStart:qy,lineEnd:qy,polygonStart:qy,polygonEnd:qy,result:function(){var e=[[HT,WT],[XT,YT]];return XT=YT=-(WT=HT=1/0),e}};const KT=QT;function ZT(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Zy(n,e.stream(KT)),t(KT.result()),null!=i&&e.clipExtent(i),e}function JT(e,t,n){return ZT(e,(function(n){var i=t[1][0]-t[0][0],r=t[1][1]-t[0][1],s=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),o=+t[0][0]+(i-s*(n[1][0]+n[0][0]))/2,a=+t[0][1]+(r-s*(n[1][1]+n[0][1]))/2;e.scale(150*s).translate([o,a])}),n)}var $T=Ly(30*Ry);function eM(e,t){return+t?function(e,t){function n(i,r,s,o,a,l,c,u,h,d,p,A,f,m){var g=c-i,v=u-r,y=g*g+v*v;if(y>4*t&&f--){var b=o+d,x=a+p,_=l+A,w=Fy(b*b+x*x+_*_),S=Uy(_/=w),T=Py(Py(_)-1)<_y||Py(s-h)<_y?(s+h)/2:Dy(x,b),M=e(T,S),E=M[0],C=M[1],R=E-i,P=C-r,N=v*R-g*P;(N*N/y>t||Py((g*R+v*P)/y-.5)>.3||o*d+a*p+l*A<$T)&&(n(i,r,s,o,a,l,E,C,T,b/=w,x/=w,_,f,m),m.point(E,C),n(E,C,T,b,x,_,c,u,h,d,p,A,f,m))}}return function(t){var i,r,s,o,a,l,c,u,h,d,p,A,f={point:m,lineStart:g,lineEnd:y,polygonStart:function(){t.polygonStart(),f.lineStart=b},polygonEnd:function(){t.polygonEnd(),f.lineStart=g}};function m(n,i){n=e(n,i),t.point(n[0],n[1])}function g(){u=NaN,f.point=v,t.lineStart()}function v(i,r){var s=uS([i,r]),o=e(i,r);n(u,h,c,d,p,A,u=o[0],h=o[1],c=i,d=s[0],p=s[1],A=s[2],16,t),t.point(u,h)}function y(){f.point=m,t.lineEnd()}function b(){g(),f.point=x,f.lineEnd=_}function x(e,t){v(i=e,t),r=u,s=h,o=d,a=p,l=A,f.point=v}function _(){n(u,h,c,d,p,A,r,s,i,o,a,l,16,t),f.lineEnd=y,y()}return f}}(e,t):function(e){return GT({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var tM=GT({point:function(e,t){this.stream.point(e*Ry,t*Ry)}});function nM(e,t,n,i,r,s){if(!s)return function(e,t,n,i,r){function s(s,o){return[t+e*(s*=i),n-e*(o*=r)]}return s.invert=function(s,o){return[(s-t)/e*i,(n-o)/e*r]},s}(e,t,n,i,r);var o=Ly(s),a=ky(s),l=o*e,c=a*e,u=o/e,h=a/e,d=(a*n-o*t)/e,p=(a*t+o*n)/e;function A(e,s){return[l*(e*=i)-c*(s*=r)+t,n-c*e-l*s]}return A.invert=function(e,t){return[i*(u*e-h*t+d),r*(p-h*e-u*t)]},A}function iM(e){return function(e){var t,n,i,r,s,o,a,l,c,u,h=150,d=480,p=250,A=0,f=0,m=0,g=0,v=0,y=0,b=1,x=1,_=null,w=kT,S=null,T=VT,M=.5;function E(e){return l(e[0]*Ry,e[1]*Ry)}function C(e){return(e=l.invert(e[0],e[1]))&&[e[0]*Cy,e[1]*Cy]}function R(){var e=nM(h,0,0,b,x,y).apply(null,t(A,f)),i=nM(h,d-e[0],p-e[1],b,x,y);return n=ST(m,g,v),a=_T(t,i),l=_T(n,a),o=eM(a,M),P()}function P(){return c=u=null,E}return E.stream=function(e){return c&&u===e?c:c=tM(function(e){return GT({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}(n)(w(o(T(u=e)))))},E.preclip=function(e){return arguments.length?(w=e,_=void 0,P()):w},E.postclip=function(e){return arguments.length?(T=e,S=i=r=s=null,P()):T},E.clipAngle=function(e){return arguments.length?(w=+e?function(e){var t=Ly(e),n=2*Ry,i=t>0,r=Py(t)>_y;function s(e,n){return Ly(e)*Ly(n)>t}function o(e,n,i){var r=[1,0,0],s=dS(uS(e),uS(n)),o=hS(s,s),a=s[0],l=o-a*a;if(!l)return!i&&e;var c=t*o/l,u=-t*a/l,h=dS(r,s),d=AS(r,c);pS(d,AS(s,u));var p=h,A=hS(d,p),f=hS(p,p),m=A*A-f*(hS(d,d)-1);if(!(m<0)){var g=Fy(m),v=AS(p,(-A-g)/f);if(pS(v,d),v=cS(v),!i)return v;var y,b=e[0],x=n[0],_=e[1],w=n[1];x<b&&(y=b,b=x,x=y);var S=x-b,T=Py(S-Sy)<_y;if(!T&&w<_&&(y=_,_=w,w=y),T||S<_y?T?_+w>0^v[1]<(Py(v[0]-b)<_y?_:w):_<=v[1]&&v[1]<=w:S>Sy^(b<=v[0]&&v[0]<=x)){var M=AS(p,(-A+g)/f);return pS(M,d),[v,cS(M)]}}}function a(t,n){var r=i?e:Sy-e,s=0;return t<-r?s|=1:t>r&&(s|=2),n<-r?s|=4:n>r&&(s|=8),s}return LT(s,(function(e){var t,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var p,A=[h,d],f=s(h,d),m=i?f?0:a(h,d):f?a(h+(h<0?Sy:-Sy),d):0;if(!t&&(c=l=f)&&e.lineStart(),f!==l&&(!(p=o(t,A))||RT(t,p)||RT(A,p))&&(A[2]=1),f!==l)u=0,f?(e.lineStart(),p=o(A,t),e.point(p[0],p[1])):(p=o(t,A),e.point(p[0],p[1],2),e.lineEnd()),t=p;else if(r&&t&&i^f){var g;m&n||!(g=o(A,t,!0))||(u=0,i?(e.lineStart(),e.point(g[0][0],g[0][1]),e.point(g[1][0],g[1][1]),e.lineEnd()):(e.point(g[1][0],g[1][1]),e.lineEnd(),e.lineStart(),e.point(g[0][0],g[0][1],3)))}!f||t&&RT(t,A)||e.point(A[0],A[1]),t=A,l=f,n=m},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return u|(c&&l)<<1}}}),(function(t,i,r,s){BT(s,e,n,r,t,i)}),i?[0,-e]:[-Sy,e-Sy])}(_=e*Ry):(_=null,kT),P()):_*Cy},E.clipExtent=function(e){return arguments.length?(T=null==e?(S=i=r=s=null,VT):qT(S=+e[0][0],i=+e[0][1],r=+e[1][0],s=+e[1][1]),P()):null==S?null:[[S,i],[r,s]]},E.scale=function(e){return arguments.length?(h=+e,R()):h},E.translate=function(e){return arguments.length?(d=+e[0],p=+e[1],R()):[d,p]},E.center=function(e){return arguments.length?(A=e[0]%360*Ry,f=e[1]%360*Ry,R()):[A*Cy,f*Cy]},E.rotate=function(e){return arguments.length?(m=e[0]%360*Ry,g=e[1]%360*Ry,v=e.length>2?e[2]%360*Ry:0,R()):[m*Cy,g*Cy,v*Cy]},E.angle=function(e){return arguments.length?(y=e%360*Ry,R()):y*Cy},E.reflectX=function(e){return arguments.length?(b=e?-1:1,R()):b<0},E.reflectY=function(e){return arguments.length?(x=e?-1:1,R()):x<0},E.precision=function(e){return arguments.length?(o=eM(a,M=e*e),P()):Fy(M)},E.fitExtent=function(e,t){return JT(E,e,t)},E.fitSize=function(e,t){return function(e,t,n){return JT(e,[[0,0],t],n)}(E,e,t)},E.fitWidth=function(e,t){return function(e,t,n){return ZT(e,(function(n){var i=+t,r=i/(n[1][0]-n[0][0]),s=(i-r*(n[1][0]+n[0][0]))/2,o=-r*n[0][1];e.scale(150*r).translate([s,o])}),n)}(E,e,t)},E.fitHeight=function(e,t){return function(e,t,n){return ZT(e,(function(n){var i=+t,r=i/(n[1][1]-n[0][1]),s=-r*n[0][0],o=(i-r*(n[1][1]+n[0][1]))/2;e.scale(150*r).translate([s,o])}),n)}(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&C,R()}}((function(){return e}))()}function rM(e,t){var n=Ly(t),i=1+Ly(e)*n;return[n*ky(e)/i,ky(t)/i]}function sM(){return iM(rM).scale(250).clipAngle(142)}rM.invert=function(e){return function(t,n){var i=Fy(t*t+n*n),r=e(i),s=ky(r),o=Ly(r);return[Dy(t*s,i*o),Uy(i&&n*s/i)]}}((function(e){return 2*Ny(e)}));const oM=Math.PI,aM=oM/2,lM=180/oM,cM=oM/180,uM=(Math.abs,Math.atan,Math.atan2),hM=Math.cos,dM=(Math.ceil,Math.exp,Math.floor,Math.log,Math.max),pM=Math.min,AM=(Math.pow,Math.sin),fM=Math.sign||function(e){return e>0?1:e<0?-1:0},mM=Math.sqrt;Math.tan;function gM(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vM(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function yM(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function bM(e){var t=mM(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function xM(e){return[uM(e[1],e[0])*lM,(t=dM(-1,pM(1,e[2])),(t>1?aM:t<-1?-aM:Math.asin(t))*lM)];var t}function _M(e){const t=e[0]*cM,n=e[1]*cM,i=hM(n);return[i*hM(t),i*AM(t),AM(n)]}function wM(e){return gM((e=e.map((e=>_M(e))))[0],vM(e[2],e[1]))}function SM(e){const t=function(e){if(e.length<2)return{};let t=0;for(;isNaN(e[t][0]+e[t][1])&&t++<e.length;);const n=function(e){function t(t){return(t=e(t[0]*Ry,t[1]*Ry))[0]*=Cy,t[1]*=Cy,t}return e=ST(e[0]*Ry,e[1]*Ry,e.length>2?e[2]*Ry:0),t.invert=function(t){return(t=e.invert(t[0]*Ry,t[1]*Ry))[0]*=Cy,t[1]*=Cy,t},t}(e[t]),i=sM().translate([0,0]).scale(1).rotate(n.invert([180,0]));e=e.map(i);const r=[];let s=1;for(let d=0,p=e.length;d<p;d++){let t=e[d][0]**2+e[d][1]**2;!isFinite(t)||t>1e32?r.push(d):t>s&&(s=t)}const o=1e6*mM(s);r.forEach((t=>e[t]=[o,0])),e.push([0,o]),e.push([-o,0]),e.push([0,-o]);const a=xT.from(e);a.projection=i;const{triangles:l,halfedges:c,inedges:u}=a,h=[];for(let d=0,p=c.length;d<p;d++)if(c[d]<0){const e=d%3==2?d-2:d+1,n=d%3==0?d+2:d-1,i=c[e],r=c[n];c[i]=r,c[r]=i,c[e]=c[n]=-1,l[d]=l[e]=l[n]=t,u[l[i]]=i%3==0?i+2:i-1,u[l[r]]=r%3==0?r+2:r-1,h.push(Math.min(d,e,n)),d+=2-d%3}else l[d]>e.length-3-1&&(l[d]=t);return a}(e),n=function(e){const{triangles:t}=e;if(!t)return[];const n=[];for(let i=0,r=t.length/3;i<r;i++){const e=t[3*i],r=t[3*i+1],s=t[3*i+2];e!==r&&r!==s&&n.push([e,s,r])}return n}(t),i=function(e,t){const n=new Set;return 2===t.length?[[0,1]]:(e.forEach((e=>{if(e[0]!==e[1]&&!(wM(e.map((e=>t[e])))<0))for(let t,i=0;i<3;i++)t=(i+1)%3,n.add(vw([e[i],e[t]]).join("-"))})),Array.from(n,(e=>e.split("-").map(Number))))}(n,e),r=function(e,t){const n=[];e.forEach((e=>{for(let t=0;t<3;t++){const i=e[t],r=e[(t+1)%3];n[i]=n[i]||[],n[i].push(r)}})),0===e.length&&(2===t?(n[0]=[1],n[1]=[0]):1===t&&(n[0]=[]));return n}(n,e.length),s=function(e,t){function n(e,t){let n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}return function(i,r,s){void 0===s&&(s=0);let o,a,l=s;const c=_M([i,r]);do{o=s,s=null,a=n(c,_M(t[o])),e[o].forEach((e=>{let i=n(c,_M(t[e]));if(i<a)return a=i,s=e,void(l=e)}))}while(null!==s);return l}}(r,e),o=function(e,t){return e.map((e=>{const n=e.map((e=>t[e])).map(_M);return xM(bM(yM(yM(vM(n[1],n[0]),vM(n[2],n[1])),vM(n[0],n[2]))))}))}(n,e),{polygons:a,centers:l}=function(e,t,n){const i=[],r=e.slice();if(0===t.length){if(n.length<2)return{polygons:i,centers:r};if(2===n.length){const e=_M(n[0]),t=_M(n[1]),s=bM(yM(e,t)),a=bM(vM(e,t)),l=vM(s,a),c=[s,vM(s,l),vM(vM(s,l),l),vM(vM(vM(s,l),l),l)].map(xM).map(o);return i.push(c),i.push(c.slice().reverse()),{polygons:i,centers:r}}}t.forEach(((e,t)=>{for(let n=0;n<3;n++){const r=e[n],s=e[(n+1)%3],o=e[(n+2)%3];i[r]=i[r]||[],i[r].push([s,o,t,[r,s,o]])}}));const s=i.map((e=>{const t=[e[0][2]];let i=e[0][1];for(let n=1;n<e.length;n++)for(let r=0;r<e.length;r++)if(e[r][0]==i){i=e[r][1],t.push(e[r][2]);break}if(t.length>2)return t;if(2==t.length){const i=TM(n[e[0][3][0]],n[e[0][3][1]],r[t[0]]),s=TM(n[e[0][3][2]],n[e[0][3][0]],r[t[0]]),a=o(i),l=o(s);return[t[0],l,t[1],a]}}));function o(e){let n=-1;return r.slice(t.length,1/0).forEach(((i,r)=>{i[0]===e[0]&&i[1]===e[1]&&(n=r+t.length)})),n<0&&(n=r.length,r.push(e)),n}return{polygons:s,centers:r}}(o,n,e),c=function(e){const t=[];return e.forEach((e=>{if(!e)return;let n=e[e.length-1];for(let i of e)i>n&&t.push([n,i]),n=i})),t}(a),u=function(e,t){const n=new Set,i=[];e.map((e=>{if(!(wM(e.map((e=>t[e>t.length?0:e])))>1e-12))for(let t=0;t<3;t++){let i=[e[t],e[(t+1)%3]],r="".concat(i[0],"-").concat(i[1]);n.has(r)?n.delete(r):n.add("".concat(i[1],"-").concat(i[0]))}}));const r=new Map;let s;if(n.forEach((e=>{e=e.split("-").map(Number),r.set(e[0],e[1]),s=e[0]})),void 0===s)return i;let o=s;do{i.push(o);let e=r.get(o);r.set(o,-1),o=e}while(o>-1&&o!==s);return i}(n,e),h=function(e,t){return function(n){const i=new Map,r=new Map;return e.forEach(((e,t)=>{const s=e.join("-");i.set(s,n[t]),r.set(s,!0)})),t.forEach((e=>{let t=0,n=-1;for(let r=0;r<3;r++){let s=vw([e[r],e[(r+1)%3]]).join("-");i.get(s)>t&&(t=i.get(s),n=s)}r.set(n,!1)})),e.map((e=>r.get(e.join("-"))))}}(i,n);return{delaunay:t,edges:i,triangles:n,centers:l,neighbors:r,polygons:a,mesh:c,hull:u,urquhart:h,find:s}}function TM(e,t,n){e=_M(e),t=_M(t),n=_M(n);const i=fM(gM(vM(t,e),n));return xM(bM(yM(e,t)).map((e=>i*e)))}function MM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function EM(e,t,n){return t=CM(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,RM()?Reflect.construct(t,[],CM(e).constructor):t.apply(e,n))}function CM(e){return CM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},CM(e)}function RM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(RM=function(){return!!e})()}function PM(e,t){return PM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},PM(e,t)}function NM(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t);else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||LM(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DM(e){return function(e){if(Array.isArray(e))return MM(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||LM(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LM(e,t){if(e){if("string"==typeof e)return MM(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MM(e,t):void 0}}function IM(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).resolution,n=void 0===t?1/0:t,i=function(e,t){return e.map((function(e){var n,i=[];return e.forEach((function(e){if(n){var r=180*rb(e,n)/Math.PI;if(r>t)for(var s=sb(n,e),o=1/Math.ceil(r/t),a=o;a<1;)i.push(s(a)),a+=o}i.push(n=e)})),i}))}(e,n),r=gw(i),s=function(e,t){var n={type:"Polygon",coordinates:e},i=ES(n),r=NM(i,2),s=NM(r[0],2),o=s[0],a=s[1],l=NM(r[1],2),c=l[0],u=l[1];if(Math.min(Math.abs(c-o),Math.abs(u-a))<t)return[];var h=o>c||u>=89||a<=-89;return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minLng,i=t.maxLng,r=t.minLat,s=t.maxLat,o=Math.round(Math.pow(360/e,2)/Math.PI),a=(1+Math.sqrt(5))/2,l=function(e){return e/a*360%360-180},c=function(e){return Math.acos(2*e/o-1)/Math.PI*180-90},u=function(e){return o*(Math.cos((e+90)*Math.PI/180)+1)/2},h=[void 0!==s?Math.ceil(u(s)):0,void 0!==r?Math.floor(u(r)):o-1],d=void 0===n&&void 0===i?function(){return!0}:void 0===n?function(e){return e<=i}:void 0===i?function(e){return e>=n}:i>=n?function(e){return e>=n&&e<=i}:function(e){return e>=n||e<=i},p=[],A=h[0];A<=h[1];A++){var f=l(A);d(f)&&p.push([f,c(A)])}return p}(t,{minLng:o,maxLng:c,minLat:a,maxLat:u}).filter((function(e){return OM(e,n,h)}))}(e,n),o=[].concat(DM(r),DM(s)),a={type:"Polygon",coordinates:e},l=NM(ES(a),2),c=NM(l[0],2),u=c[0],h=c[1],d=NM(l[1],2),p=d[0],A=d[1],f=u>p||A>=89||h<=-89,m=[];if(f){var g=function(e){const t=function(e){if(t.delaunay=null,t._data=e,"object"===typeof t._data&&"FeatureCollection"===t._data.type&&(t._data=t._data.features),"object"===typeof t._data){const e=t._data.map((e=>[t._vx(e),t._vy(e),e])).filter((e=>isFinite(e[0]+e[1])));t.points=e.map((e=>[e[0],e[1]])),t.valid=e.map((e=>e[2])),t.delaunay=SM(t.points)}return t};return t._vx=function(e){return"object"==typeof e&&"type"in e?hT(e)[0]:0 in e?e[0]:void 0},t._vy=function(e){return"object"==typeof e&&"type"in e?hT(e)[1]:1 in e?e[1]:void 0},t.x=function(e){return e?(t._vx=e,t):t._vx},t.y=function(e){return e?(t._vy=e,t):t._vy},t.polygons=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;const n={type:"FeatureCollection",features:[]};return 0===t.valid.length||(t.delaunay.polygons.forEach(((e,i)=>n.features.push({type:"Feature",geometry:e?{type:"Polygon",coordinates:[[...e,e[0]].map((e=>t.delaunay.centers[e]))]}:null,properties:{site:t.valid[i],sitecoordinates:t.points[i],neighbours:t.delaunay.neighbors[i]}}))),1===t.valid.length&&n.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:t.valid[0],sitecoordinates:t.points[0],neighbours:[]}})),n},t.triangles=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"FeatureCollection",features:t.delaunay.triangles.map(((e,n)=>((e=e.map((e=>t.points[e]))).center=t.delaunay.centers[n],e))).filter((e=>wM(e)>0)).map((e=>({type:"Feature",properties:{circumcenter:e.center},geometry:{type:"Polygon",coordinates:[[...e,e[0]]]}})))}},t.links=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;const n=t.delaunay.edges.map((e=>rb(t.points[e[0]],t.points[e[1]]))),i=t.delaunay.urquhart(n);return{type:"FeatureCollection",features:t.delaunay.edges.map(((e,r)=>({type:"Feature",properties:{source:t.valid[e[0]],target:t.valid[e[1]],length:n[r],urquhart:!!i[r]},geometry:{type:"LineString",coordinates:[t.points[e[0]],t.points[e[1]]]}})))}},t.mesh=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"MultiLineString",coordinates:t.delaunay.edges.map((e=>[t.points[e[0]],t.points[e[1]]]))}},t.cellMesh=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;const{centers:n,polygons:i}=t.delaunay,r=[];for(const t of i)if(t)for(let e=t.length,i=t[e-1],s=t[0],o=0;o<e;i=s,s=t[++o])s>i&&r.push([n[i],n[s]]);return{type:"MultiLineString",coordinates:r}},t._found=void 0,t.find=function(e,n,i){if(t._found=t.delaunay.find(e,n,t._found),!i||rb([e,n],t.points[t._found])<i)return t._found},t.hull=function(e){void 0!==e&&t(e);const n=t.delaunay.hull,i=t.points;return 0===n.length?null:{type:"Polygon",coordinates:[[...n.map((e=>i[e])),i[n[0]]]]}},e?t(e):t}(o).triangles(),v=new Map(o.map((function(e,t){var n=NM(e,2),i=n[0],r=n[1];return["".concat(i,"-").concat(r),t]})));g.features.forEach((function(e){var t,n=e.geometry.coordinates[0].slice(0,3).reverse(),i=[];if(n.forEach((function(e){var t=NM(e,2),n=t[0],r=t[1],s="".concat(n,"-").concat(r);v.has(s)&&i.push(v.get(s))})),3===i.length){if(i.some((function(e){return e<r.length})))if(!OM(e.properties.circumcenter,a,f))return;(t=m).push.apply(t,i)}}))}else if(s.length)for(var y=Pw.from(o),b=function(e){var t,n=[2,1,0].map((function(t){return y.triangles[e+t]})),i=n.map((function(e){return o[e]}));if(n.some((function(e){return e<r.length}))){var s=[0,1].map((function(e){return function(e,t){let n=0,i=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)null!=(s=t(s,++r,e))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}(i,(function(t){return t[e]}))}));if(!OM(s,a,f))return 1}(t=m).push.apply(t,DM(n))},x=0,_=y.triangles.length;x<_;x+=3)b(x);else{var w=by(i),S=w.vertices,T=w.holes;m=Yv(S,void 0===T?[]:T,2)}var M=fw(vw(o,(function(e){return e[0]})),[0,1]),E=fw(vw(o,(function(e){return e[1]})),[0,1]),C=o.map((function(e){var t=NM(e,2),n=t[0],i=t[1];return[M(n),E(i)]}));return{contour:i,triangles:{points:o,indices:m,uvs:C}}}function OM(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?function(e,t){return(e&&WS.hasOwnProperty(e.type)?WS[e.type]:YS)(e,t)}(t,e):tS(e,t)}var kM=window.THREE?window.THREE:{BufferGeometry:nd,Float32BufferAttribute:Yh},BM=(new kM.BufferGeometry).setAttribute?"setAttribute":"addAttribute",FM=function(e){function t(e,n,i,r,s,o,a){var l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(l=EM(this,t)).type="ConicPolygonBufferGeometry",l.parameters={polygonGeoJson:e,startHeight:n,endHeight:i,closedBottom:r,closedTop:s,includeSides:o,curvatureResolution:a},n=n||0,i=i||1,r=void 0===r||r,s=void 0===s||s,o=void 0===o||o;var c=IM(e,{resolution:a=a||5}),u=c.contour,h=c.triangles,d=gw(h.uvs),p=[],A=[],f=[],m=0,g=function(e){var t=Math.round(p.length/3),n=f.length;p=p.concat(e.vertices),A=A.concat(e.uvs),f=f.concat(t?e.indices.map((function(e){return e+t})):e.indices),l.addGroup(n,f.length-n,m++)};function v(e,t){var n=e.map((function(e){return e.map((function(e){var n=NM(e,2),i=n[0];return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=(90-e)*Math.PI/180,r=(90-t)*Math.PI/180;return[n*Math.sin(i)*Math.cos(r),n*Math.cos(i),n*Math.sin(i)*Math.sin(r)]}(n[1],i,t)}))}));return by(n)}function y(e){return{indices:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?h.indices:h.indices.slice().reverse(),vertices:v([h.points],e).vertices,uvs:d}}return o&&g(function(){for(var e=v(u,n),t=e.vertices,r=e.holes,s=v(u,i).vertices,o=gw([s,t]),a=Math.round(s.length/3),l=new Set(r),c=0,h=[],d=0;d<a;d++){var p=d+1;if(p===a)p=c;else if(l.has(p)){var A=p;p=c,c=A}h.push(d,d+a,p+a),h.push(p+a,p,d)}for(var f=[],m=1;m>=0;m--)for(var g=0;g<a;g+=1)f.push(g/(a-1),m);return{indices:h,vertices:o,uvs:f}}()),r&&g(y(n,!1)),s&&g(y(i,!0)),l.setIndex(f),l[BM]("position",new kM.Float32BufferAttribute(p,3)),l[BM]("uv",new kM.Float32BufferAttribute(A,2)),l.computeVertexNormals(),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PM(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(kM.BufferGeometry);var UM=function(e){var t,n="undefined"!==typeof(e=e||{})?e:{},i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);var r,s=[],o="";"undefined"!==typeof document&&document.currentScript&&(o=document.currentScript.src),o=0!==o.indexOf("blob:")?o.substr(0,o.lastIndexOf("/")+1):"",r=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status||0==i.status&&i.response)t(i.response);else{var r=Y(e);r?t(r.buffer):n()}},i.onerror=n,i.send(null)};var a=n.print||console.log.bind(console),l=n.printErr||console.warn.bind(console);for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);i=null,n.arguments&&(s=n.arguments);var c=0;var u=!1;function h(e){var t,i=n["_"+e];return t="Cannot call unknown function "+e+", make sure it is exported",i||le("Assertion failed: "+t),i}function d(e,t,n,i,r){var s={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,i){if(!(i>0))return 0;for(var r=n,s=n+i-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(a<=127){if(n>=s)break;t[n++]=a}else if(a<=2047){if(n+1>=s)break;t[n++]=192|a>>6,t[n++]=128|63&a}else if(a<=65535){if(n+2>=s)break;t[n++]=224|a>>12,t[n++]=128|a>>6&63,t[n++]=128|63&a}else{if(n+3>=s)break;t[n++]=240|a>>18,t[n++]=128|a>>12&63,t[n++]=128|a>>6&63,t[n++]=128|63&a}}t[n]=0})(e,g,t,n)})(e,t=ee(n),n)}return t},array:function(e){var t=ee(e.length);return function(e,t){m.set(e,t)}(e,t),t}};var o=h(e),a=[],l=0;if(i)for(var c=0;c<i.length;c++){var u=s[n[c]];u?(0===l&&(l=ne()),a[c]=u(i[c])):a[c]=i[c]}var d=o.apply(null,a);return d=function(e){return"string"===t?A(e):"boolean"===t?Boolean(e):e}(d),0!==l&&te(l),d}var p="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function A(e,t){return e?function(e,t,n){for(var i=t+n,r=t;e[r]&&!(r>=i);)++r;if(r-t>16&&e.subarray&&p)return p.decode(e.subarray(t,r));for(var s="";t<r;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|l:(7&o)<<18|a<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}(g,e,t):""}var f,m,g,v,y,b,x;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function _(e,t){return e%t>0&&(e+=t-e%t),e}function w(e){f=e,n.HEAP8=m=new Int8Array(e),n.HEAP16=v=new Int16Array(e),n.HEAP32=y=new Int32Array(e),n.HEAPU8=g=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=b=new Float32Array(e),n.HEAPF64=x=new Float64Array(e)}var S=n.TOTAL_MEMORY||33554432;function T(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?n.dynCall_v(i):n.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t()}}S=(f=n.buffer?n.buffer:new ArrayBuffer(S)).byteLength,w(f),y[6032]=5267040;var M=[],E=[],C=[],R=[];var P=Math.abs,N=Math.ceil,D=Math.floor,L=Math.min,I=0,O=null,k=null;n.preloadedImages={},n.preloadedAudios={};var B,F,U=null,z="data:application/octet-stream;base64,";function q(e){return String.prototype.startsWith?e.startsWith(z):0===e.indexOf(z)}U="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";function V(e){return e}function G(e){return e.replace(/\b__Z[\w\d_]+/g,(function(e){return e===e?e:e+" ["+e+"]"}))}function j(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function H(){return m.length}function W(e){try{var t=new ArrayBuffer(e);if(t.byteLength!=e)return;return new Int8Array(t).set(m),$(t),w(t),1}catch(n){}}var X="function"===typeof atob?atob:function(e){var t,n,i,r,s,o,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=a.indexOf(e.charAt(c++))<<2|(r=a.indexOf(e.charAt(c++)))>>4,n=(15&r)<<4|(s=a.indexOf(e.charAt(c++)))>>2,i=(3&s)<<6|(o=a.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==s&&(l+=String.fromCharCode(n)),64!==o&&(l+=String.fromCharCode(i))}while(c<e.length);return l};function Y(e){if(q(e))return function(e){try{for(var t=X(e),n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}catch(r){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(z.length))}var Q,K,Z={a:le,b:function(e){c=e},c:function(){return c},d:function(e,t,n,i){le("Assertion failed: "+A(e)+", at: "+[t?A(t):"unknown filename",n,i?A(i):"unknown function"])},e:function(e){return n.___errno_location&&(y[n.___errno_location()>>2]=e),e},f:H,g:function(e,t,n){g.set(g.subarray(t,t+n),e)},h:function(e){var t=H(),n=16777216,i=2130706432;if(e>i)return!1;for(var r=Math.max(t,16777216);r<e;)r=r<=536870912?_(2*r,n):Math.min(_((3*r+2147483648)/4,n),i);return!!W(r)},i:function(e){le("OOM")},j:V,k:G,l:W,m:j,n:function(){var e=j();return n.extraStackTrace&&(e+="\n"+n.extraStackTrace()),G(e)},o:24144,p:24128},J=function(e,t,n){var i=new e.Int8Array(n),r=new e.Int32Array(n),s=(new e.Uint8Array(n),new e.Float32Array(n),new e.Float64Array(n)),o=0|t.o,a=0|t.p,l=e.Math.floor,c=e.Math.abs,u=e.Math.sqrt,h=e.Math.pow,d=e.Math.cos,p=e.Math.sin,A=e.Math.tan,f=e.Math.acos,m=e.Math.asin,g=e.Math.atan,v=e.Math.atan2,y=e.Math.ceil,b=e.Math.imul,x=e.Math.min,_=e.Math.max,w=e.Math.clz32,S=t.b,T=t.c,M=t.d,E=t.e,C=t.f,R=t.g,P=t.h,N=t.i,D=24160;function L(e,t,n,i){return 0|I(e|=0,t|=0,n|=0,i|=0,0)}function I(e,t,n,i,s){var o,a=0,l=0,c=0,u=0;if(o=D,D=D+16|0,l=o,!(0|O(e|=0,t|=0,n|=0,i|=0,s|=0)))return D=o,0|(i=0);do{if((0|n)>=0){if((0|n)>13780509){if(0|(a=0|tt(15,l)))break;l=0|r[(c=l)>>2],c=0|r[c+4>>2]}else u=0|Bt(0|n,0|(a=((0|n)<0)<<31>>31),3,0),c=0|T(),a=0|Dt(0|n,0|a,1,0),a=0|Dt(0|(a=0|Bt(0|u,0|c,0|a,0|T())),0|T(),1,0),c=0|T(),r[l>>2]=a,r[l+4>>2]=c,l=a;if(Xt(0|i,0,l<<3),0|s){Xt(0|s,0,l<<2),a=0|k(e,t,n,i,s,l,c,0);break}(a=0|Nt(l,4))?(u=0|k(e,t,n,i,a,l,c,0),Pt(a),a=u):a=13}else a=2}while(0);return D=o,0|(u=a)}function O(e,t,n,i,s){e|=0,t|=0,n|=0,i|=0,s|=0;var o,a,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0;if(a=D,D=D+16|0,m=a+8|0,r[(f=o=a)>>2]=e,r[f+4>>2]=t,(0|n)<0)return D=a,0|(m=2);if(r[(l=i)>>2]=e,r[l+4>>2]=t,(l=0!=(0|s))&&(r[s>>2]=0),0|Be(e,t))return D=a,0|(m=9);r[m>>2]=0;e:do{if((0|n)>=1)if(l)for(p=1,d=0,A=0,f=1,l=e;;){if(!(d|A)){if(0|(l=0|B(l,t,4,m,o)))break e;if(0|Be(l=0|r[(t=o)>>2],t=0|r[t+4>>2])){l=9;break e}}if(0|(l=0|B(l,t,0|r[22384+(A<<2)>>2],m,o)))break e;if(l=0|r[(t=o)>>2],t=0|r[t+4>>2],r[(e=i+(p<<3)|0)>>2]=l,r[e+4>>2]=t,r[s+(p<<2)>>2]=f,c=(0|(e=d+1|0))==(0|f),h=6==(0|(u=A+1|0)),0|Be(l,t)){l=9;break e}if((0|(f=f+(h&c&1)|0))>(0|n)){l=0;break}p=p+1|0,d=c?0:e,A=c?h?0:u:A}else for(p=1,d=0,A=0,f=1,l=e;;){if(!(d|A)){if(0|(l=0|B(l,t,4,m,o)))break e;if(0|Be(l=0|r[(t=o)>>2],t=0|r[t+4>>2])){l=9;break e}}if(0|(l=0|B(l,t,0|r[22384+(A<<2)>>2],m,o)))break e;if(l=0|r[(t=o)>>2],t=0|r[t+4>>2],r[(e=i+(p<<3)|0)>>2]=l,r[e+4>>2]=t,c=(0|(e=d+1|0))==(0|f),h=6==(0|(u=A+1|0)),0|Be(l,t)){l=9;break e}if((0|(f=f+(h&c&1)|0))>(0|n)){l=0;break}p=p+1|0,d=c?0:e,A=c?h?0:u:A}else l=0}while(0);return D=a,0|(m=l)}function k(e,t,n,i,s,o,a,l){n|=0,i|=0,s|=0,l|=0;var c,u,h,d=0,p=0,A=0,f=0,m=0,g=0,v=0;if(h=D,D=D+16|0,c=h+8|0,u=h,d=0|Ut(0|(e|=0),0|(t|=0),0|(o|=0),0|(a|=0)),A=0|T(),!(0==(0|(v=0|r[(g=f=i+(d<<3)|0)>>2]))&0==(0|(g=0|r[g+4>>2]))|(p=(0|v)==(0|e)&(0|g)==(0|t))))do{d=0|Ft(0|(d=0|Dt(0|d,0|A,1,0)),0|T(),0|o,0|a),A=0|T(),p=(0|(g=0|r[(v=f=i+(d<<3)|0)>>2]))==(0|e)&(0|(v=0|r[v+4>>2]))==(0|t)}while(!(0==(0|g)&0==(0|v)|p));if(d=s+(d<<2)|0,p&&(0|r[d>>2])<=(0|l))return D=h,0|(v=0);if(r[(v=f)>>2]=e,r[v+4>>2]=t,r[d>>2]=l,(0|l)>=(0|n))return D=h,0|(v=0);switch(p=l+1|0,r[c>>2]=0,0|(d=0|B(e,t,2,c,u))){case 9:m=9;break;case 0:(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p))||(m=9)}e:do{if(9==(0|m)){switch(r[c>>2]=0,0|(d=0|B(e,t,3,c,u))){case 9:break;case 0:if(0|(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p)))break e;break;default:break e}switch(r[c>>2]=0,0|(d=0|B(e,t,1,c,u))){case 9:break;case 0:if(0|(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p)))break e;break;default:break e}switch(r[c>>2]=0,0|(d=0|B(e,t,5,c,u))){case 9:break;case 0:if(0|(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p)))break e;break;default:break e}switch(r[c>>2]=0,0|(d=0|B(e,t,4,c,u))){case 9:break;case 0:if(0|(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p)))break e;break;default:break e}switch(r[c>>2]=0,0|(d=0|B(e,t,6,c,u))){case 9:break;case 0:if(0|(d=0|k(0|r[(d=u)>>2],0|r[d+4>>2],n,i,s,o,a,p)))break e;break;default:break e}return D=h,0|(v=0)}}while(0);return D=h,0|(v=d)}function B(e,t,n,i,s){e|=0,t|=0,s|=0;var o,a,l=0,c=0,u=0,h=0,d=0,p=0,A=0;if((n|=0)>>>0>6)return 0|(s=1);if(d=(0|r[(i|=0)>>2])%6|0,r[i>>2]=d,(0|d)>0){l=0;do{n=0|Ae(n),l=l+1|0}while((0|l)<(0|r[i>>2]))}if(d=0|qt(0|e,0|t,45),T(),(a=127&d)>>>0>121)return 0|(s=5);o=0|Fe(e,t),l=0|qt(0|e,0|t,52),T(),l&=15;e:do{if(l){for(;;){if(u=0|qt(0|e,0|t,0|(c=3*(15-l|0)|0)),T(),7==(0|(u&=7))){t=5;break}if(A=0==(0|Ge(l)),l=l+-1|0,p=0|Vt(7,0,0|c),t&=~T(),e=0|Vt(0|r[(A?432:16)+(28*u|0)+(n<<2)>>2],0,0|c)|e&~p,t|=c=0|T(),!(n=0|r[(A?640:224)+(28*u|0)+(n<<2)>>2])){n=0;break e}if(!l){h=8;break e}}return 0|t}h=8}while(0);8==(0|h)&&(e|=0|Vt(0|(A=0|r[848+(28*a|0)+(n<<2)>>2]),0,45),t=T()|-1040385&t,n=0|r[4272+(28*a|0)+(n<<2)>>2],127==(127&A)&&(A=0|Vt(0|r[848+(28*a|0)+20>>2],0,45),t=T()|-1040385&t,n=0|r[4272+(28*a|0)+20>>2],e=0|ze(A|e,t),t=0|T(),r[i>>2]=1+(0|r[i>>2]))),u=0|qt(0|e,0|t,45),T(),u&=127;e:do{if(0|z(u)){t:do{if(1==(0|Fe(e,t))){if((0|a)!=(0|u)){if(0|j(u,0|r[7696+(28*a|0)>>2])){e=0|Ve(e,t),c=1,t=0|T();break}M(23313,22416,436,22424)}switch(0|o){case 3:e=0|ze(e,t),t=0|T(),r[i>>2]=1+(0|r[i>>2]),c=0;break t;case 5:e=0|Ve(e,t),t=0|T(),r[i>>2]=5+(0|r[i>>2]),c=0;break t;case 0:return 0|(A=9);default:return 0|(A=1)}}else c=0}while(0);if((0|n)>0){l=0;do{e=0|Ue(e,t),t=0|T(),l=l+1|0}while((0|l)!=(0|n))}if((0|a)!=(0|u)){if(!(0|q(u))){if(0!=(0|c)|5!=(0|Fe(e,t)))break;r[i>>2]=1+(0|r[i>>2]);break}switch(127&d){case 8:case 118:break e}3!=(0|Fe(e,t))&&(r[i>>2]=1+(0|r[i>>2]))}}else if((0|n)>0){l=0;do{e=0|ze(e,t),t=0|T(),l=l+1|0}while((0|l)!=(0|n))}}while(0);return r[i>>2]=((0|r[i>>2])+n|0)%6|0,r[(A=s)>>2]=e,r[A+4>>2]=t,0|(A=0)}function F(e,t,n,i){n|=0,i|=0;var s,o,a,l=0,c=0;for(a=D,D=D+16|0,s=a,o=a+8|0,l=(l=0==(0|Be(e|=0,t|=0)))?1:2;;){if(r[o>>2]=0,0==(0|B(e,t,l,o,s))&((0|r[(c=s)>>2])==(0|n)?(0|r[c+4>>2])==(0|i):0)){e=4;break}if((l=l+1|0)>>>0>=7){l=7,e=4;break}}return 4==(0|e)?(D=a,0|l):0}function U(e,t,n,i,o,a,l){t|=0,n|=0,i|=0,o|=0,a|=0,l|=0;var c,u,h,d,p,A,f,m,g,v,y=0,b=0,x=0,_=0,w=0,S=0,M=0,E=0,C=0,R=0,P=0,N=0,L=0,I=0,O=0,k=0,B=0,F=0,U=0;if(v=D,D=D+64|0,f=v+48|0,m=v+32|0,g=v+24|0,c=v+8|0,u=v,(0|(b=0|r[(e|=0)>>2]))<=0)return D=v,0|(O=0);for(h=e+4|0,d=f+8|0,p=m+8|0,A=c+8|0,y=0,L=0;;){N=(x=0|r[h>>2])+(L<<4)|0,r[f>>2]=r[N>>2],r[f+4>>2]=r[N+4>>2],r[f+8>>2]=r[N+8>>2],r[f+12>>2]=r[N+12>>2],(0|L)==(b+-1|0)?(r[m>>2]=r[x>>2],r[m+4>>2]=r[x+4>>2],r[m+8>>2]=r[x+8>>2],r[m+12>>2]=r[x+12>>2]):(N=x+(L+1<<4)|0,r[m>>2]=r[N>>2],r[m+4>>2]=r[N+4>>2],r[m+8>>2]=r[N+8>>2],r[m+12>>2]=r[N+12>>2]),b=0|K(f,m,i,g);e:do{if(b)x=0,y=b;else if(b=0|r[(x=g)>>2],(0|(x=0|r[x+4>>2]))>0|0==(0|x)&b>>>0>0){P=0,N=0;t:for(;;){if(U=+s[f>>3],F=+((R=0|Lt(0|b,0|x,0|P,0|N))>>>0)+4294967296*+(0|T()),k=+(b>>>0)+4294967296*+(0|x),B=+(P>>>0)+4294967296*+(0|N),s[c>>3]=U*F/k+ +s[m>>3]*B/k,s[A>>3]=+s[d>>3]*F/k+ +s[p>>3]*B/k,0|(b=0|je(c,i,u))){y=b;break}S=0|Ut(0|(C=0|r[(R=u)>>2]),0|(R=0|r[R+4>>2]),0|t,0|n),_=0|T(),x=0|r[(w=b=l+(S<<3)|0)>>2],w=0|r[w+4>>2];n:do{if(0==(0|x)&0==(0|w))I=b,O=16;else for(M=0,E=0;;){if((0|M)>(0|n)|(0|M)==(0|n)&E>>>0>t>>>0){y=1;break t}if((0|x)==(0|C)&(0|w)==(0|R))break n;if(S=0|Ft(0|(b=0|Dt(0|S,0|_,1,0)),0|T(),0|t,0|n),_=0|T(),E=0|Dt(0|E,0|M,1,0),M=0|T(),0==(0|(x=0|r[(w=b=l+(S<<3)|0)>>2]))&0==(0|(w=0|r[w+4>>2]))){I=b,O=16;break}}}while(0);if(16!=(0|O)||(O=0,0==(0|C)&0==(0|R))||(r[(E=I)>>2]=C,r[E+4>>2]=R,E=a+(r[o>>2]<<3)|0,r[E>>2]=C,r[E+4>>2]=R,E=0|Dt(0|r[(E=o)>>2],0|r[E+4>>2],1,0),C=0|T(),r[(R=o)>>2]=E,r[R+4>>2]=C),P=0|Dt(0|P,0|N,1,0),N=0|T(),b=0|r[(x=g)>>2],!((0|(x=0|r[x+4>>2]))>(0|N)|(0|x)==(0|N)&b>>>0>P>>>0)){x=1;break e}}x=0}else x=1}while(0);if(L=L+1|0,!x){O=21;break}if((0|L)>=(0|(b=0|r[e>>2]))){y=0,O=21;break}}return 21==(0|O)?(D=v,0|y):0}function z(e){return(e|=0)>>>0>121?0|(e=0):0|(e=0|r[7696+(28*e|0)+16>>2])}function q(e){return 4==(0|(e|=0))|117==(0|e)}function V(e){return 0|r[11120+(216*(0|r[(e|=0)>>2])|0)+(72*(0|r[e+4>>2])|0)+(24*(0|r[e+8>>2])|0)+(r[e+12>>2]<<3)>>2]}function G(e){return 0|r[11120+(216*(0|r[(e|=0)>>2])|0)+(72*(0|r[e+4>>2])|0)+(24*(0|r[e+8>>2])|0)+(r[e+12>>2]<<3)+4>>2]}function j(e,t){return t|=0,(0|r[7696+(28*(e|=0)|0)+20>>2])==(0|t)?0|(t=1):0|(t=(0|r[7696+(28*e|0)+24>>2])==(0|t))}function H(e,t){return 0|r[848+(28*(e|=0)|0)+((t|=0)<<2)>>2]}function W(e,t){return t|=0,(0|r[848+(28*(e|=0)|0)>>2])==(0|t)?0|(t=0):(0|r[848+(28*e|0)+4>>2])==(0|t)?0|(t=1):(0|r[848+(28*e|0)+8>>2])==(0|t)?0|(t=2):(0|r[848+(28*e|0)+12>>2])==(0|t)?0|(t=3):(0|r[848+(28*e|0)+16>>2])==(0|t)?0|(t=4):(0|r[848+(28*e|0)+20>>2])==(0|t)?0|(t=5):0|((0|r[848+(28*e|0)+24>>2])==(0|t)?6:7)}function X(e){return+s[(e|=0)+16>>3]<+s[e+24>>3]|0}function Y(e,t){e|=0;var n,i,r=0;return(r=+s[(t|=0)>>3])>=+s[e+8>>3]&&r<=+s[e>>3]?(n=+s[e+16>>3],r=+s[e+24>>3],t=(i=+s[t+8>>3])>=r,e=i<=n&1,n<r?t&&(e=1):t||(e=0),0|(t=0!=(0|e))):0|(t=0)}function Q(e,t,n){e|=0,t|=0,n|=0;var i,a,u,h,d,p,A,f=0,m=0,g=0,v=0,b=0,_=0,w=0;p=D,D=D+288|0,d=p+264|0,v=p+96|0,m=(f=g=p)+96|0;do{r[f>>2]=0,f=f+4|0}while((0|f)<(0|m));return 0|(t=0|Qe(t,g))?(D=p,0|(_=t)):(Xe(g=0|r[(m=g)>>2],m=0|r[m+4>>2],d),Ye(g,m,v),h=+et(d,v+8|0),s[d>>3]=+s[e>>3],s[(m=d+8|0)>>3]=+s[e+16>>3],s[v>>3]=+s[e+8>>3],s[(g=v+8|0)>>3]=+s[e+24>>3],a=+et(d,v),w=+s[m>>3]-+s[g>>3],u=+c(+w),A=+s[d>>3]-+s[v>>3],i=+c(+A),0==w|0==A||(w=+Gt(+u,+i),w=+y(+a*a/+jt(+w/+jt(+u,+i),3)/(h*(2.59807621135*h)*.8)),s[o>>3]=w,b=~~w>>>0,_=+c(w)>=1?w>0?~~+x(+l(w/4294967296),4294967295)>>>0:~~+y((w-+(~~w>>>0))/4294967296)>>>0:0,2146435072==(2146435072&r[o+4>>2]))?t=1:(v=0==(0|b)&0==(0|_),r[(t=n)>>2]=v?1:b,r[t+4>>2]=v?0:_,t=0),D=p,0|(_=t))}function K(e,t,n,i){e|=0,t|=0,n|=0,i|=0;var a,u,h,d,p=0,A=0,f=0;d=D,D=D+288|0,u=d+264|0,h=d+96|0,a=(p=A=d)+96|0;do{r[p>>2]=0,p=p+4|0}while((0|p)<(0|a));return 0|(n=0|Qe(n,A))?(D=d,0|(i=n)):(Xe(p=0|r[(n=A)>>2],n=0|r[n+4>>2],u),Ye(p,n,h),f=+et(u,h+8|0),f=+y(+ +et(e,t)/(2*f)),s[o>>3]=f,n=~~f>>>0,p=+c(f)>=1?f>0?~~+x(+l(f/4294967296),4294967295)>>>0:~~+y((f-+(~~f>>>0))/4294967296)>>>0:0,2146435072==(2146435072&r[o+4>>2])?(D=d,0|(i=1)):(A=0==(0|n)&0==(0|p),r[i>>2]=A?1:n,r[i+4>>2]=A?0:p,D=d,0|(i=0)))}function Z(e,t,n,i){t|=0,n|=0,i|=0,r[(e|=0)>>2]=t,r[e+4>>2]=n,r[e+8>>2]=i}function J(e,t){e|=0;var n,i,o,a,l=0,u=0,h=0,d=0,p=0,A=0,f=0;r[(a=(t|=0)+8|0)>>2]=0,i=+s[e>>3],d=+c(+i),o=+s[e+8>>3],d+=.5*(p=+c(+o)/.8660254037844386),d-=+(0|(l=~~d)),p-=+(0|(e=~~p));do{if(d<.5){if(d<.3333333333333333){if(r[t>>2]=l,p<.5*(d+1)){r[t+4>>2]=e;break}e=e+1|0,r[t+4>>2]=e;break}if(e=(1&!(p<(f=1-d)))+e|0,r[t+4>>2]=e,f<=p&p<2*d){l=l+1|0,r[t>>2]=l;break}r[t>>2]=l;break}if(!(d<.6666666666666666)){if(l=l+1|0,r[t>>2]=l,p<.5*d){r[t+4>>2]=e;break}e=e+1|0,r[t+4>>2]=e;break}if(p<1-d){if(r[t+4>>2]=e,2*d-1<p){r[t>>2]=l;break}}else e=e+1|0,r[t+4>>2]=e;l=l+1|0,r[t>>2]=l}while(0);do{if(i<0){if(1&e){l=~~(+(0|l)-(2*(+((A=0|Lt(0|l,((0|l)<0)<<31>>31,0|(A=(e+1|0)/2|0),((0|A)<0)<<31>>31))>>>0)+4294967296*+(0|T()))+1)),r[t>>2]=l;break}l=~~(+(0|l)-2*(+((A=0|Lt(0|l,((0|l)<0)<<31>>31,0|(A=(0|e)/2|0),((0|A)<0)<<31>>31))>>>0)+4294967296*+(0|T()))),r[t>>2]=l;break}}while(0);A=t+4|0,o<0&&(l=l-((1|e<<1)/2|0)|0,r[t>>2]=l,e=0-e|0,r[A>>2]=e),u=e-l|0,(0|l)<0?(h=0-l|0,r[A>>2]=u,r[a>>2]=h,r[t>>2]=0,e=u,l=0):h=0,(0|e)<0&&(l=l-e|0,r[t>>2]=l,h=h-e|0,r[a>>2]=h,r[A>>2]=0,e=0),n=l-h|0,u=e-h|0,(0|h)<0&&(r[t>>2]=n,r[A>>2]=u,r[a>>2]=0,e=u,l=n,h=0),(0|(u=(0|h)<(0|(u=(0|e)<(0|l)?e:l))?h:u))<=0||(r[t>>2]=l-u,r[A>>2]=e-u,r[a>>2]=h-u)}function $(e){var t,n=0,i=0,s=0,o=0,a=0;n=0|r[(e|=0)>>2],i=0|r[(t=e+4|0)>>2],(0|n)<0&&(i=i-n|0,r[t>>2]=i,r[(a=e+8|0)>>2]=(0|r[a>>2])-n,r[e>>2]=0,n=0),(0|i)<0?(n=n-i|0,r[e>>2]=n,o=(0|r[(a=e+8|0)>>2])-i|0,r[a>>2]=o,r[t>>2]=0,i=0):(a=o=e+8|0,o=0|r[o>>2]),(0|o)<0&&(n=n-o|0,r[e>>2]=n,i=i-o|0,r[t>>2]=i,r[a>>2]=0,o=0),(0|(s=(0|o)<(0|(s=(0|i)<(0|n)?i:n))?o:s))<=0||(r[e>>2]=n-s,r[t>>2]=i-s,r[a>>2]=o-s)}function ee(e,t){t|=0;var n,i;i=0|r[(e|=0)+8>>2],n=+((0|r[e+4>>2])-i|0),s[t>>3]=+((0|r[e>>2])-i|0)-.5*n,s[t+8>>3]=.8660254037844386*n}function te(e,t,n){e|=0,t|=0,r[(n|=0)>>2]=(0|r[t>>2])+(0|r[e>>2]),r[n+4>>2]=(0|r[t+4>>2])+(0|r[e+4>>2]),r[n+8>>2]=(0|r[t+8>>2])+(0|r[e+8>>2])}function ne(e,t,n){e|=0,t|=0,r[(n|=0)>>2]=(0|r[e>>2])-(0|r[t>>2]),r[n+4>>2]=(0|r[e+4>>2])-(0|r[t+4>>2]),r[n+8>>2]=(0|r[e+8>>2])-(0|r[t+8>>2])}function ie(e,t){t|=0;var n,i=0;i=0|b(0|r[(e|=0)>>2],t),r[e>>2]=i,n=0|b(0|r[(i=e+4|0)>>2],t),r[i>>2]=n,t=0|b(0|r[(e=e+8|0)>>2],t),r[e>>2]=t}function re(e){var t,n,i=0,s=0,o=0,a=0,l=0;l=(0|(n=0|r[(e|=0)>>2]))<0,e=(e=(s=(0|(a=((t=(0|(o=(0|r[e+4>>2])-(l?n:0)|0))<0)?0-o|0:0)+((0|r[e+8>>2])-(l?n:0))|0))<0)?0:a)-((o=(0|(s=(0|e)<(0|(s=(0|(i=(t?0:o)-(s?a:0)|0))<(0|(a=(l?0:n)-(t?o:0)-(s?a:0)|0))?i:a))?e:s))>0)?s:0)|0,i=i-(o?s:0)|0;e:do{switch(a-(o?s:0)|0){case 0:switch(0|i){case 0:return 0|(l=0==(0|e)?0:1==(0|e)?1:7);case 1:return 0|(l=0==(0|e)?2:1==(0|e)?3:7);default:break e}case 1:switch(0|i){case 0:return 0|(l=0==(0|e)?4:1==(0|e)?5:7);case 1:if(e)break e;return 0|(e=6);default:break e}}}while(0);return 0|(l=7)}function se(e){var t,n=0,i=0,s=0,o=0,a=0,l=0;o=0|r[(t=(e|=0)+8|0)>>2],a=(0|r[e>>2])-o|0,o=(0|r[(l=e+4|0)>>2])-o|0;do{if(a>>>0>715827881|o>>>0>715827881){if(i=(0|a)>0){if((2147483647-a|0)<(0|a))return 0|(l=1);if((2147483647-(a<<1)|0)<(0|a))return 0|(l=1)}else{if((-2147483648-a|0)>(0|a))return 0|(l=1);if((-2147483648-(a<<1)|0)>(0|a))return 0|(l=1)}if(n=3*a|0,(0|o)>0){if((2147483647-o|0)<(0|o))return 0|(l=1)}else if((-2147483648-o|0)>(0|o))return 0|(l=1);if(s=o<<1,(0|a)>-1){if((-2147483648|n)>=(0|o))return 0|(l=1)}else if((-2147483648^n)<(0|o))return 0|(l=1);if(i){if(!((2147483647-a|0)<(0|s))){i=s;break}return 0|(n=1)}if(!((-2147483648-a|0)>(0|s))){i=s;break}return 0|(n=1)}i=o<<1,n=3*a|0}while(0);s=0|Ct(+(n-o|0)/7),r[e>>2]=s,o=0|Ct(+(i+a|0)/7),r[l>>2]=o,r[t>>2]=0,n=(i=(0|o)<(0|s))?s:o,i=i?o:s;do{if((0|i)<0){if((0|n)>0){if((-2147483648|n)<(0|i)&-2147483648!=(0|i)&(2147483647-n|0)>=(0|i))break;M(23313,22444,355,22455)}if(-2147483648==(0|i)|(-2147483648-n|0)>(0|i)&&M(23313,22444,355,22455),(0|n)>-1){if((-2147483648|n)<(0|i))break;M(23313,22444,355,22455)}else{if((-2147483648^n)>=(0|i))break;M(23313,22444,355,22455)}}}while(0);return n=o-s|0,(0|s)<0?(i=0-s|0,r[l>>2]=n,r[t>>2]=i,r[e>>2]=0,s=0):(n=o,i=0),(0|n)<0&&(s=s-n|0,r[e>>2]=s,i=i-n|0,r[t>>2]=i,r[l>>2]=0,n=0),a=s-i|0,o=n-i|0,(0|i)<0?(r[e>>2]=a,r[l>>2]=o,r[t>>2]=0,n=o,o=a,i=0):o=s,(0|(s=(0|i)<(0|(s=(0|n)<(0|o)?n:o))?i:s))<=0||(r[e>>2]=o-s,r[l>>2]=n-s,r[t>>2]=i-s),0|(l=0)}function oe(e){var t,n=0,i=0,s=0,o=0,a=0,l=0;o=0|r[(t=(e|=0)+8|0)>>2],a=(0|r[e>>2])-o|0,o=(0|r[(l=e+4|0)>>2])-o|0;do{if(a>>>0>715827881|o>>>0>715827881){if(i=(0|a)>0){if((2147483647-a|0)<(0|a))return 0|(l=1)}else if((-2147483648-a|0)>(0|a))return 0|(l=1);if(n=a<<1,(0|o)>0){if((2147483647-o|0)<(0|o))return 0|(l=1);if((2147483647-(o<<1)|0)<(0|o))return 0|(l=1)}else{if((-2147483648-o|0)>(0|o))return 0|(l=1);if((-2147483648-(o<<1)|0)>(0|o))return 0|(l=1)}if(s=3*o|0,i){if((2147483647-n|0)<(0|o))return 0|(l=1)}else if((-2147483648-n|0)>(0|o))return 0|(l=1);if((0|o)>-1){if((-2147483648|s)<(0|a)){i=s;break}return 0|(n=1)}if(!((-2147483648^s)<(0|a))){i=s;break}return 0|(n=1)}i=3*o|0,n=a<<1}while(0);s=0|Ct(+(n+o|0)/7),r[e>>2]=s,o=0|Ct(+(i-a|0)/7),r[l>>2]=o,r[t>>2]=0,n=(i=(0|o)<(0|s))?s:o,i=i?o:s;do{if((0|i)<0){if((0|n)>0){if((-2147483648|n)<(0|i)&-2147483648!=(0|i)&(2147483647-n|0)>=(0|i))break;M(23313,22444,404,22469)}if(-2147483648==(0|i)|(-2147483648-n|0)>(0|i)&&M(23313,22444,404,22469),(0|n)>-1){if((-2147483648|n)<(0|i))break;M(23313,22444,404,22469)}else{if((-2147483648^n)>=(0|i))break;M(23313,22444,404,22469)}}}while(0);return n=o-s|0,(0|s)<0?(i=0-s|0,r[l>>2]=n,r[t>>2]=i,r[e>>2]=0,s=0):(n=o,i=0),(0|n)<0&&(s=s-n|0,r[e>>2]=s,i=i-n|0,r[t>>2]=i,r[l>>2]=0,n=0),a=s-i|0,o=n-i|0,(0|i)<0?(r[e>>2]=a,r[l>>2]=o,r[t>>2]=0,n=o,o=a,i=0):o=s,(0|(s=(0|i)<(0|(s=(0|n)<(0|o)?n:o))?i:s))<=0||(r[e>>2]=o-s,r[l>>2]=n-s,r[t>>2]=i-s),0|(l=0)}function ae(e){var t,n,i=0,s=0,o=0,a=0,l=0;s=0|r[(t=(e|=0)+8|0)>>2],o=0|Ct(+((3*(i=(0|r[e>>2])-s|0)|0)-(s=(0|r[(n=e+4|0)>>2])-s|0)|0)/7),r[e>>2]=o,i=0|Ct(+((s<<1)+i|0)/7),r[n>>2]=i,r[t>>2]=0,s=i-o|0,(0|o)<0?(l=0-o|0,r[n>>2]=s,r[t>>2]=l,r[e>>2]=0,i=s,o=0,s=l):s=0,(0|i)<0&&(o=o-i|0,r[e>>2]=o,s=s-i|0,r[t>>2]=s,r[n>>2]=0,i=0),l=o-s|0,a=i-s|0,(0|s)<0?(r[e>>2]=l,r[n>>2]=a,r[t>>2]=0,i=a,a=l,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|i)<(0|a)?i:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=i-o,r[t>>2]=s-o)}function le(e){var t,n,i=0,s=0,o=0,a=0,l=0;s=0|r[(t=(e|=0)+8|0)>>2],o=0|Ct(+(((i=(0|r[e>>2])-s|0)<<1)+(s=(0|r[(n=e+4|0)>>2])-s|0)|0)/7),r[e>>2]=o,i=0|Ct(+((3*s|0)-i|0)/7),r[n>>2]=i,r[t>>2]=0,s=i-o|0,(0|o)<0?(l=0-o|0,r[n>>2]=s,r[t>>2]=l,r[e>>2]=0,i=s,o=0,s=l):s=0,(0|i)<0&&(o=o-i|0,r[e>>2]=o,s=s-i|0,r[t>>2]=s,r[n>>2]=0,i=0),l=o-s|0,a=i-s|0,(0|s)<0?(r[e>>2]=l,r[n>>2]=a,r[t>>2]=0,i=a,a=l,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|i)<(0|a)?i:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=i-o,r[t>>2]=s-o)}function ce(e){var t,n,i,s=0,o=0,a=0,l=0;s=0|r[(e|=0)>>2],o=0|r[(n=e+4|0)>>2],a=0|r[(i=e+8|0)>>2],l=o+(3*s|0)|0,r[e>>2]=l,o=a+(3*o|0)|0,r[n>>2]=o,s=(3*a|0)+s|0,r[i>>2]=s,a=o-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=a,r[i>>2]=s,r[e>>2]=0,o=a,a=0):a=l,(0|o)<0&&(a=a-o|0,r[e>>2]=a,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=l,r[i>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=l-o,r[i>>2]=s-o)}function ue(e){var t,n,i,s=0,o=0,a=0,l=0;l=0|r[(e|=0)>>2],a=(3*(s=0|r[(n=e+4|0)>>2])|0)+l|0,l=(o=0|r[(i=e+8|0)>>2])+(3*l|0)|0,r[e>>2]=l,r[n>>2]=a,s=(3*o|0)+s|0,r[i>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=o,r[i>>2]=s,r[e>>2]=0,l=0):o=a,(0|o)<0&&(l=l-o|0,r[e>>2]=l,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=l-s|0,a=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=a,r[i>>2]=0,l=t,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|a)<(0|l)?a:l))?s:o))<=0||(r[e>>2]=l-o,r[n>>2]=a-o,r[i>>2]=s-o)}function he(e,t){e|=0;var n,i,s,o=0,a=0,l=0;((t|=0)+-1|0)>>>0>=6||(l=(0|r[15440+(12*t|0)>>2])+(0|r[e>>2])|0,r[e>>2]=l,s=e+4|0,a=(0|r[15440+(12*t|0)+4>>2])+(0|r[s>>2])|0,r[s>>2]=a,i=e+8|0,t=(0|r[15440+(12*t|0)+8>>2])+(0|r[i>>2])|0,r[i>>2]=t,o=a-l|0,(0|l)<0?(t=t-l|0,r[s>>2]=o,r[i>>2]=t,r[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,r[e>>2]=a,t=t-o|0,r[i>>2]=t,r[s>>2]=0,o=0),n=a-t|0,l=o-t|0,(0|t)<0?(r[e>>2]=n,r[s>>2]=l,r[i>>2]=0,a=n,t=0):l=o,(0|(o=(0|t)<(0|(o=(0|l)<(0|a)?l:a))?t:o))<=0||(r[e>>2]=a-o,r[s>>2]=l-o,r[i>>2]=t-o))}function de(e){var t,n,i,s=0,o=0,a=0,l=0;l=0|r[(e|=0)>>2],a=(s=0|r[(n=e+4|0)>>2])+l|0,l=(o=0|r[(i=e+8|0)>>2])+l|0,r[e>>2]=l,r[n>>2]=a,s=o+s|0,r[i>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=o,r[i>>2]=s,r[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,r[e>>2]=a,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=l,r[i>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=l-o,r[i>>2]=s-o)}function pe(e){var t,n,i,s=0,o=0,a=0,l=0;s=0|r[(e|=0)>>2],a=0|r[(n=e+4|0)>>2],o=0|r[(i=e+8|0)>>2],l=a+s|0,r[e>>2]=l,a=o+a|0,r[n>>2]=a,s=o+s|0,r[i>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=o,r[i>>2]=s,r[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,r[e>>2]=a,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=l,r[i>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=l-o,r[i>>2]=s-o)}function Ae(e){switch(0|(e|=0)){case 1:e=5;break;case 5:e=4;break;case 4:e=6;break;case 6:e=2;break;case 2:e=3;break;case 3:e=1}return 0|e}function fe(e){switch(0|(e|=0)){case 1:e=3;break;case 3:e=2;break;case 2:e=6;break;case 6:e=4;break;case 4:e=5;break;case 5:e=1}return 0|e}function me(e){var t,n,i,s=0,o=0,a=0,l=0;s=0|r[(e|=0)>>2],o=0|r[(n=e+4|0)>>2],a=0|r[(i=e+8|0)>>2],l=o+(s<<1)|0,r[e>>2]=l,o=a+(o<<1)|0,r[n>>2]=o,s=(a<<1)+s|0,r[i>>2]=s,a=o-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=a,r[i>>2]=s,r[e>>2]=0,o=a,a=0):a=l,(0|o)<0&&(a=a-o|0,r[e>>2]=a,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=l,r[i>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(r[e>>2]=a-o,r[n>>2]=l-o,r[i>>2]=s-o)}function ge(e){var t,n,i,s=0,o=0,a=0,l=0;l=0|r[(e|=0)>>2],a=((s=0|r[(n=e+4|0)>>2])<<1)+l|0,l=(o=0|r[(i=e+8|0)>>2])+(l<<1)|0,r[e>>2]=l,r[n>>2]=a,s=(o<<1)+s|0,r[i>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,r[n>>2]=o,r[i>>2]=s,r[e>>2]=0,l=0):o=a,(0|o)<0&&(l=l-o|0,r[e>>2]=l,s=s-o|0,r[i>>2]=s,r[n>>2]=0,o=0),t=l-s|0,a=o-s|0,(0|s)<0?(r[e>>2]=t,r[n>>2]=a,r[i>>2]=0,l=t,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|a)<(0|l)?a:l))?s:o))<=0||(r[e>>2]=l-o,r[n>>2]=a-o,r[i>>2]=s-o)}function ve(e,t){t|=0;var n,i,s,o=0,a=0,l=0;return s=(0|(i=(0|r[(e|=0)>>2])-(0|r[t>>2])|0))<0,n=(0|(a=(0|r[e+4>>2])-(0|r[t+4>>2])-(s?i:0)|0))<0,t=(t=(e=(0|(l=(s?0-i|0:0)+(0|r[e+8>>2])-(0|r[t+8>>2])+(n?0-a|0:0)|0))<0)?0:l)-((a=(0|(e=(0|t)<(0|(e=(0|(o=(n?0:a)-(e?l:0)|0))<(0|(l=(s?0:i)-(n?a:0)-(e?l:0)|0))?o:l))?t:e))>0)?e:0)|0,o=o-(a?e:0)|0,0|((0|(e=(0|(e=l-(a?e:0)|0))>-1?e:0-e|0))>(0|(t=(0|(o=(0|o)>-1?o:0-o|0))>(0|(t=(0|t)>-1?t:0-t|0))?o:t))?e:t)}function ye(e,t){t|=0;var n;n=0|r[(e|=0)+8>>2],r[t>>2]=(0|r[e>>2])-n,r[t+4>>2]=(0|r[e+4>>2])-n}function be(e,t){t|=0;var n,i,s,o=0,a=0,l=0;a=0|r[(e|=0)>>2],r[t>>2]=a,l=0|r[e+4>>2],r[(i=t+4|0)>>2]=l,r[(s=t+8|0)>>2]=0,e=(o=(0|l)<(0|a))?a:l,o=o?l:a;do{if((0|o)<0){if((0|e)>0){if((-2147483648|e)<(0|o)&-2147483648!=(0|o)&(2147483647-e|0)>=(0|o))break;return 0|(e=1)}if(-2147483648==(0|o)|(-2147483648-e|0)>(0|o))return 0|(t=1);if((0|e)>-1){if((-2147483648|e)<(0|o))break;return 0|(e=1)}if(!((-2147483648^e)<(0|o)))break;return 0|(e=1)}}while(0);return e=l-a|0,(0|a)<0?(o=0-a|0,r[i>>2]=e,r[s>>2]=o,r[t>>2]=0,a=0):(e=l,o=0),(0|e)<0&&(a=a-e|0,r[t>>2]=a,o=o-e|0,r[s>>2]=o,r[i>>2]=0,e=0),n=a-o|0,l=e-o|0,(0|o)<0?(r[t>>2]=n,r[i>>2]=l,r[s>>2]=0,e=l,l=n,o=0):l=a,(0|(a=(0|o)<(0|(a=(0|e)<(0|l)?e:l))?o:a))<=0||(r[t>>2]=l-a,r[i>>2]=e-a,r[s>>2]=o-a),0|(t=0)}function xe(e){var t,n,i,s;n=(s=0|r[(t=(e|=0)+8|0)>>2])-(0|r[e>>2])|0,r[e>>2]=n,e=(0|r[(i=e+4|0)>>2])-s|0,r[i>>2]=e,r[t>>2]=0-(e+n)}function _e(e){var t,n,i=0,s=0,o=0,a=0,l=0;i=0-(s=0|r[(e|=0)>>2])|0,r[e>>2]=i,r[(t=e+8|0)>>2]=0,a=(o=0|r[(n=e+4|0)>>2])+s|0,(0|s)>0?(r[n>>2]=a,r[t>>2]=s,r[e>>2]=0,i=0,o=a):s=0,(0|o)<0?(l=i-o|0,r[e>>2]=l,s=s-o|0,r[t>>2]=s,r[n>>2]=0,a=l-s|0,i=0-s|0,(0|s)<0?(r[e>>2]=a,r[n>>2]=i,r[t>>2]=0,o=i,s=0):(o=0,a=l)):a=i,(0|(i=(0|s)<(0|(i=(0|o)<(0|a)?o:a))?s:i))<=0||(r[e>>2]=a-i,r[n>>2]=o-i,r[t>>2]=s-i)}function we(e,t,n){n|=0;var i,s,o=0,a=0;return s=D,D=D+16|0,i=s,a=-2130706433&(t|=0)|134217728,!0&268435456==(2013265920&t)?(o=0|qt(0|(e|=0),0|t,56),T(),o=0|function(e,t,n){e|=0,t|=0,n|=0;var i=0,s=0,o=0;if(o=D,D=D+16|0,s=o,i=0|Be(e,t),(n+-1|0)>>>0>5)return D=o,0|(s=-1);if(i=0!=(0|i),1==(0|n)&i)return D=o,0|(s=-1);do{if(!(0|yt(e,t,s))){if(i){i=(5+(0|r[21936+(n<<2)>>2])-(0|r[s>>2])|0)%5|0;break}i=(6+(0|r[21968+(n<<2)>>2])-(0|r[s>>2])|0)%6|0;break}i=-1}while(0);return s=i,D=o,0|s}(e,a,7&o),-1==(0|o)?(r[n>>2]=0,D=s,0|(a=6)):(0|We(e,a,i)&&M(23313,22484,282,22499),t=0|qt(0|e,0|t,52),T(),t&=15,0|Be(e,a)?Ee(i,t,o,2,n):Ne(i,t,o,2,n),D=s,0|(a=0))):(D=s,0|(a=6))}function Se(e,t,n,i){t|=0,i|=0;var o,a=0,l=0,c=0,u=0;if(o=D,D=D+16|0,function(e,t,n){e|=0,t|=0,n|=0;var i=0,o=0,a=0;a=D,D=D+32|0,o=a,function(e,t){e|=0,t|=0;var n=0,i=0,r=0;n=+s[e>>3],i=+d(+n),n=+p(+n),s[t+16>>3]=n,n=+s[e+8>>3],r=i*+d(+n),s[t>>3]=r,n=i*+p(+n),s[t+8>>3]=n}(e,o),r[t>>2]=0,s[n>>3]=5,i=+vt(16400,o),i<+s[n>>3]&&(r[t>>2]=0,s[n>>3]=i);i=+vt(16424,o),i<+s[n>>3]&&(r[t>>2]=1,s[n>>3]=i);i=+vt(16448,o),i<+s[n>>3]&&(r[t>>2]=2,s[n>>3]=i);i=+vt(16472,o),i<+s[n>>3]&&(r[t>>2]=3,s[n>>3]=i);i=+vt(16496,o),i<+s[n>>3]&&(r[t>>2]=4,s[n>>3]=i);i=+vt(16520,o),i<+s[n>>3]&&(r[t>>2]=5,s[n>>3]=i);i=+vt(16544,o),i<+s[n>>3]&&(r[t>>2]=6,s[n>>3]=i);i=+vt(16568,o),i<+s[n>>3]&&(r[t>>2]=7,s[n>>3]=i);i=+vt(16592,o),i<+s[n>>3]&&(r[t>>2]=8,s[n>>3]=i);i=+vt(16616,o),i<+s[n>>3]&&(r[t>>2]=9,s[n>>3]=i);i=+vt(16640,o),i<+s[n>>3]&&(r[t>>2]=10,s[n>>3]=i);i=+vt(16664,o),i<+s[n>>3]&&(r[t>>2]=11,s[n>>3]=i);i=+vt(16688,o),i<+s[n>>3]&&(r[t>>2]=12,s[n>>3]=i);i=+vt(16712,o),i<+s[n>>3]&&(r[t>>2]=13,s[n>>3]=i);i=+vt(16736,o),i<+s[n>>3]&&(r[t>>2]=14,s[n>>3]=i);i=+vt(16760,o),i<+s[n>>3]&&(r[t>>2]=15,s[n>>3]=i);i=+vt(16784,o),i<+s[n>>3]&&(r[t>>2]=16,s[n>>3]=i);i=+vt(16808,o),i<+s[n>>3]&&(r[t>>2]=17,s[n>>3]=i);i=+vt(16832,o),i<+s[n>>3]&&(r[t>>2]=18,s[n>>3]=i);if(i=+vt(16856,o),!(i<+s[n>>3]))return void(D=a);r[t>>2]=19,s[n>>3]=i,D=a}(e|=0,n|=0,u=o),(l=+f(+(1-.5*+s[u>>3])))<1e-16)return r[i>>2]=0,r[i+4>>2]=0,r[i+8>>2]=0,r[i+12>>2]=0,void(D=o);if(u=0|r[n>>2],a=+Je((a=+s[15920+(24*u|0)>>3])-+Je(+function(e,t){e|=0,t|=0;var n=0,i=0,r=0,o=0,a=0;return o=+s[t>>3],i=+d(+o),r=+s[t+8>>3]-+s[e+8>>3],a=i*+p(+r),n=+s[e>>3],+ +v(+a,+(+p(+o)*+d(+n)-+d(+r)*(i*+p(+n))))}(15600+(u<<4)|0,e))),c=0|Ge(t)?+Je(a+-.3334731722518321):a,a=+A(+l)/.381966011250105,(0|t)>0){e=0;do{a*=2.6457513110645907,e=e+1|0}while((0|e)!=(0|t))}l=+d(+c)*a,s[i>>3]=l,c=+p(+c)*a,s[i+8>>3]=c,D=o}function Te(e,t,n,i,o){t|=0,n|=0,i|=0,o|=0;var a=0,l=0;if(a=+function(e){e|=0;var t=0,n=0;return n=+s[e>>3],t=+s[e+8>>3],+ +u(+(n*n+t*t))}(e|=0),a<1e-16)return t=15600+(t<<4)|0,r[o>>2]=r[t>>2],r[o+4>>2]=r[t+4>>2],r[o+8>>2]=r[t+8>>2],void(r[o+12>>2]=r[t+12>>2]);if(l=+v(+ +s[e+8>>3],+ +s[e>>3]),(0|n)>0){e=0;do{a/=2.6457513110645907,e=e+1|0}while((0|e)!=(0|n))}i?(a/=3,n=0==(0|Ge(n)),a=+g(.381966011250105*(n?a:a/2.6457513110645907))):(a=+g(.381966011250105*a),0|Ge(n)&&(l=+Je(l+.3334731722518321))),function(e,t,n,i){e|=0,t=+t,n=+n,i|=0;var o=0,a=0,l=0,u=0;if(n<1e-16)return r[i>>2]=r[e>>2],r[i+4>>2]=r[e+4>>2],r[i+8>>2]=r[e+8>>2],void(r[i+12>>2]=r[e+12>>2]);a=t<0?t+6.283185307179586:t,a=t>=6.283185307179586?a+-6.283185307179586:a;do{if(!(a<1e-16)){if(o=+c(+(a+-3.141592653589793))<1e-16,t=+s[e>>3],o){t-=n,s[i>>3]=t,o=i;break}if(l=+d(+n),n=+p(+n),t=l*+p(+t)+ +d(+a)*(n*+d(+t)),t=+m(+((t=t>1?1:t)<-1?-1:t)),s[i>>3]=t,+c(+(t+-1.5707963267948966))<1e-16)return s[i>>3]=1.5707963267948966,void(s[i+8>>3]=0);if(+c(+(t+1.5707963267948966))<1e-16)return s[i>>3]=-1.5707963267948966,void(s[i+8>>3]=0);if(u=+d(+t),a=n*+p(+a)/u,n=+s[e>>3],t=(l-+p(+t)*+p(+n))/+d(+n)/u,l=a>1?1:a,t=t>1?1:t,(t=+s[e+8>>3]+ +v(+(l<-1?-1:l),+(t<-1?-1:t)))>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);return void(s[i+8>>3]=t)}t=+s[e>>3]+n,s[i>>3]=t,o=i}while(0);if(+c(+(t+-1.5707963267948966))<1e-16)return s[o>>3]=1.5707963267948966,void(s[i+8>>3]=0);if(+c(+(t+1.5707963267948966))<1e-16)return s[o>>3]=-1.5707963267948966,void(s[i+8>>3]=0);if(t=+s[e+8>>3],t>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);s[i+8>>3]=t}(15600+(t<<4)|0,+Je(+s[15920+(24*t|0)>>3]-l),a,o)}function Me(e,t,n){t|=0,n|=0;var i,s;i=D,D=D+16|0,ee((e|=0)+4|0,s=i),Te(s,0|r[e>>2],t,0,n),D=i}function Ee(e,t,n,i,o){e|=0,t|=0,n|=0,i|=0,o|=0;var a,l,c,u,h,d,p,A,f,m,g,v,y,b,x,_,w,S,T,E,C,R,P=0,N=0,L=0,I=0,O=0,k=0;if(R=D,D=D+272|0,I=R+240|0,T=R,E=R+224|0,C=R+208|0,g=R+176|0,v=R+160|0,y=R+192|0,b=R+144|0,x=R+128|0,_=R+112|0,w=R+96|0,S=R+80|0,r[(P=R+256|0)>>2]=t,r[I>>2]=r[e>>2],r[I+4>>2]=r[e+4>>2],r[I+8>>2]=r[e+8>>2],r[I+12>>2]=r[e+12>>2],Ce(I,P,T),r[o>>2]=0,(0|(I=i+n+(5==(0|i)&1)|0))<=(0|n))D=R;else{l=E+4|0,c=g+4|0,u=n+5|0,h=16880+((a=0|r[P>>2])<<2)|0,d=16960+(a<<2)|0,p=x+8|0,A=_+8|0,f=w+8|0,m=C+4|0,L=n;e:for(;;){N=T+((0|L)%5<<4)|0,r[C>>2]=r[N>>2],r[C+4>>2]=r[N+4>>2],r[C+8>>2]=r[N+8>>2],r[C+12>>2]=r[N+12>>2];do{}while(2==(0|Re(C,a,0,1)));if((0|L)>(0|n)&0!=(0|Ge(t))){if(r[g>>2]=r[C>>2],r[g+4>>2]=r[C+4>>2],r[g+8>>2]=r[C+8>>2],r[g+12>>2]=r[C+12>>2],ee(l,v),i=0|r[g>>2],P=0|r[17040+(80*i|0)+(r[E>>2]<<2)>>2],r[g>>2]=r[18640+(80*i|0)+(20*P|0)>>2],(0|(N=0|r[18640+(80*i|0)+(20*P|0)+16>>2]))>0){e=0;do{de(c),e=e+1|0}while((0|e)<(0|N))}switch(N=18640+(80*i|0)+(20*P|0)+4|0,r[y>>2]=r[N>>2],r[y+4>>2]=r[N+4>>2],r[y+8>>2]=r[N+8>>2],ie(y,3*(0|r[h>>2])|0),te(c,y,c),$(c),ee(c,b),O=+(0|r[d>>2]),s[x>>3]=3*O,s[p>>3]=0,k=-1.5*O,s[_>>3]=k,s[A>>3]=2.598076211353316*O,s[w>>3]=k,s[f>>3]=-2.598076211353316*O,0|r[17040+(80*(0|r[g>>2])|0)+(r[C>>2]<<2)>>2]){case 1:e=_,i=x;break;case 3:e=w,i=_;break;case 2:e=x,i=w;break;default:e=12;break e}mt(v,b,i,e,S),Te(S,0|r[g>>2],a,1,o+8+(r[o>>2]<<4)|0),r[o>>2]=1+(0|r[o>>2])}if((0|L)<(0|u)&&(ee(m,g),Te(g,0|r[C>>2],a,1,o+8+(r[o>>2]<<4)|0),r[o>>2]=1+(0|r[o>>2])),r[E>>2]=r[C>>2],r[E+4>>2]=r[C+4>>2],r[E+8>>2]=r[C+8>>2],r[E+12>>2]=r[C+12>>2],(0|(L=L+1|0))>=(0|I)){e=3;break}}3!=(0|e)?12==(0|e)&&M(22522,22569,571,22579):D=R}}function Ce(e,t,n){e|=0,t|=0,n|=0;var i,s=0,o=0,a=0,l=0,c=0;i=D,D=D+128|0,o=i,l=20240,c=(a=s=i+64|0)+60|0;do{r[a>>2]=r[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|c));l=20304,c=(a=o)+60|0;do{r[a>>2]=r[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|c));s=(c=0==(0|Ge(0|r[t>>2])))?s:o,me(o=e+4|0),ge(o),0|Ge(0|r[t>>2])&&(ue(o),r[t>>2]=1+(0|r[t>>2])),r[n>>2]=r[e>>2],te(o,s,t=n+4|0),$(t),r[n+16>>2]=r[e>>2],te(o,s+12|0,t=n+20|0),$(t),r[n+32>>2]=r[e>>2],te(o,s+24|0,t=n+36|0),$(t),r[n+48>>2]=r[e>>2],te(o,s+36|0,t=n+52|0),$(t),r[n+64>>2]=r[e>>2],te(o,s+48|0,n=n+68|0),$(n),D=i}function Re(e,t,n,i){n|=0,i|=0;var s,o,a,l,c,u,h=0,d=0,p=0,A=0,f=0;if(u=D,D=D+32|0,c=u+12|0,o=u,f=(e|=0)+4|0,A=0|r[16960+((t|=0)<<2)>>2],A=(l=0!=(0|i))?3*A|0:A,h=0|r[f>>2],s=0|r[(a=e+8|0)>>2],l){if((0|(h=s+h+(i=0|r[(d=e+12|0)>>2])|0))==(0|A))return D=u,0|(f=1);p=d}else h=s+h+(i=0|r[(p=e+12|0)>>2])|0;if((0|h)<=(0|A))return D=u,0|(f=0);do{if((0|i)>0){if(i=0|r[e>>2],(0|s)>0){d=18640+(80*i|0)+60|0,i=e;break}i=18640+(80*i|0)+40|0,n?(Z(c,A,0,0),ne(f,c,o),pe(o),te(o,c,f),d=i,i=e):(d=i,i=e)}else d=18640+(80*(0|r[e>>2])|0)+20|0,i=e}while(0);if(r[i>>2]=r[d>>2],(0|r[(h=d+16|0)>>2])>0){i=0;do{de(f),i=i+1|0}while((0|i)<(0|r[h>>2]))}return e=d+4|0,r[c>>2]=r[e>>2],r[c+4>>2]=r[e+4>>2],r[c+8>>2]=r[e+8>>2],t=0|r[16880+(t<<2)>>2],ie(c,l?3*t|0:t),te(f,c,f),$(f),i=l&&((0|r[a>>2])+(0|r[f>>2])+(0|r[p>>2])|0)==(0|A)?1:2,D=u,0|(f=i)}function Pe(e,t){e|=0,t|=0;var n=0;do{n=0|Re(e,t,0,1)}while(2==(0|n));return 0|n}function Ne(e,t,n,i,o){e|=0,t|=0,n|=0,i|=0,o|=0;var a,l,c,u,h,d,p,A,f,m,g,v,y,b,x,_,w,S,T=0,E=0,C=0,R=0,P=0;if(S=D,D=D+240|0,b=S+208|0,x=S,_=S+192|0,w=S+176|0,f=S+160|0,m=S+144|0,g=S+128|0,v=S+112|0,y=S+96|0,r[(T=S+224|0)>>2]=t,r[b>>2]=r[e>>2],r[b+4>>2]=r[e+4>>2],r[b+8>>2]=r[e+8>>2],r[b+12>>2]=r[e+12>>2],De(b,T,x),r[o>>2]=0,(0|(A=i+n+(6==(0|i)&1)|0))<=(0|n))D=S;else{l=n+6|0,c=16960+((a=0|r[T>>2])<<2)|0,u=m+8|0,h=g+8|0,d=v+8|0,p=_+4|0,E=0,C=n,i=-1;e:for(;;){if(e=x+((T=(0|C)%6|0)<<4)|0,r[_>>2]=r[e>>2],r[_+4>>2]=r[e+4>>2],r[_+8>>2]=r[e+8>>2],r[_+12>>2]=r[e+12>>2],e=E,E=0|Re(_,a,0,1),(0|C)>(0|n)&0!=(0|Ge(t))&&(1!=(0|e)&&(0|r[_>>2])!=(0|i))){switch(ee(x+((T+5|0)%6<<4)+4|0,w),ee(x+(T<<4)+4|0,f),R=+(0|r[c>>2]),s[m>>3]=3*R,s[u>>3]=0,P=-1.5*R,s[g>>3]=P,s[h>>3]=2.598076211353316*R,s[v>>3]=P,s[d>>3]=-2.598076211353316*R,T=0|r[b>>2],0|r[17040+(80*T|0)+(((0|i)==(0|T)?r[_>>2]:i)<<2)>>2]){case 1:e=g,i=m;break;case 3:e=v,i=g;break;case 2:e=m,i=v;break;default:e=8;break e}mt(w,f,i,e,y),0|gt(w,y)||0|gt(f,y)||(Te(y,0|r[b>>2],a,1,o+8+(r[o>>2]<<4)|0),r[o>>2]=1+(0|r[o>>2]))}if((0|C)<(0|l)&&(ee(p,w),Te(w,0|r[_>>2],a,1,o+8+(r[o>>2]<<4)|0),r[o>>2]=1+(0|r[o>>2])),(0|(C=C+1|0))>=(0|A)){e=3;break}i=0|r[_>>2]}3!=(0|e)?8==(0|e)&&M(22606,22569,736,22651):D=S}}function De(e,t,n){e|=0,t|=0,n|=0;var i,s=0,o=0,a=0,l=0,c=0;i=D,D=D+160|0,o=i,l=20368,c=(a=s=i+80|0)+72|0;do{r[a>>2]=r[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|c));l=20448,c=(a=o)+72|0;do{r[a>>2]=r[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|c));s=(c=0==(0|Ge(0|r[t>>2])))?s:o,me(o=e+4|0),ge(o),0|Ge(0|r[t>>2])&&(ue(o),r[t>>2]=1+(0|r[t>>2])),r[n>>2]=r[e>>2],te(o,s,t=n+4|0),$(t),r[n+16>>2]=r[e>>2],te(o,s+12|0,t=n+20|0),$(t),r[n+32>>2]=r[e>>2],te(o,s+24|0,t=n+36|0),$(t),r[n+48>>2]=r[e>>2],te(o,s+36|0,t=n+52|0),$(t),r[n+64>>2]=r[e>>2],te(o,s+48|0,t=n+68|0),$(t),r[n+80>>2]=r[e>>2],te(o,s+60|0,n=n+84|0),$(n),D=i}function Le(e,t){return t=0|qt(0|(e|=0),0|(t|=0),45),T(),127&t}function Ie(e,t){var n=0,i=0,r=0,s=0,o=0,a=0;if(!(!0&134217728==(-16777216&(t|=0))))return 0|(t=0);if(o=0|qt(0|(e|=0),0|t,45),T(),(o&=127)>>>0>121)return 0|(t=0);n=0|qt(0|e,0|t,52),T(),n&=15;do{if(0|n){for(r=1,i=0;;){if(s=0|qt(0|e,0|t,3*(15-r|0)|0),T(),0!=(0|(s&=7))&(1^i)){if(1==(0|s)&0!=(0|z(o))){a=0,i=13;break}i=1}if(7==(0|s)){a=0,i=13;break}if(!(r>>>0<n>>>0)){i=9;break}r=r+1|0}if(9==(0|i)){if(15!=(0|n))break;return 0|(a=1)}if(13==(0|i))return 0|a}}while(0);for(;;){if(a=0|qt(0|e,0|t,3*(14-n|0)|0),T(),!(7==(7&a)&!0)){a=0,i=13;break}if(!(n>>>0<14)){a=1,i=13;break}n=n+1|0}return 13==(0|i)?0|a:0}function Oe(e,t,n,i){n|=0,i|=0;var s=0,o=0;if(o=0|qt(0|(e|=0),0|(t|=0),52),T(),n>>>0>15)return 0|(i=4);if((0|(o&=15))<(0|n))return 0|(i=12);if((0|o)==(0|n))return r[i>>2]=e,r[i+4>>2]=t,0|(i=0);if(s=0|Vt(0|n,0,52),s|=e,e=T()|-15728641&t,(0|o)>(0|n))do{t=0|Vt(7,0,3*(14-n|0)|0),n=n+1|0,s|=t,e=T()|e}while((0|n)<(0|o));return r[i>>2]=s,r[i+4>>2]=e,0|(i=0)}function ke(e,t,n,i){n|=0,i|=0;var s=0,o=0,a=0;if(o=0|qt(0|(e|=0),0|(t|=0),52),T(),!((0|n)<16&(0|(o&=15))<=(0|n)))return 0|(i=4);s=n-o|0,n=0|qt(0|e,0|t,45),T();e:do{if(0|z(127&n)){t:do{if(0|o){for(n=1;0==((a=0|Vt(7,0,3*(15-n|0)|0))&e)&0==(T()&t);){if(!(n>>>0<o>>>0))break t;n=n+1|0}n=0|ht(7,0,s,((0|s)<0)<<31>>31),s=0|T();break e}}while(0);n=0|Dt(0|(n=0|Bt(0|(n=0|ht(7,0,s,((0|s)<0)<<31>>31)),0|T(),5,0)),0|T(),-5,-1),n=0|Dt(0|(n=0|kt(0|n,0|T(),6,0)),0|T(),1,0),s=0|T()}else n=0|ht(7,0,s,((0|s)<0)<<31>>31),s=0|T()}while(0);return r[(a=i)>>2]=n,r[a+4>>2]=s,0|(a=0)}function Be(e,t){var n=0,i=0,r=0;if(r=0|qt(0|(e|=0),0|(t|=0),45),T(),!(0|z(127&r)))return 0|(r=0);r=0|qt(0|e,0|t,52),T(),r&=15;e:do{if(r)for(i=1;;){if(n=0|qt(0|e,0|t,3*(15-i|0)|0),T(),0|(n&=7))break e;if(!(i>>>0<r>>>0)){n=0;break}i=i+1|0}else n=0}while(0);return 0|(r=0==(0|n)&1)}function Fe(e,t){var n=0,i=0,r=0;if(r=0|qt(0|(e|=0),0|(t|=0),52),T(),!(r&=15))return 0|(r=0);for(i=1;;){if(n=0|qt(0|e,0|t,3*(15-i|0)|0),T(),0|(n&=7)){i=5;break}if(!(i>>>0<r>>>0)){n=0,i=5;break}i=i+1|0}return 5==(0|i)?0|n:0}function Ue(e,t){var n=0,i=0,r=0,s=0,o=0,a=0,l=0;if(l=0|qt(0|(e|=0),0|(t|=0),52),T(),!(l&=15))return l=e,S(0|(a=t)),0|l;for(a=1,n=0;;){i=0|Vt(7,0,0|(s=3*(15-a|0)|0)),r=0|T(),o=0|qt(0|e,0|t,0|s),T(),e=(s=0|Vt(0|Ae(7&o),0,0|s))|e&~i,t=(o=0|T())|t&~r;e:do{if(!n)if(0==(s&i)&0==(o&r))n=0;else if(i=0|qt(0|e,0|t,52),T(),i&=15){n=1;t:for(;;){switch(o=0|qt(0|e,0|t,3*(15-n|0)|0),T(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<i>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(r=0|qt(0|e,0|t,0|(o=3*(15-n|0)|0)),T(),s=0|Vt(7,0,0|o),t&=~T(),e=e&~s|(o=0|Vt(0|Ae(7&r),0,0|o)),t|=T(),!(n>>>0<i>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return S(0|t),0|e}function ze(e,t){var n=0,i=0,r=0,s=0,o=0;if(i=0|qt(0|(e|=0),0|(t|=0),52),T(),!(i&=15))return i=e,S(0|(n=t)),0|i;for(n=1;o=0|qt(0|e,0|t,0|(s=3*(15-n|0)|0)),T(),r=0|Vt(7,0,0|s),t&=~T(),e=(s=0|Vt(0|Ae(7&o),0,0|s))|e&~r,t=T()|t,n>>>0<i>>>0;)n=n+1|0;return S(0|t),0|e}function qe(e,t){var n=0,i=0,r=0,s=0,o=0,a=0,l=0;if(l=0|qt(0|(e|=0),0|(t|=0),52),T(),!(l&=15))return l=e,S(0|(a=t)),0|l;for(a=1,n=0;;){i=0|Vt(7,0,0|(s=3*(15-a|0)|0)),r=0|T(),o=0|qt(0|e,0|t,0|s),T(),e=(s=0|Vt(0|fe(7&o),0,0|s))|e&~i,t=(o=0|T())|t&~r;e:do{if(!n)if(0==(s&i)&0==(o&r))n=0;else if(i=0|qt(0|e,0|t,52),T(),i&=15){n=1;t:for(;;){switch(o=0|qt(0|e,0|t,3*(15-n|0)|0),T(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<i>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(s=0|Vt(7,0,0|(r=3*(15-n|0)|0)),o=t&~T(),t=0|qt(0|e,0|t,0|r),T(),e=e&~s|(t=0|Vt(0|fe(7&t),0,0|r)),t=o|T(),!(n>>>0<i>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return S(0|t),0|e}function Ve(e,t){var n=0,i=0,r=0,s=0,o=0;if(i=0|qt(0|(e|=0),0|(t|=0),52),T(),!(i&=15))return i=e,S(0|(n=t)),0|i;for(n=1;s=0|Vt(7,0,0|(o=3*(15-n|0)|0)),r=t&~T(),t=0|qt(0|e,0|t,0|o),T(),e=(t=0|Vt(0|fe(7&t),0,0|o))|e&~s,t=T()|r,n>>>0<i>>>0;)n=n+1|0;return S(0|t),0|e}function Ge(e){return(0|(e|=0))%2|0}function je(e,t,n){n|=0;var i,s=0;return i=D,D=D+16|0,s=i,(t|=0)>>>0>15?(D=i,0|(s=4)):2146435072==(2146435072&r[(e|=0)+4>>2])||2146435072==(2146435072&r[e+8+4>>2])?(D=i,0|(s=3)):(function(e,t,n){var i,r;i=D,D=D+16|0,Se(e|=0,t|=0,n|=0,r=i),J(r,n+4|0),D=i}(e,t,s),t=0|function(e,t){e|=0;var n,i=0,s=0,o=0,a=0,l=0,c=0,u=0,h=0;if(n=D,D=D+64|0,c=n+40|0,s=n+24|0,o=n+12|0,a=n,Vt(0|(t|=0),0,52),i=134225919|T(),!t)return(0|r[e+4>>2])>2||(0|r[e+8>>2])>2||(0|r[e+12>>2])>2?(c=0,S(0|(l=0)),D=n,0|c):(Vt(0|V(e),0,45),l=T()|i,c=-1,S(0|l),D=n,0|c);if(r[c>>2]=r[e>>2],r[c+4>>2]=r[e+4>>2],r[c+8>>2]=r[e+8>>2],r[c+12>>2]=r[e+12>>2],l=c+4|0,(0|t)>0)for(e=-1;r[s>>2]=r[l>>2],r[s+4>>2]=r[l+4>>2],r[s+8>>2]=r[l+8>>2],1&t?(ae(l),r[o>>2]=r[l>>2],r[o+4>>2]=r[l+4>>2],r[o+8>>2]=r[l+8>>2],ce(o)):(le(l),r[o>>2]=r[l>>2],r[o+4>>2]=r[l+4>>2],r[o+8>>2]=r[l+8>>2],ue(o)),ne(s,o,a),$(a),u=0|Vt(7,0,0|(h=3*(15-t|0)|0)),i&=~T(),e=(h=0|Vt(0|re(a),0,0|h))|e&~u,i=T()|i,(0|t)>1;)t=t+-1|0;else e=-1;e:do{if((0|r[l>>2])<=2&&(0|r[c+8>>2])<=2&&(0|r[c+12>>2])<=2){if(t=0|Vt(0|(s=0|V(c)),0,45),t|=e,e=T()|-1040385&i,a=0|G(c),!(0|z(s))){if((0|a)<=0)break;for(o=0;;){if(s=0|qt(0|t,0|e,52),T(),s&=15)for(i=1;c=0|qt(0|t,0|e,0|(h=3*(15-i|0)|0)),T(),u=0|Vt(7,0,0|h),e&=~T(),t=t&~u|(h=0|Vt(0|Ae(7&c),0,0|h)),e|=T(),i>>>0<s>>>0;)i=i+1|0;if((0|(o=o+1|0))==(0|a))break e}}o=0|qt(0|t,0|e,52),T(),o&=15;t:do{if(o){i=1;n:for(;;){switch(h=0|qt(0|t,0|e,3*(15-i|0)|0),T(),7&h){case 1:break n;case 0:break;default:break t}if(!(i>>>0<o>>>0))break t;i=i+1|0}if(0|j(s,0|r[c>>2]))for(i=1;u=0|Vt(7,0,0|(c=3*(15-i|0)|0)),h=e&~T(),e=0|qt(0|t,0|e,0|c),T(),t=t&~u|(e=0|Vt(0|fe(7&e),0,0|c)),e=h|T(),i>>>0<o>>>0;)i=i+1|0;else for(i=1;c=0|qt(0|t,0|e,0|(h=3*(15-i|0)|0)),T(),u=0|Vt(7,0,0|h),e&=~T(),t=t&~u|(h=0|Vt(0|Ae(7&c),0,0|h)),e|=T(),i>>>0<o>>>0;)i=i+1|0}}while(0);if((0|a)>0){i=0;do{t=0|Ue(t,e),e=0|T(),i=i+1|0}while((0|i)!=(0|a))}}else t=0,e=0}while(0);return h=t,S(0|(u=e)),D=n,0|h}(s,t),s=0|T(),r[n>>2]=t,r[n+4>>2]=s,0==(0|t)&0==(0|s)&&M(23313,22674,786,22697),D=i,0|(s=0))}function He(e,t,n){var i,s=0,o=0,a=0;if(i=(n|=0)+4|0,o=0|qt(0|(e|=0),0|(t|=0),52),T(),o&=15,a=0|qt(0|e,0|t,45),T(),s=0==(0|o),0|z(127&a)){if(s)return 0|(a=1);s=1}else{if(s)return 0|(a=0);s=0==(0|r[i>>2])&&0==(0|r[n+8>>2])?0!=(0|r[n+12>>2])&1:1}for(n=1;1&n?ce(i):ue(i),a=0|qt(0|e,0|t,3*(15-n|0)|0),T(),he(i,7&a),n>>>0<o>>>0;)n=n+1|0;return 0|s}function We(e,t,n){n|=0;var i,s,o=0,a=0,l=0,c=0,u=0,h=0;if(s=D,D=D+16|0,i=s,h=0|qt(0|(e|=0),0|(t|=0),45),T(),(h&=127)>>>0>121)return r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,r[n+12>>2]=0,D=s,0|(h=5);e:do{if(0!=(0|z(h))&&(l=0|qt(0|e,0|t,52),T(),0!=(0|(l&=15)))){o=1;t:for(;;){switch(u=0|qt(0|e,0|t,3*(15-o|0)|0),T(),7&u){case 5:break t;case 0:break;default:o=t;break e}if(!(o>>>0<l>>>0)){o=t;break e}o=o+1|0}for(a=1,o=t;c=0|Vt(7,0,0|(t=3*(15-a|0)|0)),u=o&~T(),o=0|qt(0|e,0|o,0|t),T(),e=e&~c|(o=0|Vt(0|fe(7&o),0,0|t)),o=u|T(),a>>>0<l>>>0;)a=a+1|0}else o=t}while(0);if(u=7696+(28*h|0)|0,r[n>>2]=r[u>>2],r[n+4>>2]=r[u+4>>2],r[n+8>>2]=r[u+8>>2],r[n+12>>2]=r[u+12>>2],!(0|He(e,o,n)))return D=s,0|(h=0);if(c=n+4|0,r[i>>2]=r[c>>2],r[i+4>>2]=r[c+4>>2],r[i+8>>2]=r[c+8>>2],l=0|qt(0|e,0|o,52),T(),u=15&l,1&l?(ue(c),l=u+1|0):l=u,0|z(h)){e:do{if(u)for(t=1;;){if(a=0|qt(0|e,0|o,3*(15-t|0)|0),T(),0|(a&=7)){o=a;break e}if(!(t>>>0<u>>>0)){o=0;break}t=t+1|0}else o=0}while(0);o=4==(0|o)&1}else o=0;if(0|Re(n,l,o,0)){if(0|z(h))do{}while(0!=(0|Re(n,l,0,0)));(0|l)!=(0|u)&&le(c)}else(0|l)!=(0|u)&&(r[c>>2]=r[i>>2],r[c+4>>2]=r[i+4>>2],r[c+8>>2]=r[i+8>>2]);return D=s,0|(h=0)}function Xe(e,t,n){n|=0;var i,r,s=0;return r=D,D=D+16|0,0|(s=0|We(e|=0,t|=0,i=r))?(D=r,0|s):(s=0|qt(0|e,0|t,52),T(),Me(i,15&s,n),D=r,0|(s=0))}function Ye(e,t,n){n|=0;var i,r=0,s=0,o=0;if(i=D,D=D+16|0,0|(r=0|We(e|=0,t|=0,o=i)))return D=i,0|(o=r);r=0|qt(0|e,0|t,45),T(),r=0==(0|z(127&r)),s=0|qt(0|e,0|t,52),T(),s&=15;e:do{if(!r){if(0|s)for(r=1;;){if(!(0==((0|Vt(7,0,3*(15-r|0)|0))&e)&0==(T()&t)))break e;if(!(r>>>0<s>>>0))break;r=r+1|0}return Ee(o,s,0,5,n),D=i,0|0}}while(0);return Ne(o,s,0,6,n),D=i,0|0}function Qe(e,t){t|=0;var n=0,i=0,s=0,o=0,a=0,l=0,c=0;if((e|=0)>>>0>15)return 0|(l=4);if(Vt(0|e,0,52),l=134225919|T(),!e){n=0,i=0;do{0|z(i)&&(Vt(0|i,0,45),a=l|T(),r[(e=t+(n<<3)|0)>>2]=-1,r[e+4>>2]=a,n=n+1|0),i=i+1|0}while(122!=(0|i));return 0|(n=0)}n=0,a=0;do{if(0|z(a)){for(Vt(0|a,0,45),i=1,s=-1,o=l|T();s&=~(c=0|Vt(7,0,3*(15-i|0)|0)),o&=~T(),(0|i)!=(0|e);)i=i+1|0;r[(c=t+(n<<3)|0)>>2]=s,r[c+4>>2]=o,n=n+1|0}a=a+1|0}while(122!=(0|a));return 0|(n=0)}function Ke(e,t,n,i){e|=0,i|=0;var s=0,o=0;s=0|qt(0|(t|=0),0|(n|=0),52),T(),0==(0|t)&0==(0|n)|(0|i)>15|(0|(s&=15))>(0|i)?(i=-1,s=-1,t=0,n=0):(o=0|function(e,t,n,i){return e|=0,t|=0,(0|(i|=0))<(0|(n|=0))?(i=e,S(0|(n=t)),0|i):(n=0|Vt(-1,-1,3+(3*(i-n|0)|0)|0),i=0|Vt(0|~n,0|~T(),3*(15-i|0)|0),n=~T()&t,i=~i&e,S(0|n),0|i)}(t,n,s+1|0,i),n=-15728641&T(),t=0|Vt(0|i,0,52),i=(o=0==(0|Be(t|=o,n|=T())))?-1:i),r[(o=e)>>2]=t,r[o+4>>2]=n,r[e+8>>2]=s,r[e+12>>2]=i}function Ze(e){var t,n=0,i=0,s=0,o=0,a=0,l=0,c=0,u=0;if(!(0==(0|(n=0|r[(i=e|=0)>>2]))&0==(0|(i=0|r[i+4>>2])))&&(s=0|qt(0|n,0|i,52),T(),n=0|Dt(0|(c=0|Vt(1,0,3*(15^(s&=15))|0)),0|T(),0|n,0|i),i=0|T(),r[(c=e)>>2]=n,r[c+4>>2]=i,!((0|s)<(0|(l=0|r[(c=e+8|0)>>2]))))){for(t=e+12|0,a=s;;){if((0|a)==(0|l)){s=5;break}if(u=(0|a)==(0|r[t>>2]),s=0|qt(0|n,0|i,0|(o=3*(15-a|0)|0)),T(),u&1==(0|(s&=7))&!0){s=7;break}if(!(7==(0|s)&!0)){s=10;break}if(n=0|Dt(0|n,0|i,0|(u=0|Vt(1,0,0|o)),0|T()),i=0|T(),r[(u=e)>>2]=n,r[u+4>>2]=i,!((0|a)>(0|l))){s=10;break}a=a+-1|0}if(5==(0|s))return r[(u=e)>>2]=0,r[u+4>>2]=0,r[c>>2]=-1,void(r[t>>2]=-1);if(7==(0|s))return l=0|Dt(0|n,0|i,0|(l=0|Vt(1,0,0|o)),0|T()),c=0|T(),r[(u=e)>>2]=l,r[u+4>>2]=c,void(r[t>>2]=a+-1)}}function Je(e){var t;return t=(e=+e)<0?e+6.283185307179586:e,+(e>=6.283185307179586?t+-6.283185307179586:t)}function $e(e,t){return t|=0,+c(+(+s[(e|=0)>>3]-+s[t>>3]))<17453292519943298e-27?0|(t=+c(+(+s[e+8>>3]-+s[t+8>>3]))<17453292519943298e-27):0|(t=0)}function et(e,t){e|=0;var n,i,r,o=0;return i=+s[(t|=0)>>3],n=+s[e>>3],o=(r=+p(.5*(i-n)))*r+(o=+p(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+d(+i)*+d(+n)*o),2*+v(+ +u(+o),+ +u(+(1-o)))*6371.007180918475}function tt(e,t){t|=0;var n=0;return(e|=0)>>>0>15?0|(t=4):(n=0|Bt(0|(n=0|ht(7,0,e,((0|e)<0)<<31>>31)),0|T(),120,0),e=0|T(),r[t>>2]=2|n,r[t+4>>2]=e,0|(t=0))}function nt(e,t,n){e|=0,n|=0;var i,r,o,a,l=0,c=0,h=0,f=0,m=0,y=0;return y=+s[(t|=0)>>3],o=+s[e>>3],m=+p(.5*(y-o)),h=+s[t+8>>3],r=+s[e+8>>3],f=+p(.5*(h-r)),i=+d(+o),a=+d(+y),f=2*+v(+ +u(+(f=m*m+f*(a*i*f))),+ +u(+(1-f))),m=+s[n>>3],y=+p(.5*(m-y)),l=+s[n+8>>3],h=+p(.5*(l-h)),c=+d(+m),h=2*+v(+ +u(+(h=y*y+h*(a*c*h))),+ +u(+(1-h))),m=+p(.5*(o-m)),l=+p(.5*(r-l)),l=2*+v(+ +u(+(l=m*m+l*(i*c*l))),+ +u(+(1-l))),4*+g(+ +u(+ +A(.5*(c=.5*(f+h+l)))*+A(.5*(c-f))*+A(.5*(c-h))*+A(.5*(c-l))))}function it(e,t,n){n|=0;var i,o,a,l=0,c=0;if(a=D,D=D+192|0,o=a,0|(c=0|Xe(e|=0,t|=0,i=a+168|0)))return D=a,0|(n=c);if(0|Ye(e,t,o)&&M(23313,22742,386,22751),(0|(t=0|r[o>>2]))>0){if(l=+nt(o+8|0,o+8+((1!=(0|t)&1)<<4)|0,i)+0,1!=(0|t)){e=1;do{l+=+nt(o+8+((c=e)<<4)|0,o+8+((0|(e=e+1|0))%(0|t)<<4)|0,i)}while((0|e)<(0|t))}}else l=0;return s[n>>3]=l,D=a,0|(n=0)}function rt(e){e|=0;var t,n,i=0;return(t=0|Nt(1,12))||M(22832,22787,49,22845),0|(i=0|r[(n=e+4|0)>>2])?(r[(i=i+8|0)>>2]=t,r[n>>2]=t,0|t):(0|r[e>>2]&&M(22862,22787,61,22885),r[(i=e)>>2]=t,r[n>>2]=t,0|t)}function st(e,t){e|=0,t|=0;var n,i;return(i=0|Rt(24))||M(22899,22787,78,22913),r[i>>2]=r[t>>2],r[i+4>>2]=r[t+4>>2],r[i+8>>2]=r[t+8>>2],r[i+12>>2]=r[t+12>>2],r[i+16>>2]=0,0|(n=0|r[(t=e+4|0)>>2])?(r[n+16>>2]=i,r[t>>2]=i,0|i):(0|r[e>>2]&&M(22928,22787,82,22913),r[e>>2]=i,r[t>>2]=i,0|i)}function ot(e){var t=0,n=0,i=0,s=0;if(e|=0)for(i=1;;){if(0|(t=0|r[e>>2]))do{if(0|(n=0|r[t>>2]))do{s=n,n=0|r[n+16>>2],Pt(s)}while(0!=(0|n));s=t,t=0|r[t+8>>2],Pt(s)}while(0!=(0|t));if(t=e,e=0|r[e+8>>2],i||Pt(t),!e)break;i=0}}function at(e){var t,n,i=0,o=0,a=0,l=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0,w=0,S=0,T=0,E=0,C=0,R=0,P=0,N=0,D=0,L=0,I=0,O=0,k=0;if(0|r[(l=(e|=0)+8|0)>>2])return 0|(k=1);if(!(a=0|r[e>>2]))return 0|(k=0);i=a,o=0;do{o=o+1|0,i=0|r[i+8>>2]}while(0!=(0|i));if(o>>>0<2)return 0|(k=0);(n=0|Rt(o<<2))||M(22948,22787,317,22967),(t=0|Rt(o<<5))||M(22989,22787,321,22967),r[e>>2]=0,r[(C=e+4|0)>>2]=0,r[l>>2]=0,o=0,I=0,E=0,m=0;e:for(;;){if(f=0|r[a>>2]){u=0,h=f;do{if(p=+s[h+8>>3],i=h,h=0|r[h+16>>2],d=+s[(l=(A=0==(0|h))?f:h)+8>>3],+c(+(p-d))>3.141592653589793){k=14;break}u+=(d-p)*(+s[i>>3]+ +s[l>>3])}while(!A);if(14==(0|k)){k=0,u=0,i=f;do{T=+s[i+8>>3],D=0|r[(L=i+16|0)>>2],S=+s[(D=0==(0|D)?f:D)+8>>3],u+=(+s[i>>3]+ +s[D>>3])*((S<0?S+6.283185307179586:S)-(T<0?T+6.283185307179586:T)),i=0|r[(0==(0|i)?a:L)>>2]}while(0!=(0|i))}u>0?(r[n+(I<<2)>>2]=a,I=I+1|0,l=E,i=m):k=19}else k=19;if(19==(0|k)){k=0;do{if(!o){if(m){l=C,h=m+8|0,i=a,o=e;break}if(0|r[e>>2]){k=27;break e}l=C,h=e,i=a,o=e;break}if(0|r[(i=o+8|0)>>2]){k=21;break e}if(!(o=0|Nt(1,12))){k=23;break e}r[i>>2]=o,l=o+4|0,h=o,i=m}while(0);if(r[h>>2]=a,r[l>>2]=a,h=t+(E<<5)|0,A=0|r[a>>2]){for(s[(f=t+(E<<5)+8|0)>>3]=17976931348623157e292,s[(m=t+(E<<5)+24|0)>>3]=17976931348623157e292,s[h>>3]=-17976931348623157e292,s[(g=t+(E<<5)+16|0)>>3]=-17976931348623157e292,_=17976931348623157e292,w=-17976931348623157e292,l=0,v=A,p=17976931348623157e292,b=17976931348623157e292,x=-17976931348623157e292,d=-17976931348623157e292;u=+s[v>>3],T=+s[v+8>>3],v=0|r[v+16>>2],S=+s[((y=0==(0|v))?A:v)+8>>3],u<p&&(s[f>>3]=u,p=u),T<b&&(s[m>>3]=T,b=T),u>x?s[h>>3]=u:u=x,T>d&&(s[g>>3]=T,d=T),_=T>0&T<_?T:_,w=T<0&T>w?T:w,l|=+c(+(T-S))>3.141592653589793,!y;)x=u;l&&(s[g>>3]=w,s[m>>3]=_)}else r[h>>2]=0,r[h+4>>2]=0,r[h+8>>2]=0,r[h+12>>2]=0,r[h+16>>2]=0,r[h+20>>2]=0,r[h+24>>2]=0,r[h+28>>2]=0;l=E+1|0}if(a=0|r[(L=a+8|0)>>2],r[L>>2]=0,!a){k=45;break}E=l,m=i}if(21==(0|k))M(22765,22787,35,22799);else if(23==(0|k))M(22819,22787,37,22799);else if(27==(0|k))M(22862,22787,61,22885);else if(45==(0|k)){e:do{if((0|I)>0){for(L=0==(0|l),N=l<<2,D=0==(0|e),P=0,i=0;;){if(R=0|r[n+(P<<2)>>2],L)k=73;else{if(!(E=0|Rt(N))){k=50;break}if(!(C=0|Rt(N))){k=52;break}t:do{if(D)o=0;else{for(l=0,o=0,h=e;a=t+(l<<5)|0,0|lt(0|r[h>>2],a,0|r[R>>2])?(r[E+(o<<2)>>2]=h,r[C+(o<<2)>>2]=a,y=o+1|0):y=o,h=0|r[h+8>>2];)l=l+1|0,o=y;if((0|y)>0)if(a=0|r[E>>2],1==(0|y))o=a;else for(g=0,v=-1,o=a,m=a;;){for(A=0|r[m>>2],a=0,h=0;f=(0|(l=0|r[r[E+(h<<2)>>2]>>2]))==(0|A)?a:a+(1&lt(l,0|r[C+(h<<2)>>2],0|r[A>>2]))|0,(0|(h=h+1|0))!=(0|y);)a=f;if(o=(l=(0|f)>(0|v))?m:o,(0|(a=g+1|0))==(0|y))break t;g=a,v=l?f:v,m=0|r[E+(a<<2)>>2]}else o=0}}while(0);if(Pt(E),Pt(C),o){if(a=0|r[(l=o+4|0)>>2])o=a+8|0;else if(0|r[o>>2]){k=70;break}r[o>>2]=R,r[l>>2]=R}else k=73}if(73==(0|k)){if(k=0,0|(i=0|r[R>>2]))do{C=i,i=0|r[i+16>>2],Pt(C)}while(0!=(0|i));Pt(R),i=1}if((0|(P=P+1|0))>=(0|I)){O=i;break e}}50==(0|k)?M(23004,22787,249,23023):52==(0|k)?M(23042,22787,252,23023):70==(0|k)&&M(22862,22787,61,22885)}else O=0}while(0);return Pt(n),Pt(t),0|(k=O)}return 0}function lt(e,t,n){e|=0;var i=0,o=0,a=0,l=0,c=0,u=0,h=0,d=0;if(!(0|Y(t|=0,n|=0)))return 0|(e=0);if(t=0|X(t),i=+s[n>>3],o=t&(o=+s[n+8>>3])<0?o+6.283185307179586:o,!(e=0|r[e>>2]))return 0|(e=0);if(t){t=0,h=o,n=e;e:for(;;){for(;l=+s[n>>3],o=+s[n+8>>3],d=0|r[(n=n+16|0)>>2],a=+s[(d=0==(0|d)?e:d)>>3],c=+s[d+8>>3],l>a?(u=l,l=c):(u=a,a=l,l=o,o=c),(i=i==a|i==u?i+2220446049250313e-31:i)<a|i>u;)if(!(n=0|r[n>>2])){n=22;break e}if(((u=(c=l<0?l+6.283185307179586:l)+(i-a)/(u-a)*((l=o<0?o+6.283185307179586:o)-c))<0?u+6.283185307179586:u)>(h=c==h|l==h?h+-2220446049250313e-31:h)&&(t^=1),!(n=0|r[n>>2])){n=22;break}}if(22==(0|n))return 0|t}else{t=0,h=o,n=e;e:for(;;){for(;l=+s[n>>3],o=+s[n+8>>3],d=0|r[(n=n+16|0)>>2],a=+s[(d=0==(0|d)?e:d)>>3],c=+s[d+8>>3],l>a?(u=l,l=c):(u=a,a=l,l=o,o=c),(i=i==a|i==u?i+2220446049250313e-31:i)<a|i>u;)if(!(n=0|r[n>>2])){n=22;break e}if(l+(i-a)/(u-a)*(o-l)>(h=l==h|o==h?h+-2220446049250313e-31:h)&&(t^=1),!(n=0|r[n>>2])){n=22;break}}if(22==(0|n))return 0|t}return 0}function ct(e,t,n,s,o){n|=0,s|=0,o|=0;var a,l,c,u,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0;if(u=D,D=D+32|0,b=u+16|0,c=u,h=0|qt(0|(e|=0),0|(t|=0),52),T(),h&=15,g=0|qt(0|n,0|s,52),T(),(0|h)!=(15&g))return D=u,0|(b=12);if(f=0|qt(0|e,0|t,45),T(),f&=127,m=0|qt(0|n,0|s,45),T(),f>>>0>121|(m&=127)>>>0>121)return D=u,0|(b=5);if(g=(0|f)!=(0|m)){if(7==(0|(p=0|W(f,m))))return D=u,0|(b=1);7==(0|(A=0|W(m,f)))?M(23066,23090,161,23100):(v=p,d=A)}else v=0,d=0;a=0|z(f),l=0|z(m),r[b>>2]=0,r[b+4>>2]=0,r[b+8>>2]=0,r[b+12>>2]=0;do{if(v){if(p=(0|(m=0|r[4272+(28*f|0)+(v<<2)>>2]))>0,l)if(p){f=0,A=n,p=s;do{A=0|qe(A,p),p=0|T(),1==(0|(d=0|fe(d)))&&(d=0|fe(1)),f=f+1|0}while((0|f)!=(0|m));m=d,f=A,A=p}else m=d,f=n,A=s;else if(p){f=0,A=n,p=s;do{A=0|Ve(A,p),p=0|T(),d=0|fe(d),f=f+1|0}while((0|f)!=(0|m));m=d,f=A,A=p}else m=d,f=n,A=s;if(He(f,A,b),g||M(23115,23090,191,23100),(p=0!=(0|a))&(d=0!=(0|l))&&M(23142,23090,192,23100),p){if(7==(0|(d=0|Fe(e,t)))){h=5;break}if(0|i[21872+(7*d|0)+v|0]){h=1;break}f=A=0|r[21040+(28*d|0)+(v<<2)>>2]}else if(d){if(7==(0|(d=0|Fe(f,A)))){h=5;break}if(0|i[21872+(7*d|0)+m|0]){h=1;break}f=0,A=0|r[21040+(28*m|0)+(d<<2)>>2]}else f=0,A=0;if((f|A)<0)h=5;else{if((0|A)>0){p=b+4|0,d=0;do{pe(p),d=d+1|0}while((0|d)!=(0|A))}if(r[c>>2]=0,r[c+4>>2]=0,r[c+8>>2]=0,he(c,v),0|h)for(;0|Ge(h)?ce(c):ue(c),(0|h)>1;)h=h+-1|0;if((0|f)>0){h=0;do{pe(c),h=h+1|0}while((0|h)!=(0|f))}te(y=b+4|0,c,y),$(y),y=51}}else if(He(n,s,b),0!=(0|a)&0!=(0|l))if((0|m)!=(0|f)&&M(23173,23090,261,23100),7==(0|(d=0|Fe(e,t)))|7==(0|(h=0|Fe(n,s))))h=5;else if(0|i[21872+(7*d|0)+h|0])h=1;else if((0|(d=0|r[21040+(28*d|0)+(h<<2)>>2]))>0){p=b+4|0,h=0;do{pe(p),h=h+1|0}while((0|h)!=(0|d));y=51}else y=51;else y=51}while(0);return 51==(0|y)&&(h=b+4|0,r[o>>2]=r[h>>2],r[o+4>>2]=r[h+4>>2],r[o+8>>2]=r[h+8>>2],h=0),D=u,0|(b=h)}function ut(e,t,n,i){n|=0,i|=0;var s,o,a,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0;if(a=D,D=D+48|0,s=a+36|0,u=a+24|0,h=a+12|0,d=a,l=0|qt(0|(e|=0),0|(t|=0),52),T(),l&=15,A=0|qt(0|e,0|t,45),T(),(A&=127)>>>0>121)return D=a,0|(i=5);if(o=0|z(A),Vt(0|l,0,52),g=134225919|T(),r[(c=i)>>2]=-1,r[c+4>>2]=g,!l)return 7==(0|(l=0|re(n)))||127==(0|(l=0|H(A,l)))?(D=a,0|(g=1)):(f=0|Vt(0|l,0,45),m=0|T(),m=-1040385&r[(A=i)+4>>2]|m,r[(g=i)>>2]=r[A>>2]|f,r[g+4>>2]=m,D=a,0|(g=0));for(r[s>>2]=r[n>>2],r[s+4>>2]=r[n+4>>2],r[s+8>>2]=r[n+8>>2],n=l;;){if(c=n,n=n+-1|0,r[u>>2]=r[s>>2],r[u+4>>2]=r[s+4>>2],r[u+8>>2]=r[s+8>>2],0|Ge(c)){if(0|(l=0|se(s))){n=13;break}r[h>>2]=r[s>>2],r[h+4>>2]=r[s+4>>2],r[h+8>>2]=r[s+8>>2],ce(h)}else{if(0|(l=0|oe(s))){n=13;break}r[h>>2]=r[s>>2],r[h+4>>2]=r[s+4>>2],r[h+8>>2]=r[s+8>>2],ue(h)}if(ne(u,h,d),$(d),y=0|r[(l=i)>>2],l=0|r[l+4>>2],v=0|Vt(7,0,0|(b=3*(15-c|0)|0)),l&=~T(),b=0|Vt(0|re(d),0,0|b),l=T()|l,r[(g=i)>>2]=b|y&~v,r[g+4>>2]=l,(0|c)<=1){n=14;break}}e:do{if(13!=(0|n)&&14==(0|n))if((0|r[s>>2])<=1&&(0|r[s+4>>2])<=1&&(0|r[s+8>>2])<=1){d=127==(0|(l=0|H(A,n=0|re(s))))?0:0|z(l);t:do{if(n){if(o){if(7==(0|(l=0|Fe(e,t)))){l=5;break e}if((0|(c=0|r[21248+(28*l|0)+(n<<2)>>2]))>0){l=n,n=0;do{l=0|Ae(l),n=n+1|0}while((0|n)!=(0|c))}else l=n;if(1==(0|l)){l=9;break e}127==(0|(n=0|H(A,l)))&&M(23200,23090,411,23230),0|z(n)?M(23245,23090,412,23230):(m=n,f=c,p=l)}else m=l,f=0,p=n;if((0|(h=0|r[4272+(28*A|0)+(p<<2)>>2]))<=-1&&M(23276,23090,419,23230),!d){if((0|f)<0){l=5;break e}if(0|f){l=0,n=0|r[(c=i)>>2],c=0|r[c+4>>2];do{n=0|ze(n,c),c=0|T(),r[(b=i)>>2]=n,r[b+4>>2]=c,l=l+1|0}while((0|l)<(0|f))}if((0|h)<=0){l=m,n=58;break}for(l=0,n=0|r[(c=i)>>2],c=0|r[c+4>>2];;)if(n=0|ze(n,c),c=0|T(),r[(b=i)>>2]=n,r[b+4>>2]=c,(0|(l=l+1|0))==(0|h)){l=m,n=58;break t}}if(7==(0|(u=0|W(m,A)))&&M(23066,23090,428,23230),n=0|r[(l=i)>>2],l=0|r[l+4>>2],(0|h)>0){c=0;do{n=0|ze(n,l),l=0|T(),r[(b=i)>>2]=n,r[b+4>>2]=l,c=c+1|0}while((0|c)!=(0|h))}if(7==(0|(l=0|Fe(n,l)))&&M(23313,23090,440,23230),n=0|q(m),(0|(n=0|r[(n?21664:21456)+(28*u|0)+(l<<2)>>2]))<0&&M(23313,23090,454,23230),n){l=0,c=0|r[(u=i)>>2],u=0|r[u+4>>2];do{c=0|Ue(c,u),u=0|T(),r[(b=i)>>2]=c,r[b+4>>2]=u,l=l+1|0}while((0|l)<(0|n));l=m,n=58}else l=m,n=58}else if(0!=(0|o)&0!=(0|d)){if(7==(0|(n=0|Fe(e,t)))|7==(0|(c=0|Fe(0|r[(c=i)>>2],0|r[c+4>>2])))){l=5;break e}if((0|(c=0|r[21248+(28*n|0)+(c<<2)>>2]))<0){l=5;break e}if(c){n=0,u=0|r[(h=i)>>2],h=0|r[h+4>>2];do{u=0|ze(u,h),h=0|T(),r[(b=i)>>2]=u,r[b+4>>2]=h,n=n+1|0}while((0|n)<(0|c));n=58}else n=59}else n=58}while(0);if(58==(0|n)&&d&&(n=59),59==(0|n)&&1==(0|Fe(0|r[(b=i)>>2],0|r[b+4>>2]))){l=9;break}v=0|r[(b=i)>>2],b=-1040385&r[b+4>>2],y=0|Vt(0|l,0,45),b|=T(),r[(l=i)>>2]=v|y,r[l+4>>2]=b,l=0}else l=1}while(0);return D=a,0|(b=l)}function ht(e,t,n,i){e|=0,t|=0;var r=0,s=0,o=0;if(0==(0|(n|=0))&0==(0|(i|=0)))return s=1,S(0|(r=0)),0|s;s=e,r=t,e=1,t=0;do{e=0|Bt(0|((o=0==(1&n)&!0)?1:s),0|(o?0:r),0|e,0|t),t=0|T(),n=0|zt(0|n,0|i,1),i=0|T(),s=0|Bt(0|s,0|r,0|s,0|r),r=0|T()}while(!(0==(0|n)&0==(0|i)));return S(0|t),0|e}function dt(e,t,n){e|=0;var i,o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0;if(!(0|Y(t|=0,n|=0)))return 0|(A=0);if(t=0|X(t),o=+s[n>>3],a=t&(a=+s[n+8>>3])<0?a+6.283185307179586:a,(0|(A=0|r[e>>2]))<=0)return 0|(A=0);if(i=0|r[e+4>>2],t){t=0,p=a,n=-1,e=0;e:for(;;){for(d=e;c=+s[i+(d<<4)>>3],a=+s[i+(d<<4)+8>>3],l=+s[i+((e=(n+2|0)%(0|A)|0)<<4)>>3],u=+s[i+(e<<4)+8>>3],c>l?(h=c,c=u):(h=l,l=c,c=a,a=u),(o=o==l|o==h?o+2220446049250313e-31:o)<l|o>h;){if((0|(n=d+1|0))>=(0|A)){n=22;break e}e=d,d=n,n=e}if(((h=(u=c<0?c+6.283185307179586:c)+(o-l)/(h-l)*((c=a<0?a+6.283185307179586:a)-u))<0?h+6.283185307179586:h)>(p=u==p|c==p?p+-2220446049250313e-31:p)&&(t^=1),(0|(e=d+1|0))>=(0|A)){n=22;break}n=d}if(22==(0|n))return 0|t}else{t=0,p=a,n=-1,e=0;e:for(;;){for(d=e;c=+s[i+(d<<4)>>3],a=+s[i+(d<<4)+8>>3],l=+s[i+((e=(n+2|0)%(0|A)|0)<<4)>>3],u=+s[i+(e<<4)+8>>3],c>l?(h=c,c=u):(h=l,l=c,c=a,a=u),(o=o==l|o==h?o+2220446049250313e-31:o)<l|o>h;){if((0|(n=d+1|0))>=(0|A)){n=22;break e}e=d,d=n,n=e}if(c+(o-l)/(h-l)*(a-c)>(p=c==p|a==p?p+-2220446049250313e-31:p)&&(t^=1),(0|(e=d+1|0))>=(0|A)){n=22;break}n=d}if(22==(0|n))return 0|t}return 0}function pt(e,t){t|=0;var n,i,o,a,l,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0;if(!(i=0|r[(e|=0)>>2]))return r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,r[t+20>>2]=0,r[t+24>>2]=0,void(r[t+28>>2]=0);if(s[(o=t+8|0)>>3]=17976931348623157e292,s[(a=t+24|0)>>3]=17976931348623157e292,s[t>>3]=-17976931348623157e292,s[(l=t+16|0)>>3]=-17976931348623157e292,!((0|i)<=0)){for(n=0|r[e+4>>2],g=17976931348623157e292,v=-17976931348623157e292,y=0,e=-1,p=17976931348623157e292,A=17976931348623157e292,m=-17976931348623157e292,h=-17976931348623157e292,b=0;u=+s[n+(b<<4)>>3],f=+s[n+(b<<4)+8>>3],d=+s[n+(((0|(e=e+2|0))==(0|i)?0:e)<<4)+8>>3],u<p&&(s[o>>3]=u,p=u),f<A&&(s[a>>3]=f,A=f),u>m?s[t>>3]=u:u=m,f>h&&(s[l>>3]=f,h=f),g=f>0&f<g?f:g,v=f<0&f>v?f:v,y|=+c(+(f-d))>3.141592653589793,(0|(e=b+1|0))!=(0|i);)x=b,m=u,b=e,e=x;y&&(s[l>>3]=v,s[a>>3]=g)}}function At(e,t){t|=0;var n,i=0,o=0,a=0,l=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0,w=0,S=0,T=0,M=0;if(v=0|r[(e|=0)>>2]){if(s[(y=t+8|0)>>3]=17976931348623157e292,s[(b=t+24|0)>>3]=17976931348623157e292,s[t>>3]=-17976931348623157e292,s[(x=t+16|0)>>3]=-17976931348623157e292,(0|v)>0){for(a=0|r[e+4>>2],m=17976931348623157e292,g=-17976931348623157e292,o=0,i=-1,d=17976931348623157e292,p=17976931348623157e292,f=-17976931348623157e292,u=-17976931348623157e292,_=0;l=+s[a+(_<<4)>>3],A=+s[a+(_<<4)+8>>3],h=+s[a+(((0|(T=i+2|0))==(0|v)?0:T)<<4)+8>>3],l<d&&(s[y>>3]=l,d=l),A<p&&(s[b>>3]=A,p=A),l>f?s[t>>3]=l:l=f,A>u&&(s[x>>3]=A,u=A),m=A>0&A<m?A:m,g=A<0&A>g?A:g,o|=+c(+(A-h))>3.141592653589793,(0|(i=_+1|0))!=(0|v);)T=_,f=l,_=i,i=T;o&&(s[x>>3]=g,s[b>>3]=m)}}else r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,r[t+20>>2]=0,r[t+24>>2]=0,r[t+28>>2]=0;if(!((0|(i=0|r[(T=e+8|0)>>2]))<=0)){n=e+12|0,S=0;do{if(a=0|r[n>>2],o=S,b=t+((S=S+1|0)<<5)|0,x=0|r[a+(o<<3)>>2]){if(s[(_=t+(S<<5)+8|0)>>3]=17976931348623157e292,s[(e=t+(S<<5)+24|0)>>3]=17976931348623157e292,s[b>>3]=-17976931348623157e292,s[(w=t+(S<<5)+16|0)>>3]=-17976931348623157e292,(0|x)>0){for(v=0|r[a+(o<<3)+4>>2],m=17976931348623157e292,g=-17976931348623157e292,a=0,o=-1,y=0,d=17976931348623157e292,p=17976931348623157e292,A=-17976931348623157e292,u=-17976931348623157e292;l=+s[v+(y<<4)>>3],f=+s[v+(y<<4)+8>>3],h=+s[v+(((0|(o=o+2|0))==(0|x)?0:o)<<4)+8>>3],l<d&&(s[_>>3]=l,d=l),f<p&&(s[e>>3]=f,p=f),l>A?s[b>>3]=l:l=A,f>u&&(s[w>>3]=f,u=f),m=f>0&f<m?f:m,g=f<0&f>g?f:g,a|=+c(+(f-h))>3.141592653589793,(0|(o=y+1|0))!=(0|x);)M=y,y=o,A=l,o=M;a&&(s[w>>3]=g,s[e>>3]=m)}}else r[b>>2]=0,r[b+4>>2]=0,r[b+8>>2]=0,r[b+12>>2]=0,r[b+16>>2]=0,r[b+20>>2]=0,r[b+24>>2]=0,r[b+28>>2]=0,i=0|r[T>>2]}while((0|S)<(0|i))}}function ft(e,t,n){var i=0,s=0,o=0;if(!(0|dt(e|=0,t|=0,n|=0)))return 0|(s=0);if((0|r[(s=e+8|0)>>2])<=0)return 0|(s=1);for(i=e+12|0,e=0;;){if(o=e,e=e+1|0,0|dt((0|r[i>>2])+(o<<3)|0,t+(e<<5)|0,n)){e=0,i=6;break}if((0|e)>=(0|r[s>>2])){e=1,i=6;break}}return 6==(0|i)?0|e:0}function mt(e,t,n,i,r){t|=0,n|=0,i|=0,r|=0;var o,a,l,c,u,h,d,p=0;c=+s[(e|=0)>>3],l=+s[t>>3]-c,a=+s[e+8>>3],o=+s[t+8>>3]-a,h=+s[n>>3],p=((p=+s[i>>3]-h)*(a-(d=+s[n+8>>3]))-(c-h)*(u=+s[i+8>>3]-d))/(l*u-o*p),s[r>>3]=c+l*p,s[r+8>>3]=a+o*p}function gt(e,t){return t|=0,+c(+(+s[(e|=0)>>3]-+s[t>>3]))<1.1920928955078125e-7?0|(t=+c(+(+s[e+8>>3]-+s[t+8>>3]))<1.1920928955078125e-7):0|(t=0)}function vt(e,t){t|=0;var n,i,r;return+((r=+s[(e|=0)>>3]-+s[t>>3])*r+(i=+s[e+8>>3]-+s[t+8>>3])*i+(n=+s[e+16>>3]-+s[t+16>>3])*n)}function yt(e,t,n){n|=0;var i,s,o,a,l=0,c=0,u=0;if(a=D,D=D+32|0,u=a,0|(l=0|We(e|=0,t|=0,s=a+16|0)))return D=a,0|(n=l);i=0|Le(e,t),o=0|Fe(e,t),function(e,t){e=7696+(28*(e|=0)|0)|0,r[(t|=0)>>2]=r[e>>2],r[t+4>>2]=r[e+4>>2],r[t+8>>2]=r[e+8>>2],r[t+12>>2]=r[e+12>>2]}(i,u),l=0|function(e,t){e|=0;var n=0,i=0;if((t|=0)>>>0>20)return-1;do{if((0|r[11120+(216*t|0)>>2])!=(0|e))if((0|r[11120+(216*t|0)+8>>2])!=(0|e))if((0|r[11120+(216*t|0)+16>>2])!=(0|e))if((0|r[11120+(216*t|0)+24>>2])!=(0|e))if((0|r[11120+(216*t|0)+32>>2])!=(0|e))if((0|r[11120+(216*t|0)+40>>2])!=(0|e))if((0|r[11120+(216*t|0)+48>>2])!=(0|e))if((0|r[11120+(216*t|0)+56>>2])!=(0|e))if((0|r[11120+(216*t|0)+64>>2])!=(0|e))if((0|r[11120+(216*t|0)+72>>2])!=(0|e))if((0|r[11120+(216*t|0)+80>>2])!=(0|e))if((0|r[11120+(216*t|0)+88>>2])!=(0|e))if((0|r[11120+(216*t|0)+96>>2])!=(0|e))if((0|r[11120+(216*t|0)+104>>2])!=(0|e))if((0|r[11120+(216*t|0)+112>>2])!=(0|e))if((0|r[11120+(216*t|0)+120>>2])!=(0|e))if((0|r[11120+(216*t|0)+128>>2])!=(0|e)){if((0|r[11120+(216*t|0)+136>>2])!=(0|e)){if((0|r[11120+(216*t|0)+144>>2])==(0|e)){e=0,n=2,i=0;break}if((0|r[11120+(216*t|0)+152>>2])==(0|e)){e=0,n=2,i=1;break}if((0|r[11120+(216*t|0)+160>>2])==(0|e)){e=0,n=2,i=2;break}if((0|r[11120+(216*t|0)+168>>2])==(0|e)){e=1,n=2,i=0;break}if((0|r[11120+(216*t|0)+176>>2])==(0|e)){e=1,n=2,i=1;break}if((0|r[11120+(216*t|0)+184>>2])==(0|e)){e=1,n=2,i=2;break}if((0|r[11120+(216*t|0)+192>>2])==(0|e)){e=2,n=2,i=0;break}if((0|r[11120+(216*t|0)+200>>2])==(0|e)){e=2,n=2,i=1;break}if((0|r[11120+(216*t|0)+208>>2])==(0|e)){e=2,n=2,i=2;break}return-1}e=2,n=1,i=2}else e=2,n=1,i=1;else e=2,n=1,i=0;else e=1,n=1,i=2;else e=1,n=1,i=1;else e=1,n=1,i=0;else e=0,n=1,i=2;else e=0,n=1,i=1;else e=0,n=1,i=0;else e=2,n=0,i=2;else e=2,n=0,i=1;else e=2,n=0,i=0;else e=1,n=0,i=2;else e=1,n=0,i=1;else e=1,n=0,i=0;else e=0,n=0,i=2;else e=0,n=0,i=1;else e=0,n=0,i=0}while(0);return 0|r[11120+(216*t|0)+(72*n|0)+(24*e|0)+(i<<3)+4>>2]}(i,0|r[s>>2]);e:do{if(0|z(i)){switch(0|i){case 4:e=0;break;case 14:e=1;break;case 24:e=2;break;case 38:e=3;break;case 49:e=4;break;case 58:e=5;break;case 63:e=6;break;case 72:e=7;break;case 83:e=8;break;case 97:e=9;break;case 107:e=10;break;case 117:e=11;break;default:l=1;break e}if(c=0|r[22e3+(24*e|0)+8>>2],t=0|r[22e3+(24*e|0)+16>>2],(0|(e=0|r[s>>2]))!=(0|r[u>>2])&&(u=0|q(i))|(0|(e=0|r[s>>2]))==(0|t)&&(l=(l+1|0)%6|0),3==(0|o)&(0|e)==(0|t)){l=(l+5|0)%6|0,c=22;break}5==(0|o)&(0|e)==(0|c)?(l=(l+1|0)%6|0,c=22):c=22}else c=22}while(0);return 22==(0|c)&&(r[n>>2]=l,l=0),D=a,0|(n=l)}function bt(e,t,n,i){n|=0,i|=0;var s,o,a,l,c,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0;if(c=D,D=D+32|0,b=c+24|0,l=c+20|0,a=c+8|0,o=c+16|0,s=c,A=(A=0==(0|Be(e|=0,t|=0)))?6:5,m=0|qt(0|e,0|t,52),T(),A>>>0<=n>>>0)return D=c,0|(i=2);!(g=0==(0|(m&=15)))&&0==((v=0|Vt(7,0,3*(15^m)|0))&e)&0==(T()&t)?u=n:h=4;e:do{if(4==(0|h)){if((0|((u=0!=(0|Be(e,t)))?4:5))<(0|n))return D=c,0|(i=1);if(0|yt(e,t,b))return D=c,0|(i=1);if(h=(0|r[b>>2])+n|0,7==(0|(v=0|r[(u=u?22288+((0|h)%5<<2)|0:22320+((0|h)%6<<2)|0)>>2])))return D=c,0|(i=1);r[l>>2]=0,u=0|B(e,t,v,l,a);do{if(!u){if(f=0|r[(p=a)>>2],h=(d=(p=0|r[p+4>>2])>>>0<t>>>0|(0|p)==(0|t)&f>>>0<e>>>0)?f:e,d=d?p:t,!g&&0==(f&(g=0|Vt(7,0,3*(15^m)|0)))&0==(p&T()))u=n;else{if(p=(n+-1+A|0)%(0|A)|0,u=0|Be(e,t),(0|p)<0&&M(23313,23315,245,23324),(0|((A=0!=(0|u))?4:5))<(0|p)&&M(23313,23315,245,23324),0|yt(e,t,b)&&M(23313,23315,245,23324),u=(0|r[b>>2])+p|0,7==(0|(p=0|r[(u=A?22288+((0|u)%5<<2)|0:22320+((0|u)%6<<2)|0)>>2]))&&M(23313,23315,245,23324),r[o>>2]=0,0|(u=0|B(e,t,p,o,s)))break;A=0|r[(f=s)>>2],f=0|r[f+4>>2];do{if(f>>>0<d>>>0|(0|f)==(0|d)&A>>>0<h>>>0){if(h=0|Be(A,f)?0|F(A,f,e,t):0|r[22384+(((0|r[o>>2])+(0|r[22352+(p<<2)>>2])|0)%6<<2)>>2],u=0|Be(A,f),(h+-1|0)>>>0>5){u=-1,h=A,d=f;break}if(1==(0|h)&(u=0!=(0|u))){u=-1,h=A,d=f;break}do{if(!(0|yt(A,f,b))){if(u){u=(5+(0|r[21936+(h<<2)>>2])-(0|r[b>>2])|0)%5|0;break}u=(6+(0|r[21968+(h<<2)>>2])-(0|r[b>>2])|0)%6|0;break}u=-1}while(0);h=A,d=f}else u=n}while(0);f=0|r[(p=a)>>2],p=0|r[p+4>>2]}if((0|h)==(0|f)&(0|d)==(0|p)){if(e=(A=0!=(0|Be(f,p)))?0|F(f,p,e,t):0|r[22384+(((0|r[l>>2])+(0|r[22352+(v<<2)>>2])|0)%6<<2)>>2],u=0|Be(f,p),(e+-1|0)>>>0<=5&&!(1==(0|e)&(y=0!=(0|u))))do{if(!(0|yt(f,p,b))){if(y){u=(5+(0|r[21936+(e<<2)>>2])-(0|r[b>>2])|0)%5|0;break}u=(6+(0|r[21968+(e<<2)>>2])-(0|r[b>>2])|0)%6|0;break}u=-1}while(0);else u=-1;u=6==(0|(u=u+1|0))|A&5==(0|u)?0:u}t=d,e=h;break e}}while(0);return D=c,0|(i=u)}}while(0);return y=0|Vt(0|u,0,56),b=T()|-2130706433&t|536870912,r[i>>2]=y|e,r[i+4>>2]=b,D=c,0|(i=0)}function xt(e,t,n){e|=0,n|=0;var i=0;(0|(t|=0))>0?(i=0|Nt(t,4),r[e>>2]=i,i||M(23337,23360,40,23374)):r[e>>2]=0,r[e+4>>2]=t,r[e+8>>2]=0,r[e+12>>2]=n}function _t(e){var t,n,i,o=0,a=0,l=0,u=0;t=(e|=0)+4|0,n=e+12|0,i=e+8|0;e:for(;;){for(a=0|r[t>>2],o=0;;){if((0|o)>=(0|a))break e;if(l=0|r[e>>2],u=0|r[l+(o<<2)>>2])break;o=o+1|0}o=l+(~~(+c(+ +h(10,+ +(15-(0|r[n>>2])|0))*(+s[u>>3]+ +s[u+8>>3]))%+(0|a))>>>0<<2)|0,a=0|r[o>>2];t:do{if(0|a){if(l=u+32|0,(0|a)==(0|u))r[o>>2]=r[l>>2];else{if(!(o=0|r[(a=a+32|0)>>2]))break;for(;(0|o)!=(0|u);)if(!(o=0|r[(a=o+32|0)>>2]))break t;r[a>>2]=r[l>>2]}Pt(u),r[i>>2]=(0|r[i>>2])-1}}while(0)}Pt(0|r[e>>2])}function wt(e){var t,n=0,i=0;for(t=0|r[(e|=0)+4>>2],i=0;;){if((0|i)>=(0|t)){n=0,i=4;break}if(n=0|r[(0|r[e>>2])+(i<<2)>>2]){i=4;break}i=i+1|0}return 4==(0|i)?0|n:0}function St(e,t){t|=0;var n=0,i=0,o=0,a=0;if(n=~~(+c(+ +h(10,+ +(15-(0|r[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|r[e+4>>2]))>>>0,n=(0|r[e>>2])+(n<<2)|0,!(i=0|r[n>>2]))return 0|(a=1);a=t+32|0;do{if((0|i)!=(0|t)){if(!(n=0|r[i+32>>2]))return 0|(a=1);for(o=n;;){if((0|o)==(0|t)){o=8;break}if(!(n=0|r[o+32>>2])){n=1,o=10;break}i=o,o=n}if(8==(0|o)){r[i+32>>2]=r[a>>2];break}if(10==(0|o))return 0|n}else r[n>>2]=r[a>>2]}while(0);return Pt(t),r[(a=e+8|0)>>2]=(0|r[a>>2])-1,0|(a=0)}function Tt(e,t,n){e|=0,t|=0,n|=0;var i,o=0,a=0,l=0;(i=0|Rt(40))||M(23390,23360,98,23403),r[i>>2]=r[t>>2],r[i+4>>2]=r[t+4>>2],r[i+8>>2]=r[t+8>>2],r[i+12>>2]=r[t+12>>2],r[(a=i+16|0)>>2]=r[n>>2],r[a+4>>2]=r[n+4>>2],r[a+8>>2]=r[n+8>>2],r[a+12>>2]=r[n+12>>2],r[i+32>>2]=0,a=~~(+c(+ +h(10,+ +(15-(0|r[e+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|r[e+4>>2]))>>>0,a=(0|r[e>>2])+(a<<2)|0,o=0|r[a>>2];do{if(o){for(;!(0|$e(o,t)&&0|$e(o+16|0,n));)if(a=0|r[o+32>>2],!(0|r[(o=0==(0|a)?o:a)+32>>2])){l=10;break}if(10==(0|l)){r[o+32>>2]=i;break}return Pt(i),0|(l=o)}r[a>>2]=i}while(0);return r[(l=e+8|0)>>2]=1+(0|r[l>>2]),0|(l=i)}function Mt(e,t,n){t|=0,n|=0;var i=0,o=0;if(o=~~(+c(+ +h(10,+ +(15-(0|r[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|r[e+4>>2]))>>>0,!(o=0|r[(0|r[e>>2])+(o<<2)>>2]))return 0|(n=0);if(!n){for(e=o;;){if(0|$e(e,t)){i=10;break}if(!(e=0|r[e+32>>2])){e=0,i=10;break}}if(10==(0|i))return 0|e}for(e=o;;){if(0|$e(e,t)&&0|$e(e+16|0,n)){i=10;break}if(!(e=0|r[e+32>>2])){e=0,i=10;break}}return 10==(0|i)?0|e:0}function Et(e,t){t|=0;var n=0;if(n=~~(+c(+ +h(10,+ +(15-(0|r[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|r[e+4>>2]))>>>0,!(e=0|r[(0|r[e>>2])+(n<<2)>>2]))return 0|(n=0);for(;;){if(0|$e(e,t)){t=5;break}if(!(e=0|r[e+32>>2])){e=0,t=5;break}}return 5==(0|t)?0|e:0}function Ct(e){return 0|+function(e){return+ +Yt(+(e=+e))}(e=+e)}function Rt(e){e|=0;var t,n=0,i=0,s=0,o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0;t=D,D=D+16|0,A=t;do{if(e>>>0<245){if(e=(h=e>>>0<11?16:e+11&-8)>>>3,3&(i=(p=0|r[5857])>>>e))return s=0|r[(i=(e=23468+((n=(1&i^1)+e|0)<<1<<2)|0)+8|0)>>2],(0|(a=0|r[(o=s+8|0)>>2]))==(0|e)?r[5857]=p&~(1<<n):(r[a+12>>2]=e,r[i>>2]=a),_=n<<3,r[s+4>>2]=3|_,r[(_=s+_+4|0)>>2]=1|r[_>>2],D=t,0|(_=o);if(h>>>0>(d=0|r[5859])>>>0){if(0|i)return n=((n=i<<e&((n=2<<e)|0-n))&0-n)-1|0,a=0|r[(e=(n=23468+((s=((i=(n>>>=c=n>>>12&16)>>>5&8)|c|(a=(n>>>=i)>>>2&4)|(e=(n>>>=a)>>>1&2)|(s=(n>>>=e)>>>1&1))+(n>>>s)|0)<<1<<2)|0)+8|0)>>2],(0|(i=0|r[(c=a+8|0)>>2]))==(0|n)?(e=p&~(1<<s),r[5857]=e):(r[i+12>>2]=n,r[e>>2]=i,e=p),l=(_=s<<3)-h|0,r[a+4>>2]=3|h,r[(o=a+h|0)+4>>2]=1|l,r[a+_>>2]=l,0|d&&(s=0|r[5862],i=23468+((n=d>>>3)<<1<<2)|0,e&(n=1<<n)?n=0|r[(e=i+8|0)>>2]:(r[5857]=e|n,n=i,e=i+8|0),r[e>>2]=s,r[n+12>>2]=s,r[s+8>>2]=n,r[s+12>>2]=i),r[5859]=l,r[5862]=o,D=t,0|(_=c);if(a=0|r[5858]){for(i=(a&0-a)-1|0,i=u=0|r[23732+(((s=(i>>>=o=i>>>12&16)>>>5&8)|o|(l=(i>>>=s)>>>2&4)|(c=(i>>>=l)>>>1&2)|(u=(i>>>=c)>>>1&1))+(i>>>u)<<2)>>2],c=u,u=(-8&r[u+4>>2])-h|0;(e=0|r[i+16>>2])||(e=0|r[i+20>>2]);)i=e,c=(o=(l=(-8&r[e+4>>2])-h|0)>>>0<u>>>0)?e:c,u=o?l:u;if((l=c+h|0)>>>0>c>>>0){o=0|r[c+24>>2],n=0|r[c+12>>2];do{if((0|n)==(0|c)){if(!(n=0|r[(e=c+20|0)>>2])&&!(n=0|r[(e=c+16|0)>>2])){i=0;break}for(;;)if(i=0|r[(s=n+20|0)>>2])n=i,e=s;else{if(!(i=0|r[(s=n+16|0)>>2]))break;n=i,e=s}r[e>>2]=0,i=n}else i=0|r[c+8>>2],r[i+12>>2]=n,r[n+8>>2]=i,i=n}while(0);do{if(0|o){if(n=0|r[c+28>>2],(0|c)==(0|r[(e=23732+(n<<2)|0)>>2])){if(r[e>>2]=i,!i){r[5858]=a&~(1<<n);break}}else if(r[((0|r[(_=o+16|0)>>2])==(0|c)?_:o+20)>>2]=i,!i)break;r[i+24>>2]=o,0|(n=0|r[c+16>>2])&&(r[i+16>>2]=n,r[n+24>>2]=i),0|(n=0|r[c+20>>2])&&(r[i+20>>2]=n,r[n+24>>2]=i)}}while(0);return u>>>0<16?(_=u+h|0,r[c+4>>2]=3|_,r[(_=c+_+4|0)>>2]=1|r[_>>2]):(r[c+4>>2]=3|h,r[l+4>>2]=1|u,r[l+u>>2]=u,0|d&&(s=0|r[5862],i=23468+((n=d>>>3)<<1<<2)|0,(n=1<<n)&p?n=0|r[(e=i+8|0)>>2]:(r[5857]=n|p,n=i,e=i+8|0),r[e>>2]=s,r[n+12>>2]=s,r[s+8>>2]=n,r[s+12>>2]=i),r[5859]=u,r[5862]=l),D=t,0|(_=c+8|0)}p=h}else p=h}else p=h}else if(e>>>0<=4294967231)if(h=-8&(e=e+11|0),s=0|r[5858]){o=0-h|0,u=(e>>>=8)?h>>>0>16777215?31:h>>>((u=14-((c=((g=e<<(p=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|p|(u=((g<<=c)+245760|0)>>>16&2))+(g<<u>>>15)|0)+7|0)&1|u<<1:0,i=0|r[23732+(u<<2)>>2];e:do{if(i)for(e=0,c=h<<(31==(0|u)?0:25-(u>>>1)),a=0;;){if((l=(-8&r[i+4>>2])-h|0)>>>0<o>>>0){if(!l){e=i,o=0,g=65;break e}e=i,o=l}if(a=0==(0|(g=0|r[i+20>>2]))|(0|g)==(0|(i=0|r[i+16+(c>>>31<<2)>>2]))?a:g,!i){i=a,g=61;break}c<<=1}else i=0,e=0,g=61}while(0);if(61==(0|g)){if(0==(0|i)&0==(0|e)){if(!(e=((e=2<<u)|0-e)&s)){p=h;break}p=(e&0-e)-1|0,e=0,i=0|r[23732+(((a=(p>>>=l=p>>>12&16)>>>5&8)|l|(c=(p>>>=a)>>>2&4)|(u=(p>>>=c)>>>1&2)|(i=(p>>>=u)>>>1&1))+(p>>>i)<<2)>>2]}i?g=65:(c=e,l=o)}if(65==(0|g))for(a=i;;){if(o=(i=(p=(-8&r[a+4>>2])-h|0)>>>0<o>>>0)?p:o,e=i?a:e,(i=0|r[a+16>>2])||(i=0|r[a+20>>2]),!i){c=e,l=o;break}a=i}if(0!=(0|c)&&l>>>0<((0|r[5859])-h|0)>>>0&&(d=c+h|0)>>>0>c>>>0){a=0|r[c+24>>2],n=0|r[c+12>>2];do{if((0|n)==(0|c)){if(!(n=0|r[(e=c+20|0)>>2])&&!(n=0|r[(e=c+16|0)>>2])){n=0;break}for(;;)if(i=0|r[(o=n+20|0)>>2])n=i,e=o;else{if(!(i=0|r[(o=n+16|0)>>2]))break;n=i,e=o}r[e>>2]=0}else _=0|r[c+8>>2],r[_+12>>2]=n,r[n+8>>2]=_}while(0);do{if(a){if(e=0|r[c+28>>2],(0|c)==(0|r[(i=23732+(e<<2)|0)>>2])){if(r[i>>2]=n,!n){s&=~(1<<e),r[5858]=s;break}}else if(r[((0|r[(_=a+16|0)>>2])==(0|c)?_:a+20)>>2]=n,!n)break;r[n+24>>2]=a,0|(e=0|r[c+16>>2])&&(r[n+16>>2]=e,r[e+24>>2]=n),(e=0|r[c+20>>2])&&(r[n+20>>2]=e,r[e+24>>2]=n)}}while(0);e:do{if(l>>>0<16)_=l+h|0,r[c+4>>2]=3|_,r[(_=c+_+4|0)>>2]=1|r[_>>2];else{if(r[c+4>>2]=3|h,r[d+4>>2]=1|l,r[d+l>>2]=l,n=l>>>3,l>>>0<256){i=23468+(n<<1<<2)|0,(e=0|r[5857])&(n=1<<n)?n=0|r[(e=i+8|0)>>2]:(r[5857]=e|n,n=i,e=i+8|0),r[e>>2]=d,r[n+12>>2]=d,r[d+8>>2]=n,r[d+12>>2]=i;break}if(n=23732+((i=(n=l>>>8)?l>>>0>16777215?31:l>>>((i=14-((b=((_=n<<(x=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|x|(i=((_<<=b)+245760|0)>>>16&2))+(_<<i>>>15)|0)+7|0)&1|i<<1:0)<<2)|0,r[d+28>>2]=i,r[(e=d+16|0)+4>>2]=0,r[e>>2]=0,!(s&(e=1<<i))){r[5858]=s|e,r[n>>2]=d,r[d+24>>2]=n,r[d+12>>2]=d,r[d+8>>2]=d;break}n=0|r[n>>2];t:do{if((-8&r[n+4>>2])!=(0|l)){for(s=l<<(31==(0|i)?0:25-(i>>>1));e=0|r[(i=n+16+(s>>>31<<2)|0)>>2];){if((-8&r[e+4>>2])==(0|l)){n=e;break t}s<<=1,n=e}r[i>>2]=d,r[d+24>>2]=n,r[d+12>>2]=d,r[d+8>>2]=d;break e}}while(0);_=0|r[(x=n+8|0)>>2],r[_+12>>2]=d,r[x>>2]=d,r[d+8>>2]=_,r[d+12>>2]=n,r[d+24>>2]=0}}while(0);return D=t,0|(_=c+8|0)}p=h}else p=h;else p=-1}while(0);if((i=0|r[5859])>>>0>=p>>>0)return n=i-p|0,e=0|r[5862],n>>>0>15?(_=e+p|0,r[5862]=_,r[5859]=n,r[_+4>>2]=1|n,r[e+i>>2]=n,r[e+4>>2]=3|p):(r[5859]=0,r[5862]=0,r[e+4>>2]=3|i,r[(_=e+i+4|0)>>2]=1|r[_>>2]),D=t,0|(_=e+8|0);if((l=0|r[5860])>>>0>p>>>0)return b=l-p|0,r[5860]=b,x=(_=0|r[5863])+p|0,r[5863]=x,r[x+4>>2]=1|b,r[_+4>>2]=3|p,D=t,0|(_=_+8|0);if(0|r[5975]?e=0|r[5977]:(r[5977]=4096,r[5976]=4096,r[5978]=-1,r[5979]=-1,r[5980]=0,r[5968]=0,r[5975]=-16&A^1431655768,e=4096),c=p+48|0,(h=(a=e+(u=p+47|0)|0)&(o=0-e|0))>>>0<=p>>>0)return D=t,0|(_=0);if(0|(e=0|r[5967])&&(A=(d=0|r[5965])+h|0)>>>0<=d>>>0|A>>>0>e>>>0)return D=t,0|(_=0);e:do{if(4&r[5968])n=0,g=143;else{i=0|r[5863];t:do{if(i){for(s=23876;!((A=0|r[s>>2])>>>0<=i>>>0&&(A+(0|r[s+4>>2])|0)>>>0>i>>>0);){if(!(e=0|r[s+8>>2])){g=128;break t}s=e}if((n=a-l&o)>>>0<2147483647)if((0|(e=0|Qt(0|n)))==((0|r[s>>2])+(0|r[s+4>>2])|0)){if(-1!=(0|e)){l=n,a=e,g=145;break e}}else s=e,g=136;else n=0}else g=128}while(0);do{if(128==(0|g))if(-1!=(0|(i=0|Qt(0)))&&(n=i,m=(n=(0==((m=(f=0|r[5976])+-1|0)&n)?0:(m+n&0-f)-n|0)+h|0)+(f=0|r[5965])|0,n>>>0>p>>>0&n>>>0<2147483647)){if(0|(A=0|r[5967])&&m>>>0<=f>>>0|m>>>0>A>>>0){n=0;break}if((0|(e=0|Qt(0|n)))==(0|i)){l=n,a=i,g=145;break e}s=e,g=136}else n=0}while(0);do{if(136==(0|g)){if(i=0-n|0,!(c>>>0>n>>>0&n>>>0<2147483647&-1!=(0|s))){if(-1==(0|s)){n=0;break}l=n,a=s,g=145;break e}if((e=u-n+(e=0|r[5977])&0-e)>>>0>=2147483647){l=n,a=s,g=145;break e}if(-1==(0|Qt(0|e))){Qt(0|i),n=0;break}l=e+n|0,a=s,g=145;break e}}while(0);r[5968]=4|r[5968],g=143}}while(0);if(143==(0|g)&&h>>>0<2147483647&&!(-1==(0|(b=0|Qt(0|h)))|1^(y=(v=(m=0|Qt(0))-b|0)>>>0>(p+40|0)>>>0)|b>>>0<m>>>0&-1!=(0|b)&-1!=(0|m)^1)&&(l=y?v:n,a=b,g=145),145==(0|g)){n=(0|r[5965])+l|0,r[5965]=n,n>>>0>(0|r[5966])>>>0&&(r[5966]=n),u=0|r[5863];e:do{if(u){for(n=23876;;){if((0|a)==((e=0|r[n>>2])+(i=0|r[n+4>>2])|0)){g=154;break}if(!(s=0|r[n+8>>2]))break;n=s}if(154==(0|g)&&(x=n+4|0,0==(8&r[n+12>>2]))&&a>>>0>u>>>0&e>>>0<=u>>>0){r[x>>2]=i+l,x=u+(b=0==(7&(b=u+8|0))?0:0-b&7)|0,b=(_=(0|r[5860])+l|0)-b|0,r[5863]=x,r[5860]=b,r[x+4>>2]=1|b,r[u+_+4>>2]=40,r[5864]=r[5979];break}for(a>>>0<(0|r[5861])>>>0&&(r[5861]=a),i=a+l|0,n=23876;;){if((0|r[n>>2])==(0|i)){g=162;break}if(!(e=0|r[n+8>>2]))break;n=e}if(162==(0|g)&&0==(8&r[n+12>>2])){r[n>>2]=a,r[(d=n+4|0)>>2]=(0|r[d>>2])+l,h=(d=a+(0==(7&(d=a+8|0))?0:0-d&7)|0)+p|0,c=(n=i+(0==(7&(n=i+8|0))?0:0-n&7)|0)-d-p|0,r[d+4>>2]=3|p;t:do{if((0|u)==(0|n))_=(0|r[5860])+c|0,r[5860]=_,r[5863]=h,r[h+4>>2]=1|_;else{if((0|r[5862])==(0|n)){_=(0|r[5859])+c|0,r[5859]=_,r[5862]=h,r[h+4>>2]=1|_,r[h+_>>2]=_;break}if(1==(3&(e=0|r[n+4>>2]))){l=-8&e,s=e>>>3;n:do{if(e>>>0<256){if(e=0|r[n+8>>2],(0|(i=0|r[n+12>>2]))==(0|e)){r[5857]=r[5857]&~(1<<s);break}r[e+12>>2]=i,r[i+8>>2]=e;break}a=0|r[n+24>>2],e=0|r[n+12>>2];do{if((0|e)==(0|n)){if(e=0|r[(s=(i=n+16|0)+4|0)>>2])i=s;else if(!(e=0|r[i>>2])){e=0;break}for(;;)if(s=0|r[(o=e+20|0)>>2])e=s,i=o;else{if(!(s=0|r[(o=e+16|0)>>2]))break;e=s,i=o}r[i>>2]=0}else _=0|r[n+8>>2],r[_+12>>2]=e,r[e+8>>2]=_}while(0);if(!a)break;s=23732+((i=0|r[n+28>>2])<<2)|0;do{if((0|r[s>>2])==(0|n)){if(r[s>>2]=e,0|e)break;r[5858]=r[5858]&~(1<<i);break n}if(r[((0|r[(_=a+16|0)>>2])==(0|n)?_:a+20)>>2]=e,!e)break n}while(0);if(r[e+24>>2]=a,0|(s=0|r[(i=n+16|0)>>2])&&(r[e+16>>2]=s,r[s+24>>2]=e),!(i=0|r[i+4>>2]))break;r[e+20>>2]=i,r[i+24>>2]=e}while(0);n=n+l|0,o=l+c|0}else o=c;if(r[(n=n+4|0)>>2]=-2&r[n>>2],r[h+4>>2]=1|o,r[h+o>>2]=o,n=o>>>3,o>>>0<256){i=23468+(n<<1<<2)|0,(e=0|r[5857])&(n=1<<n)?n=0|r[(e=i+8|0)>>2]:(r[5857]=e|n,n=i,e=i+8|0),r[e>>2]=h,r[n+12>>2]=h,r[h+8>>2]=n,r[h+12>>2]=i;break}n=o>>>8;do{if(n){if(o>>>0>16777215){s=31;break}s=o>>>((s=14-((b=((_=n<<(x=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|x|(s=((_<<=b)+245760|0)>>>16&2))+(_<<s>>>15)|0)+7|0)&1|s<<1}else s=0}while(0);if(n=23732+(s<<2)|0,r[h+28>>2]=s,r[(e=h+16|0)+4>>2]=0,r[e>>2]=0,!((e=0|r[5858])&(i=1<<s))){r[5858]=e|i,r[n>>2]=h,r[h+24>>2]=n,r[h+12>>2]=h,r[h+8>>2]=h;break}n=0|r[n>>2];n:do{if((-8&r[n+4>>2])!=(0|o)){for(s=o<<(31==(0|s)?0:25-(s>>>1));e=0|r[(i=n+16+(s>>>31<<2)|0)>>2];){if((-8&r[e+4>>2])==(0|o)){n=e;break n}s<<=1,n=e}r[i>>2]=h,r[h+24>>2]=n,r[h+12>>2]=h,r[h+8>>2]=h;break t}}while(0);_=0|r[(x=n+8|0)>>2],r[_+12>>2]=h,r[x>>2]=h,r[h+8>>2]=_,r[h+12>>2]=n,r[h+24>>2]=0}}while(0);return D=t,0|(_=d+8|0)}for(n=23876;!((e=0|r[n>>2])>>>0<=u>>>0&&(_=e+(0|r[n+4>>2])|0)>>>0>u>>>0);)n=0|r[n+8>>2];n=(e=(e=(o=_+-47|0)+(0==(7&(e=o+8|0))?0:0-e&7)|0)>>>0<(o=u+16|0)>>>0?u:e)+8|0,x=a+(b=0==(7&(b=a+8|0))?0:0-b&7)|0,b=(i=l+-40|0)-b|0,r[5863]=x,r[5860]=b,r[x+4>>2]=1|b,r[a+i+4>>2]=40,r[5864]=r[5979],r[(i=e+4|0)>>2]=27,r[n>>2]=r[5969],r[n+4>>2]=r[5970],r[n+8>>2]=r[5971],r[n+12>>2]=r[5972],r[5969]=a,r[5970]=l,r[5972]=0,r[5971]=n,n=e+24|0;do{x=n,r[(n=n+4|0)>>2]=7}while((x+8|0)>>>0<_>>>0);if((0|e)!=(0|u)){if(a=e-u|0,r[i>>2]=-2&r[i>>2],r[u+4>>2]=1|a,r[e>>2]=a,n=a>>>3,a>>>0<256){i=23468+(n<<1<<2)|0,(e=0|r[5857])&(n=1<<n)?n=0|r[(e=i+8|0)>>2]:(r[5857]=e|n,n=i,e=i+8|0),r[e>>2]=u,r[n+12>>2]=u,r[u+8>>2]=n,r[u+12>>2]=i;break}if(i=23732+((s=(n=a>>>8)?a>>>0>16777215?31:a>>>((s=14-((b=((_=n<<(x=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|x|(s=((_<<=b)+245760|0)>>>16&2))+(_<<s>>>15)|0)+7|0)&1|s<<1:0)<<2)|0,r[u+28>>2]=s,r[u+20>>2]=0,r[o>>2]=0,!((n=0|r[5858])&(e=1<<s))){r[5858]=n|e,r[i>>2]=u,r[u+24>>2]=i,r[u+12>>2]=u,r[u+8>>2]=u;break}n=0|r[i>>2];t:do{if((-8&r[n+4>>2])!=(0|a)){for(s=a<<(31==(0|s)?0:25-(s>>>1));e=0|r[(i=n+16+(s>>>31<<2)|0)>>2];){if((-8&r[e+4>>2])==(0|a)){n=e;break t}s<<=1,n=e}r[i>>2]=u,r[u+24>>2]=n,r[u+12>>2]=u,r[u+8>>2]=u;break e}}while(0);_=0|r[(x=n+8|0)>>2],r[_+12>>2]=u,r[x>>2]=u,r[u+8>>2]=_,r[u+12>>2]=n,r[u+24>>2]=0}}else 0==(0|(_=0|r[5861]))|a>>>0<_>>>0&&(r[5861]=a),r[5969]=a,r[5970]=l,r[5972]=0,r[5866]=r[5975],r[5865]=-1,r[5870]=23468,r[5869]=23468,r[5872]=23476,r[5871]=23476,r[5874]=23484,r[5873]=23484,r[5876]=23492,r[5875]=23492,r[5878]=23500,r[5877]=23500,r[5880]=23508,r[5879]=23508,r[5882]=23516,r[5881]=23516,r[5884]=23524,r[5883]=23524,r[5886]=23532,r[5885]=23532,r[5888]=23540,r[5887]=23540,r[5890]=23548,r[5889]=23548,r[5892]=23556,r[5891]=23556,r[5894]=23564,r[5893]=23564,r[5896]=23572,r[5895]=23572,r[5898]=23580,r[5897]=23580,r[5900]=23588,r[5899]=23588,r[5902]=23596,r[5901]=23596,r[5904]=23604,r[5903]=23604,r[5906]=23612,r[5905]=23612,r[5908]=23620,r[5907]=23620,r[5910]=23628,r[5909]=23628,r[5912]=23636,r[5911]=23636,r[5914]=23644,r[5913]=23644,r[5916]=23652,r[5915]=23652,r[5918]=23660,r[5917]=23660,r[5920]=23668,r[5919]=23668,r[5922]=23676,r[5921]=23676,r[5924]=23684,r[5923]=23684,r[5926]=23692,r[5925]=23692,r[5928]=23700,r[5927]=23700,r[5930]=23708,r[5929]=23708,r[5932]=23716,r[5931]=23716,x=a+(b=0==(7&(b=a+8|0))?0:0-b&7)|0,b=(_=l+-40|0)-b|0,r[5863]=x,r[5860]=b,r[x+4>>2]=1|b,r[a+_+4>>2]=40,r[5864]=r[5979]}while(0);if((n=0|r[5860])>>>0>p>>>0)return b=n-p|0,r[5860]=b,x=(_=0|r[5863])+p|0,r[5863]=x,r[x+4>>2]=1|b,r[_+4>>2]=3|p,D=t,0|(_=_+8|0)}return r[(_=23424)>>2]=12,D=t,0|(_=0)}function Pt(e){var t=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;if(e|=0){n=e+-8|0,s=0|r[5861],c=n+(t=-8&(e=0|r[e+-4>>2]))|0;do{if(1&e)l=n,a=n;else{if(i=0|r[n>>2],!(3&e))return;if(o=i+t|0,(a=n+(0-i)|0)>>>0<s>>>0)return;if((0|r[5862])==(0|a)){if(3!=(3&(t=0|r[(e=c+4|0)>>2]))){l=a,t=o;break}return r[5859]=o,r[e>>2]=-2&t,r[a+4>>2]=1|o,void(r[a+o>>2]=o)}if(n=i>>>3,i>>>0<256){if(e=0|r[a+8>>2],(0|(t=0|r[a+12>>2]))==(0|e)){r[5857]=r[5857]&~(1<<n),l=a,t=o;break}r[e+12>>2]=t,r[t+8>>2]=e,l=a,t=o;break}s=0|r[a+24>>2],e=0|r[a+12>>2];do{if((0|e)==(0|a)){if(e=0|r[(n=(t=a+16|0)+4|0)>>2])t=n;else if(!(e=0|r[t>>2])){e=0;break}for(;;)if(n=0|r[(i=e+20|0)>>2])e=n,t=i;else{if(!(n=0|r[(i=e+16|0)>>2]))break;e=n,t=i}r[t>>2]=0}else l=0|r[a+8>>2],r[l+12>>2]=e,r[e+8>>2]=l}while(0);if(s){if(t=0|r[a+28>>2],(0|r[(n=23732+(t<<2)|0)>>2])==(0|a)){if(r[n>>2]=e,!e){r[5858]=r[5858]&~(1<<t),l=a,t=o;break}}else if(r[((0|r[(l=s+16|0)>>2])==(0|a)?l:s+20)>>2]=e,!e){l=a,t=o;break}r[e+24>>2]=s,0|(n=0|r[(t=a+16|0)>>2])&&(r[e+16>>2]=n,r[n+24>>2]=e),(t=0|r[t+4>>2])?(r[e+20>>2]=t,r[t+24>>2]=e,l=a,t=o):(l=a,t=o)}else l=a,t=o}}while(0);if(!(a>>>0>=c>>>0)&&1&(i=0|r[(e=c+4|0)>>2])){if(2&i)r[e>>2]=-2&i,r[l+4>>2]=1|t,r[a+t>>2]=t,s=t;else{if((0|r[5863])==(0|c)){if(c=(0|r[5860])+t|0,r[5860]=c,r[5863]=l,r[l+4>>2]=1|c,(0|l)!=(0|r[5862]))return;return r[5862]=0,void(r[5859]=0)}if((0|r[5862])==(0|c))return c=(0|r[5859])+t|0,r[5859]=c,r[5862]=a,r[l+4>>2]=1|c,void(r[a+c>>2]=c);s=(-8&i)+t|0,n=i>>>3;do{if(i>>>0<256){if(t=0|r[c+8>>2],(0|(e=0|r[c+12>>2]))==(0|t)){r[5857]=r[5857]&~(1<<n);break}r[t+12>>2]=e,r[e+8>>2]=t;break}o=0|r[c+24>>2],e=0|r[c+12>>2];do{if((0|e)==(0|c)){if(e=0|r[(n=(t=c+16|0)+4|0)>>2])t=n;else if(!(e=0|r[t>>2])){n=0;break}for(;;)if(n=0|r[(i=e+20|0)>>2])e=n,t=i;else{if(!(n=0|r[(i=e+16|0)>>2]))break;e=n,t=i}r[t>>2]=0,n=e}else n=0|r[c+8>>2],r[n+12>>2]=e,r[e+8>>2]=n,n=e}while(0);if(0|o){if(e=0|r[c+28>>2],(0|r[(t=23732+(e<<2)|0)>>2])==(0|c)){if(r[t>>2]=n,!n){r[5858]=r[5858]&~(1<<e);break}}else if(r[((0|r[(i=o+16|0)>>2])==(0|c)?i:o+20)>>2]=n,!n)break;r[n+24>>2]=o,0|(t=0|r[(e=c+16|0)>>2])&&(r[n+16>>2]=t,r[t+24>>2]=n),0|(e=0|r[e+4>>2])&&(r[n+20>>2]=e,r[e+24>>2]=n)}}while(0);if(r[l+4>>2]=1|s,r[a+s>>2]=s,(0|l)==(0|r[5862]))return void(r[5859]=s)}if(e=s>>>3,s>>>0<256)return n=23468+(e<<1<<2)|0,(t=0|r[5857])&(e=1<<e)?e=0|r[(t=n+8|0)>>2]:(r[5857]=t|e,e=n,t=n+8|0),r[t>>2]=l,r[e+12>>2]=l,r[l+8>>2]=e,void(r[l+12>>2]=n);e=23732+((i=(e=s>>>8)?s>>>0>16777215?31:s>>>((i=14-((o=((c=e<<(a=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|a|(i=((c<<=o)+245760|0)>>>16&2))+(c<<i>>>15)|0)+7|0)&1|i<<1:0)<<2)|0,r[l+28>>2]=i,r[l+20>>2]=0,r[l+16>>2]=0,t=0|r[5858],n=1<<i;e:do{if(t&n){e=0|r[e>>2];t:do{if((-8&r[e+4>>2])!=(0|s)){for(i=s<<(31==(0|i)?0:25-(i>>>1));t=0|r[(n=e+16+(i>>>31<<2)|0)>>2];){if((-8&r[t+4>>2])==(0|s)){e=t;break t}i<<=1,e=t}r[n>>2]=l,r[l+24>>2]=e,r[l+12>>2]=l,r[l+8>>2]=l;break e}}while(0);c=0|r[(a=e+8|0)>>2],r[c+12>>2]=l,r[a>>2]=l,r[l+8>>2]=c,r[l+12>>2]=e,r[l+24>>2]=0}else r[5858]=t|n,r[e>>2]=l,r[l+24>>2]=e,r[l+12>>2]=l,r[l+8>>2]=l}while(0);if(c=(0|r[5865])-1|0,r[5865]=c,!(0|c)){for(e=23884;e=0|r[e>>2];)e=e+8|0;r[5865]=-1}}}}function Nt(e,t){t|=0;var n=0;return(e|=0)?(n=0|b(t,e),(t|e)>>>0>65535&&(n=((n>>>0)/(e>>>0)|0)==(0|t)?n:-1)):n=0,(e=0|Rt(n))&&3&r[e+-4>>2]?(Xt(0|e,0,0|n),0|e):0|e}function Dt(e,t,n,i){return 0|(S((t|=0)+(i|=0)+((n=(e|=0)+(n|=0)>>>0)>>>0<e>>>0|0)>>>0|0),n)}function Lt(e,t,n,i){return 0|(S(0|(i=(t|=0)-(i|=0)-((n|=0)>>>0>(e|=0)>>>0|0)>>>0)),e-n>>>0)}function It(e){return 0|((e|=0)?31-(0|w(e^e-1)):32)}function Ot(e,t,n,i,s){s|=0;var o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0;if(h=e|=0,a=n|=0,l=p=i|=0,!(u=c=t|=0))return o=0!=(0|s),l?o?(r[s>>2]=0|e,r[s+4>>2]=0,s=0,0|(S(0|(p=0)),s)):(s=0,0|(S(0|(p=0)),s)):(o&&(r[s>>2]=(h>>>0)%(a>>>0),r[s+4>>2]=0),s=(h>>>0)/(a>>>0)>>>0,0|(S(0|(p=0)),s));o=0==(0|l);do{if(a){if(!o){if((o=(0|w(0|l))-(0|w(0|u))|0)>>>0<=31){a=d=o+1|0,e=h>>>(d>>>0)&(t=o-31>>31)|u<<(l=31-o|0),t&=u>>>(d>>>0),o=0,l=h<<l;break}return s?(r[s>>2]=0|e,r[s+4>>2]=0|c,s=0,0|(S(0|(p=0)),s)):(s=0,0|(S(0|(p=0)),s))}if((o=a-1|0)&a){a=l=33+(0|w(0|a))-(0|w(0|u))|0,e=(d=32-l|0)-1>>31&u>>>((A=l-32|0)>>>0)|(u<<d|h>>>(l>>>0))&(t=A>>31),t&=u>>>(l>>>0),o=h<<(f=64-l|0)&(c=d>>31),l=(u<<f|h>>>(A>>>0))&c|h<<d&l-33>>31;break}return 0|s&&(r[s>>2]=o&h,r[s+4>>2]=0),1==(0|a)?(f=0|e,0|(S(0|(A=0|c)),f)):(A=u>>>((f=0|It(0|a))>>>0)|0,f=u<<32-f|h>>>(f>>>0),0|(S(0|A),f))}if(o)return 0|s&&(r[s>>2]=(u>>>0)%(a>>>0),r[s+4>>2]=0),f=(u>>>0)/(a>>>0)>>>0,0|(S(0|(A=0)),f);if(!h)return 0|s&&(r[s>>2]=0,r[s+4>>2]=(u>>>0)%(l>>>0)),f=(u>>>0)/(l>>>0)>>>0,0|(S(0|(A=0)),f);if(!((o=l-1|0)&l))return 0|s&&(r[s>>2]=0|e,r[s+4>>2]=o&u),A=0,f=u>>>((0|It(0|l))>>>0),0|(S(0|A),f);if((o=(0|w(0|l))-(0|w(0|u))|0)>>>0<=30){a=t=o+1|0,e=u<<(l=31-o|0)|h>>>(t>>>0),t=u>>>(t>>>0),o=0,l=h<<l;break}return s?(r[s>>2]=0|e,r[s+4>>2]=0|c,f=0,0|(S(0|(A=0)),f)):(f=0,0|(S(0|(A=0)),f))}while(0);if(a){u=0|Dt(0|(d=0|n),0|(h=0|p),-1,-1),n=0|T(),c=l,l=0;do{i=c,c=o>>>31|c<<1,o=l|o<<1,Lt(0|u,0|n,0|(i=e<<1|i>>>31),0|(p=e>>>31|t<<1)),l=1&(A=(f=0|T())>>31|((0|f)<0?-1:0)<<1),e=0|Lt(0|i,0|p,A&d,(((0|f)<0?-1:0)>>31|((0|f)<0?-1:0)<<1)&h),t=0|T(),a=a-1|0}while(0!=(0|a));u=c,c=0}else u=l,c=0,l=0;return a=0,0|s&&(r[s>>2]=e,r[s+4>>2]=t),f=o<<1&-2|l,0|(S(0|(A=(0|o)>>>31|(u|a)<<1|c)),f)}function kt(e,t,n,i){n|=0;var r,s,o,a,l;return s=(i|=0)>>31|((0|i)<0?-1:0)<<1,r=((0|i)<0?-1:0)>>31|((0|i)<0?-1:0)<<1,o=0|Lt((l=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0),(a=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t,0|l,0|a),e=s^l,t=r^a,0|Lt(Ot(o,0|T(),0|Lt(s^n,r^i,0|s,0|r),0|T(),0)^e,T()^t,0|e,0|t)}function Bt(e,t,n,i){t|=0,i|=0;var r,s;return n=0|function(e,t){var n,i,r,s=0;return e=((n=0|b(s=65535&(t|=0),r=65535&(e|=0)))>>>16)+(0|b(s,i=e>>>16))|0,t=0|b(s=t>>>16,r),0|(S((e>>>16)+(0|b(s,i))+(((65535&e)+t|0)>>>16)|0),e+t<<16|65535&n)}(r=e|=0,s=n|=0),e=0|T(),0|(S((0|b(t,s))+(0|b(i,r))+e|0),n)}function Ft(e,t,n,i){n|=0;var s,o,a,l,c,u;return s=D,D=D+16|0,l=0|s,u=(i|=0)>>31|((0|i)<0?-1:0)<<1,c=((0|i)<0?-1:0)>>31|((0|i)<0?-1:0)<<1,Ot(e=0|Lt((a=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0),(o=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t,0|a,0|o),t=0|T(),0|Lt(u^n,c^i,0|u,0|c),0|T(),l),i=0|Lt(r[l>>2]^a,r[l+4>>2]^o,0|a,0|o),n=0|T(),D=s,0|(S(0|n),i)}function Ut(e,t,n,i){var s,o;return o=D,D=D+16|0,Ot(e|=0,t|=0,n|=0,i|=0,s=0|o),D=o,0|(S(0|r[s+4>>2]),r[s>>2])}function zt(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(S(t>>n),e>>>n|(t&(1<<n)-1)<<32-n):(S(0|((0|t)<0?-1:0)),t>>n-32)}function qt(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(S(t>>>n|0),e>>>n|(t&(1<<n)-1)<<32-n):(S(0),t>>>n-32|0)}function Vt(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(S(t<<n|(e&(1<<n)-1<<32-n)>>>32-n),e<<n):(S(e<<n-32),0)}function Gt(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+_(+e,+t)}function jt(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+x(+e,+t)}function Ht(e){return(e=+e)>=0?+l(e+.5):+y(e-.5)}function Wt(e,t,n){e|=0,t|=0;var s,o,a=0;if((0|(n|=0))>=8192)return R(0|e,0|t,0|n),0|e;if(o=0|e,s=e+n|0,(3&e)==(3&t)){for(;3&e;){if(!n)return 0|o;i[e|0]=0|i[t|0],e=e+1|0,t=t+1|0,n=n-1|0}for(a=(n=-4&s)-64|0;(0|e)<=(0|a);)r[e>>2]=r[t>>2],r[e+4>>2]=r[t+4>>2],r[e+8>>2]=r[t+8>>2],r[e+12>>2]=r[t+12>>2],r[e+16>>2]=r[t+16>>2],r[e+20>>2]=r[t+20>>2],r[e+24>>2]=r[t+24>>2],r[e+28>>2]=r[t+28>>2],r[e+32>>2]=r[t+32>>2],r[e+36>>2]=r[t+36>>2],r[e+40>>2]=r[t+40>>2],r[e+44>>2]=r[t+44>>2],r[e+48>>2]=r[t+48>>2],r[e+52>>2]=r[t+52>>2],r[e+56>>2]=r[t+56>>2],r[e+60>>2]=r[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|n);)r[e>>2]=r[t>>2],e=e+4|0,t=t+4|0}else for(n=s-4|0;(0|e)<(0|n);)i[e|0]=0|i[t|0],i[e+1|0]=0|i[t+1|0],i[e+2|0]=0|i[t+2|0],i[e+3|0]=0|i[t+3|0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|s);)i[e|0]=0|i[t|0],e=e+1|0,t=t+1|0;return 0|o}function Xt(e,t,n){t|=0;var s,o=0,a=0,l=0;if(s=(e|=0)+(n|=0)|0,t&=255,(0|n)>=67){for(;3&e;)i[e|0]=t,e=e+1|0;for(l=t|t<<8|t<<16|t<<24,a=(o=-4&s)-64|0;(0|e)<=(0|a);)r[e>>2]=l,r[e+4>>2]=l,r[e+8>>2]=l,r[e+12>>2]=l,r[e+16>>2]=l,r[e+20>>2]=l,r[e+24>>2]=l,r[e+28>>2]=l,r[e+32>>2]=l,r[e+36>>2]=l,r[e+40>>2]=l,r[e+44>>2]=l,r[e+48>>2]=l,r[e+52>>2]=l,r[e+56>>2]=l,r[e+60>>2]=l,e=e+64|0;for(;(0|e)<(0|o);)r[e>>2]=l,e=e+4|0}for(;(0|e)<(0|s);)i[e|0]=t,e=e+1|0;return s-n|0}function Yt(e){return(e=+e)>=0?+l(e+.5):+y(e-.5)}function Qt(e){e|=0;var t,n,i;return i=0|C(),(0|e)>0&(0|(t=(n=0|r[a>>2])+e|0))<(0|n)|(0|t)<0?(N(0|t),E(12),-1):(0|t)>(0|i)&&!(0|P(0|t))?(E(12),-1):(r[a>>2]=t,0|n)}return{___divdi3:kt,___muldi3:Bt,___remdi3:Ft,___uremdi3:Ut,_areNeighborCells:function(e,t,n,i,s){s|=0;var o,a,l,c=0,u=0,h=0,d=0;if(l=D,D=D+64|0,a=l,o=l+56|0,!(!0&134217728==(2013265920&(t|=0))&!0&134217728==(2013265920&(i|=0))))return D=l,0|(s=5);if((0|(e|=0))==(0|(n|=0))&(0|t)==(0|i))return r[s>>2]=0,D=l,0|(s=0);if(u=0|qt(0|e,0|t,52),T(),u&=15,d=0|qt(0|n,0|i,52),T(),(0|u)!=(15&d))return D=l,0|(s=12);if(c=u+-1|0,u>>>0>1){Oe(e,t,c,a),Oe(n,i,c,o),h=0|r[(d=a)>>2],d=0|r[d+4>>2];e:do{if((0|h)==(0|r[o>>2])&&(0|d)==(0|r[o+4>>2])){c=0|qt(0|e,0|t,0|(u=3*(15^u)|0)),T(),c&=7,u=0|qt(0|n,0|i,0|u),T(),u&=7;do{if(0==(0|c)|0==(0|u))r[s>>2]=1,c=0;else if(7==(0|c))c=5;else{if(1==(0|c)|1==(0|u)&&0|Be(h,d)){c=5;break}if((0|r[15536+(c<<2)>>2])!=(0|u)&&(0|r[15568+(c<<2)>>2])!=(0|u))break e;r[s>>2]=1,c=0}}while(0);return D=l,0|(s=c)}}while(0)}u=(c=a)+56|0;do{r[c>>2]=0,c=c+4|0}while((0|c)<(0|u));return L(e,t,1,a),c=(0|r[(t=a)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)||(0|r[(t=a+8|0)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)||(0|r[(t=a+16|0)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)||(0|r[(t=a+24|0)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)||(0|r[(t=a+32|0)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)||(0|r[(t=a+40|0)>>2])==(0|n)&&(0|r[t+4>>2])==(0|i)?1:1&((0|r[(c=a+48|0)>>2])==(0|n)?(0|r[c+4>>2])==(0|i):0),r[s>>2]=c,D=l,0|(s=0)},_bitshift64Ashr:zt,_bitshift64Lshr:qt,_bitshift64Shl:Vt,_calloc:Nt,_cellAreaKm2:function(e,t,n){return 0|(e=0|it(e|=0,t|=0,n|=0))||(s[n>>3]=6371.007180918475*+s[n>>3]*6371.007180918475),0|e},_cellAreaM2:function(e,t,n){return 0|(e=0|it(e|=0,t|=0,n|=0))||(s[n>>3]=6371.007180918475*+s[n>>3]*6371.007180918475*1e3*1e3),0|e},_cellAreaRads2:it,_cellToBoundary:Ye,_cellToCenterChild:function(e,t,n,i){n|=0,i|=0;var s=0;return s=0|qt(0|(e|=0),0|(t|=0),52),T(),(0|n)<16&(0|(s&=15))<=(0|n)?((0|s)<(0|n)&&(s=0|Vt(-1,-1,3+(3*(n+-1-s|0)|0)|0),s=0|Vt(0|~s,0|~T(),3*(15-n|0)|0),t=~T()&t,e&=~s),s=0|Vt(0|n,0,52),n=-15728641&t|T(),r[i>>2]=e|s,r[i+4>>2]=n,0|(i=0)):0|(i=4)},_cellToChildPos:function(e,t,n,i){n|=0,i|=0;var s,o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0;if(s=D,D=D+16|0,v=s,y=0|qt(0|(e|=0),0|(t|=0),52),T(),y&=15,n>>>0>15)return D=s,0|(y=4);if((0|y)<(0|n))return D=s,0|(y=12);if((0|y)!=(0|n))if(a=0|Vt(0|n,0,52),a|=e,c=T()|-15728641&t,(0|y)>(0|n)){u=n;do{g=0|Vt(7,0,3*(14-u|0)|0),u=u+1|0,a|=g,c=T()|c}while((0|u)<(0|y));g=a}else g=a;else g=e,c=t;m=0|qt(0|g,0|c,45),T();e:do{if(0|z(127&m)){if(u=0|qt(0|g,0|c,52),T(),0|(u&=15))for(a=1;;){if(!(0==((m=0|Vt(7,0,3*(15-a|0)|0))&g)&0==(T()&c))){h=33;break e}if(!(a>>>0<u>>>0))break;a=a+1|0}if(r[(m=i)>>2]=0,r[m+4>>2]=0,(0|y)>(0|n)){for(m=-15728641&t,f=y;;){if(A=f,(f=f+-1|0)>>>0>15|(0|y)<(0|f)){h=19;break}if((0|y)!=(0|f))if(a=0|Vt(0|f,0,52),a|=e,u=T()|m,(0|y)<(0|A))p=a;else{h=f;do{p=0|Vt(7,0,3*(14-h|0)|0),h=h+1|0,a|=p,u=T()|u}while((0|h)<(0|y));p=a}else p=e,u=t;if(d=0|qt(0|p,0|u,45),T(),0|z(127&d)){d=0|qt(0|p,0|u,52),T(),d&=15;t:do{if(d)for(h=1;;){if(a=0|qt(0|p,0|u,3*(15-h|0)|0),T(),0|(a&=7))break t;if(!(h>>>0<d>>>0)){a=0;break}h=h+1|0}else a=0}while(0);a=0==(0|a)&1}else a=0;if(u=0|qt(0|e,0|t,3*(15-A|0)|0),T(),7==(0|(u&=7))){o=5,h=42;break}if(1==(0|u)&(a=0!=(0|a))){o=5,h=42;break}if(0|(p=u+((0!=(0|u)&a)<<31>>31)|0)&&(h=0|ht(7,0,h=y-A|0,((0|h)<0)<<31>>31),d=0|T(),a?(a=0|Dt(0|(a=0|Bt(0|h,0|d,5,0)),0|T(),-5,-1),a=0|Dt(0|(a=0|kt(0|a,0|T(),6,0)),0|T(),1,0),u=0|T()):(a=h,u=d),A=0|Dt(0|a,0|u,0|(A=0|Bt(0|h,0|d,0|(A=p+-1|0),((0|A)<0)<<31>>31)),0|T()),d=0|Dt(0|A,0|(p=0|T()),0|r[(d=i)>>2],0|r[d+4>>2]),p=0|T(),r[(A=i)>>2]=d,r[A+4>>2]=p),(0|f)<=(0|n)){h=37;break}}if(19==(0|h))M(23313,22674,1099,22710);else{if(37==(0|h)){o=0|r[(l=i)+4>>2],l=0|r[l>>2];break}if(42==(0|h))return D=s,0|o}}else o=0,l=0}else h=33}while(0);e:do{if(33==(0|h)){if(r[(m=i)>>2]=0,r[m+4>>2]=0,(0|y)>(0|n)){for(a=y;;){if(o=0|qt(0|e,0|t,3*(15-a|0)|0),T(),7==(0|(o&=7))){o=5;break}if(o=0|Bt(0|(l=0|ht(7,0,l=y-a|0,((0|l)<0)<<31>>31)),0|T(),0|o,0),l=0|T(),l=0|Dt(0|r[(m=i)>>2],0|r[m+4>>2],0|o,0|l),o=0|T(),r[(m=i)>>2]=l,r[m+4>>2]=o,(0|(a=a+-1|0))<=(0|n))break e}return D=s,0|o}o=0,l=0}}while(0);return 0|ke(g,c,y,v)&&M(23313,22674,1063,22725),((0|o)>-1|-1==(0|o)&l>>>0>4294967295)&((0|(v=0|r[(y=v)+4>>2]))>(0|o)|((0|v)==(0|o)?(0|r[y>>2])>>>0>l>>>0:0))?(D=s,0|(y=0)):(M(23313,22674,1139,22710),0)},_cellToChildren:function(e,t,n,i){i|=0;var s,o,a=0,l=0;if(o=D,D=D+16|0,Ke(s=o,e|=0,t|=0,n|=0),0==(0|(e=0|r[(t=s)>>2]))&0==(0|(t=0|r[t+4>>2])))return D=o,0;a=0,n=0;do{r[(l=i+(a<<3)|0)>>2]=e,r[l+4>>2]=t,a=0|Dt(0|a,0|n,1,0),n=0|T(),Ze(s),e=0|r[(l=s)>>2],t=0|r[l+4>>2]}while(!(0==(0|e)&0==(0|t)));return D=o,0},_cellToChildrenSize:ke,_cellToLatLng:Xe,_cellToLocalIj:function(e,t,n,i,r,s){var o,a;return e|=0,t|=0,n|=0,i|=0,s|=0,a=D,D=D+16|0,o=a,(r|=0)?e=15:(e=0|ct(e,t,n,i,o))||(ye(o,s),e=0),D=a,0|e},_cellToParent:Oe,_cellToVertex:bt,_cellToVertexes:function(e,t,n){n|=0;var i,s=0,o=0;return o=0==(0|Be(e|=0,t|=0)),i=0==(0|(s=0|bt(e,t,0,n))),o?i?0|(s=0|bt(e,t,1,n+8|0))||0|(s=0|bt(e,t,2,n+16|0))||0|(s=0|bt(e,t,3,n+24|0))||(s=0|bt(e,t,4,n+32|0))?0|(o=s):0|bt(e,t,5,n+40|0):0|(o=s):i?0|(s=0|bt(e,t,1,n+8|0))||0|(s=0|bt(e,t,2,n+16|0))||0|(s=0|bt(e,t,3,n+24|0))||0|(s=0|bt(e,t,4,n+32|0))?0|(o=s):(r[(o=n+40|0)>>2]=0,r[o+4>>2]=0,0|(o=0)):0|(o=s)},_cellsToDirectedEdge:function(e,t,n,i,s){return s|=0,7==(0|(n=0|F(e|=0,t|=0,n|=0,i|=0)))?0|(s=11):(i=0|Vt(0|n,0,56),t=-2130706433&t|T()|268435456,r[s>>2]=e|i,r[s+4>>2]=t,0|(s=0))},_cellsToLinkedMultiPolygon:function(e,t,n){n|=0;var i,s,o,a=0;if(o=D,D=D+32|0,i=o,e=0|function(e,t,n){e|=0,n|=0;var i,s,o=0,a=0,l=0,c=0,u=0,h=0;if(s=D,D=D+176|0,i=s,(0|(t|=0))<1)return xt(n,0,0),D=s,0;for(u=0|qt(0|r[(u=e)>>2],0|r[u+4>>2],52),T(),xt(n,(0|t)>6?t:6,15&u),u=0;!(0|(o=0|Ye(0|r[(o=e+(u<<3)|0)>>2],0|r[o+4>>2],i)));){if((0|(o=0|r[i>>2]))>0){c=0;do{l=i+8+(c<<4)|0,(a=0|Mt(n,o=i+8+((0|(c=c+1|0))%(0|o)<<4)|0,l))?St(n,a):Tt(n,l,o),o=0|r[i>>2]}while((0|c)<(0|o))}if((0|(u=u+1|0))>=(0|t)){o=0,h=13;break}}return 13==(0|h)?(D=s,0|o):(_t(n),D=s,0|(h=o))}(e|=0,t|=0,s=o+16|0),0|e)return D=o,0|(n=e);if(r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,0|(e=0|wt(s)))do{t=0|rt(n);do{st(t,e),a=e+16|0,r[i>>2]=r[a>>2],r[i+4>>2]=r[a+4>>2],r[i+8>>2]=r[a+8>>2],r[i+12>>2]=r[a+12>>2],St(s,e),e=0|Et(s,i)}while(0!=(0|e));e=0|wt(s)}while(0!=(0|e));return _t(s),(e=0|at(n))?(ot(n),D=o,0|(a=e)):(D=o,0|(a=0))},_childPosToCell:function(e,t,n,i,s,o){e|=0,t|=0,o|=0;var a,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0;if(a=D,D=D+16|0,l=a,(s|=0)>>>0>15)return D=a,0|(o=4);if(c=0|qt(0|(n|=0),0|(i|=0),52),T(),(0|(c&=15))>(0|s))return D=a,0|(o=12);if(0|ke(n,i,s,l)&&M(23313,22674,1063,22725),!(((0|t)>-1|-1==(0|t)&e>>>0>4294967295)&((0|(h=0|r[(d=l)+4>>2]))>(0|t)|((0|h)==(0|t)?(0|r[d>>2])>>>0>e>>>0:0))))return D=a,0|(o=2);d=s-c|0,s=0|Vt(0|s,0,52),u=T()|-15728641&i,r[(h=o)>>2]=s|n,r[h+4>>2]=u,h=0|qt(0|n,0|i,45),T();e:do{if(0|z(127&h)){if(0|c)for(l=1;;){if(!(0==((h=0|Vt(7,0,3*(15-l|0)|0))&n)&0==(T()&i)))break e;if(!(l>>>0<c>>>0))break;l=l+1|0}if((0|d)<1)return D=a,0|(o=0);for(h=15^c,i=-1,u=1,l=1;;){c=0|ht(7,0,c=d-u|0,((0|c)<0)<<31>>31),n=0|T();do{if(l){if(l=0|kt(0|(l=0|Dt(0|(l=0|Bt(0|c,0|n,5,0)),0|T(),-5,-1)),0|T(),6,0),(0|t)>(0|(s=0|T()))|(0|t)==(0|s)&e>>>0>l>>>0){t=0|Lt(0|(t=0|Dt(0|e,0|t,-1,-1)),0|T(),0|l,0|s),l=0|T(),f=0|r[(p=o)>>2],p=0|r[p+4>>2],A=0|Vt(7,0,0|(m=3*(h+i|0)|0)),p&=~T(),m=0|Vt(0|(s=0|Dt(0|(i=0|kt(0|t,0|l,0|c,0|n)),0|(e=0|T()),2,0)),0|T(),0|m),p=T()|p,r[(s=o)>>2]=m|f&~A,r[s+4>>2]=p,e=0|Lt(0|t,0|l,0|(e=0|Bt(0|i,0|e,0|c,0|n)),0|T()),l=0,t=0|T();break}A=0|r[(m=o)>>2],m=0|r[m+4>>2],f=0|Vt(7,0,3*(h+i|0)|0),m&=~T(),r[(l=o)>>2]=A&~f,r[l+4>>2]=m,l=1;break}s=0|r[(A=o)>>2],A=0|r[A+4>>2],p=0|Vt(7,0,0|(i=3*(h+i|0)|0)),A&=~T(),i=0|Vt(0|(m=0|kt(0|e,0|t,0|c,0|n)),0|(l=0|T()),0|i),A=T()|A,r[(f=o)>>2]=i|s&~p,r[f+4>>2]=A,e=0|Lt(0|e,0|t,0|(l=0|Bt(0|m,0|l,0|c,0|n)),0|T()),l=0,t=0|T()}while(0);if(!((0|d)>(0|u))){t=0;break}i=~u,u=u+1|0}return D=a,0|t}}while(0);if((0|d)<1)return D=a,0|(m=0);for(s=15^c,l=1;;){if(f=0|ht(7,0,f=d-l|0,((0|f)<0)<<31>>31),m=0|T(),n=0|r[(u=o)>>2],u=0|r[u+4>>2],i=0|Vt(7,0,0|(c=3*(s-l|0)|0)),u&=~T(),c=0|Vt(0|(p=0|kt(0|e,0|t,0|f,0|m)),0|(A=0|T()),0|c),u=T()|u,r[(h=o)>>2]=c|n&~i,r[h+4>>2]=u,e=0|Lt(0|e,0|t,0|(m=0|Bt(0|p,0|A,0|f,0|m)),0|T()),t=0|T(),(0|d)<=(0|l)){t=0;break}l=l+1|0}return D=a,0|t},_compactCells:function(e,t,n,i){t|=0;var s,o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0,w=0,S=0,E=0;if(0==(0|(n|=0))&0==(0|(i|=0)))return 0|(S=0);if(a=0|r[(o=e|=0)>>2],!0&0==(15728640&(o=0|r[o+4>>2]))){if(!((0|i)>0|0==(0|i)&n>>>0>0))return 0|(S=0);if(r[(S=t)>>2]=a,r[S+4>>2]=o,1==(0|n)&0==(0|i))return 0|(S=0);o=1;do{w=0|r[(_=e+(o<<3)|0)+4>>2],r[(S=t+(o<<3)|0)>>2]=r[_>>2],r[S+4>>2]=w,o=o+1|0}while(0<(0|i)|0==(0|i)&o>>>0<n>>>0);return 0|(o=0)}if(!(w=0|Rt(s=n<<3)))return 0|(S=13);if(Wt(0|w,0|e,0|s),!(_=0|Nt(n,8)))return Pt(w),0|(S=13);e:do{if(0|n){t:for(;;){b=0|qt(0|(y=0|r[(o=w)>>2]),0|(o=0|r[o+4>>2]),52),T(),x=(b&=15)+-1|0,v=(0|n)>0;n:do{if(0!=(0|b)&v){if(f=((0|n)<0)<<31>>31,m=0|Vt(0|x,0,52),g=0|T(),x>>>0>15){if(!(0==(0|y)&0==(0|o))){S=17;break t}for(a=0;;){if((0|(a=a+1|0))>=(0|n))break n;if(!(0==(0|(g=0|r[(i=w+(a<<3)|0)>>2]))&0==(0|(i=0|r[i+4>>2])))){o=i,S=17;break t}}}for(a=0,e=y,i=o;;){if(!(0==(0|e)&0==(0|i))){if(!(!0&0==(117440512&i))){S=22;break t}if(c=0|qt(0|e,0|i,52),T(),(0|(c&=15))<(0|x)){o=12,S=28;break t}if((0|c)!=(0|x)&&(e|=m,i=-15728641&i|g,c>>>0>=b>>>0)){l=x;do{A=0|Vt(7,0,3*(14-l|0)|0),l=l+1|0,e|=A,i=T()|i}while(l>>>0<c>>>0)}if(l=0|Ut(0|e,0|i,0|n,0|f),T(),0==(0|(u=0|r[(c=h=_+(l<<3)|0)>>2]))&0==(0|(c=0|r[c+4>>2])))l=h;else for(A=0;;){if((0|A)>(0|n)){S=32;break t}if((0|u)==(0|e)&(-117440513&c)==(0|i)){d=0|qt(0|u,0|c,56),T(),p=(d&=7)+1|0,E=0|qt(0|u,0|c,45),T();i:do{if(0|z(127&E)){if(u=0|qt(0|u,0|c,52),T(),!(u&=15)){c=6;break}for(c=1;;){if(!(0==((E=0|Vt(7,0,3*(15-c|0)|0))&e)&0==(T()&i))){c=7;break i}if(!(c>>>0<u>>>0)){c=6;break}c=c+1|0}}else c=7}while(0);if((d+2|0)>>>0>c>>>0){S=42;break t}E=0|Vt(0|p,0,56),i=T()|-117440513&i,r[(p=h)>>2]=0,r[p+4>>2]=0,e|=E}else l=(l+1|0)%(0|n)|0;if(0==(0|(u=0|r[(c=h=_+(l<<3)|0)>>2]))&0==(0|(c=0|r[c+4>>2]))){l=h;break}A=A+1|0}r[(E=l)>>2]=e,r[E+4>>2]=i}if((0|(a=a+1|0))>=(0|n))break n;e=0|r[(i=w+(a<<3)|0)>>2],i=0|r[i+4>>2]}}}while(0);if((n+5|0)>>>0<11){S=85;break}if(!(g=0|Nt((0|n)/6|0,8))){S=49;break}n:do{if(v){A=0,p=0;do{if(!(0==(0|(a=0|r[(i=c=_+(A<<3)|0)>>2]))&0==(0|(i=0|r[i+4>>2])))){u=0|qt(0|a,0|i,56),T(),e=(u&=7)+1|0,h=-117440513&i,E=0|qt(0|a,0|i,45),T();i:do{if(0|z(127&E)){if(d=0|qt(0|a,0|i,52),T(),0|(d&=15))for(l=1;;){if(!(0==(a&(E=0|Vt(7,0,3*(15-l|0)|0)))&0==(h&T())))break i;if(!(l>>>0<d>>>0))break;l=l+1|0}a|=i=0|Vt(0|e,0,56),i=T()|h,r[(e=c)>>2]=a,r[e+4>>2]=i,e=u+2|0}}while(0);7==(0|e)&&(r[(E=g+(p<<3)|0)>>2]=a,r[E+4>>2]=-117440513&i,p=p+1|0)}A=A+1|0}while((0|A)!=(0|n));if(v){if(A=((0|n)<0)<<31>>31,f=0|Vt(0|x,0,52),m=0|T(),x>>>0>15){if(!(0==(0|y)&0==(0|o))){o=4,S=84;break t}for(o=0;;){if((0|(o=o+1|0))>=(0|n)){a=0,o=p;break n}if(!(0==(0|r[(E=w+(o<<3)|0)>>2])&0==(0|r[E+4>>2]))){o=4,S=84;break t}}}for(d=0,a=0,h=y;;){do{if(!(0==(0|h)&0==(0|o))){if(c=0|qt(0|h,0|o,52),T(),(0|(c&=15))<(0|x)){o=12,S=84;break t}do{if((0|c)==(0|x))i=h,c=o;else{if(i=h|f,e=-15728641&o|m,c>>>0<b>>>0){c=e;break}l=x;do{E=0|Vt(7,0,3*(14-l|0)|0),l=l+1|0,i|=E,e=T()|e}while(l>>>0<c>>>0);c=e}}while(0);for(l=0|Ut(0|i,0|c,0|n,0|A),T(),e=0;;){if((0|e)>(0|n)){S=77;break t}if((-117440513&(u=0|r[(E=_+(l<<3)|0)+4>>2]))==(0|c)&&(0|r[E>>2])==(0|i)){S=79;break}if((0|r[(E=_+((l=(l+1|0)%(0|n)|0)<<3)|0)>>2])==(0|i)&&(0|r[E+4>>2])==(0|c))break;e=e+1|0}if(79==(0|S)&&(S=0,!0&100663296==(117440512&u)))break;r[(E=t+(a<<3)|0)>>2]=h,r[E+4>>2]=o,a=a+1|0}}while(0);if((0|(o=d+1|0))>=(0|n)){o=p;break n}d=o,h=0|r[(E=w+(o<<3)|0)>>2],o=0|r[E+4>>2]}}else a=0,o=p}else a=0,o=0}while(0);if(Xt(0|_,0,0|s),Wt(0|w,0|g,o<<3),Pt(g),!o)break e;t=t+(a<<3)|0,n=o}if(17==(0|S))!0&0==(117440512&o)?(o=4,S=28):S=22;else if(32==(0|S))M(23313,22674,362,22684);else{if(42==(0|S))return Pt(w),Pt(_),0|(E=10);if(49==(0|S))return Pt(w),Pt(_),0|(E=13);if(77==(0|S))M(23313,22674,462,22684);else{if(84==(0|S))return Pt(g),Pt(w),Pt(_),0|(E=o);if(85==(0|S)){Wt(0|t,0|w,n<<3);break}}}if(22==(0|S))return Pt(w),Pt(_),0|(E=5);if(28==(0|S))return Pt(w),Pt(_),0|(E=o)}}while(0);return Pt(w),Pt(_),0|(E=0)},_destroyLinkedMultiPolygon:ot,_directedEdgeToBoundary:we,_directedEdgeToCells:function(e,t,n){e|=0;var i,s,o,a=0;return i=D,D=D+16|0,a=i,!0&268435456==(2013265920&(t|=0))?(s=-2130706433&t|134217728,r[(o=n|=0)>>2]=e,r[o+4>>2]=s,r[a>>2]=0,t=0|qt(0|e,0|t,56),T(),a=0|B(e,s,7&t,a,n+8|0),D=i,0|a):(D=i,0|(a=6))},_edgeLengthKm:function(e,t,n){n|=0;var i,o=0,a=0,l=0,c=0,h=0,A=0,f=0;if(i=D,D=D+176|0,0|(e=0|we(e|=0,t|=0,c=i)))return c=e,l=+s[n>>3],l*=6371.007180918475,s[n>>3]=l,D=i,0|c;if(s[n>>3]=0,(0|(e=0|r[c>>2]))<=1)return c=0,l=0,l*=6371.007180918475,s[n>>3]=l,D=i,0|c;t=e+-1|0,e=0,o=+s[c+8>>3],a=+s[c+16>>3],l=0;do{A=o,o=+s[c+8+((e=e+1|0)<<4)>>3],f=+p(.5*(o-A)),h=a,a=+s[c+8+(e<<4)+8>>3],h=f*f+(h=+p(.5*(a-h)))*(+d(+A)*+d(+o)*h),l+=2*+v(+ +u(+h),+ +u(+(1-h)))}while((0|e)!=(0|t));return s[n>>3]=l,c=0,f=l,f*=6371.007180918475,s[n>>3]=f,D=i,0|c},_edgeLengthM:function(e,t,n){n|=0;var i,o=0,a=0,l=0,c=0,h=0,A=0,f=0;if(i=D,D=D+176|0,0|(e=0|we(e|=0,t|=0,c=i)))return c=e,l=+s[n>>3],l*=6371.007180918475,l*=1e3,s[n>>3]=l,D=i,0|c;if(s[n>>3]=0,(0|(e=0|r[c>>2]))<=1)return c=0,l=0,l*=6371.007180918475,l*=1e3,s[n>>3]=l,D=i,0|c;t=e+-1|0,e=0,o=+s[c+8>>3],a=+s[c+16>>3],l=0;do{A=o,o=+s[c+8+((e=e+1|0)<<4)>>3],f=+p(.5*(o-A)),h=a,a=+s[c+8+(e<<4)+8>>3],h=f*f+(h=+p(.5*(a-h)))*(+d(+A)*+d(+o)*h),l+=2*+v(+ +u(+h),+ +u(+(1-h)))}while((0|e)!=(0|t));return s[n>>3]=l,c=0,f=l,f*=6371.007180918475,f*=1e3,s[n>>3]=f,D=i,0|c},_edgeLengthRads:function(e,t,n){n|=0;var i,o=0,a=0,l=0,c=0,h=0,A=0,f=0;if(i=D,D=D+176|0,0|(e=0|we(e|=0,t|=0,c=i)))return D=i,0|(c=e);if(s[n>>3]=0,(0|(e=0|r[c>>2]))<=1)return D=i,0|(c=0);t=e+-1|0,e=0,o=+s[c+8>>3],a=+s[c+16>>3],l=0;do{A=o,o=+s[c+8+((e=e+1|0)<<4)>>3],f=+p(.5*(o-A)),h=a,a=+s[c+8+(e<<4)+8>>3],h=f*f+(h=+p(.5*(a-h)))*(+d(+o)*+d(+A)*h),l+=2*+v(+ +u(+h),+ +u(+(1-h)))}while((0|e)<(0|t));return s[n>>3]=l,D=i,0|(c=0)},_emscripten_replace_memory:function(e){return i=new Int8Array(e),new Uint8Array(e),r=new Int32Array(e),new Float32Array(e),s=new Float64Array(e),n=e,!0},_free:Pt,_getBaseCellNumber:Le,_getDirectedEdgeDestination:function(e,t,n){e|=0,t|=0,n|=0;var i,s,o=0;return i=D,D=D+16|0,r[(o=i)>>2]=0,!0&268435456==(2013265920&t)?(s=0|qt(0|e,0|t,56),T(),o=0|B(e,-2130706433&t|134217728,7&s,o,n),D=i,0|o):(D=i,0|(o=6))},_getDirectedEdgeOrigin:function(e,t,n){return e|=0,n|=0,!0&268435456==(2013265920&(t|=0))?(r[n>>2]=e,r[n+4>>2]=-2130706433&t|134217728,0|(n=0)):0|(n=6)},_getHexagonAreaAvgKm2:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20528+(e<<3)>>3],0|(t=0))},_getHexagonAreaAvgM2:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20656+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgKm:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20784+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgM:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20912+(e<<3)>>3],0|(t=0))},_getIcosahedronFaces:function e(t,n,i){i|=0;var s,o=0,a=0,l=0,c=0,u=0,h=0,d=0,p=0;s=D,D=D+128|0,d=s+112|0,l=s+96|0,p=s,a=0|qt(0|(t|=0),0|(n|=0),52),T(),u=15&a,r[d>>2]=u,c=0|qt(0|t,0|n,45),T(),c&=127;e:do{if(0|z(c)){if(0|u)for(o=1;;){if(!(0==((h=0|Vt(7,0,3*(15-o|0)|0))&t)&0==(T()&n))){a=0;break e}if(!(o>>>0<u>>>0))break;o=o+1|0}if(!(1&a))return h=0|Vt(u+1|0,0,52),p=T()|-15728641&n,p=0|e((h|t)&~(d=0|Vt(7,0,3*(14-u|0)|0)),p&~T(),i),D=s,0|p;a=1}else a=0}while(0);if(!(o=0|We(t,n,l))){a?(Ce(l,d,p),h=5):(De(l,d,p),h=6);e:do{if(0|z(c))if(u)for(o=1;;){if(!(0==((c=0|Vt(7,0,3*(15-o|0)|0))&t)&0==(T()&n))){t=2;break e}if(!(o>>>0<u>>>0)){t=5;break}o=o+1|0}else t=5;else t=2}while(0);Xt(0|i,-1,t<<2);e:do{if(a)for(l=0;;){if(Pe(c=p+(l<<4)|0,0|r[d>>2]),c=0|r[c>>2],-1==(0|(u=0|r[i>>2]))|(0|u)==(0|c))o=i;else{a=0;do{if((a=a+1|0)>>>0>=t>>>0){o=1;break e}u=0|r[(o=i+(a<<2)|0)>>2]}while(!(-1==(0|u)|(0|u)==(0|c)))}if(r[o>>2]=c,(l=l+1|0)>>>0>=h>>>0){o=0;break}}else for(l=0;;){if(Re(c=p+(l<<4)|0,0|r[d>>2],0,1),c=0|r[c>>2],-1==(0|(u=0|r[i>>2]))|(0|u)==(0|c))o=i;else{a=0;do{if((a=a+1|0)>>>0>=t>>>0){o=1;break e}u=0|r[(o=i+(a<<2)|0)>>2]}while(!(-1==(0|u)|(0|u)==(0|c)))}if(r[o>>2]=c,(l=l+1|0)>>>0>=h>>>0){o=0;break}}}while(0)}return D=s,0|(p=o)},_getNumCells:tt,_getPentagons:Qe,_getRes0Cells:function(e){e|=0;var t=0,n=0,i=0;t=0;do{Vt(0|t,0,45),i=134225919|T(),r[(n=e+(t<<3)|0)>>2]=-1,r[n+4>>2]=i,t=t+1|0}while(122!=(0|t));return 0},_getResolution:function(e,t){return t=0|qt(0|(e|=0),0|(t|=0),52),T(),15&t},_greatCircleDistanceKm:et,_greatCircleDistanceM:function(e,t){e|=0;var n,i,r,o=0;return i=+s[(t|=0)>>3],n=+s[e>>3],o=(r=+p(.5*(i-n)))*r+(o=+p(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+d(+i)*+d(+n)*o),2*+v(+ +u(+o),+ +u(+(1-o)))*6371.007180918475*1e3},_greatCircleDistanceRads:function(e,t){e|=0;var n,i,r,o=0;return i=+s[(t|=0)>>3],n=+s[e>>3],o=(r=+p(.5*(i-n)))*r+(o=+p(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+d(+i)*+d(+n)*o),2*+v(+ +u(+o),+ +u(+(1-o)))},_gridDisk:L,_gridDiskDistances:I,_gridDistance:function(e,t,n,i,s){n|=0,i|=0,s|=0;var o,a,l=0,c=0;return a=D,D=D+32|0,c=a,0|(o=0|ct(e|=0,t|=0,e,t,l=a+12|0))?(D=a,0|(c=o)):0|(e=0|ct(e,t,n,i,c))?(D=a,0|(c=e)):(l=0|ve(l,c),r[(c=s)>>2]=l,r[c+4>>2]=((0|l)<0)<<31>>31,D=a,0|(c=0))},_gridPathCells:function(e,t,n,i,s){n|=0,i|=0,s|=0;var o,a=0,l=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0,w=0,S=0,E=0,C=0;if(o=D,D=D+48|0,u=o+12|0,E=o,!(a=0|ct(e|=0,t|=0,e,t,l=o+24|0))&&!(a=0|ct(e,t,n,i,u))){S=((0|(w=0|ve(l,u)))<0)<<31>>31,r[l>>2]=0,r[l+4>>2]=0,r[l+8>>2]=0,r[u>>2]=0,r[u+4>>2]=0,r[u+8>>2]=0,0|ct(e,t,e,t,l)&&M(23313,23090,691,23299),0|ct(e,t,n,i,u)&&M(23313,23090,696,23299),xe(l),xe(u),w?(g=+(0|w),_=l,i=A=0|r[l>>2],a=f=0|r[(b=l+4|0)>>2],n=m=0|r[(x=l+8|0)>>2],v=+((0|r[u>>2])-A|0)/g,y=+((0|r[u+4>>2])-f|0)/g,g=+((0|r[u+8>>2])-m|0)/g):(b=a=l+4|0,x=n=l+8|0,_=l,i=0|r[l>>2],a=0|r[a>>2],n=0|r[n>>2],v=0,y=0,g=0),r[E>>2]=i,r[(m=E+4|0)>>2]=a,r[(f=E+8|0)>>2]=n;e:do{if((0|w)<0)a=0;else for(p=0,A=0,a=i;;){C=v*(d=+(A>>>0)+4294967296*+(0|p))+ +(0|a),h=y*d+ +(0|r[b>>2]),d=g*d+ +(0|r[x>>2]),n=~~+Ht(+C),l=~~+Ht(+h),a=~~+Ht(+d),C=+c(+(+(0|n)-C)),h=+c(+(+(0|l)-h)),d=+c(+(+(0|a)-d));do{if(!(C>h&C>d)){if(u=0-n|0,h>d){i=u-a|0;break}i=l,a=u-l|0;break}n=0-(l+a)|0,i=l}while(0);if(r[E>>2]=n,r[m>>2]=i,r[f>>2]=a,_e(E),0|(a=0|ut(e,t,E,s+(A<<3)|0)))break e;if(!((0|p)<(0|S)|(0|p)==(0|S)&A>>>0<w>>>0)){a=0;break e}a=0|Dt(0|A,0|p,1,0),p=u=0|T(),A=a,a=0|r[_>>2]}}while(0);return D=o,0|(E=a)}return D=o,0|(E=a)},_gridPathCellsSize:function(e,t,n,i,s){n|=0,i|=0,s|=0;var o,a=0,l=0,c=0;return o=D,D=D+32|0,c=o,(a=0|ct(e|=0,t|=0,e,t,l=o+12|0))||(a=0|ct(e,t,n,i,c))?(D=o,0|(c=a)):(i=0|Dt(0|(i=0|ve(l,c)),((0|i)<0)<<31>>31,1,0),l=0|T(),r[(c=s)>>2]=i,r[c+4>>2]=l,D=o,0|(c=0))},_gridRingUnsafe:function(e,t,n,i){e|=0,t|=0,n|=0,i|=0;var s,o,a=0,l=0,c=0,u=0,h=0,d=0,p=0,A=0,f=0;if(o=D,D=D+16|0,f=o+8|0,r[(A=s=o)>>2]=e,r[A+4>>2]=t,!n)return r[(f=i)>>2]=e,r[f+4>>2]=t,D=o,0|(f=0);r[f>>2]=0;e:do{if(0|Be(e,t))e=9;else{if(l=(0|n)>0){a=0,A=e;do{if(0|(e=0|B(A,t,4,f,s)))break e;if(a=a+1|0,0|Be(A=0|r[(t=s)>>2],t=0|r[t+4>>2])){e=9;break e}}while((0|a)<(0|n));if(r[(p=i)>>2]=A,r[p+4>>2]=t,p=n+-1|0,l){d=0,e=1;do{if(a=22384+(d<<2)|0,5==(0|d))for(c=0|r[a>>2],l=0,a=e;;){if(0|(e=0|B(0|r[(e=s)>>2],0|r[e+4>>2],c,f,s)))break e;if((0|l)!=(0|p)){if(u=0|r[(h=s)>>2],h=0|r[h+4>>2],r[(e=i+(a<<3)|0)>>2]=u,r[e+4>>2]=h,0|Be(u,h)){e=9;break e}e=a+1|0}else e=a;if((0|(l=l+1|0))>=(0|n))break;a=e}else for(c=s,h=0|r[a>>2],u=0,a=e,l=0|r[c>>2],c=0|r[c+4>>2];;){if(0|(e=0|B(l,c,h,f,s)))break e;if(l=0|r[(c=s)>>2],c=0|r[c+4>>2],r[(e=i+(a<<3)|0)>>2]=l,r[e+4>>2]=c,e=a+1|0,0|Be(l,c)){e=9;break e}if((0|(u=u+1|0))>=(0|n))break;a=e}d=d+1|0}while(d>>>0<6);c=A,a=0|r[(e=s)>>2],l=t,e=0|r[e+4>>2]}else c=A,a=A,l=t,e=t}else r[(c=i)>>2]=e,r[c+4>>2]=t,c=e,a=e,l=t,e=t;e=(0|c)==(0|a)&(0|l)==(0|e)?0:9}}while(0);return D=o,0|(f=e)},_i64Add:Dt,_i64Subtract:Lt,_isPentagon:Be,_isResClassIII:function(e,t){return t=0|qt(0|(e|=0),0|(t|=0),52),T(),1&t},_isValidCell:Ie,_isValidDirectedEdge:function(e,t){var n=0;switch(n=0|qt(0|(e|=0),0|(t|=0),56),T(),7&n){case 0:case 7:return 0|(n=0)}return n=-2130706433&t|134217728,!0&268435456==(2013265920&t)?!0&16777216==(117440512&t)&0!=(0|Be(e,n))?0|(n=0):0|(n=0|Ie(e,n)):0|(n=0)},_isValidVertex:function(e,t){e|=0;var n,i,s=0,o=0;return i=D,D=D+16|0,n=i,!0&536870912==(2013265920&(t|=0))&&0|Ie(e,s=-2130706433&t|134217728)?(o=0|qt(0|e,0|t,56),T(),s=(o=0==(0|bt(e,s,7&o,n)))&((0|r[(s=n)>>2])==(0|e)?(0|r[s+4>>2])==(0|t):0)&1,D=i,0|s):(D=i,0|(s=0))},_latLngToCell:je,_llvm_maxnum_f64:Gt,_llvm_minnum_f64:jt,_llvm_round_f64:Ht,_localIjToCell:function(e,t,n,i,r){var s,o;return e|=0,t|=0,n|=0,r|=0,o=D,D=D+16|0,s=o,(i|=0)?n=15:(n=0|be(n,s))||(n=0|ut(e,t,s,r)),D=o,0|n},_malloc:Rt,_maxFaceCount:function(e,t,n){n|=0;var i=0,s=0;if(s=0|qt(0|(e|=0),0|(t|=0),45),T(),!(0|z(127&s)))return s=2,r[n>>2]=s,0;if(s=0|qt(0|e,0|t,52),T(),!(s&=15))return s=5,r[n>>2]=s,0;for(i=1;;){if(!(0==((0|Vt(7,0,3*(15-i|0)|0))&e)&0==(T()&t))){i=2,e=6;break}if(!(i>>>0<s>>>0)){i=5,e=6;break}i=i+1|0}return 6==(0|e)?(r[n>>2]=i,0):0},_maxGridDiskSize:function(e,t){t|=0;var n=0,i=0,s=0;return(0|(e|=0))<0?0|(t=2):(0|e)>13780509?0|(t=0|tt(15,t)):(s=0|Bt(0|e,0|(n=((0|e)<0)<<31>>31),3,0),i=0|T(),n=0|Dt(0|e,0|n,1,0),n=0|Dt(0|(n=0|Bt(0|s,0|i,0|n,0|T())),0|T(),1,0),e=0|T(),r[t>>2]=n,r[t+4>>2]=e,0|(t=0))},_maxPolygonToCellsSize:function(e,t,n,i){t|=0,i|=0;var s,o=0,a=0,l=0,c=0,u=0;if(s=D,D=D+48|0,o=s+16|0,a=s+8|0,l=s,0|(n|=0))return D=s,0|(l=15);if(c=0|r[(u=e|=0)+4>>2],r[(n=a)>>2]=r[u>>2],r[n+4>>2]=c,pt(a,o),!(t=0|Q(o,t,l))){if(n=0|r[a>>2],(0|(a=0|r[e+8>>2]))>0){o=0|r[e+12>>2],t=0;do{n=(0|r[o+(t<<3)>>2])+n|0,t=t+1|0}while((0|t)<(0|a))}o=0|r[(t=l)>>2],(0|(t=0|r[t+4>>2]))<(0|(a=((0|n)<0)<<31>>31))|(0|t)==(0|a)&o>>>0<n>>>0?(r[(t=l)>>2]=n,r[t+4>>2]=a,t=a):n=o,c=0|Dt(0|n,0|t,12,0),u=0|T(),r[(t=l)>>2]=c,r[t+4>>2]=u,r[(t=i)>>2]=c,r[t+4>>2]=u,t=0}return D=s,0|(u=t)},_memcpy:Wt,_memset:Xt,_originToDirectedEdges:function(e,t,n){n|=0;var i,s=0;return i=0==(0|Be(e|=0,t|=0)),t&=-2130706433,r[(s=n)>>2]=i?e:0,r[s+4>>2]=i?285212672|t:0,r[(s=n+8|0)>>2]=e,r[s+4>>2]=301989888|t,r[(s=n+16|0)>>2]=e,r[s+4>>2]=318767104|t,r[(s=n+24|0)>>2]=e,r[s+4>>2]=335544320|t,r[(s=n+32|0)>>2]=e,r[s+4>>2]=352321536|t,r[(n=n+40|0)>>2]=e,r[n+4>>2]=369098752|t,0},_pentagonCount:function(){return 12},_polygonToCells:function(e,t,n,i){t|=0,i|=0;var s,o,a,l,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0,g=0,v=0,y=0,b=0,x=0,_=0,w=0,S=0,M=0,E=0,C=0,R=0,P=0,N=0,L=0,I=0,B=0,F=0,z=0;if(l=D,D=D+112|0,s=l+80|0,p=l+72|0,o=l,a=l+56|0,0|(n|=0))return D=l,0|(z=15);if(!(z=0|Rt(32+(r[(A=(e|=0)+8|0)>>2]<<5)|0)))return D=l,0|(z=13);if(At(e,z),F=0|r[(B=e)+4>>2],r[(n=p)>>2]=r[B>>2],r[n+4>>2]=F,pt(p,s),n=0|Q(s,t,o))B=0,F=0;else{if(n=0|r[p>>2],(0|(u=0|r[A>>2]))>0){h=0|r[e+12>>2],c=0;do{n=(0|r[h+(c<<3)>>2])+n|0,c=c+1|0}while((0|c)!=(0|u));c=n}else c=n;u=0|r[(n=o)>>2],(0|(n=0|r[n+4>>2]))<(0|(h=((0|c)<0)<<31>>31))|(0|n)==(0|h)&u>>>0<c>>>0?(r[(n=o)>>2]=c,r[n+4>>2]=h,n=h):c=u,B=0|Dt(0|c,0|n,12,0),F=0|T(),r[(n=o)>>2]=B,r[n+4>>2]=F,n=0}if(0|n)return Pt(z),D=l,0|(z=n);if(!(c=0|Nt(B,8)))return Pt(z),D=l,0|(z=13);if(!(d=0|Nt(B,8)))return Pt(z),Pt(c),D=l,0|(z=13);r[(L=s)>>2]=0,r[L+4>>2]=0,I=0|r[(L=e)+4>>2],r[(n=p)>>2]=r[L>>2],r[n+4>>2]=I,n=0|U(p,B,F,t,s,c,d);e:do{if(n)Pt(c),Pt(d),Pt(z);else{t:do{if((0|r[A>>2])>0){for(h=e+12|0,u=0;n=0|U((0|r[h>>2])+(u<<3)|0,B,F,t,s,c,d),u=u+1|0,!(0|n);)if((0|u)>=(0|r[A>>2]))break t;Pt(c),Pt(d),Pt(z);break e}}while(0);(0|F)>0|0==(0|F)&B>>>0>0&&Xt(0|d,0,B<<3),L=0|r[(I=s)+4>>2];t:do{if((0|L)>0|0==(0|L)&(0|r[I>>2])>>>0>0){R=c,P=d,N=c,L=d,I=c,n=c,M=c,E=d,C=d,c=d;n:for(;;){for(x=0,_=0,w=0,S=0,u=0,h=0;;){p=(d=o)+56|0;do{r[d>>2]=0,d=d+4|0}while((0|d)<(0|p));if(0|O(A=0|r[(t=R+(x<<3)|0)>>2],t=0|r[t+4>>2],1,o,0)){p=(d=o)+56|0;do{r[d>>2]=0,d=d+4|0}while((0|d)<(0|p));0|(d=0|Nt(7,4))&&(k(A,t,1,o,d,7,0,0),Pt(d))}for(b=0;;){v=0|r[(y=o+(b<<3)|0)>>2],y=0|r[y+4>>2];i:do{if(0==(0|v)&0==(0|y))d=u,p=h;else{if(f=0|Ut(0|v,0|y,0|B,0|F),A=0|T(),!(0==(0|(p=0|r[(t=d=i+(f<<3)|0)>>2]))&0==(0|(t=0|r[t+4>>2])))){m=0,g=0;do{if((0|m)>(0|F)|(0|m)==(0|F)&g>>>0>B>>>0)break n;if((0|p)==(0|v)&(0|t)==(0|y)){d=u,p=h;break i}f=0|Ft(0|(d=0|Dt(0|f,0|A,1,0)),0|T(),0|B,0|F),A=0|T(),g=0|Dt(0|g,0|m,1,0),m=0|T(),p=0|r[(t=d=i+(f<<3)|0)>>2],t=0|r[t+4>>2]}while(!(0==(0|p)&0==(0|t)))}0==(0|v)&0==(0|y)?(d=u,p=h):(Xe(v,y,a),0|ft(e,z,a)&&(g=0|Dt(0|u,0|h,1,0),h=0|T(),r[(m=d)>>2]=v,r[m+4>>2]=y,r[(u=P+(u<<3)|0)>>2]=v,r[u+4>>2]=y,u=g),d=u,p=h)}}while(0);if((b=b+1|0)>>>0>=7)break;u=d,h=p}if(x=0|Dt(0|x,0|_,1,0),_=0|T(),w=0|Dt(0|w,0|S,1,0),S=0|T(),u=0|r[(h=s)>>2],!((0|S)<(0|(h=0|r[h+4>>2]))|(0|S)==(0|h)&w>>>0<u>>>0))break;u=d,h=p}if((0|h)>0|0==(0|h)&u>>>0>0){u=0,h=0;do{r[(S=R+(u<<3)|0)>>2]=0,r[S+4>>2]=0,u=0|Dt(0|u,0|h,1,0),h=0|T(),w=0|r[(S=s)+4>>2]}while((0|h)<(0|w)|((0|h)==(0|w)?u>>>0<(0|r[S>>2])>>>0:0))}if(r[(S=s)>>2]=d,r[S+4>>2]=p,!((0|p)>0|0==(0|p)&d>>>0>0))break t;b=c,x=C,_=I,w=E,S=P,c=M,C=n,E=N,M=b,n=x,I=L,L=_,N=w,P=R,R=S}Pt(N),Pt(L),Pt(z),n=1;break e}n=d}while(0);Pt(z),Pt(c),Pt(n),n=0}}while(0);return D=l,0|(z=n)},_readInt64AsDoubleFromPointer:function(e){return+(+((0|r[(e|=0)>>2])>>>0)+4294967296*+(0|r[e+4>>2]))},_res0CellCount:function(){return 122},_round:Yt,_sbrk:Qt,_sizeOfCellBoundary:function(){return 168},_sizeOfCoordIJ:function(){return 8},_sizeOfGeoLoop:function(){return 8},_sizeOfGeoPolygon:function(){return 16},_sizeOfH3Index:function(){return 8},_sizeOfLatLng:function(){return 16},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompactCells:function(e,t,n,i,s,o,a){e|=0,i|=0,s|=0,o|=0;var l,c=0,u=0,h=0,d=0,p=0,A=0,f=0,m=0;if(l=D,D=D+16|0,m=l,!((0|(n|=0))>0|0==(0|n)&(t|=0)>>>0>0))return D=l,0|(m=0);if((0|(a|=0))>=16)return D=l,0|(m=12);A=0,f=0,p=0,c=0;e:for(;;){if(d=0|qt(0|(u=0|r[(h=e+(A<<3)|0)>>2]),0|(h=0|r[h+4>>2]),52),T(),(15&d)>(0|a)){c=12,u=11;break}if(Ke(m,u,h,a),0==(0|(h=0|r[(d=m)>>2]))&0==(0|(d=0|r[d+4>>2])))u=p;else{u=p;do{if(!((0|c)<(0|o)|(0|c)==(0|o)&u>>>0<s>>>0)){u=10;break e}r[(p=i+(u<<3)|0)>>2]=h,r[p+4>>2]=d,u=0|Dt(0|u,0|c,1,0),c=0|T(),Ze(m),h=0|r[(p=m)>>2],d=0|r[p+4>>2]}while(!(0==(0|h)&0==(0|d)))}if(A=0|Dt(0|A,0|f,1,0),!((0|(f=0|T()))<(0|n)|(0|f)==(0|n)&A>>>0<t>>>0)){c=0,u=11;break}p=u}return 10==(0|u)?(D=l,0|(m=14)):11==(0|u)?(D=l,0|c):0},_uncompactCellsSize:function(e,t,n,i,s){e|=0,t|=0,n|=0,i|=0,s|=0;var o,a,l=0,c=0,u=0,h=0,d=0,p=0;a=D,D=D+16|0,o=a;e:do{if((0|n)>0|0==(0|n)&t>>>0>0){for(d=0,c=0,l=0,p=0;;){if(!(0==(0|(u=0|r[(h=e+(d<<3)|0)>>2]))&0==(0|(h=0|r[h+4>>2])))&&(h=0==(0|ke(u,h,i,o)),c=0|Dt(0|r[(u=o)>>2],0|r[u+4>>2],0|c,0|l),l=0|T(),!h)){l=12;break}if(d=0|Dt(0|d,0|p,1,0),!((0|(p=0|T()))<(0|n)|(0|p)==(0|n)&d>>>0<t>>>0))break e}return D=a,0|l}c=0,l=0}while(0);return r[s>>2]=c,r[s+4>>2]=l,D=a,0|(s=0)},_vertexToLatLng:function(e,t,n){n|=0;var i,s,o,a,l=0,c=0;return a=D,D=D+192|0,s=a,o=a+168|0,l=0|qt(0|(e|=0),0|(t|=0),56),T(),l&=7,0|(i=0|We(e,c=-2130706433&t|134217728,o))?(D=a,0|(c=i)):(t=0|qt(0|e,0|t,52),T(),t&=15,0|Be(e,c)?Ee(o,t,l,1,s):Ne(o,t,l,1,s),c=s+8|0,r[n>>2]=r[c>>2],r[n+4>>2]=r[c+4>>2],r[n+8>>2]=r[c+8>>2],r[n+12>>2]=r[c+12>>2],D=a,0|(c=0))},establishStackSpace:function(e,t){D=e|=0},stackAlloc:function(e){var t;return t=D,D=(D=D+(e|=0)|0)+15&-16,0|t},stackRestore:function(e){D=e|=0},stackSave:function(){return 0|D}}}({Math:Math,Int8Array:Int8Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Float32Array:Float32Array,Float64Array:Float64Array},Z,f),$=(n.___divdi3=J.___divdi3,n.___muldi3=J.___muldi3,n.___remdi3=J.___remdi3,n.___uremdi3=J.___uremdi3,n._areNeighborCells=J._areNeighborCells,n._bitshift64Ashr=J._bitshift64Ashr,n._bitshift64Lshr=J._bitshift64Lshr,n._bitshift64Shl=J._bitshift64Shl,n._calloc=J._calloc,n._cellAreaKm2=J._cellAreaKm2,n._cellAreaM2=J._cellAreaM2,n._cellAreaRads2=J._cellAreaRads2,n._cellToBoundary=J._cellToBoundary,n._cellToCenterChild=J._cellToCenterChild,n._cellToChildPos=J._cellToChildPos,n._cellToChildren=J._cellToChildren,n._cellToChildrenSize=J._cellToChildrenSize,n._cellToLatLng=J._cellToLatLng,n._cellToLocalIj=J._cellToLocalIj,n._cellToParent=J._cellToParent,n._cellToVertex=J._cellToVertex,n._cellToVertexes=J._cellToVertexes,n._cellsToDirectedEdge=J._cellsToDirectedEdge,n._cellsToLinkedMultiPolygon=J._cellsToLinkedMultiPolygon,n._childPosToCell=J._childPosToCell,n._compactCells=J._compactCells,n._destroyLinkedMultiPolygon=J._destroyLinkedMultiPolygon,n._directedEdgeToBoundary=J._directedEdgeToBoundary,n._directedEdgeToCells=J._directedEdgeToCells,n._edgeLengthKm=J._edgeLengthKm,n._edgeLengthM=J._edgeLengthM,n._edgeLengthRads=J._edgeLengthRads,n._emscripten_replace_memory=J._emscripten_replace_memory),ee=(n._free=J._free,n._getBaseCellNumber=J._getBaseCellNumber,n._getDirectedEdgeDestination=J._getDirectedEdgeDestination,n._getDirectedEdgeOrigin=J._getDirectedEdgeOrigin,n._getHexagonAreaAvgKm2=J._getHexagonAreaAvgKm2,n._getHexagonAreaAvgM2=J._getHexagonAreaAvgM2,n._getHexagonEdgeLengthAvgKm=J._getHexagonEdgeLengthAvgKm,n._getHexagonEdgeLengthAvgM=J._getHexagonEdgeLengthAvgM,n._getIcosahedronFaces=J._getIcosahedronFaces,n._getNumCells=J._getNumCells,n._getPentagons=J._getPentagons,n._getRes0Cells=J._getRes0Cells,n._getResolution=J._getResolution,n._greatCircleDistanceKm=J._greatCircleDistanceKm,n._greatCircleDistanceM=J._greatCircleDistanceM,n._greatCircleDistanceRads=J._greatCircleDistanceRads,n._gridDisk=J._gridDisk,n._gridDiskDistances=J._gridDiskDistances,n._gridDistance=J._gridDistance,n._gridPathCells=J._gridPathCells,n._gridPathCellsSize=J._gridPathCellsSize,n._gridRingUnsafe=J._gridRingUnsafe,n._i64Add=J._i64Add,n._i64Subtract=J._i64Subtract,n._isPentagon=J._isPentagon,n._isResClassIII=J._isResClassIII,n._isValidCell=J._isValidCell,n._isValidDirectedEdge=J._isValidDirectedEdge,n._isValidVertex=J._isValidVertex,n._latLngToCell=J._latLngToCell,n._llvm_maxnum_f64=J._llvm_maxnum_f64,n._llvm_minnum_f64=J._llvm_minnum_f64,n._llvm_round_f64=J._llvm_round_f64,n._localIjToCell=J._localIjToCell,n._malloc=J._malloc,n._maxFaceCount=J._maxFaceCount,n._maxGridDiskSize=J._maxGridDiskSize,n._maxPolygonToCellsSize=J._maxPolygonToCellsSize,n._memcpy=J._memcpy,n._memset=J._memset,n._originToDirectedEdges=J._originToDirectedEdges,n._pentagonCount=J._pentagonCount,n._polygonToCells=J._polygonToCells,n._readInt64AsDoubleFromPointer=J._readInt64AsDoubleFromPointer,n._res0CellCount=J._res0CellCount,n._round=J._round,n._sbrk=J._sbrk,n._sizeOfCellBoundary=J._sizeOfCellBoundary,n._sizeOfCoordIJ=J._sizeOfCoordIJ,n._sizeOfGeoLoop=J._sizeOfGeoLoop,n._sizeOfGeoPolygon=J._sizeOfGeoPolygon,n._sizeOfH3Index=J._sizeOfH3Index,n._sizeOfLatLng=J._sizeOfLatLng,n._sizeOfLinkedGeoPolygon=J._sizeOfLinkedGeoPolygon,n._uncompactCells=J._uncompactCells,n._uncompactCellsSize=J._uncompactCellsSize,n._vertexToLatLng=J._vertexToLatLng,n.establishStackSpace=J.establishStackSpace,n.stackAlloc=J.stackAlloc),te=n.stackRestore=J.stackRestore,ne=n.stackSave=J.stackSave;if(n.asm=J,n.cwrap=function(e,t,n,i){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!i?h(e):function(){return d(e,t,n,arguments)}},n.setValue=function(e,t,n,i){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":m[e|0]=t;break;case"i16":v[e>>1]=t;break;case"i32":y[e>>2]=t;break;case"i64":F=[t>>>0,(B=t,+P(B)>=1?B>0?(0|L(+D(B/4294967296),4294967295))>>>0:~~+N((B-+(~~B>>>0))/4294967296)>>>0:0)],y[e>>2]=F[0],y[e+4>>2]=F[1];break;case"float":b[e>>2]=t;break;case"double":x[e>>3]=t;break;default:le("invalid type for setValue: "+n)}},n.getValue=function(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return m[e|0];case"i16":return v[e>>1];case"i32":case"i64":return y[e>>2];case"float":return b[e>>2];case"double":return x[e>>3];default:le("invalid type for getValue: "+t)}return null},U){q(U)||(Q=U,U=n.locateFile?n.locateFile(Q,o):o+Q),I++,n.monitorRunDependencies&&n.monitorRunDependencies(I);var ie=function(e){e.byteLength&&(e=new Uint8Array(e)),g.set(e,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(){if(I--,n.monitorRunDependencies&&n.monitorRunDependencies(I),0==I&&(null!==O&&(clearInterval(O),O=null),k)){var e=k;k=null,e()}}()},re=function(){r(U,ie,(function(){throw"could not load memory initializer "+U}))},se=Y(U);if(se)ie(se.buffer);else if(n.memoryInitializerRequest){var oe=function(){var e=n.memoryInitializerRequest,t=e.response;if(200!==e.status&&0!==e.status){var i=Y(n.memoryInitializerRequestURL);if(!i)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+U),void re();t=i.buffer}ie(t)};n.memoryInitializerRequest.response?setTimeout(oe,0):n.memoryInitializerRequest.addEventListener("load",oe)}else re()}function ae(e){function t(){K||(K=!0,u||(T(E),T(C),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),R.unshift(e);var e;T(R)}()))}e=e||s,I>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),M.unshift(e);var e;T(M)}(),I>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}function le(e){throw n.onAbort&&n.onAbort(e),a(e+=""),l(e),u=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(k=function e(){K||ae(),K||(k=e)},n.run=ae,n.abort=le,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return ae(),e}("object"===typeof UM?UM:{}),zM="number",qM={0:"Success",1:"The operation failed but a more specific error is not available",2:"Argument was outside of acceptable range",3:"Latitude or longitude arguments were outside of acceptable range",4:"Resolution argument was outside of acceptable range",5:"Cell argument was not valid",6:"Directed edge argument was not valid",7:"Undirected edge argument was not valid",8:"Vertex argument was not valid",9:"Pentagon distortion was encountered",10:"Duplicate input",11:"Cell arguments were not neighbors",12:"Cell arguments had incompatible resolutions",13:"Memory allocation failed",14:"Bounds of provided memory were insufficient",15:"Mode or flags argument was not valid"},VM={1e3:"Unknown unit",1001:"Array length out of bounds",1002:"Got unexpected null value for H3 index"};function GM(e,t,n){var i=n&&"value"in n,r=new Error((e[t]||"Unknown error")+" (code: "+t+(i?", value: "+n.value:"")+")");return r.code=t,r}function jM(e,t){return GM(qM,e,2===arguments.length?{value:t}:{})}function HM(e,t){return GM(VM,e,2===arguments.length?{value:t}:{})}function WM(e){if(0!==e)throw jM(e)}var XM={};[["sizeOfH3Index",zM],["sizeOfLatLng",zM],["sizeOfCellBoundary",zM],["sizeOfGeoLoop",zM],["sizeOfGeoPolygon",zM],["sizeOfLinkedGeoPolygon",zM],["sizeOfCoordIJ",zM],["readInt64AsDoubleFromPointer",zM],["isValidCell",zM,[zM,zM]],["latLngToCell",zM,[zM,zM,zM,zM]],["cellToLatLng",zM,[zM,zM,zM]],["cellToBoundary",zM,[zM,zM,zM]],["maxGridDiskSize",zM,[zM,zM]],["gridDisk",zM,[zM,zM,zM,zM]],["gridDiskDistances",zM,[zM,zM,zM,zM,zM]],["gridRingUnsafe",zM,[zM,zM,zM,zM]],["maxPolygonToCellsSize",zM,[zM,zM,zM,zM]],["polygonToCells",zM,[zM,zM,zM,zM]],["cellsToLinkedMultiPolygon",zM,[zM,zM,zM]],["destroyLinkedMultiPolygon",null,[zM]],["compactCells",zM,[zM,zM,zM,zM]],["uncompactCells",zM,[zM,zM,zM,zM,zM,zM]],["uncompactCellsSize",zM,[zM,zM,zM,zM,zM]],["isPentagon",zM,[zM,zM]],["isResClassIII",zM,[zM,zM]],["getBaseCellNumber",zM,[zM,zM]],["getResolution",zM,[zM,zM]],["maxFaceCount",zM,[zM,zM,zM]],["getIcosahedronFaces",zM,[zM,zM,zM]],["cellToParent",zM,[zM,zM,zM,zM]],["cellToChildren",zM,[zM,zM,zM,zM]],["cellToCenterChild",zM,[zM,zM,zM,zM]],["cellToChildrenSize",zM,[zM,zM,zM,zM]],["cellToChildPos",zM,[zM,zM,zM,zM]],["childPosToCell",zM,[zM,zM,zM,zM,zM,zM]],["areNeighborCells",zM,[zM,zM,zM,zM,zM]],["cellsToDirectedEdge",zM,[zM,zM,zM,zM,zM]],["getDirectedEdgeOrigin",zM,[zM,zM,zM]],["getDirectedEdgeDestination",zM,[zM,zM,zM]],["isValidDirectedEdge",zM,[zM,zM]],["directedEdgeToCells",zM,[zM,zM,zM]],["originToDirectedEdges",zM,[zM,zM,zM]],["directedEdgeToBoundary",zM,[zM,zM,zM]],["gridDistance",zM,[zM,zM,zM,zM,zM]],["gridPathCells",zM,[zM,zM,zM,zM,zM]],["gridPathCellsSize",zM,[zM,zM,zM,zM,zM]],["cellToLocalIj",zM,[zM,zM,zM,zM,zM,zM]],["localIjToCell",zM,[zM,zM,zM,zM,zM]],["getHexagonAreaAvgM2",zM,[zM,zM]],["getHexagonAreaAvgKm2",zM,[zM,zM]],["getHexagonEdgeLengthAvgM",zM,[zM,zM]],["getHexagonEdgeLengthAvgKm",zM,[zM,zM]],["greatCircleDistanceM",zM,[zM,zM]],["greatCircleDistanceKm",zM,[zM,zM]],["greatCircleDistanceRads",zM,[zM,zM]],["cellAreaM2",zM,[zM,zM,zM]],["cellAreaKm2",zM,[zM,zM,zM]],["cellAreaRads2",zM,[zM,zM,zM]],["edgeLengthM",zM,[zM,zM,zM]],["edgeLengthKm",zM,[zM,zM,zM]],["edgeLengthRads",zM,[zM,zM,zM]],["getNumCells",zM,[zM,zM]],["getRes0Cells",zM,[zM]],["res0CellCount",zM],["getPentagons",zM,[zM,zM]],["pentagonCount",zM],["cellToVertex",zM,[zM,zM,zM,zM]],["cellToVertexes",zM,[zM,zM,zM]],["vertexToLatLng",zM,[zM,zM,zM]],["isValidVertex",zM,[zM,zM]]].forEach((function(e){XM[e[0]]=UM.cwrap.apply(UM,e)}));var YM=16,QM=XM.sizeOfH3Index(),KM=XM.sizeOfLatLng(),ZM=XM.sizeOfCellBoundary(),JM=XM.sizeOfGeoPolygon(),$M=XM.sizeOfGeoLoop();XM.sizeOfLinkedGeoPolygon(),XM.sizeOfCoordIJ();function eE(e){if("number"!==typeof e||e<0||e>15||Math.floor(e)!==e)throw jM(4,e);return e}function tE(e){if(!e)throw HM(1002);return e}var nE=Math.pow(2,32)-1;function iE(e){if(e>nE)throw HM(1001,e);return e}var rE=/[^0-9a-fA-F]/;function sE(e){if(Array.isArray(e)&&2===e.length&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if("string"!==typeof e||rE.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),YM);return[parseInt(e.substring(e.length-8),YM),t]}function oE(e){if(e>=0)return e.toString(YM);var t=aE(8,(e&=2147483647).toString(YM));return t=(parseInt(t[0],YM)+8).toString(YM)+t.substring(1)}function aE(e,t){for(var n=e-t.length,i="",r=0;r<n;r++)i+="0";return i+=t}Math.pow(2,32);function lE(e,t,n){for(var i=e.length,r=UM._calloc(i,KM),s=n?1:0,o=n?0:1,a=0;a<2*i;a+=2)UM.HEAPF64.set([e[a/2][s],e[a/2][o]].map(bE),r/8+a);return UM.HEAPU32.set([i,r],t/4),t}function cE(e,t){void 0===t&&(t=0);var n=UM.getValue(e+QM*t,"i32"),i=UM.getValue(e+QM*t+4,"i32");return i?function(e,t){return oE(t)+aE(8,oE(e))}(n,i):null}function uE(e){return XM.readInt64AsDoubleFromPointer(e)}function hE(e,t){for(var n=[],i=0;i<t;i++){var r=cE(e,i);null!==r&&n.push(r)}return n}function dE(e){return 180*UM.getValue(e,"double")/Math.PI}function pE(e){return[dE(e),dE(e+8)]}function AE(e){return[dE(e+8),dE(e)]}function fE(e,t,n){for(var i=UM.getValue(e,"i32"),r=e+8,s=[],o=t?AE:pE,a=0;a<2*i;a+=2)s.push(o(r+8*a));return n&&s.push(s[0]),s}function mE(e,t,n){var i=UM._malloc(KM);UM.HEAPF64.set([e,t].map(bE),i/8);var r=UM._malloc(QM);try{return WM(XM.latLngToCell(i,n,r)),tE(cE(r))}finally{UM._free(r),UM._free(i)}}function gE(e){var t=UM._malloc(KM),n=sE(e),i=n[0],r=n[1];try{return WM(XM.cellToLatLng(i,r,t)),pE(t)}finally{UM._free(t)}}function vE(e,t){var n=UM._malloc(ZM),i=sE(e),r=i[0],s=i[1];try{return WM(XM.cellToBoundary(r,s,n)),fE(n,t,t)}finally{UM._free(n)}}function yE(e,t,n){if(eE(t),n=Boolean(n),0===e.length||0===e[0].length)return[];var i=function(e,t){var n,i=e.length-1,r=UM._calloc(JM),s=0+$M,o=s+4;if(lE(e[0],r+0,t),i>0){n=UM._calloc(i,$M);for(var a=0;a<i;a++)lE(e[a+1],n+$M*a,t)}return UM.setValue(r+s,i,"i32"),UM.setValue(r+o,n,"i32"),r}("number"===typeof e[0][0]?[e]:e,n),r=UM._malloc(8);try{WM(XM.maxPolygonToCellsSize(i,t,0,r));var s=iE(uE(r)),o=UM._calloc(s,QM);try{return WM(XM.polygonToCells(i,t,0,o)),hE(o,s)}finally{UM._free(o)}}finally{UM._free(r),function(e){var t=0+$M,n=t+4;UM._free(UM.getValue(e+0+4,"i8*"));var i=UM.getValue(e+t,"i32");if(i>0){for(var r=UM.getValue(e+n,"i32"),s=0;s<i;s++)UM._free(UM.getValue(r+$M*s+4,"i8*"));UM._free(r)}UM._free(e)}(i)}}function bE(e){return e*Math.PI/180}var xE=n(901);const _E=new _u,wE=new yu;class SE extends kg{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new Yh([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new Yh([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Wg(t,6,1);return this.setAttribute("instanceStart",new kf(n,3,0)),this.setAttribute("instanceEnd",new kf(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Wg(t,6,1);return this.setAttribute("instanceColorStart",new kf(n,3,0)),this.setAttribute("instanceColorEnd",new kf(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new rg(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new _u);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),_E.setFromBufferAttribute(t),this.boundingBox.union(_E))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new zu),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let r=0,s=e.count;r<s;r++)wE.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(wE)),wE.fromBufferAttribute(t,r),i=Math.max(i,n.distanceToSquared(wE));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}Yd.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Hc(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},Qd.line={uniforms:Md.merge([Yd.common,Yd.fog,Yd.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class TE extends Ed{constructor(e){super({type:"LineMaterial",uniforms:Md.clone(Qd.line.uniforms),vertexShader:Qd.line.vertexShader,fragmentShader:Qd.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const ME=new pu,EE=new yu,CE=new yu,RE=new pu,PE=new pu,NE=new pu,DE=new yu,LE=new Qu,IE=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yu;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Zg.subVectors(e,this.start),Jg.subVectors(this.end,this.start);const n=Jg.dot(Jg);let i=Jg.dot(Zg)/n;return t&&(i=Uc(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},OE=new yu,kE=new _u,BE=new zu,FE=new pu;let UE,zE;function qE(e,t,n){return FE.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),FE.multiplyScalar(1/FE.w),FE.x=zE/n.width,FE.y=zE/n.height,FE.applyMatrix4(e.projectionMatrixInverse),FE.multiplyScalar(1/FE.w),Math.abs(Math.max(FE.x,FE.y))}class VE extends bd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new SE,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TE({color:16777215*Math.random()})),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let s=0,o=0,a=t.count;s<a;s++,o+=2)EE.fromBufferAttribute(t,s),CE.fromBufferAttribute(n,s),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+EE.distanceTo(CE);const r=new Wg(i,2,1);return e.setAttribute("instanceDistanceStart",new kf(r,1,0)),e.setAttribute("instanceDistanceEnd",new kf(r,1,1)),this}raycast(e,t){const n=this.material.worldUnits,i=e.camera;null!==i||n||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const r=void 0!==e.params.Line2&&e.params.Line2.threshold||0;UE=e.ray;const s=this.matrixWorld,o=this.geometry,a=this.material;let l,c;if(zE=a.linewidth+r,null===o.boundingSphere&&o.computeBoundingSphere(),BE.copy(o.boundingSphere).applyMatrix4(s),n)l=.5*zE;else{l=qE(i,Math.max(i.near,BE.distanceToPoint(UE.origin)),a.resolution)}if(BE.radius+=l,!1!==UE.intersectsSphere(BE)){if(null===o.boundingBox&&o.computeBoundingBox(),kE.copy(o.boundingBox).applyMatrix4(s),n)c=.5*zE;else{c=qE(i,Math.max(i.near,kE.distanceToPoint(UE.origin)),a.resolution)}kE.expandByScalar(c),!1!==UE.intersectsBox(kE)&&(n?function(e,t){const n=e.matrixWorld,i=e.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd;for(let o=0,a=Math.min(i.instanceCount,r.count);o<a;o++){IE.start.fromBufferAttribute(r,o),IE.end.fromBufferAttribute(s,o),IE.applyMatrix4(n);const i=new yu,a=new yu;UE.distanceSqToSegment(IE.start,IE.end,a,i),a.distanceTo(i)<.5*zE&&t.push({point:a,pointOnLine:i,distance:UE.origin.distanceTo(a),object:e,face:null,faceIndex:o,uv:null,uv1:null})}}(this,t):function(e,t,n){const i=t.projectionMatrix,r=e.material.resolution,s=e.matrixWorld,o=e.geometry,a=o.attributes.instanceStart,l=o.attributes.instanceEnd,c=Math.min(o.instanceCount,a.count),u=-t.near;UE.at(1,NE),NE.w=1,NE.applyMatrix4(t.matrixWorldInverse),NE.applyMatrix4(i),NE.multiplyScalar(1/NE.w),NE.x*=r.x/2,NE.y*=r.y/2,NE.z=0,DE.copy(NE),LE.multiplyMatrices(t.matrixWorldInverse,s);for(let h=0,d=c;h<d;h++){if(RE.fromBufferAttribute(a,h),PE.fromBufferAttribute(l,h),RE.w=1,PE.w=1,RE.applyMatrix4(LE),PE.applyMatrix4(LE),RE.z>u&&PE.z>u)continue;if(RE.z>u){const e=RE.z-PE.z,t=(RE.z-u)/e;RE.lerp(PE,t)}else if(PE.z>u){const e=PE.z-RE.z,t=(PE.z-u)/e;PE.lerp(RE,t)}RE.applyMatrix4(i),PE.applyMatrix4(i),RE.multiplyScalar(1/RE.w),PE.multiplyScalar(1/PE.w),RE.x*=r.x/2,RE.y*=r.y/2,PE.x*=r.x/2,PE.y*=r.y/2,IE.start.copy(RE),IE.start.z=0,IE.end.copy(PE),IE.end.z=0;const t=IE.closestPointToPointParameter(DE,!0);IE.at(t,OE);const o=jc.lerp(RE.z,PE.z,t),c=o>=-1&&o<=1,d=DE.distanceTo(OE)<.5*zE;if(c&&d){IE.start.fromBufferAttribute(a,h),IE.end.fromBufferAttribute(l,h),IE.start.applyMatrix4(s),IE.end.applyMatrix4(s);const t=new yu,i=new yu;UE.distanceSqToSegment(IE.start,IE.end,i,t),n.push({point:i,pointOnLine:t,distance:UE.origin.distanceTo(i),object:e,face:null,faceIndex:h,uv:null,uv1:null})}}}(this,i,t))}}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(ME),this.material.uniforms.resolution.value.set(ME.z,ME.w))}}class GE extends SE{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setColors(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class jE extends VE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new GE,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TE({color:16777215*Math.random()})),this.isLine2=!0,this.type="Line2"}}class HE extends eg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.font;if(void 0===n)super();else{const i=n.generateShapes(e,t.size);void 0===t.depth&&void 0!==t.height&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=void 0!==t.depth?t.depth:void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(i,t)}this.type="TextGeometry"}}class WE{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e){const t=[],n=function(e,t,n){const i=Array.from(e),r=t/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<i.length;c++){const e=i[c];if("\n"===e)a=0,l-=s;else{const t=XE(e,r,a,l,n);a+=t.offsetX,o.push(t.path)}}return o}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,this.data);for(let i=0,r=n.length;i<r;i++)t.push(...n[i].toShapes());return t}}function XE(e,t,n,i,r){const s=r.glyphs[e]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".");const o=new $g;let a,l,c,u,h,d,p,A;if(s.o){const e=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let r=0,s=e.length;r<s;){switch(e[r++]){case"m":a=e[r++]*t+n,l=e[r++]*t+i,o.moveTo(a,l);break;case"l":a=e[r++]*t+n,l=e[r++]*t+i,o.lineTo(a,l);break;case"q":c=e[r++]*t+n,u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,o.quadraticCurveTo(h,d,c,u);break;case"b":c=e[r++]*t+n,u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,p=e[r++]*t+n,A=e[r++]*t+i,o.bezierCurveTo(h,d,p,A,c,u)}}}return{offsetX:s.ha*t,path:o}}function YE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function QE(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function KE(e,t,n){return t=sC(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,aC()?Reflect.construct(t,n||[],sC(e).constructor):t.apply(e,n))}function ZE(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $E(e,t){return e.get(QE(e,t))}function eC(e,t,n){ZE(e,t),t.set(e,n)}function tC(e,t,n){return e.set(QE(e,t),n),n}function nC(e,t,n){if(aC())return Reflect.construct.apply(null,arguments);var i=[null];return i.push.apply(i,t),new(e.bind.apply(e,i))}function iC(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,pC(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rC(e,t,n){return(t=pC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sC(e){return sC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sC(e)}function oC(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uC(e,t)}function aC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(aC=function(){return!!e})()}function lC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function cC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lC(Object(n),!0).forEach((function(t){rC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uC(e,t){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uC(e,t)}function hC(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||AC(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dC(e){return function(e){if(Array.isArray(e))return YE(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||AC(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pC(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function AC(e,t){if(e){if("string"==typeof e)return YE(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YE(e,t):void 0}}var fC=function(e){e instanceof Array?e.forEach(fC):(e.map&&e.map.dispose(),e.dispose())},mC=function(e){e.geometry&&e.geometry.dispose(),e.material&&fC(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(mC)},gC=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),mC(t)}};function vC(e,t){var n=new t;return{linkProp:function(t){return{default:n[t](),onChange:function(n,i){i[e][t](n)},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var i=n[e],r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];var a=i[t].apply(i,s);return a===i?this:a}}}}var yC=100;function bC(){return yC}function xC(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=(90-e)*Math.PI/180,r=(90-t)*Math.PI/180,s=yC*(1+n);return{x:s*Math.sin(i)*Math.cos(r),y:s*Math.cos(i),z:s*Math.sin(i)*Math.sin(r)}}function _C(e){var t=e.x,n=e.y,i=e.z,r=Math.sqrt(t*t+n*n+i*i),s=Math.acos(n/r),o=Math.atan2(i,t);return{lat:90-180*s/Math.PI,lng:90-180*o/Math.PI-(o<-Math.PI/2?360:0),altitude:r/yC-1}}function wC(e){return e*Math.PI/180}var SC=window.THREE?window.THREE:{BackSide:1,BufferAttribute:Hh,Color:Fh,Mesh:bd,ShaderMaterial:Ed},TC={backside:!0,coefficient:.5,color:"gold",size:2,power:1};function MC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:TC,n=t.backside,i=t.coefficient,r=t.color,s=t.size,o=t.power,a=function(e,t){for(var n=e.clone(),i=new Float32Array(3*e.attributes.position.count),r=0,s=i.length;r<s;r++){var o=e.attributes.normal.array[r],a=e.attributes.position.array[r];i[r]=a+o*t}return n.setAttribute("position",new SC.BufferAttribute(i,3)),n}(e,s),l=function(e,t,n){return new SC.ShaderMaterial({depthWrite:!1,fragmentShader:"\nuniform vec3 color;\nuniform float coefficient;\nuniform float power;\nvarying vec3 vVertexNormal;\nvarying vec3 vVertexWorldPosition;\nvoid main() {\n  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;\n  vec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n  viewCameraToVertex = normalize(viewCameraToVertex);\n  float intensity\t= pow(\n    coefficient + dot(vVertexNormal, viewCameraToVertex),\n    power\n  );\n  gl_FragColor = vec4(color, intensity);\n}",transparent:!0,uniforms:{coefficient:{value:e},color:{value:new SC.Color(t)},power:{value:n}},vertexShader:"\nvarying vec3 vVertexWorldPosition;\nvarying vec3 vVertexNormal;\nvoid main() {\n  vVertexNormal\t= normalize(normalMatrix * normal);\n  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  gl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"})}(i,r,o);return n&&(l.side=SC.BackSide),new SC.Mesh(a,l)}var EC=window.THREE?window.THREE:{Color:Fh,LineBasicMaterial:Ff,LineSegments:Kf,Mesh:bd,MeshPhongMaterial:og,SphereGeometry:ng,SRGBColorSpace:dc,TextureLoader:Eg},CC=Uv({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeObj.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return void 0!==t?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){gC(e.globeObj),gC(e.graticulesObj)}},stateInit:function(){var e=new EC.SphereGeometry(yC,75,75),t=new EC.MeshPhongMaterial({color:0}),n=new EC.Mesh(e,t);return n.rotation.y=-Math.PI/2,n.__globeObjType="globe",{globeObj:n,graticulesObj:new EC.LineSegments(new mb(wb(),yC,2),new EC.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1})),defaultGlobeMaterial:t}},init:function(e,t){gC(e),t.scene=e,t.scene.add(t.globeObj),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var n=e.globeObj.material;if(t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?(new EC.TextureLoader).load(e.globeImageUrl,(function(t){t.colorSpace=EC.SRGBColorSpace,n.map=t,n.color=null,n.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)})):!n.color&&(n.color=new EC.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&(new EC.TextureLoader).load(e.bumpImageUrl,(function(e){n.bumpMap=e,n.needsUpdate=!0})):(n.bumpMap=null,n.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),gC(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var i=e.atmosphereObj=MC(e.globeObj.geometry,{backside:!0,color:e.atmosphereColor,size:yC*e.atmosphereAltitude,power:3.5,coefficient:.1});i.visible=!!e.showAtmosphere,i.__globeObjType="atmosphere",e.scene.add(i)}e.ready||e.globeImageUrl||(e.ready=!0,e.onReady())}}),RC=function(e){return isNaN(e)?parseInt(xx(e).toHex(),16):e},PC=function(e){return e&&isNaN(e)?nx(e).opacity:1},NC=function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1,s=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(s){var o=hC(s.slice(1),4),a=o[0],l=o[1],c=o[2],u=o[3];t=new Fh("rgb(".concat(+a,",").concat(+l,",").concat(+c,")")),r=Math.min(+u,1)}else t=new Fh(e);i&&t.convertLinearToSRGB();var h=t.toArray();return n?[].concat(dC(h),[r]):h};var DC=window.THREE?window.THREE:{BufferAttribute:Hh};function LC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;if(1===t)return new DC.BufferAttribute(new n(e),t);for(var i=new DC.BufferAttribute(new n(e.length*t),t),r=0,s=e.length;r<s;r++)i.set(e[r],r*t);return i}function IC(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).removeDelay,r=void 0===i?0:i;return h_(e,t.children,(function(e){return t.add(e)}),(function(e){var n=function(){t.remove(e),gC(e),e&&e.hasOwnProperty("__data")&&delete e.__data.__currentTargetD};r?setTimeout(n,r):n()}),cC({objBindAttr:"__threeObj"},n))}var OC=window.THREE?window.THREE:{BufferGeometry:nd,CylinderGeometry:Sm,Matrix4:Qu,Mesh:bd,MeshLambertMaterial:ag,Object3D:_h,Vector3:yu},kC=Object.assign({},e),BC=kC.BufferGeometryUtils||kC,FC=Uv({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.pointLat),n=Bb(e.pointLng),i=Bb(e.pointAltitude),r=Bb(e.pointRadius),s=Bb(e.pointColor),o=new OC.CylinderGeometry(1,1,1,e.pointResolution);o.applyMatrix4((new OC.Matrix4).makeRotationX(Math.PI/2)),o.applyMatrix4((new OC.Matrix4).makeTranslation(0,0,-.5));var a=2*Math.PI*yC/360,l={},c=e.pointsMerge?new OC.Object3D:e.scene;if(IC(e.pointsData,c,{createObj:function(){var e=new OC.Mesh(o);return e.__globeObjType="point",e},updateObj:function(o,c){var u=function(t){var n=o.__currentTargetD=t,i=n.r,r=n.alt,s=n.lat,l=n.lng;Object.assign(o.position,xC(s,l));var c=e.pointsMerge?new OC.Vector3(0,0,0):e.scene.localToWorld(new OC.Vector3(0,0,0));o.lookAt(c),o.scale.x=o.scale.y=Math.min(30,i)*a,o.scale.z=Math.max(r*yC,.1)},h={alt:+i(c),r:+r(c),lat:+t(c),lng:+n(c)},d=o.__currentTargetD||Object.assign({},h,{alt:-.001});Object.keys(h).some((function(e){return d[e]!==h[e]}))&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?u(h):e.tweenGroup.add(new Wv(d).to(h,e.pointsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(u).start()));if(!e.pointsMerge){var p=s(c),A=p?PC(p):0,f=!!A;o.visible=f,f&&(l.hasOwnProperty(p)||(l[p]=new OC.MeshLambertMaterial({color:RC(p),transparent:A<1,opacity:A})),o.material=l[p])}}}),e.pointsMerge){var u=e.pointsData.length?(BC.mergeGeometries||BC.mergeBufferGeometries)(e.pointsData.map((function(e){var t=e.__threeObj;e.__threeObj=void 0;var n=t.geometry.clone();t.updateMatrix(),n.applyMatrix4(t.matrix);var i=NC(s(e));return n.setAttribute("color",LC(Array(n.getAttribute("position").count).fill(i),4)),n}))):new OC.BufferGeometry,h=new OC.Mesh(u,new OC.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));h.__globeObjType="points",h.__data=e.pointsData,gC(e.scene),e.scene.add(h)}}}),UC=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=("attribute float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join("\n")),e.fragmentShader=("uniform float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join("\n")),e},zC=function(e){return e.vertexShader="\n    attribute float r;\n    \n    const float PI = 3.1415926535897932384626433832795;\n    float toRad(in float a) {\n      return a * PI / 180.0;\n    }\n    \n    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]\n      float phi = toRad(90.0 - c.x);\n      float theta = toRad(90.0 - c.y);\n      float r = c.z;\n      return vec3( // x,y,z\n        r * sin(phi) * cos(theta),\n        r * cos(phi),\n        r * sin(phi) * sin(theta)\n      );\n    }\n    \n    vec2 Cartesian2Polar(in vec3 p) {\n      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      float phi = acos(p.y / r);\n      float theta = atan(p.z, p.x);\n      return vec2( // lat,lng\n        90.0 - phi * 180.0 / PI,\n        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)\n      );\n    }\n    ".concat(e.vertexShader.replace("}","                  \n        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n      }\n    "),"\n  "),e},qC=function(e,t){return e.onBeforeCompile=function(n){e.userData.shader=t(n)},e},VC=["stroke"],GC=window.THREE?window.THREE:{BufferGeometry:nd,CubicBezierCurve3:fm,Curve:rm,Group:Sf,Line:Wf,Mesh:bd,NormalBlending:1,ShaderMaterial:Ed,TubeGeometry:ig,Vector3:yu},jC=d_.default||d_,HC=Uv({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;null===(t=e.ticker)||void 0===t||t.dispose()}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i,t.ticker=new jC,t.ticker.onTick.add((function(e,n){t.arcsData.filter((function(e){return e.__threeObj&&e.__threeObj.children.length&&e.__threeObj.children[0].material&&e.__threeObj.children[0].__dashAnimateStep})).forEach((function(e){var t=e.__threeObj.children[0],i=t.__dashAnimateStep*n,r=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=r+i}))}))},update:function(e){var t=Bb(e.arcStartLat),n=Bb(e.arcStartLng),i=Bb(e.arcEndLat),r=Bb(e.arcEndLng),s=Bb(e.arcAltitude),o=Bb(e.arcAltitudeAutoScale),a=Bb(e.arcStroke),l=Bb(e.arcColor),c=Bb(e.arcDashLength),u=Bb(e.arcDashGap),h=Bb(e.arcDashInitialGap),d=Bb(e.arcDashAnimateTime),p=new GC.ShaderMaterial(cC(cC({},{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:"\n    uniform float dashTranslate; \n\n    attribute vec4 color;\n    varying vec4 vColor;\n    \n    attribute float relDistance;\n    varying float vRelDistance;\n\n    void main() {\n      // pass through colors and distances\n      vColor = color;\n      vRelDistance = relDistance + dashTranslate;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float dashOffset; \n    uniform float dashSize;\n    uniform float gapSize; \n    \n    varying vec4 vColor;\n    varying float vRelDistance;\n    \n    void main() {\n      // ignore pixels in the gap\n      if (vRelDistance < dashOffset) discard;\n      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;\n    \n      // set px color: [r, g, b, a], interpolated between vertices \n      gl_FragColor = vColor; \n    }\n  "}),{},{transparent:!0,blending:GC.NormalBlending}));IC(e.arcsData,e.scene,{createObj:function(){var e=new GC.Group;return e.__globeObjType="arc",e},updateObj:function(A,f){var m=a(f),g=null!==m&&void 0!==m;if(!A.children.length||g!==("Mesh"===A.children[0].type)){gC(A);var v=g?new GC.Mesh:new GC.Line(new GC.BufferGeometry);v.material=p.clone(),A.add(v)}var y=A.children[0];Object.assign(y.material.uniforms,{dashSize:{value:c(f)},gapSize:{value:u(f)},dashOffset:{value:h(f)}});var b=d(f);y.__dashAnimateStep=b>0?1e3/b:0;var x=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t+1;if(e instanceof Array||e instanceof Function){var s=e instanceof Array?fw().domain(e.map((function(t,n){return n/(e.length-1)}))).range(e):e;n=function(e){return NC(s(e),!0,!0)}}else{var o=NC(e,!0,!0);n=function(){return o}}for(var a=[],l=0,c=r;l<c;l++)for(var u=n(l/(c-1)),h=0;h<i;h++)a.push(u);return LC(a,4)}(l(f),e.arcCurveResolution,g?e.arcCircularResolution+1:1),_=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],r=0,s=e+1;r<s;r++)for(var o=r/(s-1),a=0;a<t;a++)i.push(o);return n&&i.reverse(),LC(i,1)}(e.arcCurveResolution,g?e.arcCircularResolution+1:1,!0);y.geometry.setAttribute("color",x),y.geometry.setAttribute("relDistance",_);var w=function(t){var n=f.__currentTargetD=t,i=n.stroke,r=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(n,VC),s=function(e){var t=e.alt,n=e.altAutoScale,i=e.startLat,r=e.startLng,s=e.endLat,o=e.endLng,a=function(e){var t=hC(e,3),n=t[0],i=xC(t[1],n,t[2]),r=i.x,s=i.y,o=i.z;return new GC.Vector3(r,s,o)},l=[r,i],c=[o,s],u=t;if((null===u||void 0===u)&&(u=rb(l,c)/2*n),u){var h=sb(l,c),d=hC([.25,.75].map((function(e){return[].concat(dC(h(e)),[1.5*u])})),2),p=d[0],A=d[1];return nC(GC.CubicBezierCurve3,dC([l,p,A,c].map(a)))}var f=.001;return m.apply(void 0,dC([[].concat(l,[f]),[].concat(c,[f])].map(a)));function m(e,t){var n=e.angleTo(t),i=0===n?function(){return e.clone()}:function(i){return(new GC.Vector3).addVectors(e.clone().multiplyScalar(Math.sin((1-i)*n)),t.clone().multiplyScalar(Math.sin(i*n))).divideScalar(Math.sin(n))},r=new GC.Curve;return r.getPoint=i,r}}(r);g?(y.geometry&&y.geometry.dispose(),y.geometry=new GC.TubeGeometry(s,e.arcCurveResolution,i/2,e.arcCircularResolution),y.geometry.setAttribute("color",x),y.geometry.setAttribute("relDistance",_)):y.geometry.setFromPoints(s.getPoints(e.arcCurveResolution))},S={stroke:m,alt:s(f),altAutoScale:+o(f),startLat:+t(f),startLng:+n(f),endLat:+i(f),endLng:+r(f)},T=f.__currentTargetD||Object.assign({},S,{altAutoScale:-.001});Object.keys(S).some((function(e){return T[e]!==S[e]}))&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?w(S):e.tweenGroup.add(new Wv(T).to(S,e.arcsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(w).start()))}})}}),WC=window.THREE?window.THREE:{BufferGeometry:nd,DoubleSide:2,Mesh:bd,MeshLambertMaterial:ag,Object3D:_h},XC=Object.assign({},e),YC=XC.BufferGeometryUtils||XC,QC=Uv({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){return.01*e.sumWeight}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.hexBinPointLat),n=Bb(e.hexBinPointLng),i=Bb(e.hexBinPointWeight),r=Bb(e.hexAltitude),s=Bb(e.hexTopColor),o=Bb(e.hexSideColor),a=Bb(e.hexMargin),l=t_(e.hexBinPointsData.map((function(i){return cC(cC({},i),{},{h3Idx:mE(t(i),n(i),e.hexBinResolution)})})),"h3Idx"),c=Object.entries(l).map((function(e){var t=hC(e,2),n=t[0],r=t[1];return{h3Idx:n,points:r,sumWeight:r.reduce((function(e,t){return e+ +i(t)}),0)}})),u={};if(IC(c,e.hexBinMerge?new WC.Object3D:e.scene,{createObj:function(e){var t=new WC.Mesh;t.__hexCenter=gE(e.h3Idx),t.__hexGeoJson=vE(e.h3Idx,!0).reverse();var n=t.__hexCenter[1];return t.__hexGeoJson.forEach((function(e){var t=e[0];Math.abs(n-t)>170&&(e[0]+=n>t?360:-360)})),t.__globeObjType="hexbin",t},updateObj:function(t,n){var i=Math.max(0,Math.min(1,+a(n))),l=hC(t.__hexCenter,2),c=l[0],h=l[1],d=0===i?t.__hexGeoJson:t.__hexGeoJson.map((function(e){var t=hC(e,2),n=t[0],r=t[1];return[[n,h],[r,c]].map((function(e){var t=hC(e,2);return function(e,t,n){return e-(e-t)*n}(t[0],t[1],i)}))})),p=e.hexTopCurvatureResolution;t.geometry&&t.geometry.dispose(),t.geometry=new FM([d],0,yC,!1,!0,!0,p);var A={alt:+r(n)},f=function(e){var n=(t.__currentTargetD=e).alt;t.scale.x=t.scale.y=t.scale.z=1+n;var i=yC/(n+1);t.geometry.setAttribute("surfaceRadius",LC(Array(t.geometry.getAttribute("position").count).fill(i),1))},m=t.__currentTargetD||Object.assign({},A,{alt:-.001});Object.keys(A).some((function(e){return m[e]!==A[e]}))&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?f(A):e.tweenGroup.add(new Wv(m).to(A,e.hexTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(f).start()));if(!e.hexBinMerge){var g=o(n),v=s(n);[g,v].forEach((function(e){if(!u.hasOwnProperty(e)){var t=PC(e);u[e]=qC(new WC.MeshLambertMaterial({color:RC(e),transparent:t<1,opacity:t,side:WC.DoubleSide}),UC)}})),t.material=[g,v].map((function(e){return u[e]}))}},idAccessor:function(e){return e.h3Idx}}),e.hexBinMerge){var h=c.length?(YC.mergeGeometries||YC.mergeBufferGeometries)(c.map((function(e){var t=e.__threeObj;e.__threeObj=void 0;var n=t.geometry.toNonIndexed();t.updateMatrix(),n.applyMatrix4(t.matrix);var i=NC(s(e)),r=NC(o(e)),a=n.getAttribute("position").count,l=n.groups[0].count;return n.setAttribute("color",LC(dC(new Array(a)).map((function(e,t){return t>=l?i:r})),4)),n}))):new WC.BufferGeometry,d=new WC.Mesh(h,qC(new WC.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:WC.DoubleSide}),UC));d.__globeObjType="hexBinPoints",d.__data=c,gC(e.scene),e.scene.add(d)}}}),KC=function(e){return e*e};var ZC=Math.sqrt(2*Math.PI);var JC=function(e){var t=hC(e,2),n=t[0],i=t[1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.lngAccessor,a=void 0===o?function(e){return e[0]}:o,l=s.latAccessor,c=void 0===l?function(e){return e[1]}:l,u=s.weightAccessor,h=void 0===u?function(){return 1}:u,d=s.bandwidth,p=[n,i],A=d*Math.PI/180;return function(e,t){let n=0;if(void 0===t)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}(r.map((function(e){var t=h(e);if(!t)return 0;var n,i,r=function(e,t){var n=Math.sqrt,i=Math.cos,r=function(e){return e*Math.PI/180},s=function(e){return KC(Math.sin(e/2))},o=r(e[1]),a=r(t[1]),l=r(e[0]),c=r(t[0]);return 2*Math.asin(n(s(a-o)+i(o)*i(a)*s(c-l)))}(p,[a(e),c(e)]);return n=r,i=A,Math.exp(-KC(n/i)/2)/(i*ZC)*t})))},$C=window.THREE?window.THREE:{Mesh:bd,MeshLambertMaterial:ag,SphereGeometry:ng},eR=new WeakSet,tR=new WeakMap,nR=new WeakMap,iR=new WeakMap,rR=function(){return iC((function e(t,n){JE(this,e),function(e,t){ZE(e,t),t.add(e)}(this,eR),eC(this,tR,void 0),eC(this,nR,void 0),eC(this,iR,void 0),tC(tR,this,t),tC(nR,this,xE()),$E(nR,this).init(t.map((function(e){return[e.x,e.y,e.z]})).flat()),tC(iR,this,QE(eR,this,sR).call(this,xC(0,0),xC(0,Math.min(180,n))))}),[{key:"getNearPoints",value:function(e,t,n){var i=this;return $E(nR,this).intersectSphere(e,t,n,$E(iR,this)).map((function(e){return $E(tR,i)[e/3]}))}}])}();function sR(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2))}var oR=function(e){var t=nx(function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"}(e));return t.opacity=Math.cbrt(e),t.formatRgb()},aR=Uv({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return oR}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.heatmapPoints),n=Bb(e.heatmapPointLat),i=Bb(e.heatmapPointLng),r=Bb(e.heatmapPointWeight),s=Bb(e.heatmapBandwidth),o=Bb(e.heatmapColorFn),a=Bb(e.heatmapColorSaturation),l=Bb(e.heatmapBaseAltitude),c=Bb(e.heatmapTopAltitude);IC(e.heatmapsData,e.scene,{createObj:function(){var e=new $C.Mesh(new $C.SphereGeometry(yC),qC(new $C.MeshLambertMaterial({vertexColors:!0,transparent:!0}),zC));return e.__globeObjType="heatmap",e},updateObj:function(u,h){var d=s(h),p=o(h),A=a(h),f=l(h),m=c(h),g=t(h).map((function(e){var t=n(e),s=i(e),o=xC(t,s);return{x:o.x,y:o.y,z:o.z,lat:t,lng:s,weight:r(e)}})),v=Math.max(.1,d/3.5),y=Math.ceil(360/(v||-1));u.geometry.parameters.widthSegments!==y&&(u.geometry.dispose(),u.geometry=new $C.SphereGeometry(yC,y,y/2));var b=function(e){for(var t=e.itemSize,n=[],i=0;i<e.count;i++)n.push(e.array.slice(i*t,(i+1)*t));return n}(u.geometry.getAttribute("position")),x=b.map((function(e){var t=hC(e,3),n=_C({x:t[0],y:t[1],z:t[2]});return[n.lng,n.lat]})),_=new rR(g,3.5*d),w=x.map((function(e,t){var n=hC(b[t],3),i=n[0],r=n[1],s=n[2];return JC(e,_.getNearPoints(i,r,s),{latAccessor:function(e){return e.lat},lngAccessor:function(e){return e.lng},weightAccessor:function(e){return e.weight},bandwidth:d})})),S=dC(new Array(100)).map((function(e,t){return NC(p(t/99))})),T=function(e){var t=u.__currentTargetD=e,n=t.kdeVals,i=t.topAlt,r=t.saturation,s=function(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}(n.map(Math.abs))||1e-15,o=mw([0,s/r],S);u.geometry.setAttribute("color",LC(n.map((function(e){return o(Math.abs(e))})),4));var a=fw([0,s],[yC*(1+f),yC*(1+(i||f))]);u.geometry.setAttribute("r",LC(n.map(a)))},M={kdeVals:w,topAlt:m,saturation:A},E=u.__currentTargetD||Object.assign({},M,{kdeVals:w.map((function(){return 0})),topAlt:m?f:m,saturation:.5});E.kdeVals.length!==w.length&&(E.kdeVals=w.slice()),Object.keys(M).some((function(e){return E[e]!==M[e]}))&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?T(M):e.tweenGroup.add(new Wv(E).to(M,e.heatmapsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(T).start()))}})}}),lR=window.THREE?window.THREE:{DoubleSide:2,Group:Sf,LineBasicMaterial:Ff,LineSegments:Kf,Mesh:bd,MeshBasicMaterial:Vh},cR=Uv({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.polygonGeoJsonGeometry),n=Bb(e.polygonAltitude),i=Bb(e.polygonCapCurvatureResolution),r=Bb(e.polygonCapColor),s=Bb(e.polygonCapMaterial),o=Bb(e.polygonSideColor),a=Bb(e.polygonSideMaterial),l=Bb(e.polygonStrokeColor),c=[];e.polygonsData.forEach((function(e){var u={data:e,capColor:r(e),capMaterial:s(e),sideColor:o(e),sideMaterial:a(e),strokeColor:l(e),altitude:+n(e),capCurvatureResolution:+i(e)},h=t(e),d=e.__id||"".concat(Math.round(1e9*Math.random()));e.__id=d,"Polygon"===h.type?c.push(cC({id:"".concat(d,"_0"),coords:h.coordinates},u)):"MultiPolygon"===h.type?c.push.apply(c,dC(h.coordinates.map((function(e,t){return cC({id:"".concat(d,"_").concat(t),coords:e},u)})))):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."))})),IC(c,e.scene,{idAccessor:function(e){return e.id},createObj:function(){var e=new lR.Group;return e.__defaultSideMaterial=qC(new lR.MeshBasicMaterial({side:lR.DoubleSide,depthWrite:!0}),UC),e.__defaultCapMaterial=new lR.MeshBasicMaterial({side:lR.DoubleSide,depthWrite:!0}),e.add(new lR.Mesh(void 0,[e.__defaultSideMaterial,e.__defaultCapMaterial])),e.add(new lR.LineSegments(void 0,new lR.LineBasicMaterial)),e.__globeObjType="polygon",e},updateObj:function(t,n){var i=n.coords,r=n.capColor,s=n.capMaterial,o=n.sideColor,a=n.sideMaterial,l=n.strokeColor,c=n.altitude,u=n.capCurvatureResolution,h=hC(t.children,2),d=h[0],p=h[1],A=!!l;if(p.visible=A,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return function(e,t){return e===t}};return Object.entries(t).every((function(t){var i=hC(t,2),r=i[0],s=i[1];return e.hasOwnProperty(r)&&n(r)(e[r],s)}))}(d.geometry.parameters||{},{polygonGeoJson:i,curvatureResolution:u})||(d.geometry&&d.geometry.dispose(),d.geometry=new FM(i,0,yC,!1,!0,!0,u)),!A||p.geometry.parameters&&p.geometry.parameters.geoJson.coordinates===i&&p.geometry.parameters.resolution===u||(p.geometry&&p.geometry.dispose(),p.geometry=new mb({type:"Polygon",coordinates:i},yC,u)),d.material[0]=a||t.__defaultSideMaterial,d.material[1]=s||t.__defaultCapMaterial,[!a&&o,!s&&r].forEach((function(e,t){if(e){var n=d.material[t],i=PC(e);n.color.set(RC(e)),n.transparent=i<1,n.opacity=i}})),A){var f=p.material,m=PC(l);f.color.set(RC(l)),f.transparent=m<1,f.opacity=m}var g={alt:c},v=function(e){var n=(t.__currentTargetD=e).alt;d.scale.x=d.scale.y=d.scale.z=1+n,A&&(p.scale.x=p.scale.y=p.scale.z=1+n+1e-4),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(e.userData.shader)t(e.userData.shader.uniforms);else{var n=e.onBeforeCompile;e.onBeforeCompile=function(e){n(e),t(e.uniforms)}}}(t.__defaultSideMaterial,(function(e){return e.surfaceRadius.value=yC/(n+1)}))},y=t.__currentTargetD||Object.assign({},g,{alt:-.001});Object.keys(g).some((function(e){return y[e]!==g[e]}))&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||y.alt===g.alt?v(g):e.tweenGroup.add(new Wv(y).to(g,e.polygonsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(v).start()))}})}});var uR=window.THREE?window.THREE:{BufferGeometry:nd,DoubleSide:2,Mesh:bd,MeshLambertMaterial:ag,Vector3:yu},hR=Object.assign({},e),dR=hR.BufferGeometryUtils||hR,pR=Uv({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.hexPolygonGeoJsonGeometry),n=Bb(e.hexPolygonColor),i=Bb(e.hexPolygonAltitude),r=Bb(e.hexPolygonResolution),s=Bb(e.hexPolygonMargin),o=Bb(e.hexPolygonUseDots),a=Bb(e.hexPolygonCurvatureResolution),l=Bb(e.hexPolygonDotResolution);IC(e.hexPolygonsData,e.scene,{createObj:function(e){var t=new uR.Mesh(void 0,new uR.MeshLambertMaterial({side:uR.DoubleSide}));return t.__globeObjType="hexPolygon",t},updateObj:function(c,u){var h=t(u),d=r(u),p=i(u),A=Math.max(0,Math.min(1,+s(u))),f=o(u),m=a(u),g=l(u),v=n(u),y=PC(v);c.material.color.set(RC(v)),c.material.transparent=y<1,c.material.opacity=y;var b={alt:p,margin:A,curvatureResolution:m},x={geoJson:h,h3Res:d},_=c.__currentTargetD||Object.assign({},b,{alt:-.001}),w=c.__currentMemD||x;if(Object.keys(b).some((function(e){return _[e]!==b[e]}))||Object.keys(x).some((function(e){return w[e]!==x[e]}))){c.__currentMemD=x;var S=[];"Polygon"===h.type?yE(h.coordinates,d,!0).forEach((function(e){return S.push(e)})):"MultiPolygon"===h.type?h.coordinates.forEach((function(e){return yE(e,d,!0).forEach((function(e){return S.push(e)}))})):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."));var T=S.map((function(e){var t=gE(e),n=vE(e,!0).reverse(),i=t[1];return n.forEach((function(e){var t=e[0];Math.abs(i-t)>170&&(e[0]+=i>t?360:-360)})),{h3Idx:e,hexCenter:t,hexGeoJson:n}})),M=function(e){var t=c.__currentTargetD=e,n=t.alt,i=t.margin,r=t.curvatureResolution;c.geometry&&c.geometry.dispose(),c.geometry=T.length?(dR.mergeGeometries||dR.mergeBufferGeometries)(T.map((function(e){var t=hC(e.hexCenter,2),s=t[0],o=t[1];if(f){var a=xC(s,o,n),l=xC(e.hexGeoJson[0][1],e.hexGeoJson[0][0],n),c=.85*(1-i)*new uR.Vector3(a.x,a.y,a.z).distanceTo(new uR.Vector3(l.x,l.y,l.z)),u=new wm(c,g);return u.rotateX(wC(-s)),u.rotateY(wC(o)),u.translate(a.x,a.y,a.z),u}var h=0===i?e.hexGeoJson:e.hexGeoJson.map((function(e){var t=hC(e,2),n=t[0],r=t[1];return[[n,o],[r,s]].map((function(e){var t=hC(e,2);return function(e,t,n){return e-(e-t)*n}(t[0],t[1],i)}))}));return new FM([h],yC,yC*(1+n),!1,!0,!1,r)}))):new uR.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?M(b):e.tweenGroup.add(new Wv(_).to(b,e.hexPolygonsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(M).start())}}})}}),AR=window.THREE?window.THREE:{Vector3:yu};function fR(e,t){var n=Math.max(e.length,t.length),i=I_.apply(void 0,dC([e,t].map((function(e){return e.map((function(e){return[e.x,e.y,e.z]}))})).map((function(e){return function(e,t){var n=e[e.length-1];return[].concat(dC(e),dC(Array(t-e.length).fill(n)))}(e,n)}))));return function(n){return 0===n?e:1===n?t:i(n).map((function(e){var t=hC(e,3),n=t[0],i=t[1],r=t[2];return new AR.Vector3(n,i,r)}))}}var mR=window.THREE?window.THREE:{BufferGeometry:nd,Color:Fh,Group:Sf,Line:Wf,NormalBlending:1,ShaderMaterial:Ed,Vector3:yu},gR=d_.default||d_,vR=Uv({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;null===(t=e.ticker)||void 0===t||t.dispose()}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i,t.ticker=new gR,t.ticker.onTick.add((function(e,n){t.pathsData.filter((function(e){return e.__threeObj&&e.__threeObj.children.length&&e.__threeObj.children[0].material&&e.__threeObj.children[0].__dashAnimateStep})).forEach((function(e){var t=e.__threeObj.children[0],i=t.__dashAnimateStep*n;if("Line"===t.type){var r=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=r+i}else if("Line2"===t.type){for(var s=t.material.dashOffset-i,o=t.material.dashSize+t.material.gapSize;s<=-o;)s+=o;t.material.dashOffset=s}}))}))},update:function(e){var t=Bb(e.pathPoints),n=Bb(e.pathPointLat),i=Bb(e.pathPointLng),r=Bb(e.pathPointAlt),s=Bb(e.pathStroke),o=Bb(e.pathColor),a=Bb(e.pathDashLength),l=Bb(e.pathDashGap),c=Bb(e.pathDashInitialGap),u=Bb(e.pathDashAnimateTime),h=new mR.ShaderMaterial(cC(cC({},{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:"\n    uniform float dashTranslate; \n\n    attribute vec4 color;\n    varying vec4 vColor;\n    \n    attribute float relDistance;\n    varying float vRelDistance;\n\n    void main() {\n      // pass through colors and distances\n      vColor = color;\n      vRelDistance = relDistance + dashTranslate;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float dashOffset; \n    uniform float dashSize;\n    uniform float gapSize; \n    \n    varying vec4 vColor;\n    varying float vRelDistance;\n    \n    void main() {\n      // ignore pixels in the gap\n      if (vRelDistance < dashOffset) discard;\n      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;\n    \n      // set px color: [r, g, b, a], interpolated between vertices \n      gl_FragColor = vColor; \n    }\n  "}),{},{transparent:!0,blending:mR.NormalBlending}));function d(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=t+1;if(e instanceof Array||e instanceof Function){var o=e instanceof Array?fw().domain(e.map((function(t,n){return n/(e.length-1)}))).range(e):e;n=function(e){return NC(o(e),r,!0)}}else{var a=NC(e,r,!0);n=function(){return a}}for(var l=[],c=0,u=s;c<u;c++)for(var h=n(c/(u-1)),d=0;d<i;d++)l.push(h);return LC(l,r?4:3)}IC(e.pathsData,e.scene,{createObj:function(){var e=new mR.Group;return e.__globeObjType="path",e},updateObj:function(p,A){var f=s(A),m=null!==f&&void 0!==f;if(!p.children.length||m===("Line"===p.children[0].type)){gC(p);var g=m?new jE(new GE,new TE):new mR.Line(new mR.BufferGeometry,h.clone());p.add(g)}var v=p.children[0],y=function(e,t,n,i,r){var s=function(e,t,n){for(var i=[],r=1;r<=n;r++)i.push(e+(t-e)*r/(n+1));return i},o=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=[],n=null;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(i){if(n){for(;Math.abs(n[1]-i[1])>180;)n[1]+=360*(n[1]<i[1]?1:-1);var r=Math.sqrt(Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2));if(r>e)for(var o=Math.floor(r/e),a=s(n[0],i[0],o),l=s(n[1],i[1],o),c=s(n[2],i[2],o),u=0,h=a.length;u<h;u++)t.push([a[u],l[u],c[u]])}t.push(n=i)})),t},a=function(e){var t=hC(e,3),n=xC(t[0],t[1],t[2]),i=n.x,r=n.y,s=n.z;return new mR.Vector3(i,r,s)};return o(e.map((function(e){return[t(e),n(e),i(e)]})),r).map(a)}(t(A),n,i,r,e.pathResolution),b=u(A);if(v.__dashAnimateStep=b>0?1e3/b:0,m){v.material.resolution=e.rendererSize;var x=a(A),_=l(A),w=c(A);v.material.dashed=_>0,v.material.dashed?v.material.defines.USE_DASH="":delete v.material.defines.USE_DASH,v.material.dashed&&(v.material.dashScale=1/function(e){var t,n=0;return e.forEach((function(e){t&&(n+=t.distanceTo(e)),t=e})),n}(y),v.material.dashSize=x,v.material.gapSize=_,v.material.dashOffset=-w);var S=o(A);if(S instanceof Array){var T=d(o(A),y.length-1,1,!1);v.geometry.setColors(T.array),v.material.vertexColors=!0}else{var M=S,E=PC(M);v.material.color=new mR.Color(RC(M)),v.material.transparent=E<1,v.material.opacity=E,v.material.vertexColors=!1}v.material.needsUpdate=!0}else{Object.assign(v.material.uniforms,{dashSize:{value:a(A)},gapSize:{value:l(A)},dashOffset:{value:c(A)}});var C=d(o(A),y.length),R=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],r=0,s=e+1;r<s;r++)for(var o=r/(s-1),a=0;a<t;a++)i.push(o);return n&&i.reverse(),LC(i,1)}(y.length,1,!0);v.geometry.setAttribute("color",C),v.geometry.setAttribute("relDistance",R)}var P=fR(A.__currentTargetD&&A.__currentTargetD.points||[y[0]],y),N=function(e){var t,n=A.__currentTargetD=e,i=n.stroke,r=n.interpolK,s=A.__currentTargetD.points=P(r);m?(v.geometry.setPositions((t=[]).concat.apply(t,dC(s.map((function(e){return[e.x,e.y,e.z]}))))),v.material.linewidth=i,v.material.dashed&&v.computeLineDistances()):(v.geometry.setFromPoints(s),v.geometry.computeBoundingSphere())},D={stroke:f,interpolK:1},L=Object.assign({},A.__currentTargetD||D,{interpolK:0});Object.keys(D).some((function(e){return L[e]!==D[e]}))&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?N(D):e.tweenGroup.add(new Wv(L).to(D,e.pathTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(N).start()))}})}}),yR=window.THREE?window.THREE:{Euler:sh,Mesh:bd,MeshLambertMaterial:ag,SphereGeometry:ng},bR=Uv({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new yR.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.tileLat),n=Bb(e.tileLng),i=Bb(e.tileAltitude),r=Bb(e.tileWidth),s=Bb(e.tileHeight),o=Bb(e.tileUseGlobeProjection),a=Bb(e.tileMaterial),l=Bb(e.tileCurvatureResolution);IC(e.tilesData,e.scene,{createObj:function(){var e=new yR.Mesh;return e.__globeObjType="tile",e},updateObj:function(c,u){c.material=a(u);var h=o(u),d=l(u),p=function(e){var t=c.__currentTargetD=e,n=t.lat,i=t.lng,r=t.alt,s=t.width,o=t.height,a=xR(i),l=xR(-n);c.geometry&&c.geometry.dispose(),c.geometry=new yR.SphereGeometry(yC*(1+r),Math.ceil(s/(d||-1)),Math.ceil(o/(d||-1)),xR(90-s/2)+(h?a:0),xR(s),xR(90-o/2)+(h?l:0),xR(o)),h||c.setRotationFromEuler(new yR.Euler(l,a,0,"YXZ"))},A={lat:+t(u),lng:+n(u),alt:+i(u),width:+r(u),height:+s(u)},f=c.__currentTargetD||Object.assign({},A,{width:0,height:0});Object.keys(A).some((function(e){return f[e]!==A[e]}))&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?p(A):e.tweenGroup.add(new Wv(f).to(A,e.tilesTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(p).start()))}})}}),xR=function(e){return e*Math.PI/180},_R={glyphs:{0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},"\u03bf":{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},"\u03a4":{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},"\u03a0":{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},"\u0390":{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},"\u039a":{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},"\u0192":{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},"\u03cc":{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},"\u03ce":{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\xff":{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"\xb5":{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},"\u0399":{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},"\u038e":{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\u039d":{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},"\u03c2":{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},"\u03a8":{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},"\u03b9":{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},"\u0386":{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"\u03b5":{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},"\u0394":{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},"\u03c1":{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"\u0397":{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u0391":{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u03bd":{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},"\u03b2":{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},"\u039c":{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},"\u038c":{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u0389":{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},"\u03b3":{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},"\u03b1":{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03a7":{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},"\u039e":{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{x_min:0,x_max:0,ha:853},"\u03ab":{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},"\u038a":{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},"\u0392":{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},"\u03c5":{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},"\u03c7":{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},"\u03af":{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},"\u0396":{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},"\u03b4":{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},"\u03ad":{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},"\u03c9":{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"\u03cb":{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},"\u03a9":{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},"\u03cd":{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\u03ae":{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},"\u0398":{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},"\u0395":{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"\u03c3":{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},"\u03b6":{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},"\u03b8":{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},"\u039f":{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},"\u0393":{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"\u0388":{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u038f":{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"\u03aa":{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},"\u03a1":{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\xaa":{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"\u03a6":{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},"\u03a3":{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},"\u03bb":{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},"\u03c4":{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},"\u03be":{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},"\u039b":{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"\u03b0":{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\u03a5":{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},"\u03bc":{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03c6":{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},"\u03ca":{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},"\u03c0":{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},"\u03ac":{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},"\u03ba":{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},"\u03c8":{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},"\u03b7":{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},cssFontWeight:"normal",ascender:1189,underlinePosition:-100,cssFontStyle:"normal",boundingBox:{yMin:-334,xMin:-111,yMax:1189,xMax:1672},resolution:1e3,original_font_information:{postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},descender:-334,familyName:"Helvetiker",lineHeight:1522,underlineThickness:50},wR=cC(cC({},window.THREE?window.THREE:{BoxGeometry:_d,CircleGeometry:wm,DoubleSide:2,Group:Sf,Mesh:bd,MeshLambertMaterial:ag,TextGeometry:HE,Vector3:yu}),{},{Font:WE,TextGeometry:HE}),SR=Uv({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:_R,onChange:function(e,t){t.font=new wR.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e){var t=Bb(e.labelLat),n=Bb(e.labelLng),i=Bb(e.labelAltitude),r=Bb(e.labelText),s=Bb(e.labelSize),o=Bb(e.labelRotation),a=Bb(e.labelColor),l=Bb(e.labelIncludeDot),c=Bb(e.labelDotRadius),u=Bb(e.labelDotOrientation),h=new Set(["right","top","bottom"]),d=2*Math.PI*yC/360,p=new wR.CircleGeometry(1,32);IC(e.labelsData,e.scene,{createObj:function(){var e=new wR.MeshLambertMaterial;e.side=2;var t=new wR.Group;t.add(new wR.Mesh(p,e));var n=new wR.Mesh(void 0,e);t.add(n);var i=new wR.Mesh;return i.visible=!1,n.add(i),t.__globeObjType="label",t},updateObj:function(p,A){var f=hC(p.children,2),m=f[0],g=f[1],v=hC(g.children,1)[0],y=a(A),b=PC(y);g.material.color.set(RC(y)),g.material.transparent=b<1,g.material.opacity=b;var x=l(A),_=u(A);!x||!h.has(_)&&(_="bottom");var w=x?+c(A)*d:1e-12;m.scale.x=m.scale.y=w;var S=+s(A)*d;if(g.geometry&&g.geometry.dispose(),g.geometry=new wR.TextGeometry(r(A),{font:e.font,size:S,depth:0,height:0,curveSegments:e.labelResolution}),v.geometry&&v.geometry.dispose(),g.geometry.computeBoundingBox(),v.geometry=nC(wR.BoxGeometry,dC((new wR.Vector3).subVectors(g.geometry.boundingBox.max,g.geometry.boundingBox.min).toArray())),"right"!==_&&g.geometry.center(),x){var T=w+S/2;"right"===_&&(g.position.x=T),g.position.y={right:-S/2,top:T+S/2,bottom:-T-S/2}[_]}var M=function(t){var n=p.__currentTargetD=t,i=n.lat,r=n.lng,s=n.alt,o=n.rot,a=n.scale;Object.assign(p.position,xC(i,r,s)),p.lookAt(e.scene.localToWorld(new wR.Vector3(0,0,0))),p.rotateY(Math.PI),p.rotateZ(-o*Math.PI/180),p.scale.x=p.scale.y=p.scale.z=a},E={lat:+t(A),lng:+n(A),alt:+i(A),rot:+o(A),scale:1},C=p.__currentTargetD||Object.assign({},E,{scale:1e-12});Object.keys(E).some((function(e){return C[e]!==E[e]}))&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?M(E):e.tweenGroup.add(new Wv(C).to(E,e.labelsTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(M).start()))}})}}),TR=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;JE(this,t),(e=KE(this,t)).type="CircleLineGeometry",e.parameters={radius:n,segmentCount:i};for(var r=[],s=0;s<=i;s++){var o=(s/i-.25)*Math.PI*2;r.push({x:Math.cos(o)*n,y:Math.sin(o)*n,z:0})}return e.setFromPoints(r),e}return oC(t,e),iC(t)}((window.THREE?window.THREE:{BufferGeometry:nd}).BufferGeometry),MR=window.THREE?window.THREE:{Color:Fh,Group:Sf,Line:Wf,LineBasicMaterial:Ff,Vector3:yu},ER=d_.default||d_,CR=Uv({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;null===(t=e.ticker)||void 0===t||t.dispose()}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i,t.ticker=new ER,t.ticker.onTick.add((function(e){if(t.ringsData.length){var n=Bb(t.ringColor),i=Bb(t.ringAltitude),r=Bb(t.ringMaxRadius),s=Bb(t.ringPropagationSpeed),o=Bb(t.ringRepeatPeriod);t.ringsData.filter((function(e){return e.__threeObj})).forEach((function(a){var l,c,u=a.__threeObj;if((u.__nextRingTime||0)<=e){var h=o(a)/1e3;u.__nextRingTime=e+(h<=0?1/0:h);var d,p=new MR.Line(new TR(1,t.ringResolution),new MR.LineBasicMaterial),A=n(a),f=A instanceof Array||A instanceof Function;f?A instanceof Array?(d=fw().domain(A.map((function(e,t){return t/(A.length-1)}))).range(A),p.material.transparent=A.some((function(e){return PC(e)<1}))):(d=A,p.material.transparent=!0):(p.material.color=new MR.Color(RC(A)),l=p.material,c=PC(A),l.opacity=c,l.transparent=c<1,l.depthWrite=c>=1);var m=yC*(1+i(a)),g=r(a),v=g*Math.PI/180,y=s(a),b=y<=0,x=function(e){var t=e.t,n=(b?1-t:t)*v;if(p.scale.x=p.scale.y=m*Math.sin(n),p.position.z=m*(1-Math.cos(n)),f){var i=d(t);p.material.color=new MR.Color(RC(i)),p.material.transparent&&(p.material.opacity=PC(i))}};if(0===y)x({t:0}),u.add(p);else{var _=1e3*Math.abs(g/y);t.tweenGroup.add(new Wv({t:0}).to({t:1},_).onUpdate(x).onStart((function(){return u.add(p)})).onComplete((function(){u.remove(p),mC(p)})).start())}}}))}}))},update:function(e){var t=Bb(e.ringLat),n=Bb(e.ringLng),i=Bb(e.ringAltitude),r=e.scene.localToWorld(new MR.Vector3(0,0,0));IC(e.ringsData,e.scene,{createObj:function(){var e=new MR.Group;return e.__globeObjType="ring",e},updateObj:function(e,s){var o=t(s),a=n(s),l=i(s);Object.assign(e.position,xC(o,a,l)),e.lookAt(r)}},{removeDelay:3e4})}}),RR=cC(cC({},window.THREE?window.THREE:{}),{},{CSS2DObject:class extends _h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Hc(.5,.5),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}}),PR=Uv({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){var n=t?[t]:e.htmlElementsData.map((function(e){return e.__threeObj})).filter((function(e){return e}));n.forEach((function(t){return t.visible=!e.isBehindGlobe||!e.isBehindGlobe(t.position)}))}},init:function(e,t,n){var i=n.tweenGroup;gC(e),t.scene=e,t.tweenGroup=i},update:function(e,t){var n=this,i=Bb(e.htmlLat),r=Bb(e.htmlLng),s=Bb(e.htmlAltitude),o=Bb(e.htmlElement);IC(e.htmlElementsData,e.scene,{purge:t.hasOwnProperty("htmlElement"),createObj:function(e){var t=o(e),n=new RR.CSS2DObject(t);return n.__globeObjType="html",n},updateObj:function(t,o){var a=function(e){var i=t.__currentTargetD=e,r=i.alt,s=i.lat,o=i.lng;Object.assign(t.position,xC(s,o,r)),n.updateObjVisibility(t)},l={lat:+i(o),lng:+r(o),alt:+s(o)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!t.__currentTargetD?a(l):e.tweenGroup.add(new Wv(t.__currentTargetD).to(l,e.htmlTransitionDuration).easing(zv.Quadratic.InOut).onUpdate(a).start())}})}}),NR=window.THREE?window.THREE:{Group:Sf,Mesh:bd,MeshLambertMaterial:ag,SphereGeometry:ng},DR=Uv({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new NR.Mesh(new NR.SphereGeometry(1,16,8),new NR.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){gC(e),t.scene=e},update:function(e,t){var n=Bb(e.objectLat),i=Bb(e.objectLng),r=Bb(e.objectAltitude),s=Bb(e.objectFacesSurface),o=Bb(e.objectRotation),a=Bb(e.objectThreeObject);IC(e.objectsData,e.scene,{purge:t.hasOwnProperty("objectThreeObject"),createObj:function(t){var n=a(t);e.objectThreeObject===n&&(n=n.clone());var i=new NR.Group;return i.add(n),i.__globeObjType="object",i},updateObj:function(e,t){var a=+n(t),l=+i(t),c=+r(t);Object.assign(e.position,xC(a,l,c)),s(t)?e.setRotationFromEuler(new sh(wC(-a),wC(l),0,"YXZ")):e.rotation.set(0,0,0);var u=e.children[0],h=o(t);h&&u.setRotationFromEuler(new sh(wC(h.x||0),wC(h.y||0),wC(h.z||0)))}})}}),LR=Uv({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){gC(e),t.scene=e},update:function(e,t){e.customThreeObjectUpdate||gC(e.scene);var n=Bb(e.customThreeObject),i=Bb(e.customThreeObjectUpdate);IC(e.customLayerData,e.scene,{purge:t.hasOwnProperty("customThreeObject"),createObj:function(t){var i=n(t,yC);return i&&(e.customThreeObject===i&&(i=i.clone()),i.__globeObjType="custom"),i},updateObj:function(e,t){return i(e,t,yC)}})}}),IR=window.THREE?window.THREE:{Group:Sf,Vector2:Hc,Vector3:yu},OR=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","labelsLayer","ringsLayer","htmlElementsLayer","objectsLayer","customLayer"],kR=vC("globeLayer",CC),BR=Object.assign.apply(Object,dC(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map((function(e){return rC({},e,kR.linkProp(e))})))),FR=Object.assign.apply(Object,dC(["globeMaterial"].map((function(e){return rC({},e,kR.linkMethod(e))})))),UR=vC("pointsLayer",FC),zR=Object.assign.apply(Object,dC(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map((function(e){return rC({},e,UR.linkProp(e))})))),qR=vC("arcsLayer",HC),VR=Object.assign.apply(Object,dC(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map((function(e){return rC({},e,qR.linkProp(e))})))),GR=vC("hexBinLayer",QC),jR=Object.assign.apply(Object,dC(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map((function(e){return rC({},e,GR.linkProp(e))})))),HR=vC("heatmapsLayer",aR),WR=Object.assign.apply(Object,dC(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map((function(e){return rC({},e,HR.linkProp(e))})))),XR=vC("hexedPolygonsLayer",pR),YR=Object.assign.apply(Object,dC(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map((function(e){return rC({},e,XR.linkProp(e))})))),QR=vC("polygonsLayer",cR),KR=Object.assign.apply(Object,dC(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map((function(e){return rC({},e,QR.linkProp(e))})))),ZR=vC("pathsLayer",vR),JR=Object.assign.apply(Object,dC(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map((function(e){return rC({},e,ZR.linkProp(e))})))),$R=vC("tilesLayer",bR),eP=Object.assign.apply(Object,dC(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map((function(e){return rC({},e,$R.linkProp(e))})))),tP=vC("labelsLayer",SR),nP=Object.assign.apply(Object,dC(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map((function(e){return rC({},e,tP.linkProp(e))})))),iP=vC("ringsLayer",CR),rP=Object.assign.apply(Object,dC(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map((function(e){return rC({},e,iP.linkProp(e))})))),sP=vC("htmlElementsLayer",PR),oP=Object.assign.apply(Object,dC(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration"].map((function(e){return rC({},e,sP.linkProp(e))})))),aP=vC("objectsLayer",DR),lP=Object.assign.apply(Object,dC(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map((function(e){return rC({},e,aP.linkProp(e))})))),cP=vC("customLayer",LR),uP=Object.assign.apply(Object,dC(["customLayerData","customThreeObject","customThreeObjectUpdate"].map((function(e){return rC({},e,cP.linkProp(e))})))),hP=Uv({props:cC(cC(cC(cC(cC(cC(cC(cC(cC(cC(cC(cC(cC(cC({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new IR.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},BR),zR),VR),jR),WR),KR),YR),JR),eP),nP),rP),oP),lP),uP),methods:cC({getGlobeRadius:bC,getCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return xC.apply(void 0,n)},toGeoCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return _C.apply(void 0,n)},setPointOfView:function(e,t,n){var i=void 0;if(t){var r,s,o,a=bC(),l=n?t.clone().sub(n):t;i=function(e){void 0===r&&(r=l.length()),void 0===s&&(s=Math.sqrt(Math.pow(r,2)-Math.pow(a,2))),void 0===o&&(o=Math.acos(s/r));var t=l.distanceTo(e);if(t<s)return!1;var n=e.length();return Math.acos((Math.pow(r,2)+Math.pow(t,2)-Math.pow(n,2))/(2*r*t))<o}}e.layersThatNeedBehindGlobeChecker.forEach((function(e){return e.isBehindGlobe(i)}))},pauseAnimation:function(e){return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach((function(e){var t;return null===(t=e.pauseAnimation)||void 0===t?void 0:t.call(e)})),this},resumeAnimation:function(e){return null===e.animationFrameRequestId&&this._animationCycle(),e.pausableLayers.forEach((function(e){var t;return null===(t=e.resumeAnimation)||void 0===t?void 0:t.call(e)})),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach((function(e){return e._destructor()}))}},FR),stateInit:function(){var e=new Vv,t={tweenGroup:e},n={globeLayer:CC(t),pointsLayer:FC(t),arcsLayer:HC(t),hexBinLayer:QC(t),heatmapsLayer:aR(t),polygonsLayer:cR(t),hexedPolygonsLayer:pR(t),pathsLayer:vR(t),tilesLayer:bR(t),labelsLayer:SR(t),ringsLayer:CR(t),htmlElementsLayer:PR(t),objectsLayer:DR(t),customLayer:LR(t)};return cC(cC({tweenGroup:e},n),{},{layersThatNeedBehindGlobeChecker:Object.values(n).filter((function(e){return e.hasOwnProperty("isBehindGlobe")})),destructableLayers:Object.values(n).filter((function(e){return e.hasOwnProperty("_destructor")})),pausableLayers:Object.values(n).filter((function(e){return e.hasOwnProperty("pauseAnimation")}))})},init:function(e,t,n){var i=n.animateIn,r=void 0===i||i,s=n.waitForGlobeReady,o=void 0===s||s;gC(e),t.scene=e,t.scene.visible=!1,OR.forEach((function(e){var n=new IR.Group;t.scene.add(n),t[e](n)}));var a=function(){if(r){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new Wv({k:1e-6}).to({k:1},600).easing(zv.Quadratic.Out).onUpdate((function(e){var n=e.k;return t.scene.scale.set(n,n,n)})).start());var e=new IR.Vector3(0,1,0);t.tweenGroup.add(new Wv({rot:2*Math.PI}).to({rot:0},1200).easing(zv.Quintic.Out).onUpdate((function(n){var i=n.rot;return t.scene.setRotationFromAxisAngle(e,i)})).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};o?t.globeLayer.onReady(a):a(),this._animationCycle()},update:function(e){}});var dP=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(n){function i(){var n;JE(this,i);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(n=KE(this,i,[].concat(s))).__kapsuleInstance=nC(e,[].concat(dC(t?[n]:[]),s)),n}return oC(i,n),iC(i)}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object);return Object.keys(e()).forEach((function(e){return n.prototype[e]=function(){var t,n=(t=this.__kapsuleInstance)[e].apply(t,arguments);return n===this.__kapsuleInstance?this:n}})),n}(hP,(window.THREE?window.THREE:{Group:Sf}).Group,!0);const pP="168",AP=100,fP=101,mP=102,gP=200,vP=201,yP=202,bP=203,xP=204,_P=205,wP=206,SP=207,TP=208,MP=209,EP=210,CP=301,RP=302,PP=303,NP=304,DP=1e3,LP=1001,IP=1002,OP=1003,kP=1004,BP=1005,FP=1006,UP=1007,zP=1008,qP=1009,VP=1010,GP=1011,jP=1012,HP=1013,WP=1014,XP=1015,YP=1016,QP=1020,KP=1022,ZP=1023,JP=1026,$P=1027,eN=1028,tN=1029,nN=1030,iN=1031,rN=1033,sN=33776,oN=33777,aN=33778,lN=33779,cN=37492,uN=37496,hN=37808,dN=37809,pN=37810,AN=37811,fN=37812,mN=37813,gN=37814,vN=37815,yN=37816,bN=37817,xN=37818,_N=37819,wN=37820,SN=37821,TN=36492,MN=2300,EN=2301,CN=2302,RN=2400,PN=2401,NN=2402,DN="srgb",LN="srgb-linear",IN="display-p3",ON="display-p3-linear",kN="linear",BN="srgb",FN="rec709",UN=7680,zN=512,qN=513,VN=514,GN=515,jN=516,HN=517,WN=518,XN=519,YN=35044,QN=35048,KN=2e3,ZN=2001;class JN{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const $N=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let eD=1234567;const tD=Math.PI/180,nD=180/Math.PI;function iD(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return($N[255&e]+$N[e>>8&255]+$N[e>>16&255]+$N[e>>24&255]+"-"+$N[255&t]+$N[t>>8&255]+"-"+$N[t>>16&15|64]+$N[t>>24&255]+"-"+$N[63&n|128]+$N[n>>8&255]+"-"+$N[n>>16&255]+$N[n>>24&255]+$N[255&i]+$N[i>>8&255]+$N[i>>16&255]+$N[i>>24&255]).toLowerCase()}function rD(e,t,n){return Math.max(t,Math.min(n,e))}function sD(e,t){return(e%t+t)%t}function oD(e,t,n){return(1-n)*e+n*t}function aD(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function lD(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const cD={DEG2RAD:tD,RAD2DEG:nD,generateUUID:iD,clamp:rD,euclideanModulo:sD,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:oD,damp:function(e,t,n,i){return oD(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(sD(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(eD=e);let t=eD+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*tD},radToDeg:function(e){return e*nD},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((t+i)/2),u=o((t+i)/2),h=s((t-i)/2),d=o((t-i)/2),p=s((i-t)/2),A=o((i-t)/2);switch(r){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*A,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*A,a*c);break;case"ZYZ":e.set(l*A,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:lD,denormalize:aD};class uD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;uD.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rD(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class hD{constructor(e,t,n,i,r,s,o,a,l){hD.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l)}set(e,t,n,i,r,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],A=i[0],f=i[3],m=i[6],g=i[1],v=i[4],y=i[7],b=i[2],x=i[5],_=i[8];return r[0]=s*A+o*g+a*b,r[3]=s*f+o*v+a*x,r[6]=s*m+o*y+a*_,r[1]=l*A+c*g+u*b,r[4]=l*f+c*v+u*x,r[7]=l*m+c*y+u*_,r[2]=h*A+d*g+p*b,r[5]=h*f+d*v+p*x,r[8]=h*m+d*y+p*_,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const A=1/p;return e[0]=u*A,e[1]=(i*l-c*n)*A,e[2]=(o*n-i*s)*A,e[3]=h*A,e[4]=(c*t-i*a)*A,e[5]=(i*r-o*t)*A,e[6]=d*A,e[7]=(n*a-l*t)*A,e[8]=(s*t-n*r)*A,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(dD.makeScale(e,t)),this}rotate(e){return this.premultiply(dD.makeRotation(-e)),this}translate(e,t){return this.premultiply(dD.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const dD=new hD;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function pD(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const AD={};function fD(e){e in AD||(AD[e]=!0,console.warn(e))}const mD=(new hD).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gD=(new hD).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),vD={[LN]:{transfer:kN,primaries:FN,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[DN]:{transfer:BN,primaries:FN,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[ON]:{transfer:kN,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(gD),fromReference:e=>e.applyMatrix3(mD)},[IN]:{transfer:BN,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(gD),fromReference:e=>e.applyMatrix3(mD).convertLinearToSRGB()}},yD=new Set([LN,ON]),bD={enabled:!0,_workingColorSpace:LN,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!yD.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const i=vD[t].toReference;return(0,vD[n].fromReference)(i(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return vD[e].primaries},getTransfer:function(e){return""===e?kN:vD[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._workingColorSpace;return e.fromArray(vD[t].luminanceCoefficients)}};function xD(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function _D(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let wD;class SD{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===wD&&(wD=pD("canvas")),wD.width=e.width,wD.height=e.height;const n=wD.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=wD}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=pD("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*xD(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*xD(t[e]/255)):t[e]=xD(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let TD=0;class MD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:TD++}),this.uuid=iD(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(ED(i[t].image)):e.push(ED(i[t]))}else e=ED(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function ED(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?SD.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let CD=0;class RD extends JN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:RD.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RD.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LP,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:LP,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:FP,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zP,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ZP,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:qP,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:RD.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:CD++}),this.uuid=iD(),this.name="",this.source=new MD(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new uD(0,0),this.repeat=new uD(1,1),this.center=new uD(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new hD,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case DP:e.x=e.x-Math.floor(e.x);break;case LP:e.x=e.x<0?0:1;break;case IP:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case DP:e.y=e.y-Math.floor(e.y);break;case LP:e.y=e.y<0?0:1;break;case IP:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}RD.DEFAULT_IMAGE=null,RD.DEFAULT_MAPPING=300,RD.DEFAULT_ANISOTROPY=1;class PD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;PD.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],A=a[2],f=a[6],m=a[10];if(Math.abs(c-h)<s&&Math.abs(u-A)<s&&Math.abs(p-f)<s){if(Math.abs(c+h)<o&&Math.abs(u+A)<o&&Math.abs(p+f)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,g=(m+1)/2,v=(c+h)/4,y=(u+A)/4,b=(p+f)/4;return e>a&&e>g?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=v/n,r=y/n):a>g?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=v/i,r=b/i):g<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=y/r,i=b/r),this.set(n,i,r,t),this}let g=Math.sqrt((f-p)*(f-p)+(u-A)*(u-A)+(h-c)*(h-c));return Math.abs(g)<.001&&(g=1),this.x=(f-p)/g,this.y=(u-A)/g,this.z=(h-c)/g,this.w=Math.acos((l+d+m-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ND extends JN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new PD(0,0,e,t),this.scissorTest=!1,this.viewport=new PD(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:FP,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new RD(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const s=n.count;for(let o=0;o<s;o++)this.textures[o]=r.clone(),this.textures[o].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new MD(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DD extends ND{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class LD extends RD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=OP,this.minFilter=OP,this.wrapR=LP,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class ID{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],A=r[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=A);if(u!==A||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*A,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+A*r,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rD(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class OD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;OD.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(BD.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(BD.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=2*(s*i-o*n),c=2*(o*t-r*i),u=2*(r*n-s*t);return this.x=t+a*l+s*u-o*c,this.y=n+a*c+o*l-r*u,this.z=i+a*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return kD.copy(this).projectOnVector(e),this.sub(kD)}reflect(e){return this.sub(kD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rD(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const kD=new OD,BD=new ID;class FD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new OD(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new OD(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(zD.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(zD.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=zD.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,zD):zD.fromBufferAttribute(i,t),zD.applyMatrix4(e.matrixWorld),this.expandByPoint(zD);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),qD.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),qD.copy(n.boundingBox)),qD.applyMatrix4(e.matrixWorld),this.union(qD)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,zD),zD.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(YD),QD.subVectors(this.max,YD),VD.subVectors(e.a,YD),GD.subVectors(e.b,YD),jD.subVectors(e.c,YD),HD.subVectors(GD,VD),WD.subVectors(jD,GD),XD.subVectors(VD,jD);let t=[0,-HD.z,HD.y,0,-WD.z,WD.y,0,-XD.z,XD.y,HD.z,0,-HD.x,WD.z,0,-WD.x,XD.z,0,-XD.x,-HD.y,HD.x,0,-WD.y,WD.x,0,-XD.y,XD.x,0];return!!JD(t,VD,GD,jD,QD)&&(t=[1,0,0,0,1,0,0,0,1],!!JD(t,VD,GD,jD,QD)&&(KD.crossVectors(HD,WD),t=[KD.x,KD.y,KD.z],JD(t,VD,GD,jD,QD)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zD).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(zD).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(UD[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),UD[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),UD[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),UD[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),UD[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),UD[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),UD[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),UD[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(UD)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const UD=[new OD,new OD,new OD,new OD,new OD,new OD,new OD,new OD],zD=new OD,qD=new FD,VD=new OD,GD=new OD,jD=new OD,HD=new OD,WD=new OD,XD=new OD,YD=new OD,QD=new OD,KD=new OD,ZD=new OD;function JD(e,t,n,i,r){for(let s=0,o=e.length-3;s<=o;s+=3){ZD.fromArray(e,s);const o=r.x*Math.abs(ZD.x)+r.y*Math.abs(ZD.y)+r.z*Math.abs(ZD.z),a=t.dot(ZD),l=n.dot(ZD),c=i.dot(ZD);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const $D=new FD,eL=new OD,tL=new OD;class nL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new OD,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):$D.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;eL.subVectors(e,this.center);const t=eL.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(eL,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(tL.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(eL.copy(e.center).add(tL)),this.expandByPoint(eL.copy(e.center).sub(tL))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const iL=new OD,rL=new OD,sL=new OD,oL=new OD,aL=new OD,lL=new OD,cL=new OD;class uL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new OD,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new OD(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,iL)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=iL.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(iL.copy(this.origin).addScaledVector(this.direction,t),iL.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){rL.copy(e).add(t).multiplyScalar(.5),sL.copy(t).sub(e).normalize(),oL.copy(this.origin).sub(rL);const r=.5*e.distanceTo(t),s=-this.direction.dot(sL),o=oL.dot(this.direction),a=-oL.dot(sL),l=oL.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(rL).addScaledVector(sL,h),d}intersectSphere(e,t){iL.subVectors(e.center,this.origin);const n=iL.dot(this.direction),i=iL.dot(iL)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||o>i?null:((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,iL)}intersectTriangle(e,t,n,i,r){aL.subVectors(t,e),lL.subVectors(n,e),cL.crossVectors(aL,lL);let s,o=this.direction.dot(cL);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}oL.subVectors(this.origin,e);const a=s*this.direction.dot(lL.crossVectors(oL,lL));if(a<0)return null;const l=s*this.direction.dot(aL.cross(oL));if(l<0)return null;if(a+l>o)return null;const c=-s*oL.dot(cL);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class hL{constructor(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f){hL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f)}set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,A,f){const m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=i,m[1]=r,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=d,m[7]=p,m[11]=A,m[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new hL).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/dL.setFromMatrixColumn(e,0).length(),r=1/dL.setFromMatrixColumn(e,1).length(),s=1/dL.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*a,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e+r*o,t[4]=i*o-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e-r*o,t[4]=-s*u,t[8]=i+n*o,t[1]=n+i*o,t[5]=s*c,t[9]=r-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=a*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=o*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AL,e,fL)}lookAt(e,t,n){const i=this.elements;return vL.subVectors(e,t),0===vL.lengthSq()&&(vL.z=1),vL.normalize(),mL.crossVectors(n,vL),0===mL.lengthSq()&&(1===Math.abs(n.z)?vL.x+=1e-4:vL.z+=1e-4,vL.normalize(),mL.crossVectors(n,vL)),mL.normalize(),gL.crossVectors(vL,mL),i[0]=mL.x,i[4]=gL.x,i[8]=vL.x,i[1]=mL.y,i[5]=gL.y,i[9]=vL.y,i[2]=mL.z,i[6]=gL.z,i[10]=vL.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],A=n[6],f=n[10],m=n[14],g=n[3],v=n[7],y=n[11],b=n[15],x=i[0],_=i[4],w=i[8],S=i[12],T=i[1],M=i[5],E=i[9],C=i[13],R=i[2],P=i[6],N=i[10],D=i[14],L=i[3],I=i[7],O=i[11],k=i[15];return r[0]=s*x+o*T+a*R+l*L,r[4]=s*_+o*M+a*P+l*I,r[8]=s*w+o*E+a*N+l*O,r[12]=s*S+o*C+a*D+l*k,r[1]=c*x+u*T+h*R+d*L,r[5]=c*_+u*M+h*P+d*I,r[9]=c*w+u*E+h*N+d*O,r[13]=c*S+u*C+h*D+d*k,r[2]=p*x+A*T+f*R+m*L,r[6]=p*_+A*M+f*P+m*I,r[10]=p*w+A*E+f*N+m*O,r[14]=p*S+A*C+f*D+m*k,r[3]=g*x+v*T+y*R+b*L,r[7]=g*_+v*M+y*P+b*I,r[11]=g*w+v*E+y*N+b*O,r[15]=g*S+v*C+y*D+b*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+e[7]*(+t*a*d-t*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+e[11]*(+t*l*u-t*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+e[15]*(-i*o*c-t*a*u+t*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],A=e[13],f=e[14],m=e[15],g=u*f*l-A*h*l+A*a*d-o*f*d-u*a*m+o*h*m,v=p*h*l-c*f*l-p*a*d+s*f*d+c*a*m-s*h*m,y=c*A*l-p*u*l+p*o*d-s*A*d-c*o*m+s*u*m,b=p*u*a-c*A*a-p*o*h+s*A*h+c*o*f-s*u*f,x=t*g+n*v+i*y+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=g*_,e[1]=(A*h*r-u*f*r-A*i*d+n*f*d+u*i*m-n*h*m)*_,e[2]=(o*f*r-A*a*r+A*i*l-n*f*l-o*i*m+n*a*m)*_,e[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*_,e[4]=v*_,e[5]=(c*f*r-p*h*r+p*i*d-t*f*d-c*i*m+t*h*m)*_,e[6]=(p*a*r-s*f*r-p*i*l+t*f*l+s*i*m-t*a*m)*_,e[7]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*d+t*a*d)*_,e[8]=y*_,e[9]=(p*u*r-c*A*r-p*n*d+t*A*d+c*n*m-t*u*m)*_,e[10]=(s*A*r-p*o*r+p*n*l-t*A*l-s*n*m+t*o*m)*_,e[11]=(c*o*r-s*u*r-c*n*l+t*u*l+s*n*d-t*o*d)*_,e[12]=b*_,e[13]=(c*A*i-p*u*i+p*n*h-t*A*h-c*n*f+t*u*f)*_,e[14]=(p*o*i-s*A*i-p*n*a+t*A*a+s*n*f-t*o*f)*_,e[15]=(s*u*i-c*o*i+c*n*a-t*u*a-s*n*h+t*o*h)*_,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,A=s*c,f=s*u,m=o*u,g=a*l,v=a*c,y=a*u,b=n.x,x=n.y,_=n.z;return i[0]=(1-(A+m))*b,i[1]=(d+y)*b,i[2]=(p-v)*b,i[3]=0,i[4]=(d-y)*x,i[5]=(1-(h+m))*x,i[6]=(f+g)*x,i[7]=0,i[8]=(p+v)*_,i[9]=(f-g)*_,i[10]=(1-(h+A))*_,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=dL.set(i[0],i[1],i[2]).length();const s=dL.set(i[4],i[5],i[6]).length(),o=dL.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],pL.copy(this);const a=1/r,l=1/s,c=1/o;return pL.elements[0]*=a,pL.elements[1]*=a,pL.elements[2]*=a,pL.elements[4]*=l,pL.elements[5]*=l,pL.elements[6]*=l,pL.elements[8]*=c,pL.elements[9]*=c,pL.elements[10]*=c,t.setFromRotationMatrix(pL),n.x=r,n.y=s,n.z=o,this}makePerspective(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:KN;const a=this.elements,l=2*r/(t-e),c=2*r/(n-i),u=(t+e)/(t-e),h=(n+i)/(n-i);let d,p;if(o===KN)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(o!==ZN)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-s/(s-r),p=-s*r/(s-r)}return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:KN;const a=this.elements,l=1/(t-e),c=1/(n-i),u=1/(s-r),h=(t+e)*l,d=(n+i)*c;let p,A;if(o===KN)p=(s+r)*u,A=-2*u;else{if(o!==ZN)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=r*u,A=-1*u}return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=A,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const dL=new OD,pL=new hL,AL=new OD(0,0,0),fL=new OD(1,1,1),mL=new OD,gL=new OD,vL=new OD,yL=new hL,bL=new ID;class xL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xL.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(rD(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-rD(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(rD(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-rD(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(rD(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-rD(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yL,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return bL.setFromEuler(this),this.setFromQuaternion(bL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}xL.DEFAULT_ORDER="XYZ";class _L{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let wL=0;const SL=new OD,TL=new ID,ML=new hL,EL=new OD,CL=new OD,RL=new OD,PL=new ID,NL=new OD(1,0,0),DL=new OD(0,1,0),LL=new OD(0,0,1),IL={type:"added"},OL={type:"removed"},kL={type:"childadded",child:null},BL={type:"childremoved",child:null};class FL extends JN{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:wL++}),this.uuid=iD(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=FL.DEFAULT_UP.clone();const e=new OD,t=new xL,n=new ID,i=new OD(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new hL},normalMatrix:{value:new hD}}),this.matrix=new hL,this.matrixWorld=new hL,this.matrixAutoUpdate=FL.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=FL.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new _L,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return TL.setFromAxisAngle(e,t),this.quaternion.multiply(TL),this}rotateOnWorldAxis(e,t){return TL.setFromAxisAngle(e,t),this.quaternion.premultiply(TL),this}rotateX(e){return this.rotateOnAxis(NL,e)}rotateY(e){return this.rotateOnAxis(DL,e)}rotateZ(e){return this.rotateOnAxis(LL,e)}translateOnAxis(e,t){return SL.copy(e).applyQuaternion(this.quaternion),this.position.add(SL.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(NL,e)}translateY(e){return this.translateOnAxis(DL,e)}translateZ(e){return this.translateOnAxis(LL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ML.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?EL.copy(e):EL.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),CL.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ML.lookAt(CL,EL,this.up):ML.lookAt(EL,CL,this.up),this.quaternion.setFromRotationMatrix(ML),i&&(ML.extractRotation(i.matrixWorld),TL.setFromRotationMatrix(ML),this.quaternion.premultiply(TL.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(IL),kL.child=e,this.dispatchEvent(kL),kL.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(OL),BL.child=e,this.dispatchEvent(BL),BL.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ML.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ML.multiply(e.parent.matrixWorld)),e.applyMatrix4(ML),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(IL),kL.child=e,this.dispatchEvent(kL),kL.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(CL,e,RL),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(CL,PL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}FL.DEFAULT_UP=new OD(0,1,0),FL.DEFAULT_MATRIX_AUTO_UPDATE=!0,FL.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const UL=new OD,zL=new OD,qL=new OD,VL=new OD,GL=new OD,jL=new OD,HL=new OD,WL=new OD,XL=new OD,YL=new OD;class QL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new OD,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new OD,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new OD;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),UL.subVectors(e,t),i.cross(UL);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){UL.subVectors(i,t),zL.subVectors(n,t),qL.subVectors(e,t);const s=UL.dot(UL),o=UL.dot(zL),a=UL.dot(qL),l=zL.dot(zL),c=zL.dot(qL),u=s*l-o*o;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,VL)&&(VL.x>=0&&VL.y>=0&&VL.x+VL.y<=1)}static getInterpolation(e,t,n,i,r,s,o,a){return null===this.getBarycoord(e,t,n,i,VL)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(r,VL.x),a.addScaledVector(s,VL.y),a.addScaledVector(o,VL.z),a)}static isFrontFacing(e,t,n,i){return UL.subVectors(n,t),zL.subVectors(e,t),UL.cross(zL).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return UL.subVectors(this.c,this.b),zL.subVectors(this.a,this.b),.5*UL.cross(zL).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return QL.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return QL.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return QL.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return QL.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return QL.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,o;GL.subVectors(i,n),jL.subVectors(r,n),WL.subVectors(e,n);const a=GL.dot(WL),l=jL.dot(WL);if(a<=0&&l<=0)return t.copy(n);XL.subVectors(e,i);const c=GL.dot(XL),u=jL.dot(XL);if(c>=0&&u<=c)return t.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(n).addScaledVector(GL,s);YL.subVectors(e,r);const d=GL.dot(YL),p=jL.dot(YL);if(p>=0&&d<=p)return t.copy(r);const A=d*l-a*p;if(A<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(jL,o);const f=c*p-d*u;if(f<=0&&u-c>=0&&d-p>=0)return HL.subVectors(r,i),o=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(HL,o);const m=1/(f+A+h);return s=A*m,o=h*m,t.copy(n).addScaledVector(GL,s).addScaledVector(jL,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const KL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ZL={h:0,s:0,l:0},JL={h:0,s:0,l:0};function $L(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class eI{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DN;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,bD.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bD.workingColorSpace;return this.r=e,this.g=t,this.b=n,bD.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bD.workingColorSpace;if(e=sD(e,1),t=rD(t,0,1),n=rD(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=$L(r,i,e+1/3),this.g=$L(r,i,e),this.b=$L(r,i,e-1/3)}return bD.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DN;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],o=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DN;const n=KL[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xD(e.r),this.g=xD(e.g),this.b=xD(e.b),this}copyLinearToSRGB(e){return this.r=_D(e.r),this.g=_D(e.g),this.b=_D(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DN;return bD.fromWorkingColorSpace(tI.copy(this),e),65536*Math.round(rD(255*tI.r,0,255))+256*Math.round(rD(255*tI.g,0,255))+Math.round(rD(255*tI.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DN;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bD.workingColorSpace;bD.fromWorkingColorSpace(tI.copy(this),t);const n=tI.r,i=tI.g,r=tI.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case n:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-n)/e+2;break;case r:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bD.workingColorSpace;return bD.fromWorkingColorSpace(tI.copy(this),t),e.r=tI.r,e.g=tI.g,e.b=tI.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DN;bD.fromWorkingColorSpace(tI.copy(this),e);const t=tI.r,n=tI.g,i=tI.b;return e!==DN?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(ZL),this.setHSL(ZL.h+e,ZL.s+t,ZL.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ZL),e.getHSL(JL);const n=oD(ZL.h,JL.h,t),i=oD(ZL.s,JL.s,t),r=oD(ZL.l,JL.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const tI=new eI;eI.NAMES=KL;let nI=0;class iI extends JN{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nI++}),this.uuid=iD(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xP,this.blendDst=_P,this.blendEquation=AP,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new eI(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=UN,this.stencilZFail=UN,this.stencilZPass=UN,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==xP&&(n.blendSrc=this.blendSrc),this.blendDst!==_P&&(n.blendDst=this.blendDst),this.blendEquation!==AP&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==UN&&(n.stencilFail=this.stencilFail),this.stencilZFail!==UN&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==UN&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class rI extends iI{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new eI(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const sI=oI();function oI(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function aI(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=rD(e,-65504,65504),sI.floatView[0]=e;const t=sI.uint32View[0],n=t>>23&511;return sI.baseTable[n]+((8388607&t)>>sI.shiftTable[n])}function lI(e){const t=e>>10;return sI.uint32View[0]=sI.mantissaTable[sI.offsetTable[t]+(1023&e)]+sI.exponentTable[t],sI.floatView[0]}const cI=new OD,uI=new uD;class hI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=YN,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=XP,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return fD("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)uI.fromBufferAttribute(this,t),uI.applyMatrix3(e),this.setXY(t,uI.x,uI.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)cI.fromBufferAttribute(this,t),cI.applyMatrix3(e),this.setXYZ(t,cI.x,cI.y,cI.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)cI.fromBufferAttribute(this,t),cI.applyMatrix4(e),this.setXYZ(t,cI.x,cI.y,cI.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cI.fromBufferAttribute(this,t),cI.applyNormalMatrix(e),this.setXYZ(t,cI.x,cI.y,cI.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cI.fromBufferAttribute(this,t),cI.transformDirection(e),this.setXYZ(t,cI.x,cI.y,cI.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=aD(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=lD(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=aD(t,this.array)),t}setX(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=aD(t,this.array)),t}setY(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=aD(t,this.array)),t}setZ(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=aD(t,this.array)),t}setW(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array),r=lD(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==YN&&(e.usage=this.usage),e}}class dI extends hI{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class pI extends hI{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class AI extends hI{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=lI(this.array[e*this.itemSize]);return this.normalized&&(t=aD(t,this.array)),t}setX(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize]=aI(t),this}getY(e){let t=lI(this.array[e*this.itemSize+1]);return this.normalized&&(t=aD(t,this.array)),t}setY(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+1]=aI(t),this}getZ(e){let t=lI(this.array[e*this.itemSize+2]);return this.normalized&&(t=aD(t,this.array)),t}setZ(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+2]=aI(t),this}getW(e){let t=lI(this.array[e*this.itemSize+3]);return this.normalized&&(t=aD(t,this.array)),t}setW(e,t){return this.normalized&&(t=lD(t,this.array)),this.array[e*this.itemSize+3]=aI(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array)),this.array[e+0]=aI(t),this.array[e+1]=aI(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array)),this.array[e+0]=aI(t),this.array[e+1]=aI(n),this.array[e+2]=aI(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array),r=lD(r,this.array)),this.array[e+0]=aI(t),this.array[e+1]=aI(n),this.array[e+2]=aI(i),this.array[e+3]=aI(r),this}}class fI extends hI{constructor(e,t,n){super(new Float32Array(e),t,n)}}let mI=0;const gI=new hL,vI=new FL,yI=new OD,bI=new FD,xI=new FD,_I=new OD;class wI extends JN{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:mI++}),this.uuid=iD(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(function(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}(e)?pI:dI)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new hD).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return gI.makeRotationFromQuaternion(e),this.applyMatrix4(gI),this}rotateX(e){return gI.makeRotationX(e),this.applyMatrix4(gI),this}rotateY(e){return gI.makeRotationY(e),this.applyMatrix4(gI),this}rotateZ(e){return gI.makeRotationZ(e),this.applyMatrix4(gI),this}translate(e,t,n){return gI.makeTranslation(e,t,n),this.applyMatrix4(gI),this}scale(e,t,n){return gI.makeScale(e,t,n),this.applyMatrix4(gI),this}lookAt(e){return vI.lookAt(e),vI.updateMatrix(),this.applyMatrix4(vI.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yI).negate(),this.translate(yI.x,yI.y,yI.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new fI(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new FD);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new OD(-1/0,-1/0,-1/0),new OD(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];bI.setFromBufferAttribute(e),this.morphTargetsRelative?(_I.addVectors(this.boundingBox.min,bI.min),this.boundingBox.expandByPoint(_I),_I.addVectors(this.boundingBox.max,bI.max),this.boundingBox.expandByPoint(_I)):(this.boundingBox.expandByPoint(bI.min),this.boundingBox.expandByPoint(bI.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new nL);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new OD,1/0);if(e){const n=this.boundingSphere.center;if(bI.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];xI.setFromBufferAttribute(n),this.morphTargetsRelative?(_I.addVectors(bI.min,xI.min),bI.expandByPoint(_I),_I.addVectors(bI.max,xI.max),bI.expandByPoint(_I)):(bI.expandByPoint(xI.min),bI.expandByPoint(xI.max))}bI.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)_I.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(_I));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],o=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)_I.fromBufferAttribute(s,t),o&&(yI.fromBufferAttribute(e,t),_I.add(yI)),i=Math.max(i,n.distanceToSquared(_I))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new hI(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),o=[],a=[];for(let w=0;w<n.count;w++)o[w]=new OD,a[w]=new OD;const l=new OD,c=new OD,u=new OD,h=new uD,d=new uD,p=new uD,A=new OD,f=new OD;function m(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,e),d.fromBufferAttribute(r,t),p.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const s=1/(d.x*p.y-p.x*d.y);isFinite(s)&&(A.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(s),f.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(s),o[e].add(A),o[t].add(A),o[i].add(A),a[e].add(f),a[t].add(f),a[i].add(f))}let g=this.groups;0===g.length&&(g=[{start:0,count:e.count}]);for(let w=0,S=g.length;w<S;++w){const t=g[w],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)m(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const v=new OD,y=new OD,b=new OD,x=new OD;function _(e){b.fromBufferAttribute(i,e),x.copy(b);const t=o[e];v.copy(t),v.sub(b.multiplyScalar(b.dot(t))).normalize(),y.crossVectors(x,t);const n=y.dot(a[e])<0?-1:1;s.setXYZW(e,v.x,v.y,v.z,n)}for(let w=0,S=g.length;w<S;++w){const t=g[w],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)_(e.getX(i+0)),_(e.getX(i+1)),_(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new hI(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new OD,r=new OD,s=new OD,o=new OD,a=new OD,l=new OD,c=new OD,u=new OD;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),A=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,A),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,A),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(A,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)_I.fromBufferAttribute(e,t),_I.normalize(),e.setXYZ(t,_I.x,_I.y,_I.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let o=0,a=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[a++]=n[o++]}return new hI(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wI,n=this.index.array,i=this.attributes;for(const o in i){const r=e(i[o],n);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[o]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const e=s[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const i={};let r=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[a]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const SI=new hL,TI=new uL,MI=new nL,EI=new OD,CI=new OD,RI=new OD,PI=new OD,NI=new OD,DI=new OD,LI=new uD,II=new uD,OI=new uD,kI=new OD,BI=new OD,FI=new OD,UI=new OD,zI=new OD;class qI extends FL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wI,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new rI;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(r&&o){DI.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=o[n],a=r[n];0!==i&&(NI.fromBufferAttribute(a,e),s?DI.addScaledVector(NI,i):DI.addScaledVector(NI.sub(t),i))}t.add(DI)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),MI.copy(n.boundingSphere),MI.applyMatrix4(r),TI.copy(e.ray).recast(e.near),!1===MI.containsPoint(TI.origin)){if(null===TI.intersectSphere(MI,EI))return;if(TI.origin.distanceToSquared(EI)>(e.far-e.near)**2)return}SI.copy(r).invert(),TI.copy(e.ray).applyMatrix4(SI),null!==n.boundingBox&&!1===TI.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,TI)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==o)if(Array.isArray(s))for(let p=0,A=h.length;p<A;p++){const r=h[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=VI(this,a,e,n,l,c,u,o.getX(s),o.getX(s+1),o.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=VI(this,s,e,n,l,c,u,o.getX(r),o.getX(r+1),o.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==a)if(Array.isArray(s))for(let p=0,A=h.length;p<A;p++){const r=h[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=VI(this,o,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=VI(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function VI(e,t,n,i,r,s,o,a,l,c){e.getVertexPosition(a,CI),e.getVertexPosition(l,RI),e.getVertexPosition(c,PI);const u=function(e,t,n,i,r,s,o,a){let l;if(l=1===t.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===t.side,a),null===l)return null;zI.copy(a),zI.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(zI);return c<n.near||c>n.far?null:{distance:c,point:zI.clone(),object:e}}(e,t,n,i,CI,RI,PI,UI);if(u){r&&(LI.fromBufferAttribute(r,a),II.fromBufferAttribute(r,l),OI.fromBufferAttribute(r,c),u.uv=QL.getInterpolation(UI,CI,RI,PI,LI,II,OI,new uD)),s&&(LI.fromBufferAttribute(s,a),II.fromBufferAttribute(s,l),OI.fromBufferAttribute(s,c),u.uv1=QL.getInterpolation(UI,CI,RI,PI,LI,II,OI,new uD)),o&&(kI.fromBufferAttribute(o,a),BI.fromBufferAttribute(o,l),FI.fromBufferAttribute(o,c),u.normal=QL.getInterpolation(UI,CI,RI,PI,kI,BI,FI,new OD),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const e={a:a,b:l,c:c,normal:new OD,materialIndex:0};QL.getNormal(CI,RI,PI,e.normal),u.face=e}return u}class GI extends wI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,i,r,s,p,A,f,m,g){const v=s/f,y=p/m,b=s/2,x=p/2,_=A/2,w=f+1,S=m+1;let T=0,M=0;const E=new OD;for(let o=0;o<S;o++){const s=o*y-x;for(let a=0;a<w;a++){const h=a*v-b;E[e]=h*i,E[t]=s*r,E[n]=_,l.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=A>0?1:-1,c.push(E.x,E.y,E.z),u.push(a/f),u.push(1-o/m),T+=1}}for(let o=0;o<m;o++)for(let e=0;e<f;e++){const t=h+e+w*o,n=h+e+w*(o+1),i=h+(e+1)+w*(o+1),r=h+(e+1)+w*o;a.push(t,n,r),a.push(n,i,r),M+=6}o.addGroup(d,M,g),d+=M,h+=T}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new fI(l,3)),this.setAttribute("normal",new fI(c,3)),this.setAttribute("uv",new fI(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GI(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function jI(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}class HI extends iI{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",this.fragmentShader="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=jI(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class WI extends FL{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new hL,this.projectionMatrix=new hL,this.projectionMatrixInverse=new hL,this.coordinateSystem=KN}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const XI=new OD,YI=new uD,QI=new uD;class KI extends WI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*nD*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*tD*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*nD*Math.atan(Math.tan(.5*tD*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){XI.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(XI.x,XI.y).multiplyScalar(-e/XI.z),XI.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(XI.x,XI.y).multiplyScalar(-e/XI.z)}getViewSize(e,t){return this.getViewBounds(e,YI,QI),t.subVectors(QI,YI)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*tD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/o,i*=s.width/e,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const ZI=-90;class JI extends FL{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new KI(ZI,1,e,t);i.layers=this.layers,this.add(i);const r=new KI(ZI,1,e,t);r.layers=this.layers,this.add(r);const s=new KI(ZI,1,e,t);s.layers=this.layers,this.add(s);const o=new KI(ZI,1,e,t);o.layers=this.layers,this.add(o);const a=new KI(ZI,1,e,t);a.layers=this.layers,this.add(a);const l=new KI(ZI,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,o,a]=t;for(const l of t)this.remove(l);if(e===KN)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==ZN)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const A=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,o),e.setRenderTarget(n,3,i),e.render(t,a),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=A,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class $I extends RD{constructor(e,t,n,i,r,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:CP,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class eO extends DD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new $I(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:FP}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new GI(5,5,5),o=new HI({name:"CubemapFromEquirect",uniforms:jI(n),vertexShader:i,fragmentShader:r,side:1,blending:0});o.uniforms.tEquirect.value=t;const a=new qI(s,o),l=t.minFilter;t.minFilter===zP&&(t.minFilter=FP);return new JI(1,10,this).update(e,a),t.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}class tO extends FL{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new xL,this.environmentIntensity=1,this.environmentRotation=new xL,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class nO{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=YN,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=iD()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return fD("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=iD()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=iD()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const iO=new OD;class rO{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)iO.fromBufferAttribute(this,t),iO.applyMatrix4(e),this.setXYZ(t,iO.x,iO.y,iO.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)iO.fromBufferAttribute(this,t),iO.applyNormalMatrix(e),this.setXYZ(t,iO.x,iO.y,iO.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)iO.fromBufferAttribute(this,t),iO.transformDirection(e),this.setXYZ(t,iO.x,iO.y,iO.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=aD(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=lD(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=lD(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=lD(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=lD(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=lD(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=aD(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=aD(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=aD(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=aD(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=lD(t,this.array),n=lD(n,this.array),i=lD(i,this.array),r=lD(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new hI(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new rO(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class sO extends iI{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new eI(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class oO extends RD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:OP,arguments.length>9&&void 0!==arguments[9]?arguments[9]:OP,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class aO extends hI{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lO=new OD,cO=new OD,uO=new hD;class hO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new OD(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=lO.subVectors(n,t).cross(cO.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(lO),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||uO.getNormalMatrix(e),i=this.coplanarPoint(lO).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const dO=new nL,pO=new OD;class AO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new hO,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new hO,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new hO,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new hO;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:KN;const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=i[9],A=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];if(n[0].setComponents(a-r,h-l,f-d,y-m).normalize(),n[1].setComponents(a+r,h+l,f+d,y+m).normalize(),n[2].setComponents(a+s,h+c,f+p,y+g).normalize(),n[3].setComponents(a-s,h-c,f-p,y-g).normalize(),n[4].setComponents(a-o,h-u,f-A,y-v).normalize(),t===KN)n[5].setComponents(a+o,h+u,f+A,y+v).normalize();else{if(t!==ZN)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,u,A,v).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),dO.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),dO.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(dO)}intersectsSprite(e){return dO.center.set(0,0,0),dO.radius=.7071067811865476,dO.applyMatrix4(e.matrixWorld),this.intersectsSphere(dO)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(pO.x=i.normal.x>0?e.max.x:e.min.x,pO.y=i.normal.y>0?e.max.y:e.min.y,pO.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(pO)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class fO extends iI{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new eI(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}class mO extends iI{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new eI(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class gO extends RD{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=OP,this.minFilter=OP,this.generateMipmaps=!1,this.needsUpdate=!0}}class vO extends RD{constructor(e,t,n,i,r,s,o,a,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:JP;if(c!==JP&&c!==$P)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===JP&&(n=WP),void 0===n&&c===$P&&(n=QP),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:OP,this.minFilter=void 0!==a?a:OP,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class yO extends wI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new OD,h=new OD,d=[],p=[],A=[],f=[];for(let m=0;m<=n;m++){const d=[],g=m/n;let v=0;0===m&&0===s?v=.5/t:m===n&&a===Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(i+a*r)*Math.sin(s+g*o),u.y=e*Math.cos(s+g*o),u.z=e*Math.sin(i+a*r)*Math.sin(s+g*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),A.push(h.x,h.y,h.z),f.push(a+v,1-g),d.push(l++)}c.push(d)}for(let m=0;m<n;m++)for(let e=0;e<t;e++){const t=c[m][e+1],i=c[m][e],r=c[m+1][e],o=c[m+1][e+1];(0!==m||s>0)&&d.push(t,i,o),(m!==n-1||a<Math.PI)&&d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new fI(p,3)),this.setAttribute("normal",new fI(A,3)),this.setAttribute("uv",new fI(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yO(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class bO extends iI{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new eI(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class xO extends HI{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _O extends iI{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new eI(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eI(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xL,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wO extends _O{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new uD(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rD(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new eI(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new eI(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new eI(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class SO extends iI{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new eI(16777215),this.specular=new eI(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eI(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class TO extends iI{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new eI(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eI(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class MO extends iI{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class EO extends iI{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new eI(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eI(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CO extends iI{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class RO extends iI{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class PO extends iI{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new eI(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new uD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NO extends fO{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function DO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="{";!0===e.isNode&&(n+=e.id,e=e.getSelf());for(const{property:i,childNode:r}of LO(e))n+=","+i.slice(0,-4)+":"+r.getCacheKey(t);return n+="}",n}function LO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){for(const n in e){if(!0===n.startsWith("_"))continue;const i=e[n];if(!0===Array.isArray(i))for(let e=0;e<i.length;e++){const r=i[e];r&&(!0===r.isNode||t&&"function"===typeof r.toJSON)&&(yield{property:n,index:e,childNode:r})}else if(i&&!0===i.isNode)yield{property:n,childNode:i};else if("object"===typeof i)for(const e in i){const r=i[e];r&&(!0===r.isNode||t&&"function"===typeof r.toJSON)&&(yield{property:n,index:e,childNode:r})}}}()}function IO(e){if(void 0===e||null===e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function OO(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=e?e.slice(-4):void 0;return 1===n.length&&("vec2"===r?n=[n[0],n[0]]:"vec3"===r?n=[n[0],n[0],n[0]]:"vec4"===r&&(n=[n[0],n[0],n[0],n[0]])),"color"===e?new eI(...n):"vec2"===r?new uD(...n):"vec3"===r?new OD(...n):"vec4"===r?new PD(...n):"mat3"===r?new hD(...n):"mat4"===r?new hL(...n):"bool"===e?n[0]||!1:"float"===e||"int"===e||"uint"===e?n[0]||0:"string"===e?n[0]||"":"ArrayBuffer"===e?BO(n[0]):null}function kO(e){let t="";const n=new Uint8Array(e);for(let i=0;i<n.length;i++)t+=String.fromCharCode(n[i]);return btoa(t)}function BO(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0))).buffer}const FO="vertex",UO="none",zO="frame",qO="render",VO="object",GO=["setup","analyze","generate"],jO=["fragment","vertex","compute"],HO=["x","y","z","w"],WO=new Map;let XO=0;class YO extends JN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.nodeType=e,this.updateType=UO,this.updateBeforeType=UO,this.updateAfterType=UO,this.uuid=cD.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.global=!1,this.isNode=!0,Object.defineProperty(this,"id",{value:XO++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,zO)}onRenderUpdate(e){return this.onUpdate(e,qO)}onObjectUpdate(e){return this.onUpdate(e,VO)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of LO(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e=e||this.version!==this._cacheKeyVersion,!0!==e&&null!==this._cacheKey||(this._cacheKey=DO(this,e),this._cacheKeyVersion=this.version),this._cacheKey}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const i of this.getChildren())t["node"+n++]=i;return null}analyze(e){if(1===e.increaseUsage(this)){const t=e.getNodeProperties(this);for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&!0===n.isNode)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getShared(e);if(this!==n)return n.build(e,t);e.addNode(this),e.addChain(this);let i=null;const r=e.getBuildStage();if("setup"===r){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized){e.stack.nodes.length;t.initialized=!0,t.outputNode=this.setup(e),null!==t.outputNode&&e.stack.nodes.length;for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e)}}else if("analyze"===r)this.analyze(e);else if("generate"===r){if(1===this.generate.length){const n=this.getNodeType(e),r=e.getDataFromNode(this);i=r.snippet,void 0===i&&(i=this.generate(e)||"",r.snippet=i),i=e.format(i,n,t)}else i=this.generate(e,t)||""}return e.removeChain(this),i}getSerializeChildren(){return LO(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:i,index:r,childNode:s}of t)void 0!==r?(void 0===n[i]&&(n[i]=Number.isInteger(r)?[]:{}),n[i][r]=s.toJSON(e.meta).uuid):n[i]=s.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const i=[];for(const r of e.inputNodes[n])i.push(t[r]);this[n]=i}else if("object"===typeof e.inputNodes[n]){const i={};for(const r in e.inputNodes[n]){const s=e.inputNodes[n][r];i[r]=t[s]}this[n]=i}else{const i=e.inputNodes[n];this[n]=t[i]}}}toJSON(e){const{uuid:t,type:n}=this,i=void 0===e||"string"===typeof e;i&&(e={textures:{},images:{},nodes:{}});let r=e.nodes[t];function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(void 0===r&&(r={uuid:t,type:n,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},!0!==i&&(e.nodes[r.uuid]=r),this.serialize(r),delete r.meta),i){const t=s(e.textures),n=s(e.images),i=s(e.nodes);t.length>0&&(r.textures=t),n.length>0&&(r.images=n),i.length>0&&(r.nodes=i)}return r}}function QO(e,t){const n="Node",i=e+n;if("function"!==typeof t)throw new Error("TSL.Node: Node class ".concat(e," is not a class"));if(WO.has(i))console.warn("TSL.Node: Redefinition of node class ".concat(i));else{if(e.slice(-4)!==n)return WO.set(i,t),t.type=i,i;console.warn("TSL.Node: Node class ".concat(i," should not have '").concat(n,"' suffix."))}}YO.type=QO("",YO);class KO extends YO{constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.node.build(e),n=this.indexNode.build(e,"uint");return"".concat(t,"[ ").concat(n," ]")}}KO.type=QO("ArrayElement",KO);class ZO extends YO{constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const i of this.convertTo.split("|"))null!==n&&e.getTypeLength(t)!==e.getTypeLength(i)||(n=i);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,i=this.getNodeType(e),r=n.build(e,i);return e.format(r,i,t)}}ZO.type=QO("Convert",ZO);class JO extends YO{constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const n=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(void 0!==i.propertyName)return e.format(i.propertyName,n,t);if("void"!==n&&"void"!==t&&this.hasDependencies(e)){const r=super.build(e,n),s=e.getVarFromNode(this,null,n),o=e.getPropertyName(s);return e.addLineFlowCode("".concat(o," = ").concat(r)),i.snippet=r,i.propertyName=o,e.format(i.propertyName,n,t)}}return super.build(e,t)}}JO.type=QO("Temp",JO);class $O extends JO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce(((t,n)=>t+e.getTypeLength(n.getNodeType(e))),0))}generate(e,t){const n=this.getNodeType(e),i=this.nodes,r=e.getComponentType(n),s=[];for(const a of i){let t=a.build(e);const n=e.getComponentType(a.getNodeType(e));n!==r&&(t=e.format(t,n,r)),s.push(t)}const o="".concat(e.getType(n),"( ").concat(s.join(", ")," )");return e.format(o,n,t)}}$O.type=QO("Join",$O);const ek=HO.join("");class tk extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(HO.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,i=e.getTypeLength(n.getNodeType(e));let r=null;if(i>1){let s=null;this.getVectorLength()>=i&&(s=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const o=n.build(e,s);r=this.components.length===i&&this.components===ek.slice(0,this.components.length)?e.format(o,s,t):e.format("".concat(o,".").concat(this.components),this.getNodeType(e),t)}else r=n.build(e,t);return r}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}tk.type=QO("Split",tk);class nk extends JO{constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:i}=this,r=this.getNodeType(e),s=e.getTypeFromLength(n.length),o=i.build(e,s),a=t.build(e,r),l=e.getTypeLength(r),c=[];for(let u=0;u<l;u++){const e=HO[u];e===n[0]?(c.push(o),u+=n.length-1):c.push(a+"."+e)}return"".concat(e.getType(r),"( ").concat(c.join(", ")," )")}}nk.type=QO("Set",nk);class ik extends JO{constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,i=this.getNodeType(e),r=n.build(e),s=e.getVarFromNode(this),o=e.getPropertyName(s);e.addLineFlowCode(o+" = "+r);const a=e.getTypeLength(i),l=[];let c=0;for(let u=0;u<a;u++){const e=HO[u];e===t[c]?(l.push("1.0 - "+o+"."+e),c++):l.push(o+"."+e)}return"".concat(e.getType(i),"( ").concat(l.join(", ")," )")}}ik.type=QO("Flip",ik);class rk extends YO{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?IO(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=IO(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=kO(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?OO(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}rk.type=QO("Input",rk);class sk extends rk{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return e.format(this.generateConst(e),n,t)}}sk.type=QO("Const",sk);let ok=null;const ak=new Map;function lk(e,t){if(ak.has(e))console.warn("Redefinition of method chaining ".concat(e));else{if("function"!==typeof t)throw new Error("Node element ".concat(e," is not a function"));ak.set(e,t)}}const ck=e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),uk=e=>ck(e).split("").sort().join(""),hk={setup(e,t){const n=t.shift();return e(Ok(n),...t)},get(e,t,n){if("string"===typeof t&&void 0===e[t]){if(!0!==e.isStackNode&&"assign"===t)return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return ok.assign(n,...t),n};if(ak.has(t)){const i=ak.get(t);return e.isStackNode?function(){return n.add(i(...arguments))}:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i(n,...t)}}if("self"===t)return e;if(t.endsWith("Assign")&&ak.has(t.slice(0,t.length-6))){const i=ak.get(t.slice(0,t.length-6));return e.isStackNode?function(){return n.assign(arguments.length<=0?void 0:arguments[0],i(...arguments))}:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.assign(i(n,...t))}}if(!0===/^[xyzwrgbastpq]{1,4}$/.test(t))return t=ck(t),Ik(new tk(n,t));if(!0===/^set[XYZWRGBASTPQ]{1,4}$/.test(t))return t=uk(t.slice(3).toLowerCase()),n=>Ik(new nk(e,t,n));if(!0===/^flip[XYZWRGBASTPQ]{1,4}$/.test(t))return t=uk(t.slice(4).toLowerCase()),()=>Ik(new ik(Ik(e),t));if("width"===t||"height"===t||"depth"===t)return"width"===t?t="x":"height"===t?t="y":"depth"===t&&(t="z"),Ik(new tk(e,t));if(!0===/^\d+$/.test(t))return Ik(new KO(n,new sk(Number(t),"uint")))}return Reflect.get(e,t,n)},set:(e,t,n,i)=>"string"!==typeof t||void 0!==e[t]||!0!==/^[xyzwrgbastpq]{1,4}$/.test(t)&&"width"!==t&&"height"!==t&&"depth"!==t&&!0!==/^\d+$/.test(t)?Reflect.set(e,t,n,i):(i[t].assign(n),!0)},dk=new WeakMap,pk=new WeakMap,Ak=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(const n in e)e[n]=Ik(e[n],t);return e},fk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e.length;for(let i=0;i<n;i++)e[i]=Ik(e[i],t);return e},mk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=e=>Ik(null!==i?Object.assign(e,i):e);return null===t?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r(new e(...kk(n)))}:null!==n?(n=Ik(n),function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r(new e(t,...kk(s),n))}):function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r(new e(t,...kk(i)))}},gk=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ik(new e(...kk(n)))};class vk extends YO{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}call(e){const{shaderNode:t,inputNodes:n}=this,i=e.getNodeProperties(t);if(i.onceOutput)return i.onceOutput;let r=null;if(t.layout){let i=pk.get(e.constructor);void 0===i&&(i=new WeakMap,pk.set(e.constructor,i));let s=i.get(t);void 0===s&&(s=Ik(e.buildFunctionNode(t)),i.set(t,s)),null!==e.currentFunctionNode&&e.currentFunctionNode.includes.push(s),r=Ik(s.call(n))}else{const i=t.jsFunc,s=null!==n?i(n,e):i(e);r=Ik(s)}return t.once&&(i.onceOutput=r),r}getOutputNode(e){const t=e.getNodeProperties(this);return null===t.outputNode&&(t.outputNode=this.setupOutput(e)),t.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){return this.getOutputNode(e).build(e,t)}}class yk extends YO{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Ok(e),Ik(new vk(this,e))}setup(){return this.call()}}const bk=[!1,!0],xk=[0,1,2,3],_k=[-1,-2],wk=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],Sk=new Map;for(const n of bk)Sk.set(n,new sk(n));const Tk=new Map;for(const n of xk)Tk.set(n,new sk(n,"uint"));const Mk=new Map([...Tk].map((e=>new sk(e.value,"int"))));for(const n of _k)Mk.set(n,new sk(n,"int"));const Ek=new Map([...Mk].map((e=>new sk(e.value))));for(const n of wk)Ek.set(n,new sk(n));for(const n of wk)Ek.set(-n,new sk(-n));const Ck={bool:Sk,uint:Tk,ints:Mk,float:Ek},Rk=new Map([...Sk,...Ek]),Pk=(e,t)=>Rk.has(e)?Rk.get(e):!0===e.isNode?e:new sk(e,t),Nk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if((0===i.length||!["bool","float","int","uint"].includes(e)&&i.every((e=>"object"!==typeof e)))&&(i=[OO(e,...i)]),1===i.length&&null!==t&&t.has(i[0]))return Ik(t.get(i[0]));if(1===i.length){const t=Pk(i[0],e);return(e=>{try{return e.getNodeType()}catch(t){return}})(t)===e?Ik(t):Ik(new ZO(t,e))}const s=i.map((e=>Pk(e)));return Ik(new $O(s,e))}},Dk=e=>"object"===typeof e&&null!==e?e.value:e;function Lk(e,t){return new Proxy(new yk(e,t),hk)}const Ik=function(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=IO(e);if("node"===n){let t=dk.get(e);return void 0===t&&(t=new Proxy(e,hk),dk.set(e,t),dk.set(t,t)),t}return null===t&&("float"===n||"boolean"===n)||n&&"shader"!==n&&"string"!==n?Ik(Pk(e,t)):"shader"===n?Uk(e):e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},Ok=function(e){return new Ak(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},kk=function(e){return new fk(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},Bk=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new mk(...t)},Fk=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new gk(...t)},Uk=(e,t)=>{const n=new Lk(e,t),i=function(){let e;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return Ok(i),e=i[0]&&i[0].isNode?[...i]:i[0],n.call(e)};return i.shaderNode=n,i.setLayout=e=>(n.setLayout(e),i),i.once=()=>(n.once=!0,i),i};lk("toGlobal",(e=>(e.global=!0,e)));const zk=e=>{ok=e},qk=()=>ok,Vk=function(){return ok.If(...arguments)};lk("append",(function(e){return ok&&ok.add(e),e}));const Gk=new Nk("color"),jk=new Nk("float",Ck.float),Hk=new Nk("int",Ck.ints),Wk=new Nk("uint",Ck.uint),Xk=new Nk("bool",Ck.bool),Yk=new Nk("vec2"),Qk=new Nk("ivec2"),Kk=new Nk("uvec2"),Zk=new Nk("bvec2"),Jk=new Nk("vec3"),$k=new Nk("ivec3"),eB=new Nk("uvec3"),tB=new Nk("bvec3"),nB=new Nk("vec4"),iB=new Nk("ivec4"),rB=new Nk("uvec4"),sB=new Nk("bvec4"),oB=new Nk("mat2"),aB=new Nk("mat3"),lB=new Nk("mat4");lk("toColor",Gk),lk("toFloat",jk),lk("toInt",Hk),lk("toUint",Wk),lk("toBool",Xk),lk("toVec2",Yk),lk("toIVec2",Qk),lk("toUVec2",Kk),lk("toBVec2",Zk),lk("toVec3",Jk),lk("toIVec3",$k),lk("toUVec3",eB),lk("toBVec3",tB),lk("toVec4",nB),lk("toIVec4",iB),lk("toUVec4",rB),lk("toBVec4",sB),lk("toMat2",oB),lk("toMat3",aB),lk("toMat4",lB);lk("element",Bk(KO)),lk("convert",((e,t)=>Ik(new ZO(Ik(e),t))));class cB extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super("string"),this.name=e,this.version=0,this.shared=t,this.isUniformGroup=!0}set needsUpdate(e){!0===e&&this.version++}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}cB.type=QO("UniformGroup",cB);const uB=e=>new cB(e),hB=e=>new cB(e,!0),dB=hB("frame"),pB=hB("render"),AB=uB("object");class fB extends rk{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isUniformNode=!0,this.name="",this.groupNode=AB}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate((t=>{const i=e(t,n);void 0!==i&&(this.value=i)}),t)}generate(e,t){const n=this.getNodeType(e),i=this.getUniformHash(e);let r=e.getNodeFromHash(i);void 0===r&&(e.setHashNode(this,i),r=this);const s=r.getInputType(e),o=e.getUniformFromNode(r,s,e.shaderStage,this.name||e.context.label),a=e.getPropertyName(o);return void 0!==e.context.label&&delete e.context.label,e.format(a,n,t)}}fB.type=QO("Uniform",fB);const mB=(e,t)=>{const n=(e=>void 0!==e&&null!==e?e.nodeType||e.convertTo||("string"===typeof e?e:null):null)(t||e),i=e&&!0===e.isNode?e.node&&e.node.value||e.value:e;return Ik(new fB(i,n))};class gB extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.name=t,this.varying=n,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}gB.type=QO("Property",gB);const vB=(e,t)=>Ik(new gB(e,t)),yB=(e,t)=>Ik(new gB(e,t,!0)),bB=Fk(gB,"vec4","DiffuseColor"),xB=Fk(gB,"vec3","EmissiveColor"),_B=Fk(gB,"float","Roughness"),wB=Fk(gB,"float","Metalness"),SB=Fk(gB,"float","Clearcoat"),TB=Fk(gB,"float","ClearcoatRoughness"),MB=Fk(gB,"vec3","Sheen"),EB=Fk(gB,"float","SheenRoughness"),CB=Fk(gB,"float","Iridescence"),RB=Fk(gB,"float","IridescenceIOR"),PB=Fk(gB,"float","IridescenceThickness"),NB=Fk(gB,"float","AlphaT"),DB=Fk(gB,"float","Anisotropy"),LB=Fk(gB,"vec3","AnisotropyT"),IB=Fk(gB,"vec3","AnisotropyB"),OB=Fk(gB,"color","SpecularColor"),kB=Fk(gB,"float","SpecularF90"),BB=Fk(gB,"float","Shininess"),FB=Fk(gB,"vec4","Output"),UB=Fk(gB,"float","dashSize"),zB=Fk(gB,"float","gapSize"),qB=Fk(gB,"float","IOR"),VB=Fk(gB,"float","Transmission"),GB=Fk(gB,"float","Thickness"),jB=Fk(gB,"float","AttenuationDistance"),HB=Fk(gB,"color","AttenuationColor"),WB=Fk(gB,"float","Dispersion");class XB extends JO{constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return HO.join("").slice(0,n)!==t.components}return!1}generate(e,t){const{targetNode:n,sourceNode:i}=this,r=this.needsSplitAssign(e),s=n.getNodeType(e),o=n.context({assign:!0}).build(e),a=i.build(e,s),l=i.getNodeType(e),c=e.getDataFromNode(this);let u;if(!0===c.initialized)"void"!==t&&(u=o);else if(r){const i=e.getVarFromNode(this,null,s),r=e.getPropertyName(i);e.addLineFlowCode("".concat(r," = ").concat(a));const l=n.node.context({assign:!0}).build(e);for(let t=0;t<n.components.length;t++){const i=n.components[t];e.addLineFlowCode("".concat(l,".").concat(i," = ").concat(r,"[ ").concat(t," ]"))}"void"!==t&&(u=o)}else u="".concat(o," = ").concat(a),"void"!==t&&"void"!==l||(e.addLineFlowCode(u),"void"!==t&&(u=o));return c.initialized=!0,e.format(u,s,t)}}XB.type=QO("Assign",XB);lk("assign",Bk(XB));class YB extends JO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,i=n.getInputs(e),r=this.parameters;if(Array.isArray(r))for(let o=0;o<r.length;o++){const n=i[o],s=r[o];t.push(s.build(e,n.type))}else for(const o of i){const n=r[o.name];if(void 0===n)throw new Error("FunctionCallNode: Input '".concat(o.name,"' not found in FunctionNode."));t.push(n.build(e,o.type))}const s=n.build(e,"property");return"".concat(s,"( ").concat(t.join(", ")," )")}}YB.type=QO("FunctionCall",YB);lk("call",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n=n.length>1||n[0]&&!0===n[0].isNode?kk(n):Ok(n[0]),Ik(new YB(Ik(e),n))}));class QB extends JO{constructor(e,t,n){if(super(),(arguments.length<=3?0:arguments.length-3)>0){var i;let r=new QB(e,t,n);for(let t=0;t<(arguments.length<=3?0:arguments.length-3)-1;t++)r=new QB(e,r,t+3<3||arguments.length<=t+3?void 0:arguments[t+3]);t=r,n=(i=(arguments.length<=3?0:arguments.length-3)-1+3)<3||arguments.length<=i?void 0:arguments[i]}this.op=e,this.aNode=t,this.bNode=n}getNodeType(e,t){const n=this.op,i=this.aNode,r=this.bNode,s=i.getNodeType(e),o="undefined"!==typeof r?r.getNodeType(e):null;if("void"===s||"void"===o)return"void";if("%"===n)return s;if("~"===n||"&"===n||"|"===n||"^"===n||">>"===n||"<<"===n)return e.getIntegerType(s);if("!"===n||"=="===n||"&&"===n||"||"===n||"^^"===n)return"bool";if("<"===n||">"===n||"<="===n||">="===n){const n=t?e.getTypeLength(t):Math.max(e.getTypeLength(s),e.getTypeLength(o));return n>1?"bvec".concat(n):"bool"}return"float"===s&&e.isMatrix(o)?o:e.isMatrix(s)&&e.isVector(o)?e.getVectorFromMatrix(s):e.isVector(s)&&e.isMatrix(o)?e.getVectorFromMatrix(o):e.getTypeLength(o)>e.getTypeLength(s)?o:s}generate(e,t){const n=this.op,i=this.aNode,r=this.bNode,s=this.getNodeType(e,t);let o=null,a=null;"void"!==s?(o=i.getNodeType(e),a="undefined"!==typeof r?r.getNodeType(e):null,"<"===n||">"===n||"<="===n||">="===n||"=="===n?e.isVector(o)?a=o:o!==a&&(o=a="float"):">>"===n||"<<"===n?(o=s,a=e.changeComponentType(a,"uint")):e.isMatrix(o)&&e.isVector(a)?a=e.getVectorFromMatrix(o):o=e.isVector(o)&&e.isMatrix(a)?e.getVectorFromMatrix(a):a=s):o=a=s;const l=i.build(e,o),c="undefined"!==typeof r?r.build(e,a):null,u=e.getTypeLength(t),h=e.getFunctionOperator(n);return"void"!==t?"<"===n&&u>1?e.useComparisonMethod?e.format("".concat(e.getMethod("lessThan",t),"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," < ").concat(c," )"),s,t):"<="===n&&u>1?e.useComparisonMethod?e.format("".concat(e.getMethod("lessThanEqual",t),"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," <= ").concat(c," )"),s,t):">"===n&&u>1?e.useComparisonMethod?e.format("".concat(e.getMethod("greaterThan",t),"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," > ").concat(c," )"),s,t):">="===n&&u>1?e.useComparisonMethod?e.format("".concat(e.getMethod("greaterThanEqual",t),"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," >= ").concat(c," )"),s,t):"!"===n||"~"===n?e.format("(".concat(n).concat(l,")"),o,t):h?e.format("".concat(h,"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," ").concat(n," ").concat(c," )"),s,t):"void"!==o?h?e.format("".concat(h,"( ").concat(l,", ").concat(c," )"),s,t):e.format("".concat(l," ").concat(n," ").concat(c),s,t):void 0}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}QB.type=QO("Operator",QB);const KB=Bk(QB,"+"),ZB=Bk(QB,"-"),JB=Bk(QB,"*"),$B=Bk(QB,"/"),eF=Bk(QB,"%"),tF=Bk(QB,"=="),nF=Bk(QB,"!="),iF=Bk(QB,"<"),rF=Bk(QB,">"),sF=Bk(QB,"<="),oF=Bk(QB,">="),aF=Bk(QB,"&&"),lF=Bk(QB,"||"),cF=Bk(QB,"!"),uF=Bk(QB,"^^"),hF=Bk(QB,"&"),dF=Bk(QB,"~"),pF=Bk(QB,"|"),AF=Bk(QB,"^"),fF=Bk(QB,"<<"),mF=Bk(QB,">>");lk("add",KB),lk("sub",ZB),lk("mul",JB),lk("div",$B),lk("modInt",eF),lk("equal",tF),lk("notEqual",nF),lk("lessThan",iF),lk("greaterThan",rF),lk("lessThanEqual",sF),lk("greaterThanEqual",oF),lk("and",aF),lk("or",lF),lk("not",cF),lk("xor",uF),lk("bitAnd",hF),lk("bitNot",dF),lk("bitOr",pF),lk("bitXor",AF),lk("shiftLeft",fF),lk("shiftRight",mF);lk("remainder",(function(){return console.warn("TSL.OperatorNode: .remainder() has been renamed to .modInt()."),eF(...arguments)}));class gF extends JO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.method=e,this.aNode=t,this.bNode=n,this.cNode=i}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,i=this.cNode?this.cNode.getNodeType(e):null,r=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(i)?0:e.getTypeLength(i);return r>s&&r>o?t:s>o?n:o>r?i:t}getNodeType(e){const t=this.method;return t===gF.LENGTH||t===gF.DISTANCE||t===gF.DOT?"float":t===gF.CROSS?"vec3":t===gF.ALL?"bool":t===gF.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===gF.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const n=this.method,i=this.getNodeType(e),r=this.getInputType(e),s=this.aNode,o=this.bNode,a=this.cNode,l=!0===e.renderer.isWebGLRenderer;if(n===gF.TRANSFORM_DIRECTION){let n=s,i=o;e.isMatrix(n.getNodeType(e))?i=nB(Jk(i),0):n=nB(Jk(n),0);const r=JB(n,i).xyz;return LF(r).build(e,t)}if(n===gF.NEGATE)return e.format("( - "+s.build(e,r)+" )",i,t);if(n===gF.ONE_MINUS)return ZB(1,s).build(e,t);if(n===gF.RECIPROCAL)return $B(1,s).build(e,t);if(n===gF.DIFFERENCE)return qF(ZB(s,o)).build(e,t);{const c=[];return n===gF.CROSS||n===gF.MOD?c.push(s.build(e,i),o.build(e,i)):l&&n===gF.STEP?c.push(s.build(e,1===e.getTypeLength(s.getNodeType(e))?"float":r),o.build(e,r)):l&&(n===gF.MIN||n===gF.MAX)||n===gF.MOD?c.push(s.build(e,r),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":r)):n===gF.REFRACT?c.push(s.build(e,r),o.build(e,r),a.build(e,"float")):n===gF.MIX?c.push(s.build(e,r),o.build(e,r),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":r)):(c.push(s.build(e,r)),null!==o&&c.push(o.build(e,r)),null!==a&&c.push(a.build(e,r))),e.format("".concat(e.getMethod(n,i),"( ").concat(c.join(", ")," )"),i,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}gF.ALL="all",gF.ANY="any",gF.EQUALS="equals",gF.RADIANS="radians",gF.DEGREES="degrees",gF.EXP="exp",gF.EXP2="exp2",gF.LOG="log",gF.LOG2="log2",gF.SQRT="sqrt",gF.INVERSE_SQRT="inversesqrt",gF.FLOOR="floor",gF.CEIL="ceil",gF.NORMALIZE="normalize",gF.FRACT="fract",gF.SIN="sin",gF.COS="cos",gF.TAN="tan",gF.ASIN="asin",gF.ACOS="acos",gF.ATAN="atan",gF.ABS="abs",gF.SIGN="sign",gF.LENGTH="length",gF.NEGATE="negate",gF.ONE_MINUS="oneMinus",gF.DFDX="dFdx",gF.DFDY="dFdy",gF.ROUND="round",gF.RECIPROCAL="reciprocal",gF.TRUNC="trunc",gF.FWIDTH="fwidth",gF.BITCAST="bitcast",gF.TRANSPOSE="transpose",gF.ATAN2="atan2",gF.MIN="min",gF.MAX="max",gF.MOD="mod",gF.STEP="step",gF.REFLECT="reflect",gF.DISTANCE="distance",gF.DIFFERENCE="difference",gF.DOT="dot",gF.CROSS="cross",gF.POW="pow",gF.TRANSFORM_DIRECTION="transformDirection",gF.MIX="mix",gF.CLAMP="clamp",gF.REFRACT="refract",gF.SMOOTHSTEP="smoothstep",gF.FACEFORWARD="faceforward",gF.type=QO("Math",gF);const vF=jk(1e-6),yF=jk(Math.PI),bF=(Math.PI,Bk(gF,gF.ALL)),xF=Bk(gF,gF.ANY),_F=Bk(gF,gF.EQUALS),wF=Bk(gF,gF.RADIANS),SF=Bk(gF,gF.DEGREES),TF=Bk(gF,gF.EXP),MF=Bk(gF,gF.EXP2),EF=Bk(gF,gF.LOG),CF=Bk(gF,gF.LOG2),RF=Bk(gF,gF.SQRT),PF=Bk(gF,gF.INVERSE_SQRT),NF=Bk(gF,gF.FLOOR),DF=Bk(gF,gF.CEIL),LF=Bk(gF,gF.NORMALIZE),IF=Bk(gF,gF.FRACT),OF=Bk(gF,gF.SIN),kF=Bk(gF,gF.COS),BF=Bk(gF,gF.TAN),FF=Bk(gF,gF.ASIN),UF=Bk(gF,gF.ACOS),zF=Bk(gF,gF.ATAN),qF=Bk(gF,gF.ABS),VF=Bk(gF,gF.SIGN),GF=Bk(gF,gF.LENGTH),jF=Bk(gF,gF.NEGATE),HF=Bk(gF,gF.ONE_MINUS),WF=Bk(gF,gF.DFDX),XF=Bk(gF,gF.DFDY),YF=Bk(gF,gF.ROUND),QF=Bk(gF,gF.RECIPROCAL),KF=Bk(gF,gF.TRUNC),ZF=Bk(gF,gF.FWIDTH),JF=(gF.BITCAST,Bk(gF,gF.TRANSPOSE)),$F=Bk(gF,gF.ATAN2),eU=Bk(gF,gF.MIN),tU=Bk(gF,gF.MAX),nU=Bk(gF,gF.MOD),iU=Bk(gF,gF.STEP),rU=Bk(gF,gF.REFLECT),sU=Bk(gF,gF.DISTANCE),oU=Bk(gF,gF.DIFFERENCE),aU=Bk(gF,gF.DOT),lU=Bk(gF,gF.CROSS),cU=Bk(gF,gF.POW),uU=Bk(gF,gF.POW,2),hU=Bk(gF,gF.POW,3),dU=Bk(gF,gF.POW,4),pU=Bk(gF,gF.TRANSFORM_DIRECTION),AU=Bk(gF,gF.MIX),fU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ik(new gF(gF.CLAMP,Ik(e),Ik(t),Ik(n)))},mU=Bk(gF,gF.REFRACT),gU=Bk(gF,gF.SMOOTHSTEP),vU=Bk(gF,gF.FACEFORWARD),yU=Uk((e=>{let[t]=e;const n=aU(t.xy,Yk(12.9898,78.233)),i=nU(n,yF);return IF(OF(i).mul(43758.5453))}));lk("all",bF),lk("any",xF),lk("equals",_F),lk("radians",wF),lk("degrees",SF),lk("exp",TF),lk("exp2",MF),lk("log",EF),lk("log2",CF),lk("sqrt",RF),lk("inverseSqrt",PF),lk("floor",NF),lk("ceil",DF),lk("normalize",LF),lk("fract",IF),lk("sin",OF),lk("cos",kF),lk("tan",BF),lk("asin",FF),lk("acos",UF),lk("atan",zF),lk("abs",qF),lk("sign",VF),lk("length",GF),lk("lengthSq",(e=>aU(e,e))),lk("negate",jF),lk("oneMinus",HF),lk("dFdx",WF),lk("dFdy",XF),lk("round",YF),lk("reciprocal",QF),lk("trunc",KF),lk("fwidth",ZF),lk("atan2",$F),lk("min",eU),lk("max",tU),lk("mod",nU),lk("step",iU),lk("reflect",rU),lk("distance",sU),lk("dot",aU),lk("cross",lU),lk("pow",cU),lk("pow2",uU),lk("pow3",hU),lk("pow4",dU),lk("transformDirection",pU),lk("mix",((e,t,n)=>AU(t,n,e))),lk("clamp",fU),lk("refract",mU),lk("smoothstep",((e,t,n)=>gU(t,n,e))),lk("faceForward",vU),lk("difference",oU),lk("saturate",(e=>fU(e))),lk("cbrt",(e=>JB(VF(e),cU(qF(e),1/3)))),lk("transpose",JF),lk("rand",yU);class bU extends YO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const t=this.ifNode.getNodeType(e);if(null!==this.elseNode){const n=this.elseNode.getNodeType(e);if(e.getTypeLength(n)>e.getTypeLength(t))return n}return t}setup(e){const t=e.getNodeProperties(this);t.condNode=this.condNode.cache(),t.ifNode=this.ifNode.cache(),t.elseNode=this.elseNode?this.elseNode.cache():null}generate(e,t){const n=this.getNodeType(e),i=e.getDataFromNode(this);if(void 0!==i.nodeProperty)return i.nodeProperty;const{condNode:r,ifNode:s,elseNode:o}=e.getNodeProperties(this),a="void"!==t,l=a?vB(n).build(e):"";i.nodeProperty=l;const c=r.build(e,"bool");e.addFlowCode("\n".concat(e.tab,"if ( ").concat(c," ) {\n\n")).addFlowTab();let u=s.build(e,n);if(u&&(u=a?l+" = "+u+";":"return "+u+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+u+"\n\n"+e.tab+"}"),null!==o){e.addFlowCode(" else {\n\n").addFlowTab();let t=o.build(e,n);t&&(t=a?l+" = "+t+";":"return "+t+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(l,n,t)}}bU.type=QO("Conditional",bU);const xU=Bk(bU);lk("select",xU);lk("cond",(function(){return console.warn("TSL.ConditionalNode: cond() has been renamed to select()."),xU(...arguments)}));class _U extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const t=e.getContext();e.setContext(M(M({},e.context),this.value));const n=this.node.build(e);return e.setContext(t),n}generate(e,t){const n=e.getContext();e.setContext(M(M({},e.context),this.value));const i=this.node.build(e,t);return e.setContext(n),i}}_U.type=QO("Context",_U);const wU=Bk(_U);lk("context",wU),lk("label",((e,t)=>wU(e,{label:t})));class SU extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n}=this,i=e.getVarFromNode(this,n,e.getVectorType(this.getNodeType(e))),r=e.getPropertyName(i),s=t.build(e,i.type);return e.addLineFlowCode("".concat(r," = ").concat(s)),r}}SU.type=QO("Var",SU);const TU=Bk(SU);lk("temp",TU),lk("toVar",(function(){return TU(...arguments).append()}));class MU extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.node=e,this.name=t,this.isVaryingNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(void 0===n){const i=this.name,r=this.getNodeType(e);t.varying=n=e.getVaryingFromNode(this,i,r),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation="fragment"===e.shaderStage),n}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const t=e.getNodeProperties(this),n=this.setupVarying(e);if(void 0===t.propertyName){const i=this.getNodeType(e),r=e.getPropertyName(n,FO);e.flowNodeFromShaderStage(FO,this.node,i,r),t.propertyName=r}return e.getPropertyName(n)}}MU.type=QO("Varying",MU);const EU=Bk(MU);lk("varying",EU);const CU=e=>{let t=null;return e===LN?t="Linear":e===DN&&(t="sRGB"),t},RU=(e,t)=>CU(e)+"To"+CU(t);class PU extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("vec4"),this.colorNode=e,this.target=t,this.source=n}setup(e){const{renderer:t,context:n}=e,i=this.source||n.outputColorSpace||t.outputColorSpace,r=this.target||n.outputColorSpace||t.outputColorSpace,s=this.colorNode;if(i===r)return s;const o=RU(i,r);let a=null;const l=t.nodes.library.getColorSpaceFunction(o);return null!==l?a=nB(l(s.rgb),s.a):(console.error("ColorSpaceNode: Unsupported Color Space configuration.",o),a=s),a}}PU.type=QO("ColorSpace",PU);const NU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ik(new PU(Ik(e),LN,t))};lk("toOutputColorSpace",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ik(new PU(Ik(e),t,LN))})),lk("toWorkingColorSpace",NU);let DU=class extends KO{constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,n,i)}};class LU extends YO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.property=e,this.uniformType=t,this.object=n,this.count=i,this.properties=e.split("."),this.reference=n,this.node=null,this.updateType=VO}element(e){return Ik(new DU(this,Ik(e)))}setNodeType(e){this.node=mB(null,e).getSelf()}getNodeType(e){return null===this.node&&this.updateValue(),this.node.getNodeType(e)}getValueFromReference(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference;const{properties:t}=this;let n=e[t[0]];for(let i=1;i<t.length;i++)n=n[t[i]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}LU.type=QO("ReferenceBase",LU);class IU extends LU{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.renderer=n}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}IU.type=QO("RendererReference",IU);const OU=(e,t,n)=>Ik(new IU(e,t,n));class kU extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:BU,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}getCacheKey(){let e=super.getCacheKey();return e="{toneMapping:"+this.toneMapping+",nodes:"+e+"}",e}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(0===n)return t;let i=null;const r=e.renderer.nodes.library.getToneMappingFunction(n);return null!==r?i=nB(r(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),i=t),i}}kU.type=QO("ToneMapping",kU);const BU=OU("toneMappingExposure","float");lk("toneMapping",((e,t,n)=>((e,t,n)=>Ik(new kU(e,Ik(t),Ik(n))))(t,n,e)));class FU extends rk{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=i,this.usage=YN,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),n=this.value,i=e.getTypeLength(t),r=this.bufferStride||i,s=this.bufferOffset,o=!0===n.isInterleavedBuffer?n:new nO(n,r),a=new rO(o,i,s);o.setUsage(this.usage),this.attribute=a,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),i=e.getPropertyName(n);let r=null;if("vertex"===e.shaderStage||"compute"===e.shaderStage)this.name=i,r=i;else{r=EU(this).build(e,t)}return r}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}FU.type=QO("BufferAttribute",FU);const UU=(e,t,n,i)=>Ik(new FU(e,t,n,i)),zU=(e,t,n,i)=>UU(e,t,n,i).setInstanced(!0),qU=(e,t,n,i)=>((e,t,n,i)=>UU(e,t,n,i).setUsage(QN))(e,t,n,i).setInstanced(!0);lk("toAttribute",(e=>UU(e.value)));class VU extends YO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[64];super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.updateBeforeType=VO,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let i=1;i<t.length;i++)n*=t[i];this.dispatchCount=Math.ceil(e/n)}onInit(){}updateBefore(e){let{renderer:t}=e;t.compute(this)}generate(e){const{shaderStage:t}=e;if("compute"===t){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t)}}}VU.type=QO("Compute",VU);lk("compute",((e,t,n)=>Ik(new VU(Ik(e),t,n))));class GU extends YO{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){return this.node.getNodeType(e)}build(e){const t=e.getCache(),n=e.getCacheFromNode(this,parent);e.setCache(n);for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const o=this.node.build(e,...r);return e.setCache(t),o}}GU.type=QO("Cache",GU);const jU=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ik(new GU(Ik(e),...n))};lk("cache",jU);class HU extends YO{constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t),this.outputNode.build(e)}}HU.type=QO("Bypass",HU);lk("bypass",Bk(HU));class WU extends YO{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jk(0),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jk(1);super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=i,this.outHighNode=r,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:i,outHighNode:r,doClamp:s}=this;let o=e.sub(t).div(n.sub(t));return!0===s&&(o=o.clamp()),o.mul(r.sub(i)).add(i)}}WU.type=QO("Remap",WU);const XU=Bk(WU,null,null,{doClamp:!1}),YU=Bk(WU);lk("remap",XU),lk("remapClamp",YU);class QU extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"void"),this.snippet=e}generate(e,t){const n=this.getNodeType(e),i=this.snippet;if("void"!==n)return e.format("( ".concat(i," )"),n,t);e.addLineFlowCode(i)}}QU.type=QO("Expression",QU);const KU=Bk(QU);lk("discard",(e=>(e?xU(e,KU("discard")):KU("discard")).append()));class ZU extends JO{constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutput=!0}setup(e){let{context:t}=e,n=this.colorNode||t.color;const i=(null!==this.toneMapping?this.toneMapping:t.toneMapping)||0,r=(null!==this.outputColorSpace?this.outputColorSpace:t.outputColorSpace)||LN;return 0!==i&&(n=n.toneMapping(i)),r===DN&&(n=n.toOutputColorSpace(r)),n}}ZU.type=QO("RenderOutput",ZU);const JU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Ik(new ZU(Ik(e),t,n))};lk("renderOutput",JU);class $U extends YO{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const i=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(i)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const i=e.geometry.getAttribute(t),r=e.getTypeFromAttribute(i),s=e.getAttribute(t,r);if("vertex"===e.shaderStage)return e.format(s.name,r,n);return EU(this).build(e,n)}return console.warn('AttributeNode: Vertex attribute "'.concat(t,'" not found on geometry.')),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}$U.type=QO("Attribute",$U);const ez=(e,t)=>Ik(new $U(e,t)),tz=e=>ez("uv"+(e>0?e:""),"vec2");class nz extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),i=this.levelNode.build(e,"int");return e.format("".concat(e.getMethod("textureDimensions"),"( ").concat(n,", ").concat(i," )"),this.getNodeType(e),t)}}nz.type=QO("TextureSize",nz);const iz=Bk(nz);class rz extends fB{constructor(e){super(0),this._textureNode=e,this.updateType=zO}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&void 0!==n.width){const{width:e,height:t}=n;this.value=Math.log2(Math.max(e,t))}}}rz.type=QO("MaxMipLevel",rz);const sz=Bk(rz);class oz extends fB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=i,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=UO,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":this.value.type===WP?"uvec4":this.value.type===HP?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return tz(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=mB(this.value.matrix)),this._matrixUniform.mul(Jk(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?zO:UO,this}setupUV(e,t){const n=this.value;return!e.isFlipY()||!0!==n.isRenderTargetTexture&&!0!==n.isFramebufferTexture&&!0!==n.isDepthTexture||(t=t.setY(t.y.oneMinus())),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;let n=this.uvNode;null!==n&&!0!==e.context.forceUVContext||!e.context.getUV||(n=e.context.getUV(this)),n||(n=this.getDefaultUV()),!0===this.updateMatrix&&(n=this.getTransformedUV(n)),n=this.setupUV(e,n);let i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=n,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateSnippet(e,t,n,i,r,s,o,a){const l=this.value;let c;return c=i?e.generateTextureLevel(l,t,n,i,s):r?e.generateTextureBias(l,t,n,r,s):a?e.generateTextureGrad(l,t,n,a,s):o?e.generateTextureCompare(l,t,n,o,s):!1===this.sampler?e.generateTextureLoad(l,t,n,s):e.generateTexture(l,t,n,s),c}generate(e,t){const n=e.getNodeProperties(this),i=this.value;if(!i||!0!==i.isTexture)throw new Error("TextureNode: Need a three.js texture.");const r=super.generate(e,"property");if("sampler"===t)return r+"_sampler";if(e.isReference(t))return r;{const s=e.getDataFromNode(this);let o=s.propertyName;if(void 0===o){const{uvNode:t,levelNode:i,biasNode:a,compareNode:l,depthNode:c,gradNode:u}=n,h=this.generateUV(e,t),d=i?i.build(e,"float"):null,p=a?a.build(e,"float"):null,A=c?c.build(e,"int"):null,f=l?l.build(e,"float"):null,m=u?[u[0].build(e,"vec2"),u[1].build(e,"vec2")]:null,g=e.getVarFromNode(this);o=e.getPropertyName(g);const v=this.generateSnippet(e,r,h,d,p,A,f,m);e.addLineFlowCode("".concat(o," = ").concat(v)),s.snippet=v,s.propertyName=o}let a=o;const l=this.getNodeType(e);return e.needsToWorkingColorSpace(i)&&(a=NU(KU(a,l),i.colorSpace).setup(e).build(e,l)),e.format(a,l,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){const t=this.clone();return t.uvNode=Ik(e),t.referenceNode=this.getSelf(),Ik(t)}blur(e){const t=this.clone();return t.biasNode=Ik(e).mul(sz(t)),t.referenceNode=this.getSelf(),Ik(t)}level(e){const t=this.clone();return t.levelNode=Ik(e),t.referenceNode=this.getSelf(),Ik(t)}size(e){return iz(this,e)}bias(e){const t=this.clone();return t.biasNode=Ik(e),t.referenceNode=this.getSelf(),Ik(t)}compare(e){const t=this.clone();return t.compareNode=Ik(e),t.referenceNode=this.getSelf(),Ik(t)}grad(e,t){const n=this.clone();return n.gradNode=[Ik(e),Ik(t)],n.referenceNode=this.getSelf(),Ik(n)}depth(e){const t=this.clone();return t.depthNode=Ik(e),t.referenceNode=this.getSelf(),Ik(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e}}oz.type=QO("Texture",oz);const az=Bk(oz),lz=function(){return az(...arguments).setSampler(!1)},cz=hB("camera").onRenderUpdate((()=>{cz.needsUpdate=!0})),uz=mB("float").label("cameraNear").setGroup(cz).onRenderUpdate((e=>{let{camera:t}=e;return t.near})),hz=mB("float").label("cameraFar").setGroup(cz).onRenderUpdate((e=>{let{camera:t}=e;return t.far})),dz=mB("float").label("cameraLogDepth").setGroup(cz).onRenderUpdate((e=>{let{camera:t}=e;return 2/(Math.log(t.far+1)/Math.LN2)})),pz=mB("mat4").label("cameraProjectionMatrix").setGroup(cz).onRenderUpdate((e=>{let{camera:t}=e;return t.projectionMatrix})),Az=mB("mat4").label("cameraViewMatrix").setGroup(cz).onRenderUpdate((e=>{let{camera:t}=e;return t.matrixWorldInverse})),fz=mB(new OD).label("cameraPosition").setGroup(cz).onRenderUpdate(((e,t)=>{let{camera:n}=e;return t.value.setFromMatrixPosition(n.matrixWorld)}));class mz extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mz.VIEW_MATRIX,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.object3d=t,this.updateType=VO,this._uniformNode=new fB(null)}getNodeType(){const e=this.scope;return e===mz.WORLD_MATRIX||e===mz.VIEW_MATRIX?"mat4":e===mz.NORMAL_MATRIX?"mat3":e===mz.POSITION||e===mz.VIEW_POSITION||e===mz.DIRECTION||e===mz.SCALE?"vec3":void 0}update(e){const t=this.object3d,n=this._uniformNode,i=this.scope;if(i===mz.VIEW_MATRIX)n.value=t.modelViewMatrix;else if(i===mz.NORMAL_MATRIX)n.value=t.normalMatrix;else if(i===mz.WORLD_MATRIX)n.value=t.matrixWorld;else if(i===mz.POSITION)n.value=n.value||new OD,n.value.setFromMatrixPosition(t.matrixWorld);else if(i===mz.SCALE)n.value=n.value||new OD,n.value.setFromMatrixScale(t.matrixWorld);else if(i===mz.DIRECTION)n.value=n.value||new OD,t.getWorldDirection(n.value);else if(i===mz.VIEW_POSITION){const i=e.camera;n.value=n.value||new OD,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}}generate(e){const t=this.scope;return t===mz.WORLD_MATRIX||t===mz.VIEW_MATRIX?this._uniformNode.nodeType="mat4":t===mz.NORMAL_MATRIX?this._uniformNode.nodeType="mat3":t!==mz.POSITION&&t!==mz.VIEW_POSITION&&t!==mz.DIRECTION&&t!==mz.SCALE||(this._uniformNode.nodeType="vec3"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}mz.VIEW_MATRIX="viewMatrix",mz.NORMAL_MATRIX="normalMatrix",mz.WORLD_MATRIX="worldMatrix",mz.POSITION="position",mz.SCALE="scale",mz.VIEW_POSITION="viewPosition",mz.DIRECTION="direction",mz.type=QO("Object3D",mz);mz.DIRECTION,mz.VIEW_MATRIX,mz.NORMAL_MATRIX,mz.WORLD_MATRIX;const gz=Bk(mz,mz.POSITION),vz=(mz.SCALE,Bk(mz,mz.VIEW_POSITION));class yz extends mz{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:yz.VIEW_MATRIX)}update(e){this.object3d=e.object,super.update(e)}}yz.type=QO("Model",yz);yz.DIRECTION;const bz=Fk(yz,yz.VIEW_MATRIX).label("modelViewMatrix").toVar("ModelViewMatrix"),xz=Fk(yz,yz.NORMAL_MATRIX),_z=Fk(yz,yz.WORLD_MATRIX),wz=(yz.POSITION,yz.SCALE,yz.VIEW_POSITION,mB(new hL).onObjectUpdate(((e,t)=>{let{object:n}=e;return t.value.copy(n.matrixWorld).invert()}))),Sz=ez("position","vec3"),Tz=Sz.varying("positionLocal"),Mz=Sz.varying("positionPrevious"),Ez=_z.mul(Tz).xyz.varying("v_positionWorld"),Cz=Tz.transformDirection(_z).varying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),Rz=bz.mul(Tz).xyz.varying("v_positionView"),Pz=Rz.negate().varying("v_positionViewDirection").normalize().toVar("positionViewDirection");class Nz extends YO{constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:n}=e;return t.coordinateSystem===KN&&1===n.side?"false":e.getFrontFacing()}}Nz.type=QO("FrontFacing",Nz);const Dz=jk(Fk(Nz)).mul(2).sub(1),Lz=ez("normal","vec3"),Iz=Uk((e=>!1===e.geometry.hasAttribute("normal")?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),Jk(0,1,0)):Lz),"vec3").once()().toVar("normalLocal"),Oz=Rz.dFdx().cross(Rz.dFdy()).normalize().toVar("normalFlat");let kz=null;const Bz=Uk((e=>{let t;return t=!0===e.material.flatShading?Oz:kz||(kz=EU(xz.mul(Iz),"v_normalView").normalize()),t}),"vec3").once()().toVar("normalView"),Fz=EU(Bz.transformDirection(Az),"v_normalWorld").normalize().toVar("normalWorld"),Uz=Uk((e=>e.context.setupNormal()),"vec3").once()().mul(Dz).toVar("transformedNormalView"),zz=Uz.transformDirection(Az).normalize().toVar("transformedNormalWorld"),qz=Uk((e=>e.context.setupClearcoatNormal()),"vec3").once()().mul(Dz).toVar("transformedClearcoatNormalView"),Vz=mB(0).onReference((e=>{let{material:t}=e;return t})).onRenderUpdate((e=>{let{material:t}=e;return t.refractionRatio})),Gz=Pz.negate().reflect(Uz),jz=Pz.negate().refract(Uz,Vz),Hz=Gz.transformDirection(Az).toVar("reflectVector"),Wz=jz.transformDirection(Az).toVar("reflectVector");class Xz extends oz{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===CP?Hz:e.mapping===RP?Wz:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Jk(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.renderer.coordinateSystem!==ZN&&n.isRenderTargetTexture?t:Jk(t.x.negate(),t.yz)}generateUV(e,t){return t.build(e,"vec3")}}Xz.type=QO("CubeTexture",Xz);const Yz=Bk(Xz);class Qz extends fB{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}Qz.type=QO("Buffer",Qz);const Kz=(e,t,n)=>Ik(new Qz(e,t,n));class Zz extends KO{constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=super.generate(e),n=this.getNodeType();return e.format(t,"vec4",n)}}class Jz extends Qz{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null,"vec4"),this.array=e,this.elementType=t,this._elementType=null,this._elementLength=0,this.updateType=qO,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:e,value:t}=this,n=this.getElementLength(),i=this.getElementType();if(1===n)for(let r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===i)for(let r=0;r<e.length;r++){const n=4*r,i=e[r];t[n]=i.r,t[n+1]=i.g,t[n+2]=i.b||0}else for(let r=0;r<e.length;r++){const n=4*r,i=e[r];t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z||0,t[n+3]=i.w||0}}setup(e){const t=this.array.length;this._elementType=null===this.elementType?IO(this.array[0]):this.elementType,this._elementLength=e.getTypeLength(this._elementType);let n=Float32Array;return"i"===this._elementType.charAt(0)?n=Int32Array:"u"===this._elementType.charAt(0)&&(n=Uint32Array),this.value=new n(4*t),this.bufferCount=t,this.bufferType=e.changeComponentType("vec4",e.getComponentType(this._elementType)),super.setup(e)}element(e){return Ik(new Zz(this,Ik(e)))}}Jz.type=QO("UniformArray",Jz);const $z=(e,t)=>Ik(new Jz(e,t));class eq extends KO{constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,n,i)}}class tq extends YO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.property=e,this.uniformType=t,this.object=n,this.count=i,this.properties=e.split("."),this.reference=n,this.node=null,this.updateType=VO}element(e){return Ik(new eq(this,Ik(e)))}setNodeType(e){let t=null;t=null!==this.count?Kz(null,e,this.count):Array.isArray(this.getValueFromReference())?$z(null,e):"texture"===e?az(null):"cubeTexture"===e?Yz(null):mB(null,e),this.node=t.getSelf()}getNodeType(e){return null===this.node&&this.updateValue(),this.node.getNodeType(e)}getValueFromReference(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference;const{properties:t}=this;let n=e[t[0]];for(let i=1;i<t.length;i++)n=n[t[i]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}tq.type=QO("Reference",tq);const nq=(e,t,n)=>Ik(new tq(e,t,n)),iq=(e,t,n,i)=>Ik(new tq(e,t,i,n));class rq extends tq{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}rq.type=QO("MaterialReference",rq);const sq=(e,t,n)=>Ik(new rq(e,t,n)),oq=Uk((e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),ez("tangent","vec4"))))(),aq=oq.xyz.toVar("tangentLocal"),lq=bz.mul(nB(aq,0)).xyz.varying("v_tangentView").normalize().toVar("tangentView"),cq=e=>e.mul(oq.w).xyz,uq=aB(lq,EU(cq(Bz.cross(lq)),"v_bitangentView").normalize().toVar("bitangentView"),Bz),hq=(()=>{let e=IB.cross(Pz);return e=e.cross(IB).normalize(),e=AU(e,Uz,DB.mul(_B.oneMinus()).oneMinus().pow2().pow2()).normalize(),e})(),dq=Uk((e=>{const{eye_pos:t,surf_norm:n,mapN:i,uv:r}=e,s=t.dFdx(),o=t.dFdy(),a=r.dFdx(),l=r.dFdy(),c=n,u=o.cross(c),h=c.cross(s),d=u.mul(a.x).add(h.mul(l.x)),p=u.mul(a.y).add(h.mul(l.y)),A=d.dot(d).max(p.dot(p)),f=Dz.mul(A.inverseSqrt());return KB(d.mul(i.x,f),p.mul(i.y,f),c.mul(i.z)).normalize()}));class pq extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=0}setup(e){const{normalMapType:t,scaleNode:n}=this;let i=this.node.mul(2).sub(1);null!==n&&(i=Jk(i.xy.mul(n),i.z));let r=null;if(1===t)r=xz.mul(i).normalize();else if(0===t){r=!0===e.hasGeometryAttribute("tangent")?uq.mul(i).normalize():dq({eye_pos:Rz,surf_norm:Bz,mapN:i,uv:tz()})}return r}}pq.type=QO("NormalMap",pq);const Aq=Bk(pq),fq=Uk((e=>{let{textureNode:t,bumpScale:n}=e;const i=e=>t.cache().context({getUV:t=>e(t.uvNode||tz()),forceUVContext:!0}),r=jk(i((e=>e)));return Yk(jk(i((e=>e.add(e.dFdx())))).sub(r),jk(i((e=>e.add(e.dFdy())))).sub(r)).mul(n)})),mq=Uk((e=>{const{surf_pos:t,surf_norm:n,dHdxy:i}=e,r=t.dFdx().normalize(),s=n,o=t.dFdy().normalize().cross(s),a=s.cross(r),l=r.dot(o).mul(Dz),c=l.sign().mul(i.x.mul(o).add(i.y.mul(a)));return l.abs().mul(n).sub(c).normalize()}));class gq extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=fq({textureNode:this.textureNode,bumpScale:e});return mq({surf_pos:Rz,surf_norm:Bz,dHdxy:t})}}const vq=Bk(gq),yq=new Map;class bq extends YO{constructor(e){super(),this.scope=e}getCache(e,t){let n=yq.get(e);return void 0===n&&(n=sq(e,t),yq.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let i=null;if(n===bq.COLOR){const e=void 0!==t.color?this.getColor(n):Jk();i=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(n===bq.OPACITY){const e=this.getFloat(n);i=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(n===bq.SPECULAR_STRENGTH)i=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:jk(1);else if(n===bq.SPECULAR_INTENSITY){const e=this.getFloat(n);i=t.specularMap?e.mul(this.getTexture(n).a):e}else if(n===bq.SPECULAR_COLOR){const e=this.getColor(n);i=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(n).rgb):e}else if(n===bq.ROUGHNESS){const e=this.getFloat(n);i=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(n).g):e}else if(n===bq.METALNESS){const e=this.getFloat(n);i=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(n).b):e}else if(n===bq.EMISSIVE){const e=this.getFloat("emissiveIntensity"),r=this.getColor(n).mul(e);i=t.emissiveMap&&!0===t.emissiveMap.isTexture?r.mul(this.getTexture(n)):r}else if(n===bq.NORMAL)i=t.normalMap?Aq(this.getTexture("normal"),this.getCache("normalScale","vec2")):t.bumpMap?vq(this.getTexture("bump").r,this.getFloat("bumpScale")):Bz;else if(n===bq.CLEARCOAT){const e=this.getFloat(n);i=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===bq.CLEARCOAT_ROUGHNESS){const e=this.getFloat(n);i=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===bq.CLEARCOAT_NORMAL)i=t.clearcoatNormalMap?Aq(this.getTexture(n),this.getCache(n+"Scale","vec2")):Bz;else if(n===bq.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));i=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(n===bq.SHEEN_ROUGHNESS){const e=this.getFloat(n);i=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(n).a):e,i=i.clamp(.07,1)}else if(n===bq.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){const e=this.getTexture(n);i=oB(rV.x,rV.y,rV.y.negate(),rV.x).mul(e.rg.mul(2).sub(Yk(1)).normalize().mul(e.b))}else i=rV;else if(n===bq.IRIDESCENCE_THICKNESS){const e=nq("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const r=nq("0","float",t.iridescenceThicknessRange);i=e.sub(r).mul(this.getTexture(n).g).add(r)}else i=e}else if(n===bq.TRANSMISSION){const e=this.getFloat(n);i=t.transmissionMap?e.mul(this.getTexture(n).r):e}else if(n===bq.THICKNESS){const e=this.getFloat(n);i=t.thicknessMap?e.mul(this.getTexture(n).g):e}else if(n===bq.IOR)i=this.getFloat(n);else if(n===bq.LIGHT_MAP)i=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===bq.AO_MAP)i=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const t=this.getNodeType(e);i=this.getCache(n,t)}return i}}bq.ALPHA_TEST="alphaTest",bq.COLOR="color",bq.OPACITY="opacity",bq.SHININESS="shininess",bq.SPECULAR="specular",bq.SPECULAR_STRENGTH="specularStrength",bq.SPECULAR_INTENSITY="specularIntensity",bq.SPECULAR_COLOR="specularColor",bq.REFLECTIVITY="reflectivity",bq.ROUGHNESS="roughness",bq.METALNESS="metalness",bq.NORMAL="normal",bq.CLEARCOAT="clearcoat",bq.CLEARCOAT_ROUGHNESS="clearcoatRoughness",bq.CLEARCOAT_NORMAL="clearcoatNormal",bq.EMISSIVE="emissive",bq.ROTATION="rotation",bq.SHEEN="sheen",bq.SHEEN_ROUGHNESS="sheenRoughness",bq.ANISOTROPY="anisotropy",bq.IRIDESCENCE="iridescence",bq.IRIDESCENCE_IOR="iridescenceIOR",bq.IRIDESCENCE_THICKNESS="iridescenceThickness",bq.IOR="ior",bq.TRANSMISSION="transmission",bq.THICKNESS="thickness",bq.ATTENUATION_DISTANCE="attenuationDistance",bq.ATTENUATION_COLOR="attenuationColor",bq.LINE_SCALE="scale",bq.LINE_DASH_SIZE="dashSize",bq.LINE_GAP_SIZE="gapSize",bq.LINE_WIDTH="linewidth",bq.LINE_DASH_OFFSET="dashOffset",bq.POINT_WIDTH="pointWidth",bq.DISPERSION="dispersion",bq.LIGHT_MAP="light",bq.AO_MAP="ao",bq.type=QO("Material",bq);const xq=Fk(bq,bq.ALPHA_TEST),_q=Fk(bq,bq.COLOR),wq=Fk(bq,bq.SHININESS),Sq=Fk(bq,bq.EMISSIVE),Tq=Fk(bq,bq.OPACITY),Mq=Fk(bq,bq.SPECULAR),Eq=Fk(bq,bq.SPECULAR_INTENSITY),Cq=Fk(bq,bq.SPECULAR_COLOR),Rq=Fk(bq,bq.SPECULAR_STRENGTH),Pq=Fk(bq,bq.REFLECTIVITY),Nq=Fk(bq,bq.ROUGHNESS),Dq=Fk(bq,bq.METALNESS),Lq=Fk(bq,bq.NORMAL).context({getUV:null}),Iq=Fk(bq,bq.CLEARCOAT),Oq=Fk(bq,bq.CLEARCOAT_ROUGHNESS),kq=Fk(bq,bq.CLEARCOAT_NORMAL).context({getUV:null}),Bq=Fk(bq,bq.ROTATION),Fq=Fk(bq,bq.SHEEN),Uq=Fk(bq,bq.SHEEN_ROUGHNESS),zq=Fk(bq,bq.ANISOTROPY),qq=Fk(bq,bq.IRIDESCENCE),Vq=Fk(bq,bq.IRIDESCENCE_IOR),Gq=Fk(bq,bq.IRIDESCENCE_THICKNESS),jq=Fk(bq,bq.TRANSMISSION),Hq=Fk(bq,bq.THICKNESS),Wq=Fk(bq,bq.IOR),Xq=Fk(bq,bq.ATTENUATION_DISTANCE),Yq=Fk(bq,bq.ATTENUATION_COLOR),Qq=Fk(bq,bq.LINE_SCALE),Kq=Fk(bq,bq.LINE_DASH_SIZE),Zq=Fk(bq,bq.LINE_GAP_SIZE),Jq=Fk(bq,bq.LINE_WIDTH),$q=Fk(bq,bq.LINE_DASH_OFFSET),eV=Fk(bq,bq.POINT_WIDTH),tV=Fk(bq,bq.DISPERSION),nV=Fk(bq,bq.LIGHT_MAP),iV=Fk(bq,bq.AO_MAP);bq.REFRACTION_RATIO;const rV=mB(new uD).onReference((function(e){return e.material})).onRenderUpdate((function(e){let{material:t}=e;this.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation))}));class sV extends JO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("vec4"),this.positionNode=e}setup(e){if("fragment"===e.shaderStage)return EU(e.context.mvp);const t=this.positionNode||Tz;return pz.mul(bz).mul(t)}}sV.type=QO("ModelViewProjection",sV);const oV=Bk(sV);class aV extends YO{constructor(e){super("uint"),this.scope=e,this.isInstanceIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let i,r;if(n===aV.VERTEX)i=e.getVertexIndex();else if(n===aV.INSTANCE)i=e.getInstanceIndex();else if(n===aV.DRAW)i=e.getDrawIndex();else{if(n!==aV.INVOCATION_LOCAL)throw new Error("THREE.IndexNode: Unknown scope: "+n);i=e.getInvocationLocalIndex()}if("vertex"===e.shaderStage||"compute"===e.shaderStage)r=i;else{r=EU(this).build(e,t)}return r}}aV.VERTEX="vertex",aV.INSTANCE="instance",aV.INVOCATION_LOCAL="invocationLocal",aV.DRAW="draw",aV.type=QO("Index",aV);const lV=Fk(aV,aV.VERTEX),cV=Fk(aV,aV.INSTANCE),uV=(aV.INVOCATION_LOCAL,Fk(aV,aV.DRAW));class hV extends nO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class dV extends YO{constructor(e){super("void"),this.instanceMesh=e,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=zO,this.buffer=null,this.bufferColor=null}setup(e){let t=this.instanceMatrixNode,n=this.instanceColorNode;const i=this.instanceMesh;if(null===t){const e=i.instanceMatrix;if(i.count<=1e3)t=Kz(e.array,"mat4",i.count).element(cV);else{const n=new hV(e.array,16,1);this.buffer=n;const i=e.usage===QN?qU:zU,r=[i(n,"vec4",16,0),i(n,"vec4",16,4),i(n,"vec4",16,8),i(n,"vec4",16,12)];t=lB(...r)}this.instanceMatrixNode=t}const r=i.instanceColor;if(r&&null===n){const e=new aO(r.array,3),t=r.usage===QN?qU:zU;this.bufferColor=e,n=Jk(t(e,"vec3",3,0)),this.instanceColorNode=n}const s=t.mul(Tz).xyz;if(Tz.assign(s),e.hasGeometryAttribute("normal")){const e=aB(t),n=Iz.div(Jk(e[0].dot(e[0]),e[1].dot(e[1]),e[2].dot(e[2]))),i=e.mul(n).xyz;Iz.assign(i)}null!==this.instanceColorNode&&yB("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMesh.instanceMatrix.usage!==QN&&null!=this.buffer&&this.instanceMesh.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMesh.instanceMatrix.version),this.instanceMesh.instanceColor&&this.instanceMesh.instanceColor.usage!==QN&&null!=this.bufferColor&&this.instanceMesh.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceMesh.instanceColor.version)}}dV.type=QO("Instance",dV);const pV=Bk(dV);class AV extends YO{constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=cV:this.batchingIdNode=uV);const t=Uk((e=>{let[t]=e;const n=iz(lz(this.batchMesh._indirectTexture),0),i=Hk(t).modInt(Hk(n)),r=Hk(t).div(Hk(n));return lz(this.batchMesh._indirectTexture,Qk(i,r)).x})).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]}),n=t(Hk(this.batchingIdNode)),i=this.batchMesh._matricesTexture,r=iz(lz(i),0),s=jk(n).mul(4).toInt().toVar(),o=s.modInt(r),a=s.div(Hk(r)),l=lB(lz(i,Qk(o,a)),lz(i,Qk(o.add(1),a)),lz(i,Qk(o.add(2),a)),lz(i,Qk(o.add(3),a))),c=this.batchMesh._colorsTexture;if(null!==c){const e=Uk((e=>{let[t]=e;const n=iz(lz(c),0).x,i=t,r=i.modInt(n),s=i.div(n);return lz(c,Qk(r,s)).rgb})).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]}),t=e(n);yB("vec3","vBatchColor").assign(t)}const u=aB(l);Tz.assign(l.mul(Tz));const h=Iz.div(Jk(u[0].dot(u[0]),u[1].dot(u[1]),u[2].dot(u[2]))),d=u.mul(h).xyz;Iz.assign(d),e.hasGeometryAttribute("tangent")&&aq.mulAssign(u)}}AV.type=QO("Batch",AV);const fV=Bk(AV),mV=new WeakMap;class gV extends YO{constructor(e){let t,n,i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super("void"),this.skinnedMesh=e,this.useReference=r,this.updateType=VO,this.skinIndexNode=ez("skinIndex","uvec4"),this.skinWeightNode=ez("skinWeight","vec4"),r?(t=nq("bindMatrix","mat4"),n=nq("bindMatrixInverse","mat4"),i=iq("skeleton.boneMatrices","mat4",e.skeleton.bones.length)):(t=mB(e.bindMatrix,"mat4"),n=mB(e.bindMatrixInverse,"mat4"),i=Kz(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)),this.bindMatrixNode=t,this.bindMatrixInverseNode=n,this.boneMatricesNode=i,this.previousBoneMatricesNode=null}getSkinnedPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tz;const{skinIndexNode:n,skinWeightNode:i,bindMatrixNode:r,bindMatrixInverseNode:s}=this,o=e.element(n.x),a=e.element(n.y),l=e.element(n.z),c=e.element(n.w),u=r.mul(t),h=KB(o.mul(i.x).mul(u),a.mul(i.y).mul(u),l.mul(i.z).mul(u),c.mul(i.w).mul(u));return s.mul(h).xyz}getSkinnedNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Iz;const{skinIndexNode:n,skinWeightNode:i,bindMatrixNode:r,bindMatrixInverseNode:s}=this,o=e.element(n.x),a=e.element(n.y),l=e.element(n.z),c=e.element(n.w);let u=KB(i.x.mul(o),i.y.mul(a),i.z.mul(l),i.w.mul(c));return u=s.mul(u).mul(r),u.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=iq("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Mz)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")}setup(e){this.needsPreviousBoneMatrices(e)&&Mz.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(Tz.assign(t),e.hasGeometryAttribute("normal")){const t=this.getSkinnedNormal();Iz.assign(t),e.hasGeometryAttribute("tangent")&&aq.assign(t)}}generate(e,t){if("void"!==t)return Tz.build(e,t)}update(e){const t=(this.useReference?e.object:this.skinnedMesh).skeleton;mV.get(t)!==e.frameId&&(mV.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}gV.type=QO("Skinning",gV);class vV extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt()+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const n={};for(let r=0,s=this.params.length-1;r<s;r++){const e=this.params[r],t=!0!==e.isNode&&e.name||this.getVarName(r),i=!0!==e.isNode&&e.type||"int";n[t]=KU(t,i)}const i=e.addStack();return t.returnsNode=this.params[this.params.length-1](n,i,e),t.stackNode=i,e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,i=t.stackNode;for(let o=0,a=n.length-1;o<a;o++){const t=n[o];let i=null,r=null,s=null,a=null,l=null,c=null;t.isNode?(a="int",s=this.getVarName(o),i="0",r=t.build(e,a),l="<"):(a=t.type||"int",s=t.name||this.getVarName(o),i=t.start,r=t.end,l=t.condition,c=t.update,"number"===typeof i?i=i.toString():i&&i.isNode&&(i=i.build(e,a)),"number"===typeof r?r=r.toString():r&&r.isNode&&(r=r.build(e,a)),void 0!==i&&void 0===r?(i+=" - 1",r="0",l=">="):void 0!==r&&void 0===i&&(i="0",l="<"),void 0===l&&(l=Number(i)>Number(r)?">=":"<"));const u={start:i,end:r,condition:l},h=u.start,d=u.end;let p="",A="",f="";c||(c="int"===a||"uint"===a?l.includes("<")?"++":"--":l.includes("<")?"+= 1.":"-= 1."),p+=e.getVar(a,s)+" = "+h,A+=s+" "+l+" "+d,f+=s+" "+c;const m="for ( ".concat(p,"; ").concat(A,"; ").concat(f," )");e.addFlowCode((0===o?"\n":"")+e.tab+m+" {\n\n").addFlowTab()}const r=i.build(e,"void"),s=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+r);for(let o=0,a=this.params.length-1;o<a;o++)e.addFlowCode((0===o?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),s}}vV.type=QO("Loop",vV);const yV=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ik(new vV(kk(t,"int"))).append()},bV=()=>KU("break").append(),xV=new WeakMap,_V=new PD,wV=Uk((e=>{let{bufferMap:t,influence:n,stride:i,width:r,depth:s,offset:o}=e;const a=Hk(lV).mul(i).add(o),l=a.div(r),c=a.sub(l.mul(r));return lz(t,Qk(c,l)).depth(s).mul(n)}));class SV extends YO{constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=mB(1),this.updateType=VO}setup(e){const{geometry:t}=e,n=void 0!==t.morphAttributes.position,i=t.hasAttribute("normal")&&void 0!==t.morphAttributes.normal,r=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,s=void 0!==r?r.length:0,{texture:o,stride:a,size:l}=function(e){const t=void 0!==e.morphAttributes.position,n=void 0!==e.morphAttributes.normal,i=void 0!==e.morphAttributes.color,r=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,s=void 0!==r?r.length:0;let o=xV.get(e);if(void 0===o||o.count!==s){void 0!==o&&o.texture.dispose();const a=e.morphAttributes.position||[],l=e.morphAttributes.normal||[],c=e.morphAttributes.color||[];let u=0;!0===t&&(u=1),!0===n&&(u=2),!0===i&&(u=3);let h=e.attributes.position.count*u,d=1;const p=4096;h>p&&(d=Math.ceil(h/p),h=p);const A=new Float32Array(h*d*4*s),f=new LD(A,h,d,s);f.type=XP,f.needsUpdate=!0;const m=4*u;for(let v=0;v<s;v++){const y=a[v],b=l[v],x=c[v],_=h*d*4*v;for(let w=0;w<y.count;w++){const S=w*m;!0===t&&(_V.fromBufferAttribute(y,w),A[_+S+0]=_V.x,A[_+S+1]=_V.y,A[_+S+2]=_V.z,A[_+S+3]=0),!0===n&&(_V.fromBufferAttribute(b,w),A[_+S+4]=_V.x,A[_+S+5]=_V.y,A[_+S+6]=_V.z,A[_+S+7]=0),!0===i&&(_V.fromBufferAttribute(x,w),A[_+S+8]=_V.x,A[_+S+9]=_V.y,A[_+S+10]=_V.z,A[_+S+11]=4===x.itemSize?_V.w:1)}}function g(){f.dispose(),xV.delete(e),e.removeEventListener("dispose",g)}o={count:s,texture:f,stride:u,size:new uD(h,d)},xV.set(e,o),e.addEventListener("dispose",g)}return o}(t);!0===n&&Tz.mulAssign(this.morphBaseInfluence),!0===i&&Iz.mulAssign(this.morphBaseInfluence);const c=Hk(l.width);yV(s,(e=>{let{i:t}=e;const r=jk(0).toVar();this.mesh.count>1&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?r.assign(lz(this.mesh.morphTexture,Qk(Hk(t).add(1),Hk(cV))).r):r.assign(nq("morphTargetInfluences","float").element(t).toVar()),!0===n&&Tz.addAssign(wV({bufferMap:o,influence:r,stride:a,width:c,depth:t,offset:Hk(0)})),!0===i&&Iz.addAssign(wV({bufferMap:o,influence:r,stride:a,width:c,depth:t,offset:Hk(1)}))}))}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce(((e,t)=>e+t),0)}}SV.type=QO("Morph",SV);const TV=Bk(SV),MV=(e,t)=>{for(const n of t)if(n.isAnalyticLightNode&&n.light.id===e)return n;return null};class EV extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super("vec3"),this.totalDiffuseNode=Jk().toVar("totalDiffuse"),this.totalSpecularNode=Jk().toVar("totalSpecular"),this.outgoingLightNode=Jk().toVar("outgoingLight"),this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this.global=!0}getHash(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);const t=[];for(const e of this._lightNodes)t.push(e.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getDataFromNode(this);for(const n of t.nodes)n.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,i=(e=>e.sort(((e,t)=>e.id-t.id)))(this._lights),r=e.renderer.nodes.library;for(const s of i)if(s.isNode)t.push(Ik(s));else{let e=null;if(null!==n&&(e=MV(s.id,n)),null===e){const e=r.getLightNodeClass(s.constructor);if(void 0===e){console.warn("LightsNode.setupNodeLights: Light node not found for ".concat(s.constructor.name));continue}t.push(Ik(new e(s)))}}this._lightNodes=t}setup(e){null===this._lightNodes&&this.setupLightsNode(e);const t=e.context,n=t.lightingModel;let i=this.outgoingLightNode;if(n){const{_lightNodes:r,totalDiffuseNode:s,totalSpecularNode:o}=this;t.outgoingLight=i;const a=e.addStack();e.getDataFromNode(this).nodes=a.nodes,n.start(t,a,e);for(const t of r)t.build(e);n.indirect(t,a,e);const{backdrop:l,backdropAlpha:c}=t,{directDiffuse:u,directSpecular:h,indirectDiffuse:d,indirectSpecular:p}=t.reflectedLight;let A=u.add(d);null!==l&&(A=Jk(null!==c?c.mix(A,l):l),t.material.transparent=!0),s.assign(A),o.assign(h.add(p)),i.assign(s.add(o)),n.finish(t,a,e),i=i.bypass(e.removeStack())}return i}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}}EV.type=QO("Lights",EV);const CV=Bk(EV);class RV extends YO{constructor(){super("vec3"),this.isLightingNode=!0}generate(){console.warn("Abstract function.")}}RV.type=QO("Lighting",RV);class PV extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}PV.type=QO("AO",PV);class NV extends _U{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=i,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n={directDiffuse:Jk().toVar("directDiffuse"),directSpecular:Jk().toVar("directSpecular"),indirectDiffuse:Jk().toVar("indirectDiffuse"),indirectSpecular:Jk().toVar("indirectSpecular")};return{radiance:Jk().toVar("radiance"),irradiance:Jk().toVar("irradiance"),iblIrradiance:Jk().toVar("iblIrradiance"),ambientOcclusion:jk(1).toVar("ambientOcclusion"),reflectedLight:n,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}NV.type=QO("LightingContext",NV);const DV=Bk(NV);class LV extends RV{constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let IV,OV;LV.type=QO("Irradiance",LV);class kV extends YO{constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===kV.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=UO;return this.scope!==kV.RESOLUTION&&this.scope!==kV.VIEWPORT||(e=qO),this.updateType=e,e}update(e){let{renderer:t}=e;this.scope===kV.VIEWPORT?t.getViewport(OV):t.getDrawingBufferSize(IV)}setup(){const e=this.scope;let t=null;return t=e===kV.RESOLUTION?mB(IV||(IV=new uD)):e===kV.VIEWPORT?mB(OV||(OV=new PD)):Yk(BV.div(FV)),t}generate(e){if(this.scope===kV.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(FV).outputNode.build(e);t="".concat(e.getType("vec2"),"( ").concat(t,".x, ").concat(n,".y - ").concat(t,".y )")}return t}return super.generate(e)}}kV.COORDINATE="coordinate",kV.RESOLUTION="resolution",kV.VIEWPORT="viewport",kV.UV="uv",kV.type=QO("Viewport",kV);const BV=Fk(kV,kV.COORDINATE),FV=Fk(kV,kV.RESOLUTION),UV=Fk(kV,kV.VIEWPORT),zV=Fk(kV,kV.UV),qV=new uD;class VV extends oz{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zV,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=new gO,n.minFilter=zP),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=zO}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(qV);const n=this.value;n.image.width===qV.width&&n.image.height===qV.height||(n.image.width=qV.width,n.image.height=qV.height,n.needsUpdate=!0);const i=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=i}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}VV.type=QO("ViewportTexture",VV);const GV=Bk(VV,null,null,{generateMipmaps:!0});let jV=null;class HV extends VV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zV,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===jV&&(jV=new vO),super(e,t,jV)}}HV.type=QO("ViewportDepthTexture",HV);const WV=Bk(HV);class XV extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===XV.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup(e){let{camera:t}=e;const{scope:n}=this,i=this.valueNode;let r=null;if(n===XV.DEPTH_BASE)null!==i&&(r=ZV().assign(i));else if(n===XV.DEPTH)r=t.isPerspectiveCamera?QV(Rz.z,uz,hz):YV(Rz.z,uz,hz);else if(n===XV.LINEAR_DEPTH)if(null!==i)if(t.isPerspectiveCamera){const e=KV(i,uz,hz);r=YV(e,uz,hz)}else r=i;else r=YV(Rz.z,uz,hz);return r}}XV.DEPTH_BASE="depthBase",XV.DEPTH="depth",XV.LINEAR_DEPTH="linearDepth",XV.type=QO("ViewportDepth",XV);const YV=(e,t,n)=>e.add(t).div(t.sub(n)),QV=(e,t,n)=>t.add(e).mul(n).div(n.sub(t).mul(e)),KV=(e,t,n)=>t.mul(n).div(n.sub(t).mul(e).sub(n)),ZV=Bk(XV,XV.DEPTH_BASE),JV=Fk(XV,XV.DEPTH),$V=Bk(XV,XV.LINEAR_DEPTH);WV();JV.assign=e=>ZV(e);class eG extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eG.DEFAULT;super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{localClipIntersection:n,localClippingCount:i,globalClippingCount:r}=t,s=r+i,o=n?s-i:s;return this.scope===eG.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(t.planes,s,o):this.setupDefault(t.planes,s,o)}setupAlphaToCoverage(e,t,n){return Uk((()=>{const i=$z(e),r=vB("float","distanceToPlane"),s=vB("float","distanceToGradient"),o=vB("float","clipOpacity");let a;if(o.assign(1),yV(n,(e=>{let{i:t}=e;a=i.element(t),r.assign(Rz.dot(a.xyz).negate().add(a.w)),s.assign(r.fwidth().div(2)),o.mulAssign(gU(s.negate(),s,r)),o.equal(0).discard()})),n<t){const e=vB("float","unionclipOpacity");e.assign(1),yV({start:n,end:t},(t=>{let{i:n}=t;a=i.element(n),r.assign(Rz.dot(a.xyz).negate().add(a.w)),s.assign(r.fwidth().div(2)),e.mulAssign(gU(s.negate(),s,r).oneMinus())})),o.mulAssign(e.oneMinus())}bB.a.mulAssign(o),bB.a.equal(0).discard()}))()}setupDefault(e,t,n){return Uk((()=>{const i=$z(e);let r;if(yV(n,(e=>{let{i:t}=e;r=i.element(t),Rz.dot(r.xyz).greaterThan(r.w).discard()})),n<t){const e=vB("bool","clipped");e.assign(!0),yV({start:n,end:t},(t=>{let{i:n}=t;r=i.element(n),e.assign(Rz.dot(r.xyz).greaterThan(r.w).and(e))})),e.discard()}}))()}}eG.ALPHA_TO_COVERAGE="alphaToCoverage",eG.DEFAULT="default",eG.type=QO("Clipping",eG);const tG=new Map;class nG extends iI{constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.depthNode=null,this.shadowNode=null,this.shadowPositionNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+DO(this)}build(e){this.setup(e)}setup(e){let t;e.context.setupNormal=()=>this.setupNormal(e),e.addStack(),e.stack.outputNode=this.vertexNode||this.setupPosition(e),e.addFlow("vertex",e.removeStack()),e.addStack();const n=this.setupClipping(e);if(!0===this.depthWrite&&this.setupDepth(e),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);const i=this.setupLighting(e);null!==n&&e.stack.add(n);const r=nB(i,bB.a).max(0);t=this.setupOutput(e,r),FB.assign(t),null!==this.outputNode&&(t=this.outputNode);if(null!==e.renderer.getRenderTarget()){const n=e.renderer.getMRT(),i=this.mrtNode;null!==n?(t=n,null!==i&&(t=n.merge(i))):null!==i&&(t=i)}}else{let n=this.fragmentNode;!0!==n.isOutputStructNode&&(n=nB(n)),t=this.setupOutput(e,n)}e.stack.outputNode=t,e.addFlow("fragment",e.removeStack())}setupClipping(e){if(null===e.clippingContext)return null;const{globalClippingCount:t,localClippingCount:n}=e.clippingContext;let i=null;return(t||n)&&(this.alphaToCoverage?i=Ik(new eG(eG.ALPHA_TO_COVERAGE)):e.stack.add(Ik(new eG))),i}setupDepth(e){const{renderer:t}=e;let n=this.depthNode;if(null===n){const e=t.getMRT();if(e&&e.has("depth"))n=e.get("depth");else if(!0===t.logarithmicDepthBuffer){n=oV().w.add(1).log2().mul(dz).mul(.5)}}null!==n&&JV.assign(n).append()}setupPosition(e){const{object:t}=e,n=t.geometry;var i;if(e.addStack(),(n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&TV(t).append(),!0===t.isSkinnedMesh&&(i=t,Ik(new gV(i,!0))).append(),this.displacementMap){const e=sq("displacementMap","texture"),t=sq("displacementScale","float"),n=sq("displacementBias","float");Tz.addAssign(Iz.normalize().mul(e.x.mul(t).add(n)))}t.isBatchedMesh&&fV(t).append(),t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&pV(t).append(),null!==this.positionNode&&Tz.assign(this.positionNode);const r=oV();return e.context.vertex=e.removeStack(),e.context.mvp=r,r}setupDiffuseColor(e){let{object:t,geometry:n}=e,i=this.colorNode?nB(this.colorNode):_q;if(!0===this.vertexColors&&n.hasAttribute("color")&&(i=nB(i.xyz.mul(ez("color","vec3")),i.a)),t.instanceColor){i=yB("vec3","vInstanceColor").mul(i)}if(t.isBatchedMesh&&t._colorsTexture){i=yB("vec3","vBatchColor").mul(i)}bB.assign(i);const r=this.opacityNode?jk(this.opacityNode):Tq;if(bB.a.assign(bB.a.mul(r)),null!==this.alphaTestNode||this.alphaTest>0){const e=null!==this.alphaTestNode?jk(this.alphaTestNode):xq;bB.a.lessThanEqual(e).discard()}!1===this.transparent&&1===this.blending&&!1===this.alphaToCoverage&&bB.a.assign(1)}setupVariants(){}setupOutgoingLight(){return!0===this.lights?Jk(0):bB.rgb}setupNormal(){return this.normalNode?Jk(this.normalNode):Lq}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?sq("envMap","cubeTexture"):sq("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new LV(nV)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const i=this.setupLightMap(e);if(i&&i.isLightingNode&&t.push(i),null!==this.aoNode||e.material.aoMap){const e=null!==this.aoNode?this.aoNode:iV;t.push(new PV(e))}let r=this.lightsNode||e.lightsNode;return t.length>0&&(r=CV([...r.getLights(),...t])),r}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:i,emissiveNode:r}=this,s=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null;let o=this.setupOutgoingLight(e);if(s&&s.getScope().getLights().length>0){const t=this.setupLightingModel(e);o=DV(s,t,n,i)}else null!==n&&(o=Jk(null!==i?AU(o,n,i):n));return(r&&!0===r.isNode||t.emissive&&!0===t.emissive.isColor)&&(xB.assign(Jk(r||Sq)),o=o.add(xB)),o}setupOutput(e,t){if(!0===this.fog){const n=e.fogNode;n&&(t=nB(n.mix(t.rgb,n.colorNode),t.a))}return t}setDefaultValues(e){for(const n in e){const t=e[n];void 0===this[n]&&(this[n]=t,t&&t.clone&&(this[n]=t.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,n)&&void 0!==t[n].get&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{},nodes:{}});const n=iI.prototype.toJSON.call(this,e),i=LO(this);n.inputNodes={};for(const{property:s,childNode:o}of i)n.inputNodes[s]=o.toJSON(e).uuid;function r(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(t){const t=r(e.textures),i=r(e.images),s=r(e.nodes);t.length>0&&(n.textures=t),i.length>0&&(n.images=i),s.length>0&&(n.nodes=s)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.depthNode=e.depthNode,this.shadowNode=e.shadowNode,this.shadowPositionNode=e.shadowPositionNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}function iG(e,t){const n="NodeMaterial",i=e+n;if("function"!==typeof t)throw new Error('THREE.Node: NodeMaterial class "'.concat(e,'" is not a class.'));if(tG.has(i))console.warn('THREE.Node: Redefinition of NodeMaterial class "'.concat(i,'".'));else{if(e.slice(-12)!==n)return tG.set(i,t),t.type=i,i;console.warn("THREE.NodeMaterial: NodeMaterial class ".concat(i," should not have '").concat(n,"' suffix."))}}nG.type=iG("",nG);const rG=new mO;class sG extends nG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.lights=!1,this.useAlphaToCoverage=!0,this.useColor=e.vertexColors,this.pointWidth=1,this.pointColorNode=null,this.pointWidthNode=null,this.setDefaultValues(rG),this.setupShaders(),this.setValues(e)}setup(e){this.setupShaders(),super.setup(e)}setupShaders(){const e=this.alphaToCoverage,t=this.useColor;this.vertexNode=Uk((()=>{EU(Yk(),"vUv").assign(tz());const e=ez("instancePosition").xyz,t=vB("vec4","mvPos");t.assign(bz.mul(nB(e,1)));const n=UV.z.div(UV.w),i=pz.mul(t),r=vB("vec2","offset");return r.assign(Sz.xy),r.mulAssign(this.pointWidthNode?this.pointWidthNode:eV),r.assign(r.div(UV.z)),r.y.assign(r.y.mul(n)),r.assign(r.mul(i.w)),i.assign(i.add(nB(r,0,0))),i}))(),this.fragmentNode=Uk((()=>{const n=EU(Yk(),"vUv"),i=vB("float","alpha");i.assign(1);const r=n.x,s=n.y,o=r.mul(r).add(s.mul(s));if(e){const e=vB("float","dlen");e.assign(o.fwidth()),i.assign(gU(e.oneMinus(),e.add(1),o).oneMinus())}else o.greaterThan(1).discard();let a;if(this.pointColorNode)a=this.pointColorNode;else if(t){a=ez("instanceColor").mul(_q)}else a=_q;return i.mulAssign(Tq),nB(a,i)}))()}get alphaToCoverage(){return this.useAlphaToCoverage}set alphaToCoverage(e){this.useAlphaToCoverage!==e&&(this.useAlphaToCoverage=e,this.needsUpdate=!0)}}sG.type=iG("InstancedPoints",sG);const oG=new fO;class aG extends nG{constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(oG),this.setValues(e)}}aG.type=iG("LineBasic",aG);const lG=new NO;class cG extends nG{constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.setDefaultValues(lG),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode,t=this.dashScaleNode?jk(this.dashScaleNode):Qq,n=this.dashSizeNode?jk(this.dashSizeNode):Kq,i=this.dashSizeNode?jk(this.dashGapNode):Zq;UB.assign(n),zB.assign(i);const r=EU(ez("lineDistance").mul(t));(e?r.add(e):r).mod(UB.add(zB)).greaterThan(UB).discard()}}cG.type=iG("LineDashed",cG);const uG=new NO;class hG extends nG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.lights=!1,this.setDefaultValues(uG),this.useAlphaToCoverage=!0,this.useColor=e.vertexColors,this.useDash=e.dashed,this.useWorldUnits=!1,this.dashOffset=0,this.lineWidth=1,this.lineColorNode=null,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setup(e){this.setupShaders(),super.setup(e)}setupShaders(){const e=this.alphaToCoverage,t=this.useColor,n=this.dashed,i=this.worldUnits,r=Uk((e=>{let{start:t,end:n}=e;const i=pz.element(2).element(2),r=pz.element(3).element(2).mul(-.5).div(i).sub(t.z).div(n.z.sub(t.z));return nB(AU(t.xyz,n.xyz,r),n.w)}));this.vertexNode=Uk((()=>{yB("vec2","vUv").assign(tz());const e=ez("instanceStart"),t=ez("instanceEnd"),s=vB("vec4","start"),o=vB("vec4","end");s.assign(bz.mul(nB(e,1))),o.assign(bz.mul(nB(t,1))),i&&(yB("vec3","worldStart").assign(s.xyz),yB("vec3","worldEnd").assign(o.xyz));const a=UV.z.div(UV.w),l=pz.element(2).element(3).equal(-1);Vk(l,(()=>{Vk(s.z.lessThan(0).and(o.z.greaterThan(0)),(()=>{o.assign(r({start:s,end:o}))})).ElseIf(o.z.lessThan(0).and(s.z.greaterThanEqual(0)),(()=>{s.assign(r({start:o,end:s}))}))}));const c=pz.mul(s),u=pz.mul(o),h=c.xyz.div(c.w),d=u.xyz.div(u.w),p=d.xy.sub(h.xy).toVar();p.x.assign(p.x.mul(a)),p.assign(p.normalize());const A=nB().toVar();if(i){const e=o.xyz.sub(s.xyz).normalize(),t=AU(s.xyz,o.xyz,.5).normalize(),i=e.cross(t).normalize(),r=e.cross(i),a=yB("vec4","worldPos");a.assign(Sz.y.lessThan(.5).select(s,o));const l=Jq.mul(.5);a.addAssign(nB(Sz.x.lessThan(0).select(i.mul(l),i.mul(l).negate()),0)),n||(a.addAssign(nB(Sz.y.lessThan(.5).select(e.mul(l).negate(),e.mul(l)),0)),a.addAssign(nB(r.mul(l),0)),Vk(Sz.y.greaterThan(1).or(Sz.y.lessThan(0)),(()=>{a.subAssign(nB(r.mul(2).mul(l),0))}))),A.assign(pz.mul(a));const c=Jk().toVar();c.assign(Sz.y.lessThan(.5).select(h,d)),A.z.assign(c.z.mul(A.w))}else{const e=vB("vec2","offset");e.assign(Yk(p.y,p.x.negate())),p.x.assign(p.x.div(a)),e.x.assign(e.x.div(a)),e.assign(Sz.x.lessThan(0).select(e.negate(),e)),Vk(Sz.y.lessThan(0),(()=>{e.assign(e.sub(p))})).ElseIf(Sz.y.greaterThan(1),(()=>{e.assign(e.add(p))})),e.assign(e.mul(Jq)),e.assign(e.div(UV.w)),A.assign(Sz.y.lessThan(.5).select(c,u)),e.assign(e.mul(A.w)),A.assign(A.add(nB(e,0,0)))}return A}))();const s=Uk((e=>{let{p1:t,p2:n,p3:i,p4:r}=e;const s=t.sub(i),o=r.sub(i),a=n.sub(t),l=s.dot(o),c=o.dot(a),u=s.dot(a),h=o.dot(o),d=a.dot(a).mul(h).sub(c.mul(c)),p=l.mul(c).sub(u.mul(h)).div(d).clamp(),A=l.add(c.mul(p)).div(h).clamp();return Yk(p,A)}));this.fragmentNode=Uk((()=>{const r=yB("vec2","vUv");if(n){const e=this.offsetNode?jk(this.offsetNodeNode):$q,t=this.dashScaleNode?jk(this.dashScaleNode):Qq,n=this.dashSizeNode?jk(this.dashSizeNode):Kq,i=this.dashSizeNode?jk(this.dashGapNode):Zq;UB.assign(n),zB.assign(i);const s=ez("instanceDistanceStart"),o=ez("instanceDistanceEnd"),a=Sz.y.lessThan(.5).select(t.mul(s),Qq.mul(o)),l=EU(a.add($q)),c=e?l.add(e):l;r.y.lessThan(-1).or(r.y.greaterThan(1)).discard(),c.mod(UB.add(zB)).greaterThan(UB).discard()}const o=vB("float","alpha");if(o.assign(1),i){const t=yB("vec3","worldStart"),i=yB("vec3","worldEnd"),r=yB("vec4","worldPos").xyz.normalize().mul(1e5),a=i.sub(t),l=s({p1:t,p2:i,p3:Jk(0,0,0),p4:r}),c=t.add(a.mul(l.x)),u=r.mul(l.y),h=c.sub(u).length().div(Jq);if(!n)if(e){const e=h.fwidth();o.assign(gU(e.negate().add(.5),e.add(.5),h).oneMinus())}else h.greaterThan(.5).discard()}else if(e){const e=r.x,t=r.y.greaterThan(0).select(r.y.sub(1),r.y.add(1)),n=e.mul(e).add(t.mul(t)),i=vB("float","dlen");i.assign(n.fwidth()),Vk(r.y.abs().greaterThan(1),(()=>{o.assign(gU(i.oneMinus(),i.add(1),n).oneMinus())}))}else Vk(r.y.abs().greaterThan(1),(()=>{const e=r.x,t=r.y.greaterThan(0).select(r.y.sub(1),r.y.add(1));e.mul(e).add(t.mul(t)).greaterThan(1).discard()}));let a;if(this.lineColorNode)a=this.lineColorNode;else if(t){const e=ez("instanceColorStart"),t=ez("instanceColorEnd");a=Sz.y.lessThan(.5).select(e,t).mul(_q)}else a=_q;return nB(a,o)}))()}get worldUnits(){return this.useWorldUnits}set worldUnits(e){this.useWorldUnits!==e&&(this.useWorldUnits=e,this.needsUpdate=!0)}get dashed(){return this.useDash}set dashed(e){this.useDash!==e&&(this.useDash=e,this.needsUpdate=!0)}get alphaToCoverage(){return this.useAlphaToCoverage}set alphaToCoverage(e){this.useAlphaToCoverage!==e&&(this.useAlphaToCoverage=e,this.needsUpdate=!0)}}hG.type=iG("Line2",hG);const dG=new MO;class pG extends nG{constructor(e){super(),this.lights=!1,this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(dG),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?jk(this.opacityNode):Tq;bB.assign(nB(Ik(Uz).mul(.5).add(.5),e))}}pG.type=iG("MeshNormal",pG);class AG extends JO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cz;super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan2(e.x).mul(1/(2*Math.PI)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Yk(t,n)}}AG.type=QO("EquirectUV",AG);const fG=Bk(AG);class mG extends eO{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,i=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r=new GI(5,5,5),s=fG(Cz),o=new nG;o.colorNode=az(t,s,0),o.side=1,o.blending=0;const a=new qI(r,o),l=new tO;l.add(a),t.minFilter===zP&&(t.minFilter=FP);const c=new JI(1,10,this),u=e.getMRT();return e.setMRT(null),c.update(e,l),e.setMRT(u),t.minFilter=n,t.currentGenerateMipmaps=i,a.geometry.dispose(),a.material.dispose(),this}}const gG=new WeakMap;class vG extends JO{constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Yz();const t=new $I;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=qO}updateBefore(e){const{renderer:t,material:n}=e,i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const e=i.isTextureNode?i.value:n[i.property];if(e&&e.isTexture){const n=e.mapping;if(n===PP||n===NP){if(gG.has(e)){const t=gG.get(e);bG(t,e.mapping),this._cubeTexture=t}else{const n=e.image;if(function(e){return null!==e&&void 0!==e&&e.height>0}(n)){const i=new mG(n.height);i.fromEquirectangularTexture(t,e),bG(i.texture,e.mapping),this._cubeTexture=i.texture,gG.set(e,i.texture),e.addEventListener("dispose",yG)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function yG(e){const t=e.target;t.removeEventListener("dispose",yG);const n=gG.get(t);void 0!==n&&(gG.delete(t),n.dispose())}function bG(e,t){t===PP?e.mapping=CP:t===NP&&(e.mapping=RP)}vG.type=QO("CubeMap",vG);const xG=Bk(vG);class _G extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.envNode=e}setup(e){e.context.environment=xG(this.envNode)}}_G.type=QO("BasicEnvironment",_G);class wG extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.lightMapNode=e}setup(e){const t=jk(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}wG.type=QO("BasicLightMap",wG);class SG{start(){}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class TG extends SG{constructor(){super()}indirect(e,t,n){const i=e.ambientOcclusion,r=e.reflectedLight,s=n.context.irradianceLightMap;r.indirectDiffuse.assign(nB(0)),s?r.indirectDiffuse.addAssign(s):r.indirectDiffuse.addAssign(nB(1,1,1,0)),r.indirectDiffuse.mulAssign(i),r.indirectDiffuse.mulAssign(bB.rgb)}finish(e,t,n){const i=n.material,r=e.outgoingLight,s=n.context.environment;if(s)switch(i.combine){case 0:r.rgb.assign(AU(r.rgb,r.rgb.mul(s.rgb),Rq.mul(Pq)));break;case 1:r.rgb.assign(AU(r.rgb,s.rgb,Rq.mul(Pq)));break;case 2:r.rgb.addAssign(s.rgb.mul(Rq.mul(Pq)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",i.combine)}}}const MG=new rI;class EG extends nG{constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(MG),this.setValues(e)}setupNormal(){return Bz}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new _G(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new wG(nV)),t}setupOutgoingLight(){return bB.rgb}setupLightingModel(){return new TG}}EG.type=iG("MeshBasic",EG);const CG=Uk((e=>{let{f0:t,f90:n,dotVH:i}=e;const r=i.mul(-5.55473).sub(6.98316).mul(i).exp2();return t.mul(r.oneMinus()).add(n.mul(r))})),RG=Uk((e=>e.diffuseColor.mul(1/Math.PI))),PG=Uk((e=>{let{dotNH:t}=e;return BB.mul(jk(.5)).add(1).mul(jk(1/Math.PI)).mul(t.pow(BB))})),NG=Uk((e=>{let{lightDirection:t}=e;const n=t.add(Pz).normalize(),i=Uz.dot(n).clamp(),r=Pz.dot(n).clamp(),s=CG({f0:OB,f90:1,dotVH:r}),o=jk(.25),a=PG({dotNH:i});return s.mul(o).mul(a)}));class DG extends TG{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super(),this.specular=e}direct(e){let{lightDirection:t,lightColor:n,reflectedLight:i}=e;const r=Uz.dot(t).clamp().mul(n);i.directDiffuse.addAssign(r.mul(RG({diffuseColor:bB.rgb}))),!0===this.specular&&i.directSpecular.addAssign(r.mul(NG({lightDirection:t})).mul(Rq))}indirect(e){let{ambientOcclusion:t,irradiance:n,reflectedLight:i}=e;i.indirectDiffuse.addAssign(n.mul(RG({diffuseColor:bB}))),i.indirectDiffuse.mulAssign(t)}}const LG=new EO;class IG extends nG{constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(LG),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new _G(t):null}setupLightingModel(){return new DG(!1)}}IG.type=iG("MeshLambert",IG);const OG=new SO;class kG extends nG{constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(OG),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new _G(t):null}setupLightingModel(){return new DG}setupVariants(){const e=(this.shininessNode?jk(this.shininessNode):wq).max(1e-4);BB.assign(e);const t=this.specularNode||Mq;OB.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}kG.type=iG("MeshPhong",kG);const BG=Uk((()=>{const e=Bz.dFdx().abs().max(Bz.dFdy().abs());return e.x.max(e.y).max(e.z)})),FG=Uk((e=>{const{roughness:t}=e,n=BG();let i=t.max(.0525);return i=i.add(n),i=i.min(1),i})),UG=Uk((e=>{let{alpha:t,dotNL:n,dotNV:i}=e;const r=t.pow2(),s=n.mul(r.add(r.oneMinus().mul(i.pow2())).sqrt()),o=i.mul(r.add(r.oneMinus().mul(n.pow2())).sqrt());return $B(.5,s.add(o).max(vF))})).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),zG=Uk((e=>{let{alphaT:t,alphaB:n,dotTV:i,dotBV:r,dotTL:s,dotBL:o,dotNV:a,dotNL:l}=e;const c=l.mul(Jk(t.mul(i),n.mul(r),a).length()),u=a.mul(Jk(t.mul(s),n.mul(o),l).length());return $B(.5,c.add(u)).saturate()})).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),qG=Uk((e=>{let{alpha:t,dotNH:n}=e;const i=t.pow2(),r=n.pow2().mul(i.oneMinus()).oneMinus();return i.div(r.pow2()).mul(1/Math.PI)})).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),VG=jk(1/Math.PI),GG=Uk((e=>{let{alphaT:t,alphaB:n,dotNH:i,dotTH:r,dotBH:s}=e;const o=t.mul(n),a=Jk(n.mul(r),t.mul(s),o.mul(i)),l=a.dot(a),c=o.div(l);return VG.mul(o.mul(c.pow2()))})).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),jG=Uk((e=>{const{lightDirection:t,f0:n,f90:i,roughness:r,f:s,USE_IRIDESCENCE:o,USE_ANISOTROPY:a}=e,l=e.normalView||Uz,c=r.pow2(),u=t.add(Pz).normalize(),h=l.dot(t).clamp(),d=l.dot(Pz).clamp(),p=l.dot(u).clamp(),A=Pz.dot(u).clamp();let f,m,g=CG({f0:n,f90:i,dotVH:A});if(Dk(o)&&(g=CB.mix(g,s)),Dk(a)){const e=LB.dot(t),n=LB.dot(Pz),i=LB.dot(u),r=IB.dot(t),s=IB.dot(Pz),o=IB.dot(u);f=zG({alphaT:NB,alphaB:c,dotTV:n,dotBV:s,dotTL:e,dotBL:r,dotNV:d,dotNL:h}),m=GG({alphaT:NB,alphaB:c,dotNH:p,dotTH:i,dotBH:o})}else f=UG({alpha:c,dotNL:h,dotNV:d}),m=qG({alpha:c,dotNH:p});return g.mul(f).mul(m)})),HG=Uk((e=>{let{roughness:t,dotNV:n}=e;const i=nB(-1,-.0275,-.572,.022),r=nB(1,.0425,1.04,-.04),s=t.mul(i).add(r),o=s.x.mul(s.x).min(n.mul(-9.28).exp2()).mul(s.x).add(s.y);return Yk(-1.04,1.04).mul(o).add(s.zw)})).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),WG=Uk((e=>{const{dotNV:t,specularColor:n,specularF90:i,roughness:r}=e,s=HG({dotNV:t,roughness:r});return n.mul(s.x).add(i.mul(s.y))})),XG=Uk((e=>{let{f:t,f90:n,dotVH:i}=e;const r=i.oneMinus().saturate(),s=r.mul(r),o=r.mul(s,s).clamp(0,.9999);return t.sub(Jk(n).mul(o)).div(o.oneMinus())})).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),YG=Uk((e=>{let{roughness:t,dotNH:n}=e;const i=t.pow2(),r=jk(1).div(i),s=n.pow2().oneMinus().max(.0078125);return jk(2).add(r).mul(s.pow(r.mul(.5))).div(2*Math.PI)})).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),QG=Uk((e=>{let{dotNV:t,dotNL:n}=e;return jk(1).div(jk(4).mul(n.add(t).sub(n.mul(t))))})).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),KG=Uk((e=>{let{lightDirection:t}=e;const n=t.add(Pz).normalize(),i=Uz.dot(t).clamp(),r=Uz.dot(Pz).clamp(),s=Uz.dot(n).clamp(),o=YG({roughness:EB,dotNH:s}),a=QG({dotNV:r,dotNL:i});return MB.mul(o).mul(a)})),ZG=Uk((e=>{let{N:t,V:n,roughness:i}=e;const r=t.dot(n).saturate(),s=Yk(i,r.oneMinus().sqrt());return s.assign(s.mul(.984375).add(.0078125)),s})).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),JG=Uk((e=>{let{f:t}=e;const n=t.length();return tU(n.mul(n).add(t.z).div(n.add(1)),0)})).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),$G=Uk((e=>{let{v1:t,v2:n}=e;const i=t.dot(n),r=i.abs().toVar(),s=r.mul(.0145206).add(.4965155).mul(r).add(.8543985).toVar(),o=r.add(4.1616724).mul(r).add(3.417594).toVar(),a=s.div(o),l=i.greaterThan(0).select(a,tU(i.mul(i).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return t.cross(n).mul(l)})).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),ej=Uk((e=>{let{N:t,V:n,P:i,mInv:r,p0:s,p1:o,p2:a,p3:l}=e;const c=o.sub(s).toVar(),u=l.sub(s).toVar(),h=c.cross(u),d=Jk().toVar();return Vk(h.dot(i.sub(s)).greaterThanEqual(0),(()=>{const e=n.sub(t.mul(n.dot(t))).normalize(),c=t.cross(e).negate(),u=r.mul(aB(e,c,t).transpose()).toVar(),h=u.mul(s.sub(i)).normalize().toVar(),p=u.mul(o.sub(i)).normalize().toVar(),A=u.mul(a.sub(i)).normalize().toVar(),f=u.mul(l.sub(i)).normalize().toVar(),m=Jk(0).toVar();m.addAssign($G({v1:h,v2:p})),m.addAssign($G({v1:p,v2:A})),m.addAssign($G({v1:A,v2:f})),m.addAssign($G({v1:f,v2:h})),d.assign(Jk(JG({f:m})))})),d})).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),tj=1/6,nj=e=>JB(tj,JB(e,JB(e,e.negate().add(3)).sub(3)).add(1)),ij=e=>JB(tj,JB(e,JB(e,JB(3,e).sub(6))).add(4)),rj=e=>JB(tj,JB(e,JB(e,JB(-3,e).add(3)).add(3)).add(1)),sj=e=>JB(tj,cU(e,3)),oj=e=>nj(e).add(ij(e)),aj=e=>rj(e).add(sj(e)),lj=e=>KB(-1,ij(e).div(nj(e).add(ij(e)))),cj=e=>KB(1,sj(e).div(rj(e).add(sj(e)))),uj=(e,t,n)=>{const i=e.uvNode,r=JB(i,t.zw).add(.5),s=NF(r),o=IF(r),a=oj(o.x),l=aj(o.x),c=lj(o.x),u=cj(o.x),h=lj(o.y),d=cj(o.y),p=Yk(s.x.add(c),s.y.add(h)).sub(.5).mul(t.xy),A=Yk(s.x.add(u),s.y.add(h)).sub(.5).mul(t.xy),f=Yk(s.x.add(c),s.y.add(d)).sub(.5).mul(t.xy),m=Yk(s.x.add(u),s.y.add(d)).sub(.5).mul(t.xy),g=oj(o.y).mul(KB(a.mul(e.uv(p).level(n)),l.mul(e.uv(A).level(n)))),v=aj(o.y).mul(KB(a.mul(e.uv(f).level(n)),l.mul(e.uv(m).level(n))));return g.add(v)},hj=Uk((e=>{let[t,n=jk(3)]=e;const i=Yk(t.size(Hk(n))),r=Yk(t.size(Hk(n.add(1)))),s=$B(1,i),o=$B(1,r),a=uj(t,nB(s,i),NF(n)),l=uj(t,nB(o,r),DF(n));return IF(n).mix(a,l)})),dj=Uk((e=>{let[t,n,i,r,s]=e;const o=Jk(mU(n.negate(),LF(t),$B(1,r))),a=Jk(GF(s[0].xyz),GF(s[1].xyz),GF(s[2].xyz));return LF(o).mul(i.mul(a))})).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),pj=Uk((e=>{let[t,n]=e;return t.mul(fU(n.mul(2).sub(2),0,1))})).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Aj=GV(),fj=Uk((e=>{let[t,n,i]=e;const r=Aj.uv(t),s=CF(jk(FV.x)).mul(pj(n,i));return hj(r,s)})),mj=Uk((e=>{let[t,n,i]=e;return Vk(i.notEqual(0),(()=>{const e=EF(n).negate().div(i);return TF(e.negate().mul(t))})),Jk(1)})).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),gj=Uk((e=>{let t,n,[i,r,s,o,a,l,c,u,h,d,p,A,f,m,g]=e;if(g){t=nB().toVar(),n=Jk().toVar();const e=p.sub(1).mul(g.mul(.025)),a=Jk(p.sub(e),p,p.add(e));yV({start:0,end:3},(e=>{let{i:l}=e;const p=a.element(l),g=dj(i,r,A,p,u),v=c.add(g),y=d.mul(h.mul(nB(v,1))),b=Yk(y.xy.div(y.w)).toVar();b.addAssign(1),b.divAssign(2),b.assign(Yk(b.x,b.y.oneMinus()));const x=fj(b,s,p);t.element(l).assign(x.element(l)),t.a.addAssign(x.a),n.element(l).assign(o.element(l).mul(mj(GF(g),f,m).element(l)))})),t.a.divAssign(3)}else{const e=dj(i,r,A,p,u),a=c.add(e),l=d.mul(h.mul(nB(a,1))),g=Yk(l.xy.div(l.w)).toVar();g.addAssign(1),g.divAssign(2),g.assign(Yk(g.x,g.y.oneMinus())),t=fj(g,s,p),n=o.mul(mj(GF(e),f,m))}const v=n.rgb.mul(t.rgb),y=i.dot(r).clamp(),b=Jk(WG({dotNV:y,specularColor:a,specularF90:l,roughness:s})),x=n.r.add(n.g,n.b).div(3);return nB(b.oneMinus().mul(v),t.a.oneMinus().mul(x).oneMinus())})),vj=aB(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),yj=(e,t)=>e.sub(t).div(e.add(t)).pow2(),bj=(e,t)=>{const n=e.mul(2*Math.PI*1e-9),i=Jk(54856e-17,44201e-17,52481e-17),r=Jk(1681e3,1795300,2208400),s=Jk(43278e5,93046e5,66121e5),o=jk(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(t.x).cos()).mul(n.pow2().mul(-45282e5).exp());let a=i.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(n).add(t).cos()).mul(n.pow2().negate().mul(s).exp());a=Jk(a.x.add(o),a.y,a.z).div(1.0685e-7);return vj.mul(a)},xj=Uk((e=>{let{outsideIOR:t,eta2:n,cosTheta1:i,thinFilmThickness:r,baseF0:s}=e;const o=AU(t,n,gU(0,.03,r)),a=t.div(o).pow2().mul(jk(1).sub(i.pow2())),l=jk(1).sub(a).sqrt(),c=yj(o,t),u=CG({f0:c,f90:1,dotVH:i}),h=u.oneMinus(),d=o.lessThan(t).select(Math.PI,0),p=jk(Math.PI).sub(d),A=(e=>{const t=e.sqrt();return Jk(1).add(t).div(Jk(1).sub(t))})(s.clamp(0,.9999)),f=yj(A,o.toVec3()),m=CG({f0:f,f90:1,dotVH:l}),g=Jk(A.x.lessThan(o).select(Math.PI,0),A.y.lessThan(o).select(Math.PI,0),A.z.lessThan(o).select(Math.PI,0)),v=o.mul(r,l,2),y=Jk(p).add(g),b=u.mul(m).clamp(1e-5,.9999),x=b.sqrt(),_=h.pow2().mul(m).div(Jk(1).sub(b));let w=u.add(_),S=_.sub(h);for(let T=1;T<=2;++T){S=S.mul(x);const e=bj(jk(T).mul(v),jk(T).mul(y)).mul(2);w=w.add(S.mul(e))}return w.max(Jk(0))})).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),_j=Uk((e=>{let{normal:t,viewDir:n,roughness:i}=e;const r=t.dot(n).saturate(),s=i.pow2(),o=xU(i.lessThan(.25),jk(-339.2).mul(s).add(jk(161.4).mul(i)).sub(25.9),jk(-8.48).mul(s).add(jk(14.3).mul(i)).sub(9.95)),a=xU(i.lessThan(.25),jk(44).mul(s).sub(jk(23.7).mul(i)).add(3.26),jk(1.97).mul(s).sub(jk(3.27).mul(i)).add(.72));return xU(i.lessThan(.25),0,jk(.1).mul(i).sub(.025)).add(o.mul(r).add(a).exp()).mul(1/Math.PI).saturate()})),wj=Jk(.04),Sj=jk(1);class Tj extends SG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=i,this.transmission=r,this.dispersion=s,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=Jk().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Jk().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Jk().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=Jk().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Jk().toVar("sheenSpecularIndirect")),!0===this.iridescence){const e=Uz.dot(Pz).clamp();this.iridescenceFresnel=xj({outsideIOR:jk(1),eta2:RB,cosTheta1:e,thinFilmThickness:PB,baseF0:OB}),this.iridescenceF0=XG({f:this.iridescenceFresnel,f90:1,dotVH:e})}if(!0===this.transmission){const t=Ez,n=fz.sub(Ez).normalize(),i=zz;e.backdrop=gj(i,n,_B,bB,OB,kB,t,_z,Az,pz,qB,GB,HB,jB,this.dispersion?WB:null),e.backdropAlpha=VB,bB.a.mulAssign(AU(1,e.backdrop.a,VB))}}computeMultiscattering(e,t,n){const i=Uz.dot(Pz).clamp(),r=HG({roughness:_B,dotNV:i}),s=(this.iridescenceF0?CB.mix(OB,this.iridescenceF0):OB).mul(r.x).add(n.mul(r.y)),o=r.x.add(r.y).oneMinus(),a=OB.add(OB.oneMinus().mul(.047619)),l=s.mul(a).div(o.mul(a).oneMinus());e.addAssign(s),t.addAssign(l.mul(o))}direct(e){let{lightDirection:t,lightColor:n,reflectedLight:i}=e;const r=Uz.dot(t).clamp().mul(n);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(r.mul(KG({lightDirection:t}))),!0===this.clearcoat){const e=qz.dot(t).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(e.mul(jG({lightDirection:t,f0:wj,f90:Sj,roughness:TB,normalView:qz})))}i.directDiffuse.addAssign(r.mul(RG({diffuseColor:bB.rgb}))),i.directSpecular.addAssign(r.mul(jG({lightDirection:t,f0:OB,f90:1,roughness:_B,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea(e){let{lightColor:t,lightPosition:n,halfWidth:i,halfHeight:r,reflectedLight:s,ltc_1:o,ltc_2:a}=e;const l=n.add(i).sub(r),c=n.sub(i).sub(r),u=n.sub(i).add(r),h=n.add(i).add(r),d=Uz,p=Pz,A=Rz.toVar(),f=ZG({N:d,V:p,roughness:_B}),m=o.uv(f).toVar(),g=a.uv(f).toVar(),v=aB(Jk(m.x,0,m.y),Jk(0,1,0),Jk(m.z,0,m.w)).toVar(),y=OB.mul(g.x).add(OB.oneMinus().mul(g.y)).toVar();s.directSpecular.addAssign(t.mul(y).mul(ej({N:d,V:p,P:A,mInv:v,p0:l,p1:c,p2:u,p3:h}))),s.directDiffuse.addAssign(t.mul(bB).mul(ej({N:d,V:p,P:A,mInv:aB(1,0,0,0,1,0,0,0,1),p0:l,p1:c,p2:u,p3:h})))}indirect(e,t,n){this.indirectDiffuse(e,t,n),this.indirectSpecular(e,t,n),this.ambientOcclusion(e,t,n)}indirectDiffuse(e){let{irradiance:t,reflectedLight:n}=e;n.indirectDiffuse.addAssign(t.mul(RG({diffuseColor:bB})))}indirectSpecular(e){let{radiance:t,iblIrradiance:n,reflectedLight:i}=e;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(n.mul(MB,_j({normal:Uz,viewDir:Pz,roughness:EB}))),!0===this.clearcoat){const e=qz.dot(Pz).clamp(),t=WG({dotNV:e,specularColor:wj,specularF90:Sj,roughness:TB});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(t))}const r=Jk().toVar("singleScattering"),s=Jk().toVar("multiScattering"),o=n.mul(1/Math.PI);this.computeMultiscattering(r,s,kB);const a=r.add(s),l=bB.mul(a.r.max(a.g).max(a.b).oneMinus());i.indirectSpecular.addAssign(t.mul(r)),i.indirectSpecular.addAssign(s.mul(o)),i.indirectDiffuse.addAssign(l.mul(o))}ambientOcclusion(e){let{ambientOcclusion:t,reflectedLight:n}=e;const i=Uz.dot(Pz).clamp().add(t),r=_B.mul(-16).oneMinus().negate().exp2(),s=t.sub(i.pow(r).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(t),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(s)}finish(e){const{outgoingLight:t}=e;if(!0===this.clearcoat){const e=qz.dot(Pz).clamp(),n=CG({dotVH:e,f0:wj,f90:Sj}),i=t.mul(SB.mul(n).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(SB));t.assign(i)}if(!0===this.sheen){const e=MB.r.max(MB.g).max(MB.b).mul(.157).oneMinus(),n=t.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(n)}}}const Mj=jk(1),Ej=jk(-2),Cj=jk(.8),Rj=jk(-1),Pj=jk(.4),Nj=jk(2),Dj=jk(.305),Lj=jk(3),Ij=jk(.21),Oj=jk(4),kj=jk(4),Bj=jk(16),Fj=Uk((e=>{let[t]=e;const n=Jk(qF(t)).toVar(),i=jk(-1).toVar();return Vk(n.x.greaterThan(n.z),(()=>{Vk(n.x.greaterThan(n.y),(()=>{i.assign(xU(t.x.greaterThan(0),0,3))})).Else((()=>{i.assign(xU(t.y.greaterThan(0),1,4))}))})).Else((()=>{Vk(n.z.greaterThan(n.y),(()=>{i.assign(xU(t.z.greaterThan(0),2,5))})).Else((()=>{i.assign(xU(t.y.greaterThan(0),1,4))}))})),i})).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),Uj=Uk((e=>{let[t,n]=e;const i=Yk().toVar();return Vk(n.equal(0),(()=>{i.assign(Yk(t.z,t.y).div(qF(t.x)))})).ElseIf(n.equal(1),(()=>{i.assign(Yk(t.x.negate(),t.z.negate()).div(qF(t.y)))})).ElseIf(n.equal(2),(()=>{i.assign(Yk(t.x.negate(),t.y).div(qF(t.z)))})).ElseIf(n.equal(3),(()=>{i.assign(Yk(t.z.negate(),t.y).div(qF(t.x)))})).ElseIf(n.equal(4),(()=>{i.assign(Yk(t.x.negate(),t.z).div(qF(t.y)))})).Else((()=>{i.assign(Yk(t.x,t.y).div(qF(t.z)))})),JB(.5,i.add(1))})).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),zj=Uk((e=>{let[t]=e;const n=jk(0).toVar();return Vk(t.greaterThanEqual(Cj),(()=>{n.assign(Mj.sub(t).mul(Rj.sub(Ej)).div(Mj.sub(Cj)).add(Ej))})).ElseIf(t.greaterThanEqual(Pj),(()=>{n.assign(Cj.sub(t).mul(Nj.sub(Rj)).div(Cj.sub(Pj)).add(Rj))})).ElseIf(t.greaterThanEqual(Dj),(()=>{n.assign(Pj.sub(t).mul(Lj.sub(Nj)).div(Pj.sub(Dj)).add(Nj))})).ElseIf(t.greaterThanEqual(Ij),(()=>{n.assign(Dj.sub(t).mul(Oj.sub(Lj)).div(Dj.sub(Ij)).add(Lj))})).Else((()=>{n.assign(jk(-2).mul(CF(JB(1.16,t))))})),n})).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),qj=Uk((e=>{let[t,n]=e;const i=t.toVar();i.assign(JB(2,i).sub(1));const r=Jk(i,1).toVar();return Vk(n.equal(0),(()=>{r.assign(r.zyx)})).ElseIf(n.equal(1),(()=>{r.assign(r.xzy),r.xz.mulAssign(-1)})).ElseIf(n.equal(2),(()=>{r.x.mulAssign(-1)})).ElseIf(n.equal(3),(()=>{r.assign(r.zyx),r.xz.mulAssign(-1)})).ElseIf(n.equal(4),(()=>{r.assign(r.xzy),r.xy.mulAssign(-1)})).ElseIf(n.equal(5),(()=>{r.z.mulAssign(-1)})),r})).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),Vj=Uk((e=>{let[t,n,i,r,s,o]=e;const a=jk(i),l=Jk(n),c=fU(zj(a),Ej,o),u=IF(c),h=NF(c),d=Jk(Gj(t,l,h,r,s,o)).toVar();return Vk(u.notEqual(0),(()=>{const e=Jk(Gj(t,l,h.add(1),r,s,o)).toVar();d.assign(AU(d,e,u))})),d})),Gj=Uk((e=>{let[t,n,i,r,s,o]=e;const a=jk(i).toVar(),l=Jk(n),c=jk(Fj(l)).toVar(),u=jk(tU(kj.sub(a),0)).toVar();a.assign(tU(a,kj));const h=jk(MF(a)).toVar(),d=Yk(Uj(l,c).mul(h.sub(2)).add(1)).toVar();return Vk(c.greaterThan(2),(()=>{d.y.addAssign(h),c.subAssign(3)})),d.x.addAssign(c.mul(h)),d.x.addAssign(u.mul(JB(3,Bj))),d.y.addAssign(JB(4,MF(o).sub(h))),d.x.mulAssign(r),d.y.mulAssign(s),t.uv(d).grad(Yk(),Yk())})),jj=Uk((e=>{let{envMap:t,mipInt:n,outputDirection:i,theta:r,axis:s,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:l}=e;const c=kF(r),u=i.mul(c).add(s.cross(i).mul(OF(r))).add(s.mul(s.dot(i).mul(c.oneMinus())));return Gj(t,u,n,o,a,l)})),Hj=Uk((e=>{let{n:t,latitudinal:n,poleAxis:i,outputDirection:r,weights:s,samples:o,dTheta:a,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}=e;const p=Jk(xU(n,i,lU(i,r))).toVar();Vk(bF(p.equals(Jk(0))),(()=>{p.assign(Jk(r.z,0,r.x.negate()))})),p.assign(LF(p));const A=Jk().toVar();return A.addAssign(s.element(Hk(0)).mul(jj({theta:0,axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),yV({start:Hk(1),end:t},(e=>{let{i:t}=e;Vk(t.greaterThanEqual(o),(()=>{bV()}));const n=jk(a.mul(jk(t))).toVar();A.addAssign(s.element(t).mul(jj({theta:n.mul(-1),axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),A.addAssign(s.element(t).mul(jj({theta:n,axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d})))})),nB(A,1)}));let Wj=null;const Xj=new WeakMap;function Yj(e){let t=Xj.get(e);if((void 0!==t?t.pmremVersion:-1)!==e.pmremVersion){const n=e.image;if(e.isCubeTexture){if(!function(e){if(null===e||void 0===e)return!1;let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(n))return null;t=Wj.fromCubemap(e,t)}else{if(!function(e){return null!==e&&void 0!==e&&e.height>0}(n))return null;t=Wj.fromEquirectangular(e,t)}t.pmremVersion=e.pmremVersion,Xj.set(e,t)}return t.texture}class Qj extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const i=new RD;i.isRenderTargetTexture=!0,this._texture=az(i),this._width=mB(0),this._height=mB(0),this._maxMip=mB(0),this.updateBeforeType=qO}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=function(e){const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(){let e=this._pmrem;const t=e?e.pmremVersion:-1,n=this._value;t!==n.pmremVersion&&(e=!0===n.isPMREMTexture?n:Yj(n),null!==e&&(this._pmrem=e,this.updateFromTexture(e)))}setup(e){null===Wj&&(Wj=e.createPMREMGenerator()),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this));const n=this.value;e.renderer.coordinateSystem===KN&&!0!==n.isPMREMTexture&&!0===n.isRenderTargetTexture&&(t=Jk(t.x.negate(),t.yz));let i=this.levelNode;return null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),Vj(this._texture,t,i,this._width,this._height,this._maxMip)}}Qj.type=QO("PMREM",Qj);const Kj=Bk(Qj),Zj=new WeakMap;class Jj extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const e=n.isTextureNode?n.value:t[n.property];let i=Zj.get(e);void 0===i&&(i=Kj(e),Zj.set(e,i)),n=i}const i=t.envMap?nq("envMapIntensity","float",e.material):nq("environmentIntensity","float",e.scene),r=!0===t.useAnisotropy||t.anisotropy>0?hq:Uz,s=n.context($j(_B,r)).mul(i),o=n.context(eH(zz)).mul(Math.PI).mul(i),a=jU(s),l=jU(o);e.context.radiance.addAssign(a),e.context.iblIrradiance.addAssign(l);const c=e.context.lightingModel.clearcoatRadiance;if(c){const e=n.context($j(TB,qz)).mul(i),t=jU(e);c.addAssign(t)}}}Jj.type=QO("Environment",Jj);const $j=(e,t)=>{let n=null;return{getUV:()=>(null===n&&(n=Pz.negate().reflect(t),n=e.mul(e).mix(n,t).normalize(),n=n.transformDirection(Az)),n),getTextureLevel:()=>e}},eH=e=>({getUV:()=>e,getTextureLevel:()=>jk(1)}),tH=new _O;class nH extends nG{constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(tH),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new Jj(t):null}setupLightingModel(){return new Tj}setupSpecular(){const e=AU(Jk(.04),bB.rgb,wB);OB.assign(e),kB.assign(1)}setupVariants(){const e=this.metalnessNode?jk(this.metalnessNode):Dq;wB.assign(e);let t=this.roughnessNode?jk(this.roughnessNode):Nq;t=FG({roughness:t}),_B.assign(t),this.setupSpecular(),bB.assign(nB(bB.rgb.mul(e.oneMinus()),bB.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}nH.type=iG("MeshStandard",nH);const iH=new wO;class rH extends nH{constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(iH),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}get useAnisotropy(){return this.anisotropy>0||null!==this.anisotropyNode}get useTransmission(){return this.transmission>0||null!==this.transmissionNode}get useDispersion(){return this.dispersion>0||null!==this.dispersionNode}setupSpecular(){const e=this.iorNode?jk(this.iorNode):Wq;qB.assign(e),OB.assign(AU(eU(uU(qB.sub(1).div(qB.add(1))).mul(Cq),Jk(1)).mul(Eq),bB.rgb,wB)),kB.assign(AU(Eq,1,wB))}setupLightingModel(){return new Tj(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const e=this.clearcoatNode?jk(this.clearcoatNode):Iq,t=this.clearcoatRoughnessNode?jk(this.clearcoatRoughnessNode):Oq;SB.assign(e),TB.assign(FG({roughness:t}))}if(this.useSheen){const e=this.sheenNode?Jk(this.sheenNode):Fq,t=this.sheenRoughnessNode?jk(this.sheenRoughnessNode):Uq;MB.assign(e),EB.assign(t)}if(this.useIridescence){const e=this.iridescenceNode?jk(this.iridescenceNode):qq,t=this.iridescenceIORNode?jk(this.iridescenceIORNode):Vq,n=this.iridescenceThicknessNode?jk(this.iridescenceThicknessNode):Gq;CB.assign(e),RB.assign(t),PB.assign(n)}if(this.useAnisotropy){const e=(this.anisotropyNode?Yk(this.anisotropyNode):zq).toVar();DB.assign(e.length()),Vk(DB.equal(0),(()=>{e.assign(Yk(1,0))})).Else((()=>{e.divAssign(Yk(DB)),DB.assign(DB.saturate())})),NB.assign(DB.pow2().mix(_B.pow2(),1)),LB.assign(uq[0].mul(e.x).add(uq[1].mul(e.y))),IB.assign(uq[1].mul(e.x).sub(uq[0].mul(e.y)))}if(this.useTransmission){const e=this.transmissionNode?jk(this.transmissionNode):jq,t=this.thicknessNode?jk(this.thicknessNode):Hq,n=this.attenuationDistanceNode?jk(this.attenuationDistanceNode):Xq,i=this.attenuationColorNode?Jk(this.attenuationColorNode):Yq;if(VB.assign(e),GB.assign(t),jB.assign(n),HB.assign(i),this.useDispersion){const e=this.dispersionNode?jk(this.dispersionNode):tV;WB.assign(e)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Jk(this.clearcoatNormalNode):kq}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}rH.type=iG("MeshPhysical",rH);class sH extends Tj{constructor(e,t,n,i){super(e,t,n),this.useSSS=i}direct(e,t,n){let{lightDirection:i,lightColor:r,reflectedLight:s}=e;if(!0===this.useSSS){const e=n.material,{thicknessColorNode:t,thicknessDistortionNode:o,thicknessAmbientNode:a,thicknessAttenuationNode:l,thicknessPowerNode:c,thicknessScaleNode:u}=e,h=i.add(Uz.mul(o)).normalize(),d=jk(Pz.dot(h.negate()).saturate().pow(c).mul(u)),p=Jk(d.add(a).mul(t));s.directDiffuse.addAssign(p.mul(l.mul(r)))}super.direct({lightDirection:i,lightColor:r,reflectedLight:s},t,n)}}class oH extends rH{constructor(e){super(e),this.thicknessColorNode=null,this.thicknessDistortionNode=jk(.1),this.thicknessAmbientNode=jk(0),this.thicknessAttenuationNode=jk(.1),this.thicknessPowerNode=jk(2),this.thicknessScaleNode=jk(10)}get useSSS(){return null!==this.thicknessColorNode}setupLightingModel(){return new sH(this.useClearcoat,this.useSheen,this.useIridescence,this.useSSS)}copy(e){return this.thicknessColorNode=e.thicknessColorNode,this.thicknessDistortionNode=e.thicknessDistortionNode,this.thicknessAmbientNode=e.thicknessAmbientNode,this.thicknessAttenuationNode=e.thicknessAttenuationNode,this.thicknessPowerNode=e.thicknessPowerNode,this.thicknessScaleNode=e.thicknessScaleNode,super.copy(e)}}oH.type=iG("MeshSSS",oH);const aH=Uk((e=>{let{normal:t,lightDirection:n,builder:i}=e;const r=t.dot(n),s=Yk(r.mul(.5).add(.5),0);if(i.material.gradientMap){const e=sq("gradientMap","texture").context({getUV:()=>s});return Jk(e.r)}{const e=s.fwidth().mul(.5);return AU(Jk(.7),Jk(1),gU(jk(.7).sub(e.x),jk(.7).add(e.x),s.x))}}));class lH extends SG{direct(e,t,n){let{lightDirection:i,lightColor:r,reflectedLight:s}=e;const o=aH({normal:Lz,lightDirection:i,builder:n}).mul(r);s.directDiffuse.addAssign(o.mul(RG({diffuseColor:bB.rgb})))}indirect(e){let{ambientOcclusion:t,irradiance:n,reflectedLight:i}=e;i.indirectDiffuse.addAssign(n.mul(RG({diffuseColor:bB}))),i.indirectDiffuse.mulAssign(t)}}const cH=new TO;class uH extends nG{constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(cH),this.setValues(e)}setupLightingModel(){return new lH}}uH.type=iG("MeshToon",uH);class hH extends JO{constructor(){super("vec2")}setup(){const e=Jk(Pz.z,0,Pz.x.negate()).normalize(),t=Pz.cross(e);return Yk(e.dot(Uz),t.dot(Uz)).mul(.495).add(.5)}}hH.type=QO("MatcapUV",hH);const dH=Fk(hH),pH=new PO;class AH extends nG{constructor(e){super(),this.lights=!1,this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(pH),this.setValues(e)}setupVariants(e){const t=dH;let n;n=e.material.matcap?sq("matcap","texture").context({getUV:()=>t}):Jk(AU(.2,.8,t.y)),bB.rgb.mulAssign(n.rgb)}}AH.type=iG("MeshMatcap",AH);const fH=new mO;class mH extends nG{constructor(e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(fH),this.setValues(e)}copy(e){return this.sizeNode=e.sizeNode,super.copy(e)}}mH.type=iG("Points",mH);class gH extends JO{constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if("vec2"===this.getNodeType(e)){const e=t.cos(),i=t.sin();return oB(e,i,i.negate(),e).mul(n)}{const e=t,i=lB(nB(1,0,0,0),nB(0,kF(e.x),OF(e.x).negate(),0),nB(0,OF(e.x),kF(e.x),0),nB(0,0,0,1)),r=lB(nB(kF(e.y),0,OF(e.y),0),nB(0,1,0,0),nB(OF(e.y).negate(),0,kF(e.y),0),nB(0,0,0,1)),s=lB(nB(kF(e.z),OF(e.z).negate(),0,0),nB(OF(e.z),kF(e.z),0,0),nB(0,0,1,0),nB(0,0,0,1));return i.mul(r).mul(s).mul(nB(n,1)).xyz}}}gH.type=QO("Rotate",gH);const vH=Bk(gH),yH=new sO;class bH extends nG{constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(yH),this.setValues(e)}setupPosition(e){let{object:t,context:n}=e;const{positionNode:i,rotationNode:r,scaleNode:s}=this,o=Tz;let a=bz.mul(Jk(i||0)),l=Yk(_z[0].xyz.length(),_z[1].xyz.length());null!==s&&(l=l.mul(s));let c=o.xy;t.center&&!0===t.center.isVector2&&(c=c.sub(mB(t.center).sub(.5))),c=c.mul(l);const u=jk(r||Bq),h=vH(c,u);a=nB(a.xy.add(h),a.zw);const d=pz.mul(a);return n.vertex=o,d}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}}bH.type=iG("Sprite",bH);class xH extends SG{constructor(){super(),this.shadowNode=jk(1).toVar("shadowMask")}direct(e){let{shadowMask:t}=e;this.shadowNode.mulAssign(t)}finish(e){bB.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(bB.rgb)}}const _H=new bO;class wH extends nG{constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_H),this.setValues(e)}setupLightingModel(){return new xH}}wH.type=iG("Shadow",wH);const SH=Uk((e=>{let{texture:t,uv:n}=e;const i=1e-4,r=Jk().temp();return Vk(n.x.lessThan(i),(()=>{r.assign(Jk(1,0,0))})).ElseIf(n.y.lessThan(i),(()=>{r.assign(Jk(0,1,0))})).ElseIf(n.z.lessThan(i),(()=>{r.assign(Jk(0,0,1))})).ElseIf(n.x.greaterThan(.9999),(()=>{r.assign(Jk(-1,0,0))})).ElseIf(n.y.greaterThan(.9999),(()=>{r.assign(Jk(0,-1,0))})).ElseIf(n.z.greaterThan(.9999),(()=>{r.assign(Jk(0,0,-1))})).Else((()=>{const e=.01,i=t.uv(n.add(Jk(-.01,0,0))).r.sub(t.uv(n.add(Jk(e,0,0))).r),s=t.uv(n.add(Jk(0,-.01,0))).r.sub(t.uv(n.add(Jk(0,e,0))).r),o=t.uv(n.add(Jk(0,0,-.01))).r.sub(t.uv(n.add(Jk(0,0,e))).r);r.assign(Jk(i,s,o))})),r.normalize()}));class TH extends oz{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Jk(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){return t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return SH({texture:this,uv:e})}}TH.type=QO("Texture3D",TH);const MH=Bk(TH);class EH extends nG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.lights=!1,this.isVolumeNodeMaterial=!0,this.testNode=null,this.setValues(e)}setup(e){const t=MH(this.map,null,0),n=Uk((e=>{let{orig:t,dir:n}=e;const i=Jk(-.5),r=Jk(.5),s=n.reciprocal(),o=i.sub(t).mul(s),a=r.sub(t).mul(s),l=eU(o,a),c=tU(o,a),u=tU(l.x,tU(l.y,l.z)),h=eU(c.x,eU(c.y,c.z));return Yk(u,h)}));this.fragmentNode=Uk((()=>{const e=EU(Jk(wz.mul(nB(fz,1)))),i=EU(Sz.sub(e)).normalize(),r=vB("vec2","bounds").assign(n({orig:e,dir:i}));r.x.greaterThan(r.y).discard(),r.assign(Yk(tU(r.x,0),r.y));const s=vB("vec3","p").assign(e.add(r.x.mul(i))),o=vB("vec3","inc").assign(Jk(i.abs().reciprocal())),a=vB("float","delta").assign(eU(o.x,eU(o.y,o.z)));a.divAssign(sq("steps","float"));const l=vB("vec4","ac").assign(nB(sq("base","color"),0));return yV({type:"float",start:r.x,end:r.y,update:"+= delta"},(()=>{const e=vB("float","d").assign(t.uv(s.add(.5)).r);null!==this.testNode?this.testNode({map:t,mapValue:e,probe:s,finalColor:l}).append():(l.a.assign(1),bV()),s.addAssign(i.mul(a))})),l.a.equal(0).discard(),nB(l)}))(),super.setup(e)}}function CH(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function RH(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}EH.type=iG("Volume",EH);class PH{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NH extends PH{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:RN,endingEnd:RN}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case PN:r=e,o=2*t-n;break;case NN:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case PN:s=e,a=2*n-t;break;case NN:s=1,a=n+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),A=p*p,f=A*p,m=-h*f+2*h*A-h*p,g=(1+h)*f+(-1.5-2*h)*A+(-.5+h)*p+1,v=(-1-d)*f+(1.5+d)*A+.5*p,y=d*f-d*A;for(let b=0;b!==o;++b)r[b]=m*s[c+b]+g*s[l+b]+v*s[a+b]+y*s[u+b];return r}}class DH extends PH{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),u=1-c;for(let h=0;h!==o;++h)r[h]=s[l+h]*u+s[a+h]*c;return r}}class LH extends PH{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class IH{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=CH(t,this.TimeBufferType),this.values=CH(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:CH(e.times,Array),values:CH(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new LH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new DH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new NH(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case MN:t=this.InterpolantFactoryMethodDiscrete;break;case EN:t=this.InterpolantFactoryMethodLinear;break;case CN:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return MN;case this.InterpolantFactoryMethodLinear:return EN;case this.InterpolantFactoryMethodSmooth:return CN}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const t=n[o];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,s),e=!1;break}s=t}if(void 0!==i&&RH(i))for(let o=0,a=i.length;o!==a;++o){const t=i[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===CN,r=e.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)r=!0;else{const e=o*n,i=e-n,s=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[s+o]){r=!0;break}}}if(r){if(o!==s){e[s]=e[o];const i=o*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,o=0;o!==n;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}IH.prototype.TimeBufferType=Float32Array,IH.prototype.ValueBufferType=Float32Array,IH.prototype.DefaultInterpolation=EN;class OH extends IH{constructor(e,t,n){super(e,t,n)}}OH.prototype.ValueTypeName="bool",OH.prototype.ValueBufferType=Array,OH.prototype.DefaultInterpolation=MN,OH.prototype.InterpolantFactoryMethodLinear=void 0,OH.prototype.InterpolantFactoryMethodSmooth=void 0;class kH extends IH{}kH.prototype.ValueTypeName="color";class BH extends IH{}BH.prototype.ValueTypeName="number";class FH extends PH{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let c=l+o;l!==c;l+=4)ID.slerpFlat(r,0,s,l-o,s,l,a);return r}}class UH extends IH{InterpolantFactoryMethodLinear(e){return new FH(this.times,this.values,this.getValueSize(),e)}}UH.prototype.ValueTypeName="quaternion",UH.prototype.InterpolantFactoryMethodSmooth=void 0;class zH extends IH{constructor(e,t,n){super(e,t,n)}}zH.prototype.ValueTypeName="string",zH.prototype.ValueBufferType=Array,zH.prototype.DefaultInterpolation=MN,zH.prototype.InterpolantFactoryMethodLinear=void 0,zH.prototype.InterpolantFactoryMethodSmooth=void 0;class qH extends IH{}qH.prototype.ValueTypeName="vector";const VH={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class GH{constructor(e,t,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const jH=new GH;class HH{constructor(e){this.manager=void 0!==e?e:jH,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}HH.DEFAULT_MATERIAL_NAME="__DEFAULT";const WH={};class XH extends Error{constructor(e,t){super(e),this.response=t}}class YH extends HH{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=VH.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==WH[e])return void WH[e].push({onLoad:t,onProgress:n,onError:i});WH[e]=[],WH[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=WH[e],i=t.body.getReader(),r=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=r?parseInt(r):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{a+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}),(t=>{e.error(t)}))}()}});return new Response(l)}throw new XH('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{VH.add(e,t);const n=WH[e];delete WH[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=WH[e];if(void 0===n)throw this.manager.itemError(e),t;delete WH[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class QH extends FL{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new eI(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class KH extends QH{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(FL.DEFAULT_UP),this.updateMatrix(),this.groundColor=new eI(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const ZH=new hL,JH=new OD,$H=new OD;class eW{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new uD(512,512),this.map=null,this.mapPass=null,this.matrix=new hL,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new AO,this._frameExtents=new uD(1,1),this._viewportCount=1,this._viewports=[new PD(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;JH.setFromMatrixPosition(e.matrixWorld),t.position.copy(JH),$H.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($H),t.updateMatrixWorld(),ZH.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZH),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(ZH)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class tW extends eW{constructor(){super(new KI(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*nD*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class nW extends QH{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(FL.DEFAULT_UP),this.updateMatrix(),this.target=new FL,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new tW}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const iW=new hL,rW=new OD,sW=new OD;class oW extends eW{constructor(){super(new KI(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new uD(4,2),this._viewportCount=6,this._viewports=[new PD(2,1,1,1),new PD(0,1,1,1),new PD(3,1,1,1),new PD(1,1,1,1),new PD(3,0,1,1),new PD(1,0,1,1)],this._cubeDirections=[new OD(1,0,0),new OD(-1,0,0),new OD(0,0,1),new OD(0,0,-1),new OD(0,1,0),new OD(0,-1,0)],this._cubeUps=[new OD(0,1,0),new OD(0,1,0),new OD(0,1,0),new OD(0,1,0),new OD(0,0,1),new OD(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),rW.setFromMatrixPosition(e.matrixWorld),n.position.copy(rW),sW.copy(n.position),sW.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(sW),n.updateMatrixWorld(),i.makeTranslation(-rW.x,-rW.y,-rW.z),iW.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iW)}}class aW extends QH{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new oW}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class lW extends WI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class cW extends eW{constructor(){super(new lW(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class uW extends QH{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(FL.DEFAULT_UP),this.updateMatrix(),this.target=new FL,this.shadow=new cW}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class hW extends QH{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class dW extends QH{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class pW{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new OD)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class AW extends QH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pW;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class fW extends HH{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new YH(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=fW.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new eI).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(i.dispersion=e.dispersion),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new eI).setHex(t.value);break;case"v2":i.uniforms[r].value=(new uD).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new OD).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new PD).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new hD).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new hL).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new uD).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapRotation&&i.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new uD).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:bO,SpriteMaterial:sO,RawShaderMaterial:xO,ShaderMaterial:HI,PointsMaterial:mO,MeshPhysicalMaterial:wO,MeshStandardMaterial:_O,MeshPhongMaterial:SO,MeshToonMaterial:TO,MeshNormalMaterial:MO,MeshLambertMaterial:EO,MeshDepthMaterial:CO,MeshDistanceMaterial:RO,MeshBasicMaterial:rI,MeshMatcapMaterial:PO,LineDashedMaterial:NO,LineBasicMaterial:fO,Material:iI}[e]}}const mW=new hL,gW=new hL,vW=new hL;class yW{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new KI,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new KI,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,vW.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(tD*t.fov*.5)/t.zoom;let s,o;gW.elements[12]=-n,mW.elements[12]=n,s=-r*t.aspect+i,o=r*t.aspect+i,vW.elements[0]=2*t.near/(o-s),vW.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(vW),s=-r*t.aspect-i,o=r*t.aspect-i,vW.elements[0]=2*t.near/(o-s),vW.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(vW)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(gW),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(mW)}}const bW="\\[\\]\\.:\\/",xW=new RegExp("["+bW+"]","g"),_W="[^"+bW+"]",wW="[^"+bW.replace("\\.","")+"]",SW=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",_W)+/(WCOD+)?/.source.replace("WCOD",wW)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_W)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_W)+"$"),TW=["material","materials","bones","map"];class MW{constructor(e,t,n){this.path=t,this.parsedPath=n||MW.parseTrackName(t),this.node=MW.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new MW.Composite(e,t,n):new MW(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(xW,"")}static parseTrackName(e){const t=SW.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==TW.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=MW.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}MW.Composite=class{constructor(e,t,n){const i=n||MW.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},MW.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},MW.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},MW.prototype.GetterByBindingType=[MW.prototype._getValue_direct,MW.prototype._getValue_array,MW.prototype._getValue_arrayElement,MW.prototype._getValue_toArray],MW.prototype.SetterByBindingTypeAndVersioning=[[MW.prototype._setValue_direct,MW.prototype._setValue_direct_setNeedsUpdate,MW.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[MW.prototype._setValue_array,MW.prototype._setValue_array_setNeedsUpdate,MW.prototype._setValue_array_setMatrixWorldNeedsUpdate],[MW.prototype._setValue_arrayElement,MW.prototype._setValue_arrayElement_setNeedsUpdate,MW.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[MW.prototype._setValue_fromArray,MW.prototype._setValue_fromArray_setNeedsUpdate,MW.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class EW{constructor(e,t){this.nodes=e,this.info=t,this.animationLoop=null,this.requestId=null,this._init()}_init(){const e=(t,n)=>{this.requestId=self.requestAnimationFrame(e),!0===this.info.autoReset&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,null!==this.animationLoop&&this.animationLoop(t,n)};e()}dispose(){self.cancelAnimationFrame(this.requestId),this.requestId=null}setAnimationLoop(e){this.animationLoop=e}}class CW{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let i=0;i<e.length;i++){const t=e[i];!1===n.has(t)&&n.set(t,new WeakMap),n=n.get(t)}return n.set(e[e.length-1],t)}delete(e){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return!1;return t.delete(e[e.length-1])}}const RW=new hO;class PW{constructor(){this.version=0,this.globalClippingCount=0,this.localClippingCount=0,this.localClippingEnabled=!1,this.localClipIntersection=!1,this.planes=[],this.parentVersion=0,this.viewNormalMatrix=new hD,this.cacheKey=""}projectPlanes(e,t){const n=e.length,i=this.planes;for(let r=0;r<n;r++){RW.copy(e[r]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const n=i[t+r],s=RW.normal;n.x=-s.x,n.y=-s.y,n.z=-s.z,n.w=RW.constant}}updateGlobal(e,t){const n=e.clippingPlanes;this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix);let i=!1;if(Array.isArray(n)&&0!==n.length){const e=n.length;if(e!==this.globalClippingCount){const t=[];for(let n=0;n<e;n++)t.push(new PD);this.globalClippingCount=e,this.planes=t,i=!0}this.projectPlanes(n,0)}else 0!==this.globalClippingCount&&(this.globalClippingCount=0,this.planes=[],i=!0);e.localClippingEnabled!==this.localClippingEnabled&&(this.localClippingEnabled=e.localClippingEnabled,i=!0),i&&(this.version++,this.cacheKey="".concat(this.globalClippingCount,":").concat(void 0!==this.localClippingEnabled&&this.localClippingEnabled,":"))}update(e,t){let n=!1;if(this!==e&&e.version!==this.parentVersion&&(this.globalClippingCount=t.isShadowNodeMaterial?0:e.globalClippingCount,this.localClippingEnabled=e.localClippingEnabled,this.planes=Array.from(e.planes),this.parentVersion=e.version,this.viewMatrix=e.viewMatrix,this.viewNormalMatrix=e.viewNormalMatrix,n=!0),this.localClippingEnabled){const e=t.clippingPlanes;if(Array.isArray(e)&&0!==e.length){const t=e.length,i=this.planes,r=this.globalClippingCount;if(n||t!==this.localClippingCount){i.length=r+t;for(let e=0;e<t;e++)i[r+e]=new PD;this.localClippingCount=t,n=!0}this.projectPlanes(e,r)}else 0!==this.localClippingCount&&(this.localClippingCount=0,n=!0);this.localClipIntersection!==t.clipIntersection&&(this.localClipIntersection=t.clipIntersection,n=!0)}n&&(this.version+=e.version,this.cacheKey=e.cacheKey+":".concat(this.localClippingCount,":").concat(void 0!==this.localClipIntersection&&this.localClipIntersection))}}let NW=0;class DW{constructor(e,t,n,i,r,s,o,a,l){this._nodes=e,this._geometries=t,this.id=NW++,this.renderer=n,this.object=i,this.material=r,this.scene=s,this.camera=o,this.lightsNode=a,this.context=l,this.geometry=i.geometry,this.version=r.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.vertexBuffers=null,this.updateClipping(l.clippingContext),this.clippingContextVersion=this.clippingContext.version,this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){const t=this.material;let n=this.clippingContext;Array.isArray(t.clippingPlanes)?(n!==e&&n||(n=new PW,this.clippingContext=n),n.update(e,t)):this.clippingContext!==e&&(this.clippingContext=e)}get clippingNeedsUpdate(){return this.clippingContext.version!==this.clippingContextVersion&&(this.clippingContextVersion=this.clippingContext.version,!0)}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getIndex(){return this._geometries.getIndex(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}getAttributes(){if(null!==this.attributes)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],i=new Set;for(const r of e){const e=r.node&&r.node.attribute?r.node.attribute:t.getAttribute(r.name);if(void 0===e)continue;n.push(e);const s=e.isInterleavedBufferAttribute?e.data:e;i.add(s)}return this.attributes=n,this.vertexBuffers=Array.from(i.values()),n}getVertexBuffers(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const i of function(e){const t=Object.keys(e);let n=Object.getPrototypeOf(e);for(;n;){const e=Object.getOwnPropertyDescriptors(n);for(const n in e)if(void 0!==e[n]){const i=e[n];i&&"function"===typeof i.get&&t.push(n)}n=Object.getPrototypeOf(n)}return t}(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(i))continue;const e=t[i];let r;if(null!==e){const t=typeof e;"number"===t?r=0!==e?"1":"0":"object"===t?(r="{",e.isTexture&&(r+=e.mapping),r+="}"):r=String(e)}else r=String(e);n+=r+","}return n+=this.clippingContext.cacheKey+",",e.skeleton&&(n+=e.skeleton.bones.length+","),e.morphTargetInfluences&&(n+=e.morphTargetInfluences.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",null!==e._colorsTexture&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.count+","+e.uuid+","),n}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){return this.object.receiveShadow+","+this._nodes.getCacheKey(this.scene,this.lightsNode)}getCacheKey(){return this.getMaterialCacheKey()+","+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}class LW{constructor(e,t,n,i,r,s){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=i,this.bindings=r,this.info=s,this.chainMaps={}}get(e,t,n,i,r,s,o){const a=this.getChainMap(o),l=[e,t,s,r];let c=a.get(l);return void 0===c?(c=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,i,r,s,o),a.set(l,c)):(c.updateClipping(s.clippingContext),(c.version!==t.version||c.needsUpdate)&&(c.initialCacheKey!==c.getCacheKey()?(c.dispose(),c=this.get(e,t,n,i,r,s,o)):c.version=t.version)),c}getChainMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.chainMaps[e]||(this.chainMaps[e]=new CW)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,i,r,s,o,a,l,c){const u=this.getChainMap(c),h=new DW(e,t,n,i,r,s,o,a,l);return h.onDispose=()=>{this.pipelines.delete(h),this.bindings.delete(h),this.nodes.delete(h),u.delete(h.getChainArray())},h}}class IW{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}delete(e){let t;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const OW=1,kW=2,BW=4,FW=16;class UW extends IW{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return void 0!==t&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(void 0===n.version)t===OW?this.backend.createAttribute(e):t===kW?this.backend.createIndexAttribute(e):t===BW&&this.backend.createStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const t=this._getBufferAttribute(e);(n.version<t.version||t.usage===QN)&&(this.backend.updateAttribute(e),n.version=t.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function zW(e){return null!==e.index?e.index.version:e.attributes.position.version}function qW(e){const t=[],n=e.index,i=e.attributes.position;if(null!==n){const e=n.array;for(let n=0,i=e.length;n<i;n+=3){const i=e[n+0],r=e[n+1],s=e[n+2];t.push(i,r,r,s,s,i)}}else{for(let e=0,n=i.array.length/3-1;e<n;e+=3){const n=e+0,i=e+1,r=e+2;t.push(n,i,i,r,r,n)}}const r=new(function(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}(t)?pI:dI)(t,1);return r.version=zW(e),r}class VW extends IW{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&!0===this.get(t).initialized}updateForRender(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry;this.get(t).initialized=!0,this.info.memory.geometries++;const n=()=>{this.info.memory.geometries--;const i=t.index,r=e.getAttributes();null!==i&&this.attributes.delete(i);for(const e of r)this.attributes.delete(e);const s=this.wireframes.get(t);void 0!==s&&this.attributes.delete(s),t.removeEventListener("dispose",n)};t.addEventListener("dispose",n)}updateAttributes(e){const t=e.getAttributes();for(const i of t)i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute?this.updateAttribute(i,BW):this.updateAttribute(i,OW);const n=this.getIndex(e);null!==n&&this.updateAttribute(n,kW)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndex(e){const{geometry:t,material:n}=e;let i=t.index;if(!0===n.wireframe){const e=this.wireframes;let n=e.get(t);void 0===n?(n=qW(t),e.set(t,n)):n.version!==zW(t)&&(this.attributes.delete(n),n=qW(t),e.set(t,n)),i=n}return i}}class GW{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.compute={calls:0,frameCalls:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}updateTimestamp(e,t){0===this[e].timestampCalls&&(this[e].timestamp=0),this[e].timestamp+=t,this[e].timestampCalls++,this[e].timestampCalls>=this[e].previousFrameCalls&&(this[e].timestampCalls=0)}reset(){const e=this.render.frameCalls;this.render.previousFrameCalls=e;const t=this.compute.frameCalls;this.compute.previousFrameCalls=t,this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class jW{constructor(e){this.cacheKey=e,this.usedTimes=0}}class HW extends jW{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class WW extends jW{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let XW=0;class YW{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.id=XW++,this.code=e,this.stage=t,this.transforms=n,this.attributes=i,this.usedTimes=0}}class QW extends IW{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,i=this.get(e);if(this._needsComputeUpdate(e)){const r=i.pipeline;r&&(r.usedTimes--,r.computeProgram.usedTimes--);const s=this.nodes.getForCompute(e);let o=this.programs.compute.get(s.computeShader);void 0===o&&(r&&0===r.computeProgram.usedTimes&&this._releaseProgram(r.computeProgram),o=new YW(s.computeShader,"compute",s.transforms,s.nodeAttributes),this.programs.compute.set(s.computeShader,o),n.createProgram(o));const a=this._getComputeCacheKey(e,o);let l=this.caches.get(a);void 0===l&&(r&&0===r.usedTimes&&this._releasePipeline(r),l=this._getComputePipeline(e,o,a,t)),l.usedTimes++,o.usedTimes++,i.version=e.version,i.pipeline=l}return i.pipeline}getForRender(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{backend:n}=this,i=this.get(e);if(this._needsRenderUpdate(e)){const r=i.pipeline;r&&(r.usedTimes--,r.vertexProgram.usedTimes--,r.fragmentProgram.usedTimes--);const s=e.getNodeBuilderState();let o=this.programs.vertex.get(s.vertexShader);void 0===o&&(r&&0===r.vertexProgram.usedTimes&&this._releaseProgram(r.vertexProgram),o=new YW(s.vertexShader,"vertex"),this.programs.vertex.set(s.vertexShader,o),n.createProgram(o));let a=this.programs.fragment.get(s.fragmentShader);void 0===a&&(r&&0===r.fragmentProgram.usedTimes&&this._releaseProgram(r.fragmentProgram),a=new YW(s.fragmentShader,"fragment"),this.programs.fragment.set(s.fragmentShader,a),n.createProgram(a));const l=this._getRenderCacheKey(e,o,a);let c=this.caches.get(l);void 0===c?(r&&0===r.usedTimes&&this._releasePipeline(r),c=this._getRenderPipeline(e,o,a,l,t)):e.pipeline=c,c.usedTimes++,o.usedTimes++,a.usedTimes++,i.pipeline=c}return i.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,i){n=n||this._getComputeCacheKey(e,t);let r=this.caches.get(n);return void 0===r&&(r=new WW(n,t),this.caches.set(n,r),this.backend.createComputePipeline(r,i)),r}_getRenderPipeline(e,t,n,i,r){i=i||this._getRenderCacheKey(e,t,n);let s=this.caches.get(i);return void 0===s&&(s=new HW(i,t,n),this.caches.set(i,s),e.pipeline=s,this.backend.createRenderPipeline(e,r)),s}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return void 0===t.pipeline||t.version!==e.version}_needsRenderUpdate(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}}class KW extends IW{constructor(e,t,n,i,r,s){super(),this.backend=e,this.textures=n,this.pipelines=r,this.attributes=i,this.nodes=t,this.info=s,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const e=this.get(n);void 0===e.bindGroup&&(this._init(n),this.backend.createBindings(n,t),e.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const e=this.get(n);void 0===e.bindGroup&&(this._init(n),this.backend.createBindings(n,t),e.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const e=t.attribute;this.attributes.update(e,BW)}}_update(e,t){const{backend:n}=this;let i=!1;for(const r of e.bindings){if(r.isNodeUniformsGroup){if(!this.nodes.updateGroup(r))continue}if(r.isUniformBuffer){r.update()&&n.updateBinding(r)}else if(r.isSampler)r.update();else if(r.isSampledTexture){r.needsBindingsUpdate(this.textures.get(r.texture).generation)&&(i=!0);const e=r.update(),t=r.texture;e&&this.textures.updateTexture(t);const s=n.get(t);if(!0===n.isWebGPUBackend&&void 0===s.texture&&void 0===s.externalTexture&&(console.error("Bindings._update: binding should be available:",r,e,t,r.textureNode.value,i),this.textures.updateTexture(t),i=!0),!0===t.isStorageTexture){const e=this.get(t);!0===r.store?e.needsMipmap=!0:!0===t.generateMipmaps&&this.textures.needsMipmaps(t)&&!0===e.needsMipmap&&(this.backend.generateMipmaps(t),e.needsMipmap=!1)}}}!0===i&&this.backend.updateBindings(e,t)}}class ZW{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class JW{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class $W{constructor(e,t){this.isNodeVar=!0,this.name=e,this.type=t}}class eX extends $W{constructor(e,t){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0}}class tX{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let nX=0;class iX{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.id=nX++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class rX extends gB{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}rX.type=QO("Parameter",rX);class sX extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";super("code"),this.isCodeNode=!0,this.code=e,this.language=n,this.includes=t}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const i of t)i.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}sX.type=QO("Code",sX);class oX extends sX{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return void 0===n&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),i=n.name,r=n.type,s=e.getCodeFromNode(this,r);""!==i&&(s.name=i);const o=e.getPropertyName(s),a=this.getNodeFunction(e).getCode(o);return s.code=a+"\n","property"===t?o:e.format("".concat(o,"()"),r,t)}}oX.type=QO("Function",oX);class aX{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class lX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class cX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new uD),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class uX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new OD),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class hX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PD),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class dX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eI),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class pX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hD),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class AX extends aX{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hL),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class fX extends lX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class mX extends cX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class gX extends uX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class vX extends hX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class yX extends dX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class bX extends pX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class xX extends AX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class _X extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new Lk(t);return this._currentCond=xU(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new Lk(t),i=xU(e,n);return this._currentCond.elseNode=i,this._currentCond=i,this}Else(e){return this._currentCond.elseNode=new Lk(e),this}build(e){const t=qk();zk(this);for(const s of this.nodes)s.build(e,"void");zk(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.outputNode?this.outputNode.build(e,...i):super.build(e,...i)}else(){return console.warn("TSL.StackNode: .else() has been renamed to .Else()."),this.Else(...arguments)}elseif(){return console.warn("TSL.StackNode: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...arguments)}}_X.type=QO("Stack",_X);const wX=Bk(_X),SX=[.125,.215,.35,.446,.526,.582],TX=20,MX=new lW(-1,1,1,-1,0,1),EX=new KI(90,1),CX=new eI;let RX=null,PX=0,NX=0;const DX=(1+Math.sqrt(5))/2,LX=1/DX,IX=[new OD(-DX,LX,0),new OD(DX,LX,0),new OD(-LX,0,DX),new OD(LX,0,DX),new OD(0,DX,-LX),new OD(0,DX,LX),new OD(-1,1,-1),new OD(1,1,-1),new OD(-1,1,1),new OD(1,1,1)],OX=[3,1,5,0,4,2],kX=qj(tz(),ez("faceIndex")).normalize(),BX=Jk(kX.x,kX.y.negate(),kX.z);class FX{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;RX=this._renderer.getRenderTarget(),PX=this._renderer.getActiveCubeFace(),NX=this._renderer.getActiveMipmapLevel(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=VX(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=GX(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(RX,PX,NX),e.scissorTest=!1,zX(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===CP||e.mapping===RP?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),RX=this._renderer.getRenderTarget(),PX=this._renderer.getActiveCubeFace(),NX=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:FP,minFilter:FP,generateMipmaps:!1,type:YP,format:ZP,colorSpace:LN},i=UX(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=UX(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=function(e){const t=[],n=[],i=[],r=[];let s=e;const o=e-4+1+SX.length;for(let a=0;a<o;a++){const o=Math.pow(2,s);n.push(o);let l=1/o;a>e-4?l=SX[a-e+4-1]:0===a&&(l=0),i.push(l);const c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,A=6,f=3,m=2,g=1,v=new Float32Array(f*A*p),y=new Float32Array(m*A*p),b=new Float32Array(g*A*p);for(let e=0;e<p;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0],r=OX[e];v.set(i,f*A*r),y.set(d,m*A*r);const s=[r,r,r,r,r,r];b.set(s,g*A*r)}const x=new wI;x.setAttribute("position",new hI(v,f)),x.setAttribute("uv",new hI(y,m)),x.setAttribute("faceIndex",new hI(b,g)),t.push(x),r.push(new qI(x,null)),s>4&&s--}return{lodPlanes:t,sizeLods:n,sigmas:i,lodMeshes:r}}(i)),this._blurMaterial=function(e,t,n){const i=$z(new Array(TX).fill(0)),r=mB(new OD(0,1,0)),s=mB(0),o=jk(TX),a=mB(0),l=mB(1),c=az(null),u=mB(0),h=jk(1/t),d=jk(1/n),p=jk(e),A={n:o,latitudinal:a,weights:i,poleAxis:r,outputDirection:BX,dTheta:s,samples:l,envMap:c,mipInt:u,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p},f=qX("blur");return f.uniforms=A,f.fragmentNode=Hj(M(M({},A),{},{latitudinal:a.equal(1)})),f}(i,e,t)}return i}_compileMaterial(e){const t=this._lodMeshes[0];t.material=e,this._renderer.compile(t,MX)}_sceneToCubeUV(e,t,n,i){const r=EX;r.near=t,r.far=n;const s=[-1,1,-1,-1,-1,-1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear;a.getClearColor(CX),a.autoClear=!1;let c=this._backgroundBox;if(null===c){const e=new rI({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});c=new qI(new GI,e)}let u=!1;const h=e.background;h?h.isColor&&(c.material.color.copy(h),e.background=null,u=!0):(c.material.color.copy(CX),u=!0),a.setRenderTarget(i),a.clear(),u&&a.render(c,r);for(let d=0;d<6;d++){const t=d%3;0===t?(r.up.set(0,s[d],0),r.lookAt(o[d],0,0)):1===t?(r.up.set(0,0,s[d]),r.lookAt(0,o[d],0)):(r.up.set(0,s[d],0),r.lookAt(0,0,o[d]));const n=this._cubeSize;zX(i,t*n,d>2?n:0,n,n),a.render(e,r)}a.autoClear=l,e.background=h}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===CP||e.mapping===RP;i?null===this._cubemapMaterial&&(this._cubemapMaterial=VX(e)):null===this._equirectMaterial&&(this._equirectMaterial=GX(e));const r=i?this._cubemapMaterial:this._equirectMaterial;r.fragmentNode.value=e;const s=this._lodMeshes[0];s.material=r;const o=this._cubeSize;zX(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(s,MX)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=IX[(i-r-1)%IX.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[i];c.material=l;const u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,A=isFinite(r)?1+Math.floor(3*p):TX;A>TX&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(A," samples when the maximum is set to ").concat(TX));const f=[];let m=0;for(let y=0;y<TX;++y){const e=y/p,t=Math.exp(-e*e/2);f.push(t),0===y?m+=t:y<A&&(m+=2*t)}for(let y=0;y<f.length;y++)f[y]=f[y]/m;e.texture.frame=(e.texture.frame||0)+1,u.envMap.value=e.texture,u.samples.value=A,u.weights.array=f,u.latitudinal.value="latitudinal"===s?1:0,o&&(u.poleAxis.value=o);const{_lodMax:g}=this;u.dTheta.value=d,u.mipInt.value=g-n;const v=this._sizeLods[i];zX(t,3*v*(i>g-4?i-g+4:0),4*(this._cubeSize-v),3*v,2*v),a.setRenderTarget(t),a.render(c,MX)}}function UX(e,t,n){const i=new ND(e,t,n);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function zX(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function qX(e){const t=new nG;return t.depthTest=!1,t.depthWrite=!1,t.blending=0,t.name="PMREM_".concat(e),t}function VX(e){const t=qX("cubemap");return t.fragmentNode=Yz(e,BX),t}function GX(e){const t=qX("equirect");return t.fragmentNode=az(e,fG(BX),0),t}let jX=0;class HX{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.name=e,this.bindings=t,this.index=n,this.bindingsReference=i,this.id=jX++}}const WX=new WeakMap,XX=new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),YX=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),QX=e=>(e=Number(e))+(e%1?"":".0");class KX{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.flow={code:""},this.chaining=[],this.stack=wX(),this.stacks=[],this.tab="\t",this.instanceBindGroups=!0,this.currentFunctionNode=null,this.context={material:this.material},this.cache=new iX,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.useComparisonMethod=!1}getBindGroupsCache(){let e=WX.get(this.renderer);return void 0===e&&(e=new CW,WX.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new ND(e,t,n)}createCubeRenderTarget(e,t){return new mG(e,t)}createPMREMGenerator(){return new FX(this.renderer)}includes(e){return this.nodes.includes(e)}_getBindGroup(e,t){const n=this.getBindGroupsCache(),i=[];let r,s=!0;for(const o of t)i.push(o),s=s&&!0!==o.groupNode.shared;return s?(r=n.get(i),void 0===r&&(r=new HX(e,i,this.bindingsIndexes[e].group,i),n.set(i,r))):r=new HX(e,i,this.bindingsIndexes[e].group,i),r}getBindGroupArray(e,t){const n=this.bindings[t];let i=n[e];return void 0===i&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=i=[]),i}getBindings(){let e=this.bindGroups;if(null===e){const t={},n=this.bindings;for(const e of jO)for(const i in n[e]){const r=n[e][i];(t[i]||(t[i]=[])).push(...r)}e=[];for(const i in t){const n=t[i],r=this._getBindGroup(i,n);e.push(r)}this.bindGroups=e}return e}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}buildUpdateNodes(){for(const e of this.nodes){const t=e.getUpdateType(),n=e.getUpdateBeforeType(),i=e.getUpdateAfterType();t!==UO&&this.updateNodes.push(e.getSelf()),n!==UO&&this.updateBeforeNodes.push(e),i!==UO&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===FP||e.magFilter===UP||e.magFilter===BP||e.magFilter===zP||e.minFilter===FP||e.minFilter===UP||e.minFilter===BP||e.minFilter===zP}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return M({},this.context),this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getDataFromNode(e);return void 0===n.cache&&(n.cache=new iX(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateConst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t&&("float"===e||"int"===e||"uint"===e?t=0:"bool"===e?t=!1:"color"===e?t=new eI:"vec2"===e?t=new uD:"vec3"===e?t=new OD:"vec4"===e&&(t=new PD)),"float"===e)return QX(t);if("int"===e)return"".concat(Math.round(t));if("uint"===e)return t>=0?"".concat(Math.round(t),"u"):"0u";if("bool"===e)return t?"true":"false";if("color"===e)return"".concat(this.getType("vec3"),"( ").concat(QX(t.r),", ").concat(QX(t.g),", ").concat(QX(t.b)," )");const n=this.getTypeLength(e),i=this.getComponentType(e),r=e=>this.generateConst(i,e);if(2===n)return"".concat(this.getType(e),"( ").concat(r(t.x),", ").concat(r(t.y)," )");if(3===n)return"".concat(this.getType(e),"( ").concat(r(t.x),", ").concat(r(t.y),", ").concat(r(t.z)," )");if(4===n)return"".concat(this.getType(e),"( ").concat(r(t.x),", ").concat(r(t.y),", ").concat(r(t.z),", ").concat(r(t.w)," )");if(n>4&&t&&(t.isMatrix3||t.isMatrix4))return"".concat(this.getType(e),"( ").concat(t.elements.map(r).join(", ")," )");if(n>4)return"".concat(this.getType(e),"()");throw new Error("NodeBuilder: Type '".concat(e,"' not found in generate constant attempt."))}getType(e){return"color"===e?"vec3":e}hasGeometryAttribute(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}getAttribute(e,t){const n=this.attributes;for(const r of n)if(r.name===e)return r;const i=new ZW(e,t);return n.push(i),i}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return"void"===e||"property"===e||"sampler"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===HP)return"int";if(t===WP)return"uint"}return"float"}getElementType(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}getComponentType(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}getVectorType(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}getTypeFromLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";if(1===e)return t;const n=XX.get(e);return("float"===t?"":t[0])+n}getTypeFromArray(e){return YX.get(e.constructor)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,i=e.itemSize,r=e.normalized;let s;return e instanceof AI||!0===r||(s=this.getTypeFromArray(n)),this.getTypeFromLength(i,s)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return null!==n?Number(n[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:!0===/mat4/.test(e)?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}addStack(){return this.stack=wX(this.stack),this.stacks.push(qk()||this.stack),zk(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,zk(this.stacks.pop()),e}getDataFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n=null===n?e.isGlobal(this)?this.globalCache:this.cache:n;let i=n.getData(e);return void 0===i&&(i={},n.setData(e,i)),void 0===i[t]&&(i[t]={}),i[t]}getNodeProperties(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let i=n.bufferAttribute;if(void 0===i){const r=this.uniforms.index++;i=new ZW("nodeAttribute"+r,t,e),this.bufferAttributes.push(i),n.bufferAttribute=i}return i}getStructTypeFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;const n=this.getDataFromNode(e,t);if(void 0===n.structType){const i=this.structs.index++;e.name="StructType".concat(i),this.structs[t].push(e),n.structType=e}return e}getUniformFromNode(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.getDataFromNode(e,n,this.globalCache);let s=r.uniform;if(void 0===s){const o=this.uniforms.index++;s=new JW(i||"nodeUniform"+o,t,e),this.uniforms[n].push(s),r.uniform=s}return s}getVarFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage;const r=this.getDataFromNode(e,i);let s=r.variable;if(void 0===s){const e=this.vars[i]||(this.vars[i]=[]);null===t&&(t="nodeVar"+e.length),s=new $W(t,n),e.push(s),r.variable=s}return s}getVaryingFromNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this);const i=this.getDataFromNode(e,"any");let r=i.varying;if(void 0===r){const e=this.varyings,s=e.length;null===t&&(t="nodeVarying"+s),r=new eX(t,n),e.push(r),i.varying=r}return r}getCodeFromNode(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage;const i=this.getDataFromNode(e);let r=i.code;if(void 0===r){const e=this.codes[n]||(this.codes[n]=[]),s=e.length;r=new tX("nodeCode"+s,t),e.push(r),i.code=r}return r}addLineFlowCode(e){return""===e||(e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="\t",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}buildFunctionNode(e){const t=new oX,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let e=0;const t=Object.values(this);return{next:()=>({value:t[e],done:e++>=t.length})}}};for(const s of t.inputs)n[s.name]=new rX(s.type,s.name);e.layout=null;const i=e.call(n),r=this.flowStagesNode(i,t.type);return e.layout=t,r}flowStagesNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.flow,i=this.vars,r=this.cache,s=this.buildStage,o=this.stack,a={code:""};this.flow=a,this.vars={},this.cache=new iX,this.stack=wX();for(const l of GO)this.setBuildStage(l),a.result=e.build(this,t);return a.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=i,this.cache=r,this.stack=o,this.setBuildStage(s),a}getFunctionOperator(){return null}flowChildNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.flow,i={code:""};return this.flow=i,i.result=e.build(this,t),this.flow=n,i}flowNodeFromShaderStage(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.shaderStage;this.setShaderStage(e);const s=this.flowChildNode(t,n);return null!==i&&(s.code+="".concat(this.tab+i," = ").concat(s.result,";\n")),this.flowCode[e]=this.flowCode[e]+s.code,this.setShaderStage(r),s}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t){return"".concat(this.getType(e)," ").concat(t)}getVars(e){let t="";const n=this.vars[e];if(void 0!==n)for(const i of n)t+="".concat(this.getVar(i.type,i.name),"; ");return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(void 0!==t)for(const i of t)n+=i.code+"\n";return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:n}=this;if(null!==t){let e=n.nodes.library.fromMaterial(t);null===e&&(console.error('NodeMaterial: Material "'.concat(t.type,'" is not compatible.')),e=new nG),e.build(this)}else this.addFlow("compute",e);for(const i of GO){this.setBuildStage(i),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const e of jO){this.setShaderStage(e);const t=this.flowNodes[e];for(const e of t)"generate"===i?this.flowNode(e):e.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if("float"===t||"int"===t||"uint"===t)return new fX(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new mX(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new gX(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new vX(e);if("color"===t)return new yX(e);if("mat3"===t)return new bX(e);if("mat4"===t)return new xX(e);throw new Error('Uniform "'.concat(t,'" not declared.'))}createNodeMaterial(){throw new Error("THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NodeMaterial","() instead."))}format(e,t,n){if((t=this.getVectorType(t))===(n=this.getVectorType(n))||null===n||this.isReference(n))return e;const i=this.getTypeLength(t),r=this.getTypeLength(n);return 16===i&&9===r?"".concat(this.getType(n),"(").concat(e,"[0].xyz, ").concat(e,"[1].xyz, ").concat(e,"[2].xyz)"):9===i&&4===r?"".concat(this.getType(n),"(").concat(e,"[0].xy, ").concat(e,"[1].xy)"):i>4||r>4||0===r?e:i===r?"".concat(this.getType(n),"( ").concat(e," )"):i>r?this.format("".concat(e,".").concat("xyz".slice(0,r)),this.getTypeFromLength(r,this.getComponentType(t)),n):4===r&&i>1?"".concat(this.getType(n),"( ").concat(this.format(e,t,"vec3"),", 1.0 )"):2===i?"".concat(this.getType(n),"( ").concat(this.format(e,t,"vec2"),", 0.0 )"):(1===i&&r>1&&t!==this.getComponentType(n)&&(e="".concat(this.getType(this.getComponentType(n)),"( ").concat(e," )")),"".concat(this.getType(n),"( ").concat(e," )"))}getSignature(){return"// Three.js r".concat(pP," - Node System\n")}}class ZX{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.startTime=null,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return void 0===n&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===zO){const{frameMap:t}=this._getMaps(this.updateBeforeMap,n);t.get(n)!==this.frameId&&!1!==e.updateBefore(this)&&t.set(n,this.frameId)}else if(t===qO){const{renderMap:t}=this._getMaps(this.updateBeforeMap,n);t.get(n)!==this.renderId&&!1!==e.updateBefore(this)&&t.set(n,this.renderId)}else t===VO&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===zO){const{frameMap:t}=this._getMaps(this.updateAfterMap,n);t.get(n)!==this.frameId&&!1!==e.updateAfter(this)&&t.set(n,this.frameId)}else if(t===qO){const{renderMap:t}=this._getMaps(this.updateAfterMap,n);t.get(n)!==this.renderId&&!1!==e.updateAfter(this)&&t.set(n,this.renderId)}else t===VO&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===zO){const{frameMap:t}=this._getMaps(this.updateMap,n);t.get(n)!==this.frameId&&!1!==e.update(this)&&t.set(n,this.frameId)}else if(t===qO){const{renderMap:t}=this._getMaps(this.updateMap,n);t.get(n)!==this.renderId&&!1!==e.update(this)&&t.set(n,this.renderId)}else t===VO&&e.update(this)}update(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class JX{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.type=e,this.name=t,this.count=n,this.qualifier=i,this.isConst=r}}JX.isNodeFunctionInput=!0;class $X extends YO{constructor(e){super(),this.types=e,this.isStructTypeNode=!0}getMemberTypes(){return this.types}}$X.type=QO("StructType",$X);class eY extends YO{constructor(){super();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.members=t,this.isOutputStructNode=!0}setup(e){super.setup(e);const t=this.members,n=[];for(let i=0;i<t.length;i++)n.push(t[i].getNodeType(e));this.nodeType=e.getStructTypeFromNode(new $X(n)).name}generate(e,t){const n=e.getOutputStructName(),i=this.members,r=""!==n?n+".":"";for(let s=0;s<i.length;s++){const n=i[s].build(e,t);e.addLineFlowCode("".concat(r,"m").concat(s," = ").concat(n))}return n}}eY.type=QO("OutputStruct",eY);function tY(e,t){for(let n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}class nY extends eY{constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return void 0!==this.outputNodes[e]}get(e){return this.outputNodes[e]}merge(e){const t=M(M({},this.outputNodes),e.outputNodes);return iY(t)}setup(e){const t=this.outputNodes,n=[],i=e.renderer.getRenderTarget().textures;for(const r in t){n[tY(i,r)]=nB(t[r])}return this.members=n,super.setup(e)}}nY.type=QO("MRT",nY);const iY=Bk(nY);class rY extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.functionNodes=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.parametersNodes=n,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let n=this._candidateFnCall;if(null===n){let i=null,r=-1;for(const n of this.functionNodes){const s=n.shaderNode.layout;if(null===s)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const o=s.inputs;if(t.length===o.length){let s=0;for(let n=0;n<t.length;n++){const i=t[n],r=o[n];i.getNodeType(e)===r.type?s++:s=0}s>r&&(i=n,r=s)}}this._candidateFnCall=n=i(...t)}return n}}rY.type=QO("FunctionOverloading",rY);class sY extends fB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sY.LOCAL,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this.scope=e,this.scale=t,this.updateType=zO}update(e){const t=this.scope,n=this.scale;t===sY.LOCAL?this.value+=e.deltaTime*n:t===sY.DELTA?this.value=e.deltaTime*n:t===sY.FRAME?this.value=e.frameId:this.value=e.time*n}serialize(e){super.serialize(e),e.scope=this.scope,e.scale=this.scale}deserialize(e){super.deserialize(e),this.scope=e.scope,this.scale=e.scale}}sY.LOCAL="local",sY.GLOBAL="global",sY.DELTA="delta",sY.FRAME="frame",sY.type=QO("Timer",sY);const oY=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ik(new sY(sY.LOCAL,e,t))};class aY extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aY.SINE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oY();super(),this.method=e,this.timeNode=t}getNodeType(e){return this.timeNode.getNodeType(e)}setup(){const e=this.method,t=Ik(this.timeNode);let n=null;return e===aY.SINE?n=t.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5):e===aY.SQUARE?n=t.fract().round():e===aY.TRIANGLE?n=t.add(.5).fract().mul(2).sub(1).abs():e===aY.SAWTOOTH&&(n=t.fract()),n}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}aY.SINE="sine",aY.SQUARE="square",aY.TRIANGLE="triangle",aY.SAWTOOTH="sawtooth",aY.type=QO("Osc",aY);aY.SINE,aY.SQUARE,aY.TRIANGLE,aY.SAWTOOTH;class lY extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tz(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jk(0);super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=n}setup(){const{frameNode:e,uvNode:t,countNode:n}=this,{width:i,height:r}=n,s=e.mod(i.mul(r)).floor(),o=s.mod(i),a=r.sub(s.add(1).div(i).ceil()),l=n.reciprocal(),c=Yk(o,a);return t.add(c).mul(l)}}lY.type=QO("SpriteSheetUV",lY);class cY extends KO{constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}setup(e){return!1===e.isAvailable("storageBuffer")&&(this.node.instanceIndex||!0!==this.node.bufferObject||e.setupPBO(this.node)),super.setup(e)}generate(e,t){let n;const i=e.context.assign;if(!1===e.isAvailable("storageBuffer")){const{node:t}=this;n=t.instanceIndex||!0!==this.node.bufferObject||!0===i?t.build(e):e.generatePBO(this)}else n=super.generate(e);if(!0!==i){const i=this.getNodeType(e);n=e.format(n,i,t)}return n}}cY.type=QO("StorageArrayElement",cY);const uY=Bk(cY);class hY extends YO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jk(1),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Tz,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Iz;super("vec4"),this.textureXNode=e,this.textureYNode=t,this.textureZNode=n,this.scaleNode=i,this.positionNode=r,this.normalNode=s}setup(){const{textureXNode:e,textureYNode:t,textureZNode:n,scaleNode:i,positionNode:r,normalNode:s}=this;let o=s.abs().normalize();o=o.div(o.dot(Jk(1)));const a=r.yz.mul(i),l=r.zx.mul(i),c=r.xy.mul(i),u=e.value,h=null!==t?t.value:u,d=null!==n?n.value:u,p=az(u,a).mul(o.x),A=az(h,l).mul(o.y),f=az(d,c).mul(o.z);return KB(p,A,f)}}hY.type=QO("TriplanarTextures",hY);const dY=new hO,pY=new OD,AY=new OD,fY=new OD,mY=new hL,gY=new OD(0,0,-1),vY=new PD,yY=new OD,bY=new OD,xY=new PD,_Y=new uD,wY=new ND,SY=zV.flipX();let TY=!1;class MY extends oz{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(wY.texture,SY);const{target:t=new FL,resolution:n=1,generateMipmaps:i=!1,bounces:r=!0}=e;this.target=t,this.resolution=n,this.generateMipmaps=i,this.bounces=r,this.updateBeforeType=r?qO:zO,this.virtualCameras=new WeakMap,this.renderTargets=new WeakMap}_updateResolution(e,t){const n=this.resolution;t.getDrawingBufferSize(_Y),e.setSize(Math.round(_Y.width*n),Math.round(_Y.height*n))}setup(e){return this._updateResolution(wY,e.renderer),super.setup(e)}getTextureNode(){return this.textureNode}getVirtualCamera(e){let t=this.virtualCameras.get(e);return void 0===t&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return void 0===t&&(t=new ND(0,0,{type:YP}),!0===this.generateMipmaps&&(t.texture.minFilter=1008,t.texture.generateMipmaps=!0),this.renderTargets.set(e,t)),t}updateBefore(e){if(!1===this.bounces&&TY)return!1;TY=!0;const{scene:t,camera:n,renderer:i,material:r}=e,{target:s}=this,o=this.getVirtualCamera(n),a=this.getRenderTarget(o);if(i.getDrawingBufferSize(_Y),this._updateResolution(a,i),AY.setFromMatrixPosition(s.matrixWorld),fY.setFromMatrixPosition(n.matrixWorld),mY.extractRotation(s.matrixWorld),pY.set(0,0,1),pY.applyMatrix4(mY),yY.subVectors(AY,fY),yY.dot(pY)>0)return;yY.reflect(pY).negate(),yY.add(AY),mY.extractRotation(n.matrixWorld),gY.set(0,0,-1),gY.applyMatrix4(mY),gY.add(fY),bY.subVectors(AY,gY),bY.reflect(pY).negate(),bY.add(AY),o.coordinateSystem=n.coordinateSystem,o.position.copy(yY),o.up.set(0,1,0),o.up.applyMatrix4(mY),o.up.reflect(pY),o.lookAt(bY),o.near=n.near,o.far=n.far,o.updateMatrixWorld(),o.projectionMatrix.copy(n.projectionMatrix),dY.setFromNormalAndCoplanarPoint(pY,AY),dY.applyMatrix4(o.matrixWorldInverse),vY.set(dY.normal.x,dY.normal.y,dY.normal.z,dY.constant);const l=o.projectionMatrix;xY.x=(Math.sign(vY.x)+l.elements[8])/l.elements[0],xY.y=(Math.sign(vY.y)+l.elements[9])/l.elements[5],xY.z=-1,xY.w=(1+l.elements[10])/l.elements[14],vY.multiplyScalar(1/vY.dot(xY));l.elements[2]=vY.x,l.elements[6]=vY.y,l.elements[10]=vY.z-0,l.elements[14]=vY.w,this.value=a.texture,r.visible=!1;const c=i.getRenderTarget(),u=i.getMRT();i.setMRT(null),i.setRenderTarget(a),i.render(t,o),i.setMRT(u),i.setRenderTarget(c),r.visible=!0,TY=!1}}MY.type=QO("Reflector",MY);const EY=new lW(-1,1,1,-1,0,1);class CY extends wI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super();const t=!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new fI([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fI(t,2))}}const RY=new CY;class PY extends qI{constructor(){super(RY,arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.camera=EY,this.isQuadMesh=!0}renderAsync(e){return e.renderAsync(this,EY)}render(e){e.render(this,EY)}}const NY=new uD;class DY extends oz{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=new ND(t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{type:YP});super(i.texture,tz()),this.node=e,this.width=t,this.height=n,this.renderTarget=i,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this.updateMap=new WeakMap,this._rttNode=null,this._quadMesh=new PY(new nG),this.updateBeforeType=qO}get autoSize(){return null===this.width}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const n=e*this.pixelRatio,i=t*this.pixelRatio;this.renderTarget.setSize(n,i),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore(e){let{renderer:t}=e;if(!1===this.textureNeedsUpdate&&!1===this.autoUpdate)return;if(this.textureNeedsUpdate=!1,!0===this.autoSize){this.pixelRatio=t.getPixelRatio();const e=t.getSize(NY);this.setSize(e.width,e.height)}this._quadMesh.material.fragmentNode=this._rttNode;const n=t.getRenderTarget();t.setRenderTarget(this.renderTarget),this._quadMesh.render(t),t.setRenderTarget(n)}clone(){const e=new oz(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}DY.type=QO("RTT",DY);const LY=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.isTextureNode?e:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ik(new DY(Ik(e),...n))}(e,...n)};class IY extends $U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e);let n;return n=!0===e.hasGeometryAttribute(t)?super.generate(e):e.generateConst(this.nodeType,new PD(1,1,1,1)),n}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}IY.type=QO("VertexColor",IY);class OY extends YO{constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}OY.type=QO("PointUV",OY);class kY extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kY.BACKGROUND_BLURRINESS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=null!==this.scene?this.scene:e.scene;let i;return t===kY.BACKGROUND_BLURRINESS?i=nq("backgroundBlurriness","float",n):t===kY.BACKGROUND_INTENSITY?i=nq("backgroundIntensity","float",n):console.error("THREE.SceneNode: Unknown scope:",t),i}}kY.BACKGROUND_BLURRINESS="backgroundBlurriness",kY.BACKGROUND_INTENSITY="backgroundIntensity",kY.type=QO("Scene",kY);const BY=Fk(kY,kY.BACKGROUND_BLURRINESS),FY=Fk(kY,kY.BACKGROUND_INTENSITY),UY="point-list",zY="line-list",qY="line-strip",VY="triangle-list",GY="triangle-strip",jY="never",HY="less",WY="equal",XY="less-equal",YY="greater",QY="not-equal",KY="greater-equal",ZY="always",JY="store",$Y="load",eQ="clear",tQ="ccw",nQ="none",iQ="front",rQ="back",sQ="uint16",oQ="uint32",aQ={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10uFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Stencil8:"stencil8",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},lQ="clamp-to-edge",cQ="repeat",uQ="mirror-repeat",hQ="linear",dQ="nearest",pQ="zero",AQ="one",fQ="src",mQ="one-minus-src",gQ="src-alpha",vQ="one-minus-src-alpha",yQ="dst",bQ="one-minus-dst",xQ="dst-alpha",_Q="one-minus-dst-alpha",wQ="src-alpha-saturated",SQ="constant",TQ="one-minus-constant",MQ="add",EQ="subtract",CQ="reverse-subtract",RQ="min",PQ="max",NQ=0,DQ=15,LQ="keep",IQ="zero",OQ="replace",kQ="invert",BQ="increment-clamp",FQ="decrement-clamp",UQ="increment-wrap",zQ="decrement-wrap",qQ="storage",VQ="read-only-storage",GQ="write-only",jQ="read-only",HQ="float",WQ="unfilterable-float",XQ="depth",YQ="sint",QQ="uint",KQ="2d",ZQ="3d",JQ="2d",$Q="2d-array",eK="cube",tK="3d",nK="all",iK="vertex",rK="instance",sK={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class oK extends Qz{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(e,t,n),this.isStorageBufferNode=!0,this.access=qQ,this.bufferObject=!1,this.bufferCount=n,this._attribute=null,this._varying=null,this.global=!0,!0!==e.isStorageBufferAttribute&&!0!==e.isStorageInstancedBufferAttribute&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(0===this.bufferCount){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return"storageBuffer"}element(e){return uY(this,e)}setBufferObject(e){return this.bufferObject=e,this}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(VQ)}generate(e){if(e.isAvailable("storageBuffer"))return super.generate(e);const t=this.getNodeType(e);null===this._attribute&&(this._attribute=UU(this.value),this._varying=EU(this._attribute));const n=this._varying.build(e,t);return e.registerTransform(n,this._attribute),n}}oK.type=QO("StorageBuffer",oK);class aK extends oz{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t),this.storeNode=n,this.isStorageTextureNode=!0,this.access=GQ}getInputType(){return"storageTexture"}setup(e){super.setup(e);e.getNodeProperties(this).storeNode=this.storeNode}setAccess(e){return this.access=e,this}generate(e,t){let n;return n=null!==this.storeNode?this.generateStore(e):super.generate(e,t),n}toReadOnly(){return this.setAccess(jQ)}toWriteOnly(){return this.setAccess(GQ)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:n,storeNode:i}=t,r=super.generate(e,"property"),s=n.build(e,"uvec2"),o=i.build(e,"vec4"),a=e.generateTextureStore(e,r,s,o);e.addLineFlowCode(a)}}aK.type=QO("StorageTexture",aK);class lK extends tq{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.userData=n}update(e){this.reference=null!==this.userData?this.userData:e.object.userData,super.update(e)}}lK.type=QO("UserData",lK);class cK extends JO{constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}cK.type=QO("Posterize",cK);let uK=null;class hK extends VV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zV,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===uK&&(uK=new gO),super(e,t,uK)}updateReference(){return this}}hK.type=QO("ViewportSharedTexture",hK);const dK=new uD;class pK extends oz{constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}pK.type=QO("PassTexture",pK);class AK extends pK{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}AK.type=QO("PassMultipleTexture",AK);class fK extends JO{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=i,this._pixelRatio=1,this._width=1,this._height=1;const r=new vO;r.isRenderTargetTexture=!0,r.name="depth";const s=new ND(this._width*this._pixelRatio,this._height*this._pixelRatio,M({type:YP},i));s.texture.name="output",s.depthTexture=r,this.renderTarget=s,this.updateBeforeType=zO,this._textures={output:s.texture,depth:r},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=mB(0),this._cameraFar=mB(0),this._mrt=null,this.isPassNode=!0}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let t=this._textures[e];if(void 0===t){t=this.renderTarget.texture.clone(),t.isRenderTargetTexture=!0,t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)}return t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),t.isRenderTargetTexture=!0,this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(void 0!==t){const n=this._textures[e],i=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[i]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._textureNodes[e];return void 0===t&&(this._textureNodes[e]=t=Ik(new AK(this,e)),this._textureNodes[e].updateTexture()),t}getPreviousTextureNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),this._previousTextureNodes[e]=t=Ik(new AK(this,e,!0)),this._previousTextureNodes[e].updateTexture()),t}getViewZNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._viewZNodes[e];if(void 0===t){const n=this._cameraNear,i=this._cameraFar;this._viewZNodes[e]=t=KV(this.getTextureNode(e),n,i)}return t}getLinearDepthNode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._linearDepthNodes[e];if(void 0===t){const n=this._cameraNear,i=this._cameraFar,r=this.getViewZNode(e);this._linearDepthNodes[e]=t=YV(r,n,i)}return t}setup(e){let{renderer:t}=e;return this.renderTarget.samples=void 0===this.options.samples?t.samples:this.options.samples,!0===t.backend.isWebGLBackend&&(this.renderTarget.samples=0),this.renderTarget.depthTexture.isMultisampleRenderTargetTexture=this.renderTarget.samples>1,this.scope===fK.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n,camera:i}=this;this._pixelRatio=t.getPixelRatio();const r=t.getSize(dK);this.setSize(r.width,r.height);const s=t.getRenderTarget(),o=t.getMRT();this._cameraNear.value=i.near,this._cameraFar.value=i.far;for(const a in this._previousTextures)this.toggleTexture(a);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,i),t.setRenderTarget(s),t.setMRT(o)}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget.setSize(n,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}fK.COLOR="color",fK.DEPTH="depth",fK.type=QO("Pass",fK);const mK=(e,t)=>Ik(new pK(e,t)),gK=new PY,vK=new PY;class yK extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;super("vec4"),this.textureNode=e,this.directionNode=t,this.sigma=n,this._invSize=mB(new uD),this._passDirection=mB(new uD),this._horizontalRT=new ND,this._horizontalRT.texture.name="GaussianBlurNode.horizontal",this._verticalRT=new ND,this._verticalRT.texture.name="GaussianBlurNode.vertical",this._textureNode=mK(this,this._verticalRT.texture),this.updateBeforeType=qO,this.resolution=new uD(1,1)}setSize(e,t){e=Math.max(Math.round(e*this.resolution.x),1),t=Math.max(Math.round(t*this.resolution.y),1),this._invSize.value.set(1/e,1/t),this._horizontalRT.setSize(e,t),this._verticalRT.setSize(e,t)}updateBefore(e){const{renderer:t}=e,n=this.textureNode,i=n.value,r=t.getRenderTarget(),s=t.getMRT(),o=n.value;gK.material=this._material,vK.material=this._material,this.setSize(i.image.width,i.image.height);const a=i.type;this._horizontalRT.texture.type=a,this._verticalRT.texture.type=a,t.setMRT(null),t.setRenderTarget(this._horizontalRT),this._passDirection.value.set(1,0),gK.render(t),n.value=this._horizontalRT.texture,t.setRenderTarget(this._verticalRT),this._passDirection.value.set(0,1),vK.render(t),t.setRenderTarget(r),t.setMRT(s),n.value=o}getTextureNode(){return this._textureNode}setup(e){const t=this.textureNode;if(!0!==t.isTextureNode)return console.error("GaussianBlurNode requires a TextureNode."),nB();const n=t.uvNode||tz(),i=Yk(this.directionNode||1),r=e=>t.uv(e),s=Uk((()=>{const e=3+2*this.sigma,t=this._getCoefficients(e),s=this._invSize,o=i.mul(this._passDirection),a=jk(t[0]).toVar(),l=nB(r(n).mul(a)).toVar();for(let i=1;i<e;i++){const e=jk(i),c=jk(t[i]),u=Yk(o.mul(s.mul(e))).toVar(),h=nB(r(n.add(u))),d=nB(r(n.sub(u)));l.addAssign(h.add(d).mul(c)),a.addAssign(JB(2,c))}return l.div(a)})),o=this._material||(this._material=new nG);o.fragmentNode=s().context(e.getSharedContext()),o.name="Gaussian_blur",o.needsUpdate=!0;return e.getNodeProperties(this).textureNode=t,this._textureNode}dispose(){this._horizontalRT.dispose(),this._verticalRT.dispose()}_getCoefficients(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return t}}yK.type=QO("GaussianBlur",yK);const bK=new OD,xK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jk(...bD.getLuminanceCoefficients(bK));return aU(e,t)};class _K extends JO{constructor(e){super(),this.textureNode=e,this.updateBeforeType=qO,this._invSize=mB(new uD)}updateBefore(){const e=this.textureNode.value;this._invSize.value.set(1/e.image.width,1/e.image.height)}setup(){const{textureNode:e}=this,t=e.uvNode||tz(),n=t=>e.uv(t);return Uk((()=>{const e=this._invSize,i=aB(-1,-2,-1,0,0,0,1,2,1),r=aB(-1,0,1,-2,0,2,-1,0,1),s=xK(n(t.add(e.mul(Yk(-1,-1)))).xyz),o=xK(n(t.add(e.mul(Yk(-1,0)))).xyz),a=xK(n(t.add(e.mul(Yk(-1,1)))).xyz),l=xK(n(t.add(e.mul(Yk(0,-1)))).xyz),c=xK(n(t.add(e.mul(Yk(0,0)))).xyz),u=xK(n(t.add(e.mul(Yk(0,1)))).xyz),h=xK(n(t.add(e.mul(Yk(1,-1)))).xyz),d=xK(n(t.add(e.mul(Yk(1,0)))).xyz),p=xK(n(t.add(e.mul(Yk(1,1)))).xyz),A=KB(i[0][0].mul(s),i[1][0].mul(l),i[2][0].mul(h),i[0][1].mul(o),i[1][1].mul(c),i[2][1].mul(d),i[0][2].mul(a),i[1][2].mul(u),i[2][2].mul(p)),f=KB(r[0][0].mul(s),r[1][0].mul(l),r[2][0].mul(h),r[0][1].mul(o),r[1][1].mul(c),r[2][1].mul(d),r[0][2].mul(a),r[1][2].mul(u),r[2][2].mul(p)),m=A.mul(A).add(f.mul(f)).sqrt();return nB(Jk(m),1)}))()}}_K.type=QO("SobelOperator",_K);class wK extends JO{constructor(e,t,n,i,r){super(),this.textureNode=e,this.viewZNode=t,this.focusNode=n,this.apertureNode=i,this.maxblurNode=r,this._aspect=mB(0),this.updateBeforeType=qO}updateBefore(){const e=this.textureNode.value;this._aspect.value=e.image.width/e.image.height}setup(){const e=this.textureNode,t=e.uvNode||tz(),n=t=>e.uv(t);return Uk((()=>{const e=Yk(1,this._aspect),i=this.focusNode.add(this.viewZNode),r=Yk(fU(i.mul(this.apertureNode),this.maxblurNode.negate(),this.maxblurNode)),s=r.mul(.9),o=r.mul(.7),a=r.mul(.4);let l=nB(0);return l=l.add(n(t)),l=l.add(n(t.add(Yk(0,.4).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.15,.37).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.29,.29).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.37,.15).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.4,0).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.37,-.15).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.29,-.29).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.15,-.37).mul(e).mul(r)))),l=l.add(n(t.add(Yk(0,-.4).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.15,.37).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.29,.29).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.37,.15).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.4,0).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.37,-.15).mul(e).mul(r)))),l=l.add(n(t.add(Yk(-.29,-.29).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.15,-.37).mul(e).mul(r)))),l=l.add(n(t.add(Yk(.15,.37).mul(e).mul(s)))),l=l.add(n(t.add(Yk(-.37,.15).mul(e).mul(s)))),l=l.add(n(t.add(Yk(.37,-.15).mul(e).mul(s)))),l=l.add(n(t.add(Yk(-.15,-.37).mul(e).mul(s)))),l=l.add(n(t.add(Yk(-.15,.37).mul(e).mul(s)))),l=l.add(n(t.add(Yk(.37,.15).mul(e).mul(s)))),l=l.add(n(t.add(Yk(-.37,-.15).mul(e).mul(s)))),l=l.add(n(t.add(Yk(.15,-.37).mul(e).mul(s)))),l=l.add(n(t.add(Yk(.29,.29).mul(e).mul(o)))),l=l.add(n(t.add(Yk(.4,0).mul(e).mul(o)))),l=l.add(n(t.add(Yk(.29,-.29).mul(e).mul(o)))),l=l.add(n(t.add(Yk(0,-.4).mul(e).mul(o)))),l=l.add(n(t.add(Yk(-.29,.29).mul(e).mul(o)))),l=l.add(n(t.add(Yk(-.4,0).mul(e).mul(o)))),l=l.add(n(t.add(Yk(-.29,-.29).mul(e).mul(o)))),l=l.add(n(t.add(Yk(0,.4).mul(e).mul(o)))),l=l.add(n(t.add(Yk(.29,.29).mul(e).mul(a)))),l=l.add(n(t.add(Yk(.4,0).mul(e).mul(a)))),l=l.add(n(t.add(Yk(.29,-.29).mul(e).mul(a)))),l=l.add(n(t.add(Yk(0,-.4).mul(e).mul(a)))),l=l.add(n(t.add(Yk(-.29,.29).mul(e).mul(a)))),l=l.add(n(t.add(Yk(-.4,0).mul(e).mul(a)))),l=l.add(n(t.add(Yk(-.29,-.29).mul(e).mul(a)))),l=l.add(n(t.add(Yk(0,.4).mul(e).mul(a)))),l=l.div(41),l.a=1,nB(l)}))()}}wK.type=QO("DepthOfField",wK);class SK extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new uD(.5,.5),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.57,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super("vec4"),this.inputNode=e,this.center=mB(t),this.angle=mB(n),this.scale=mB(i)}setup(){const e=this.inputNode,t=Uk((()=>{const e=OF(this.angle),t=kF(this.angle),n=tz().mul(FV).sub(this.center),i=Yk(t.mul(n.x).sub(e.mul(n.y)),e.mul(n.x).add(t.mul(n.y))).mul(this.scale);return OF(i.x).mul(OF(i.y)).mul(4)})),n=Uk((()=>{const n=e,i=KB(n.r,n.g,n.b).div(3);return nB(Jk(i.mul(10).sub(5).add(t())),n.a)}));return n()}}SK.type=QO("DotScreen",SK);class TK extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.005,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super("vec4"),this.textureNode=e,this.amount=mB(t),this.angle=mB(n)}setup(){const{textureNode:e}=this,t=e.uvNode||tz(),n=t=>e.uv(t);return Uk((()=>{const e=Yk(kF(this.angle),OF(this.angle)).mul(this.amount),i=n(t.add(e)),r=n(t),s=n(t.sub(e));return nB(i.r,r.g,s.b,r.a)}))()}}TK.type=QO("RGBShift",TK);class MK extends JO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.inputNode=e,this.intensityNode=t,this.uvNode=n}setup(){const e=this.uvNode||tz(),t=Uk((()=>{const t=this.inputNode.rgb,n=yU(IF(e.add(oY())));let i=t.add(t.mul(fU(n.add(.1),0,1)));return null!==this.intensityNode&&(i=AU(t,i,this.intensityNode)),nB(i,this.inputNode.a)}));return t()}}MK.type=QO("Film",MK);class EK extends JO{constructor(e,t,n,i){super(),this.inputNode=e,this.lutNode=t,this.size=mB(n),this.intensityNode=i}setup(){const{inputNode:e,lutNode:t}=this,n=Uk((()=>{const n=e,i=jk(1).div(this.size),r=jk(.5).div(this.size),s=Jk(r).add(n.rgb.mul(jk(1).sub(i))),o=nB((e=>t.uv(e))(s).rgb,n.a);return nB(AU(n,o,this.intensityNode))}));return n()}}EK.type=QO("Lut3D",EK);const CK=new PY,RK=new eI,PK=new uD;class NK extends JO{constructor(e,t,n){super(),this.depthNode=e,this.normalNode=t,this.radius=mB(.25),this.resolution=mB(new uD),this.thickness=mB(1),this.distanceExponent=mB(1),this.distanceFallOff=mB(1),this.scale=mB(1),this.noiseNode=az(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=Math.floor(e)%2===0?Math.floor(e)+1:Math.floor(e),n=function(e){const t=Math.floor(e)%2===0?Math.floor(e)+1:Math.floor(e),n=t*t,i=Array(n).fill(0);let r=Math.floor(t/2),s=t-1;for(let o=1;o<=n;)-1===r&&s===t?(s=t-2,r=0):(s===t&&(s=0),r<0&&(r=t-1)),0===i[r*t+s]?(i[r*t+s]=o++,s++,r--):(s-=2,r++);return i}(t),i=n.length,r=new Uint8Array(4*i);for(let o=0;o<i;++o){const e=n[o],t=2*Math.PI*e/i,s=new OD(Math.cos(t),Math.sin(t),0).normalize();r[4*o]=255*(.5*s.x+.5),r[4*o+1]=255*(.5*s.y+.5),r[4*o+2]=127,r[4*o+3]=255}const s=new oO(r,t,t);return s.wrapS=DP,s.wrapT=DP,s.needsUpdate=!0,s}()),this.cameraProjectionMatrix=mB(n.projectionMatrix),this.cameraProjectionMatrixInverse=mB(n.projectionMatrixInverse),this.SAMPLES=mB(16),this._aoRenderTarget=new ND,this._aoRenderTarget.texture.name="GTAONode.AO",this._material=null,this._textureNode=mK(this,this._aoRenderTarget.texture),this.updateBeforeType=zO}getTextureNode(){return this._textureNode}setSize(e,t){this.resolution.value.set(e,t),this._aoRenderTarget.setSize(e,t)}updateBefore(e){const{renderer:t}=e,n=t.getDrawingBufferSize(PK),i=t.getRenderTarget(),r=t.getMRT();t.getClearColor(RK);const s=t.getClearAlpha();CK.material=this._material,this.setSize(n.width,n.height),t.setMRT(null),t.setClearColor(16777215,1),t.setRenderTarget(this._aoRenderTarget),CK.render(t),t.setRenderTarget(i),t.setMRT(r),t.setClearColor(RK,s)}setup(e){const t=tz(),n=e=>this.depthNode.uv(e).x,i=e=>this.noiseNode.uv(e),r=Uk((e=>{let[t]=e;const i=this.cameraProjectionMatrix.mul(nB(t,1));let r=i.xy.div(i.w).mul(.5).add(.5).toVar();r=Yk(r.x,r.y.oneMinus());const s=n(r);return Jk(r,s)})),s=Uk((e=>{let[t,n]=e;t=Yk(t.x,t.y.oneMinus()).mul(2).sub(1);const i=nB(Jk(t,n),1),r=nB(this.cameraProjectionMatrixInverse.mul(i));return r.xyz.div(r.w)})),o=Uk((()=>{const e=n(t);e.greaterThanEqual(1).discard();const o=s(t,e),a=this.normalNode.rgb.normalize(),l=this.radius,c=iz(this.noiseNode,0);let u=Yk(t.x,t.y.oneMinus());u=u.mul(this.resolution.div(c));const h=i(u),d=h.xyz.mul(2).sub(1),p=Jk(d.xy,0).normalize(),A=Jk(p.y.mul(-1),p.x,0),f=aB(p,A,Jk(0,0,1)),m=this.SAMPLES.lessThan(30).select(3,5),g=KB(this.SAMPLES,m.sub(1)).div(m),v=jk(0).toVar();return yV({start:Hk(0),end:m,type:"int",condition:"<"},(e=>{let{i:t}=e;const n=jk(t).div(jk(m)).mul(yF),i=nB(kF(n),OF(n),0,KB(.5,JB(.5,h.w)));i.xyz=LF(f.mul(i.xyz));const c=LF(o.xyz.negate()),u=LF(lU(i.xyz,c)),d=lU(u,c),p=LF(a.sub(u.mul(aU(a,u)))),A=lU(p,u),y=Yk(aU(c,A),aU(c,A.negate())).toVar();yV({end:g,type:"int",name:"j",condition:"<"},(e=>{let{j:t}=e;const n=i.xyz.mul(l).mul(i.w).mul(cU($B(jk(t).add(1),jk(g)),this.distanceExponent)),a=r(o.add(n)),u=s(a.xy,a.z).sub(o);Vk(qF(u.z).lessThan(this.thickness),(()=>{const e=aU(c,LF(u));y.x.addAssign(tU(0,JB(e.sub(y.x),AU(1,jk(2).div(jk(t).add(2)),this.distanceFallOff))))}));const h=r(o.sub(n)),d=s(h.xy,h.z).sub(o);Vk(qF(d.z).lessThan(this.thickness),(()=>{const e=aU(c,LF(d));y.y.addAssign(tU(0,JB(e.sub(y.y),AU(1,jk(2).div(jk(t).add(2)),this.distanceFallOff))))}))}));const b=RF(ZB(1,y.mul(y))),x=aU(p,d),_=aU(p,c),w=JB(.5,UF(y.y).sub(UF(y.x)).add(b.x.mul(y.x).sub(b.y.mul(y.y)))),S=JB(.5,ZB(2,y.x.mul(y.x)).sub(y.y.mul(y.y))),T=x.mul(w).add(_.mul(S));v.addAssign(T)})),v.assign(fU(v.div(m),0,1)),v.assign(cU(v,this.scale)),nB(Jk(v),1)})),a=this._material||(this._material=new nG);return a.fragmentNode=o().context(e.getSharedContext()),a.name="GTAO",a.needsUpdate=!0,this._textureNode}dispose(){this._aoRenderTarget.dispose()}}NK.type=QO("GTAO",NK);class DK extends JO{constructor(e,t,n,i,r){super(),this.textureNode=e,this.depthNode=t,this.normalNode=n,this.noiseNode=i,this.cameraProjectionMatrixInverse=mB(r.projectionMatrixInverse),this.lumaPhi=mB(5),this.depthPhi=mB(5),this.normalPhi=mB(5),this.radius=mB(5),this.index=mB(0),this._resolution=mB(new uD),this._sampleVectors=$z(function(e,t,n){const i=function(e,t,n){const i=[];for(let r=0;r<e;r++){const s=2*Math.PI*t*r/e,o=Math.pow(r/(e-1),n);i.push(new OD(Math.cos(s),Math.sin(s),o))}return i}(e,t,n),r=[];for(let s=0;s<e;s++){const e=i[s];r.push(e)}return r}(16,2,1)),this.updateBeforeType=qO}updateBefore(){const e=this.textureNode.value;this._resolution.value.set(e.image.width,e.image.height)}setup(){const e=tz(),t=e=>this.textureNode.uv(e),n=e=>this.depthNode.uv(e).x,i=e=>this.normalNode.uv(e),r=e=>this.noiseNode.uv(e),s=Uk((e=>{let[t,n]=e;t=Yk(t.x,t.y.oneMinus()).mul(2).sub(1);const i=nB(Jk(t,n),1),r=nB(this.cameraProjectionMatrixInverse.mul(i));return r.xyz.div(r.w)})),o=Uk((e=>{let[r,o,a,l]=e;const c=t(l),u=n(l),h=i(l).rgb.normalize(),d=c.rgb,p=s(l,u),A=aU(o,h).toVar(),f=cU(tU(A,0),this.normalPhi).toVar(),m=qF(xK(d).sub(xK(r))).toVar(),g=tU(jk(1).sub(m.div(this.lumaPhi)),0).toVar(),v=qF(aU(a.sub(p),o)).toVar(),y=tU(jk(1).sub(v.div(this.depthPhi)),0),b=g.mul(y).mul(f);return nB(d.mul(b),b)})),a=Uk((e=>{let[a]=e;const l=n(a),c=i(a).rgb.normalize(),u=t(a);Vk(l.greaterThanEqual(1).or(aU(c,c).equal(0)),(()=>u));const h=Jk(u.rgb),d=s(a,l),p=iz(this.noiseNode,0);let A=Yk(a.x,a.y.oneMinus());A=A.mul(this._resolution.div(p));const f=r(A),m=OF(f.element(this.index.mod(4).mul(2).mul(yF))),g=kF(f.element(this.index.mod(4).mul(2).mul(yF))),v=Yk(m,g),y=oB(v.x,v.y.negate(),v.x,v.y),b=jk(1).toVar(),x=Jk(u.rgb).toVar();return yV({start:Hk(0),end:Hk(16),type:"int",condition:"<"},(e=>{let{i:t}=e;const n=this._sampleVectors.element(t).toVar(),i=y.mul(n.xy.mul(jk(1).add(n.z.mul(this.radius.sub(1))))).div(this._resolution).toVar(),r=a.add(i).toVar(),s=o(h,c,d,r);x.addAssign(s.xyz),b.addAssign(s.w)})),Vk(b.greaterThan(jk(0)),(()=>{x.divAssign(b)})),nB(x,u.a)})).setLayout({name:"denoise",type:"vec4",inputs:[{name:"uv",type:"vec2"}]});return Uk((()=>a(e)))()}}DK.type=QO("Denoise",DK);class LK extends JO{constructor(e){super(),this.textureNode=e,this.updateBeforeType=qO,this._invSize=mB(new uD)}updateBefore(){const e=this.textureNode.value;this._invSize.value.set(1/e.image.width,1/e.image.height)}setup(){const e=this.textureNode.bias(-100),t=e.uvNode||tz(),n=t=>e.uv(t),i=(t,n,i)=>e.uv(t.add(n.mul(i))),r=Hk(5),s=Uk((e=>{let[t,n]=e;const i=nB(n).toVar(),r=nB(t).toVar(),s=nB(qF(r.sub(i))).toVar();return tU(tU(tU(s.r,s.g),s.b),s.a)})),o=Uk((e=>{let[t,o,a,l]=e;const c=n(t).toVar(),u=i(t,Yk(0,-1),o.xy).toVar(),h=i(t,Yk(1,0),o.xy).toVar(),d=i(t,Yk(0,1),o.xy).toVar(),p=i(t,Yk(-1,0),o.xy).toVar(),A=s(c,d).toVar(),f=s(c,u).toVar(),m=s(c,h).toVar(),g=s(c,p).toVar(),v=tU(A,tU(f,tU(m,g))).toVar();Vk(v.lessThan(a),(()=>c));const y=ZB(A.add(f),m.add(g)).toVar();y.mulAssign(l),Vk(qF(y).lessThan(.3),(()=>{const e=m.greaterThan(g).select(1,-1).toVar(),n=f.greaterThan(A).select(1,-1).toVar(),r=Yk(e,n).toVar(),a=i(t,Yk(r.x,r.y),o.xy),v=s(c,a).toVar(),b=i(t,Yk(r.x.negate(),r.y.negate()),o.xy),x=s(c,b).toVar();y.assign(x.sub(v)),y.mulAssign(l),Vk(qF(y).lessThan(.3),(()=>{const e=d.add(u).add(h).add(p);return AU(c,e.mul(.25),.4)}))}));const b=Yk().toVar();Vk(y.lessThanEqual(0),(()=>{d.assign(p),u.assign(h),b.x.assign(0),b.y.assign(o.y)})).Else((()=>{b.x.assign(o.x),b.y.assign(0)}));const x=s(c,d).toVar(),_=s(c,u).toVar();Vk(x.lessThanEqual(_),(()=>{d.assign(u)}));const w=Hk(0).toVar(),S=Hk(0).toVar(),T=jk(0).toVar(),M=jk(0).toVar(),E=Yk(t).toVar(),C=Yk(t).toVar(),R=Hk(0).toVar(),P=Hk(0).toVar();yV(r,(e=>{let{i:i}=e;const r=i.add(1).toVar();Vk(w.equal(0),(()=>{T.addAssign(r),E.assign(t.add(b.mul(T)));const e=n(E.xy),o=s(e,c).toVar(),a=s(e,d).toVar();Vk(o.greaterThan(a),(()=>{w.assign(1)})),R.assign(i)})),Vk(S.equal(0),(()=>{M.addAssign(r),C.assign(t.sub(b.mul(M)));const e=n(C.xy),o=s(e,c).toVar(),a=s(e,d).toVar();Vk(o.greaterThan(a),(()=>{S.assign(1)})),P.assign(i)})),Vk(w.equal(1).or(S.equal(1)),(()=>{bV()}))})),Vk(w.equal(0).and(S.equal(0)),(()=>c));const N=jk(1).toVar(),D=jk(1).toVar();Vk(w.equal(1),(()=>{N.assign(jk(R).div(jk(r.sub(1))))})),Vk(S.equal(1),(()=>{D.assign(jk(P).div(jk(r.sub(1))))}));const L=eU(N,D);return L.assign(cU(L,.5)),L.assign(jk(1).sub(L)),AU(c,d,L.mul(.5))})).setLayout({name:"FxaaPixelShader",type:"vec4",inputs:[{name:"uv",type:"vec2"},{name:"fxaaQualityRcpFrame",type:"vec2"},{name:"fxaaQualityEdgeThreshold",type:"float"},{name:"fxaaQualityinvEdgeThreshold",type:"float"}]});return Uk((()=>{const e=jk(.2),n=jk(1).div(e);return o(t,this._invSize,e,n)}))()}}LK.type=QO("FXAA",LK);class IK extends JO{constructor(e,t,n,i,r,s){super(),this.textureNodeA=e,this.textureNodeB=t,this.mixTextureNode=n,this.mixRatioNode=i,this.thresholdNode=r,this.useTextureNode=s}setup(){const{textureNodeA:e,textureNodeB:t,mixTextureNode:n,mixRatioNode:i,thresholdNode:r,useTextureNode:s}=this,o=e=>{const t=e.uvNode||tz();return e.uv(t)},a=Uk((()=>{const a=o(e),l=o(t),c=nB().toVar();return Vk(s.equal(Hk(1)),(()=>{const e=o(n),t=i.mul(r.mul(2).add(1)).sub(r),s=fU(ZB(e.r,t).mul(jk(1).div(r)),0,1);c.assign(AU(a,l,s))})).Else((()=>{c.assign(AU(l,a,i))})),c}));return a()}}IK.type=QO("Transition",IK);class OK extends JO{constructor(e,t,n,i,r,s){super(),this.textureNode=e,this.depthNode=t,this.normalNode=n,this.pixelSize=i,this.normalEdgeStrength=r,this.depthEdgeStrength=s,this._resolution=mB(new PD),this.updateBeforeType=qO}updateBefore(){const e=this.textureNode.value,t=e.image.width,n=e.image.height;this._resolution.value.set(t,n,1/t,1/n)}setup(){const{textureNode:e,depthNode:t,normalNode:n}=this,i=e.uvNode||tz(),r=t.uvNode||tz(),s=n.uvNode||tz(),o=(e,n)=>t.uv(r.add(Yk(e,n).mul(this._resolution.zw))).r,a=(e,t)=>n.uv(s.add(Yk(e,t).mul(this._resolution.zw))).rgb.normalize(),l=(e,t,n,i)=>{const r=o(e,t).sub(n),s=a(e,t),l=Jk(1,1,1),c=aU(i.sub(s),l),u=fU(gU(-.01,.01,c),0,1),h=fU(VF(r.mul(.25).add(.0025)),0,1);return jk(1).sub(aU(i,s)).mul(h).mul(u)},c=Uk((()=>{const t=e.uv(i),n=vB("float","depth"),r=vB("vec3","normal");Vk(this.depthEdgeStrength.greaterThan(0).or(this.normalEdgeStrength.greaterThan(0)),(()=>{n.assign(o(0,0)),r.assign(a(0,0))}));const s=vB("float","dei");Vk(this.depthEdgeStrength.greaterThan(0),(()=>{s.assign((e=>{const t=vB("float","diff");return t.addAssign(fU(o(1,0).sub(e))),t.addAssign(fU(o(-1,0).sub(e))),t.addAssign(fU(o(0,1).sub(e))),t.addAssign(fU(o(0,-1).sub(e))),NF(gU(.01,.02,t).mul(2)).div(2)})(n))}));const c=vB("float","nei");Vk(this.normalEdgeStrength.greaterThan(0),(()=>{c.assign(((e,t)=>{const n=vB("float","indicator");return n.addAssign(l(0,-1,e,t)),n.addAssign(l(0,1,e,t)),n.addAssign(l(-1,0,e,t)),n.addAssign(l(1,0,e,t)),iU(.1,n)})(n,r))}));const u=s.greaterThan(0).select(jk(1).sub(s.mul(this.depthEdgeStrength)),c.mul(this.normalEdgeStrength).add(1));return t.mul(u)}));return c()}}OK.type=QO("Pixelation",OK);class kK extends fK{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.4;super("color",e,t,{minFilter:OP,magFilter:OP}),this.pixelSize=n,this.normalEdgeStrength=i,this.depthEdgeStrength=r,this.isPixelationPassNode=!0,this._mrt=iY({output:FB,normal:Bz})}setSize(e,t){const n=this.pixelSize.value?this.pixelSize.value:this.pixelSize,i=Math.floor(e/n),r=Math.floor(t/n);super.setSize(i,r)}setup(){return function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.4;return Ik(new OK(LY(e),LY(t),LY(n),Ik(i),Ik(r),Ik(s)))}(super.getTextureNode("output"),super.getTextureNode("depth"),super.getTextureNode("normal"),this.pixelSize,this.normalEdgeStrength,this.depthEdgeStrength)}}kK.type=QO("PixelationPass",kK);const BK=new uD;class FK extends fK{constructor(e,t){super(fK.COLOR,e,t),this.isSSAAPassNode=!0,this.sampleLevel=4,this.unbiased=!0,this.clearColor=new eI(0),this.clearAlpha=0,this._currentClearColor=new eI,this.sampleWeight=mB(1),this.sampleRenderTarget=null,this._quadMesh=new PY}updateBefore(e){const{renderer:t}=e,{scene:n,camera:i}=this;this._pixelRatio=t.getPixelRatio();const r=t.getSize(BK);this.setSize(r.width,r.height),this.sampleRenderTarget.setSize(this.renderTarget.width,this.renderTarget.height),t.getClearColor(this._currentClearColor);const s=t.getClearAlpha(),o=t.getRenderTarget(),a=t.getMRT(),l=t.autoClear;this._cameraNear.value=i.near,this._cameraFar.value=i.far,t.setMRT(this.getMRT()),t.autoClear=!1;const c=UK[Math.max(0,Math.min(this.sampleLevel,5))],u=1/c.length,h={fullWidth:this.renderTarget.width,fullHeight:this.renderTarget.height,offsetX:0,offsetY:0,width:this.renderTarget.width,height:this.renderTarget.height},d=Object.assign({},i.view);d.enabled&&Object.assign(h,d);for(let p=0;p<c.length;p++){const e=c[p];if(i.setViewOffset&&i.setViewOffset(h.fullWidth,h.fullHeight,h.offsetX+.0625*e[0],h.offsetY+.0625*e[1],h.width,h.height),this.sampleWeight.value=u,this.unbiased){const e=(p+.5)/c.length-.5;this.sampleWeight.value+=.03125*e}t.setClearColor(this.clearColor,this.clearAlpha),t.setRenderTarget(this.sampleRenderTarget),t.clear(),t.render(n,i),t.setRenderTarget(this.renderTarget),0===p&&(t.setClearColor(0,0),t.clear()),this._quadMesh.render(t)}t.copyTextureToTexture(this.sampleRenderTarget.depthTexture,this.renderTarget.depthTexture),i.setViewOffset&&d.enabled?i.setViewOffset(d.fullWidth,d.fullHeight,d.offsetX,d.offsetY,d.width,d.height):i.clearViewOffset&&i.clearViewOffset(),t.setRenderTarget(o),t.setMRT(a),t.autoClear=l,t.setClearColor(this._currentClearColor,s)}setup(e){let t;null===this.sampleRenderTarget&&(this.sampleRenderTarget=this.renderTarget.clone());const n=this.getMRT();if(null!==n){const e={};for(const t in n.outputNodes){const n=tY(this.sampleRenderTarget.textures,t);n>=0&&(e[t]=az(this.sampleRenderTarget.textures[n]).mul(this.sampleWeight))}t=iY(e)}else t=az(this.sampleRenderTarget.texture).mul(this.sampleWeight);return this._quadMesh.material=new nG,this._quadMesh.material.fragmentNode=t,this._quadMesh.material.transparent=!0,this._quadMesh.material.depthTest=!1,this._quadMesh.material.depthWrite=!1,this._quadMesh.material.premultipliedAlpha=!0,this._quadMesh.material.blending=2,this._quadMesh.material.normals=!1,this._quadMesh.material.name="SSAA",super.setup(e)}dispose(){super.dispose(),null!==this.sampleRenderTarget&&this.sampleRenderTarget.dispose()}}FK.type=QO("SSAAPass",FK);const UK=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],zK=new uD;class qK extends fK{constructor(e,t){super(fK.COLOR,e,t),this.isStereoPassNode=!0,this.stereo=new yW,this.stereo.aspect=.5}updateBefore(e){const{renderer:t}=e,{scene:n,camera:i,stereo:r,renderTarget:s}=this;this._pixelRatio=t.getPixelRatio(),r.cameraL.coordinateSystem=t.coordinateSystem,r.cameraR.coordinateSystem=t.coordinateSystem,r.update(i);const o=t.getSize(zK);this.setSize(o.width,o.height);const a=t.autoClear;t.autoClear=!1;const l=t.getRenderTarget(),c=t.getMRT();this._cameraNear.value=i.near,this._cameraFar.value=i.far;for(const u in this._previousTextures)this.toggleTexture(u);t.setRenderTarget(s),t.setMRT(this._mrt),t.clear(),s.scissorTest=!0,s.scissor.set(0,0,s.width/2,s.height),s.viewport.set(0,0,s.width/2,s.height),t.render(n,r.cameraL),s.scissor.set(s.width/2,0,s.width/2,s.height),s.viewport.set(s.width/2,0,s.width/2,s.height),t.render(n,r.cameraR),s.scissorTest=!1,t.setRenderTarget(l),t.setMRT(c),t.autoClear=a}}qK.type=QO("StereoPass",qK);const VK=new uD,GK=new PY;class jK extends fK{constructor(e,t){super(fK.COLOR,e,t),this.isStereoCompositePassNode=!0,this.stereo=new yW;const n={minFilter:FP,magFilter:OP,type:YP};this._renderTargetL=new ND(1,1,n),this._renderTargetR=new ND(1,1,n),this._mapLeft=az(this._renderTargetL.texture),this._mapRight=az(this._renderTargetR.texture),this._material=null}updateStereoCamera(e){this.stereo.cameraL.coordinateSystem=e,this.stereo.cameraR.coordinateSystem=e,this.stereo.update(this.camera)}setSize(e,t){super.setSize(e,t),this._renderTargetL.setSize(this.renderTarget.width,this.renderTarget.height),this._renderTargetR.setSize(this.renderTarget.width,this.renderTarget.height)}updateBefore(e){const{renderer:t}=e,{scene:n,stereo:i,renderTarget:r}=this;this._pixelRatio=t.getPixelRatio(),this.updateStereoCamera(t.coordinateSystem);const s=t.getSize(VK);this.setSize(s.width,s.height);const o=t.getRenderTarget();t.setRenderTarget(this._renderTargetL),t.render(n,i.cameraL),t.setRenderTarget(this._renderTargetR),t.render(n,i.cameraR),t.setRenderTarget(r),GK.material=this._material,GK.render(t),t.setRenderTarget(o)}dispose(){super.dispose(),this._renderTargetL.dispose(),this._renderTargetR.dispose(),null!==this._material&&this._material.dispose()}}jK.type=QO("StereoCompositePass",jK);class HK extends jK{constructor(e,t){super(e,t),this.isParallaxBarrierPassNode=!0}setup(e){const t=tz(),n=Uk((()=>{const e=nB().toVar();return Vk(nU(BV.y,2).greaterThan(1),(()=>{e.assign(this._mapLeft.uv(t))})).Else((()=>{e.assign(this._mapRight.uv(t))})),e})),i=this._material||(this._material=new nG);return i.fragmentNode=n().context(e.getSharedContext()),i.needsUpdate=!0,super.setup(e)}}HK.type=QO("ParallaxBarrierPass",HK);class WK extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this._value=e,this._cache=null,this.inputType=null,this.outpuType=null,this.events=new JN,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return null!==this.outputType}set value(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"===typeof e.value||"Number"===this.inputType&&"number"===typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:jk()}serialize(e){super.serialize(e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=kO(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?BO(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}WK.type=QO("ScriptableValue",WK);const XK=Bk(WK);class YK extends Map{get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.has(e))return super.get(e);if(null!==t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=t(...i);return this.set(e,s),s}}}class QK{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const KK=new YK;class ZK extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.codeNode=e,this.parameters=t,this._local=new YK,this._output=XK(),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const n=this._outputs;return void 0===n[e]?n[e]=XK(t):n[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const n=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),n[e]=t,n[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),n[e]=t,n[e].events.addEventListener("refresh",this.onRefresh)):void 0===n[e]?(n[e]=XK(t),n[e].events.addEventListener("refresh",this.onRefresh)):n[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e){const t=this.getObject()[e];if("function"===typeof t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t(...i)}}async callAsync(e){const t=this.getObject()[e];if("function"===typeof t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return"AsyncFunction"===t.constructor.name?await t(...i):t(...i)}}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;const e=new QK(this),t=KK.get("THREE"),n=KK.get("TSL"),i=this.getMethod(this.codeNode),r=[e,this._local,KK,()=>this.refresh(),(e,t)=>this.setOutput(e,t),t,n];this._object=i(...r);const s=this._object.layout;if(s&&(!1===s.cache&&this._local.clear(),this._output.outputType=s.outputType||null,Array.isArray(s.elements)))for(const o of s.elements){const e=o.id||o.name;o.inputType&&(void 0===this.getParameter(e)&&this.setParameter(e,null),this.getParameter(e).inputType=o.inputType),o.outputType&&(void 0===this.getOutput(e)&&this.setOutput(e,null),this.getOutput(e).outputType=o.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let e=this.parameters[t];e.isScriptableNode&&(e=e.getDefaultOutput()),e.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:jk()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;const e=["layout","init","main","dispose"].join(", "),t="\nreturn { ...output, "+e+" };",n="var "+e+"; var output = {};\n"+this.codeNode.code+t;return this._method=new Function(...["parameters","local","global","refresh","setOutput","THREE","TSL"],n),this._method}dispose(){null!==this._method&&(this._object&&"function"===typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[this.source,this.getDefaultOutputNode().getCacheKey(e)];for(const n in this.parameters)t.push(this.parameters[n].getCacheKey(e));return t.join(",")}set needsUpdate(e){!0===e&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}ZK.type=QO("Scriptable",ZK);class JK extends YO{constructor(e,t){super("float"),this.isFogNode=!0,this.colorNode=e,this.factorNode=t}getViewZNode(e){let t;const n=e.context.getViewZ;return void 0!==n&&(t=n(this)),(t||Rz.z).negate()}setup(){return this.factorNode}}JK.type=QO("Fog",JK);class $K extends JK{constructor(e,t,n){super(e),this.isFogRangeNode=!0,this.nearNode=t,this.farNode=n}setup(e){const t=this.getViewZNode(e);return gU(this.nearNode,this.farNode,t)}}$K.type=QO("FogRange",$K);const eZ=Bk($K);class tZ extends JK{constructor(e,t){super(e),this.isFogExp2Node=!0,this.densityNode=t}setup(e){const t=this.getViewZNode(e),n=this.densityNode;return n.mul(n,t,t).negate().exp().oneMinus()}}tZ.type=QO("FogExp2",tZ);const nZ=Bk(tZ);let iZ=null,rZ=null;class sZ extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jk(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jk();super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(IO(this.minNode.value)),n=e.getTypeLength(IO(this.maxNode.value));return t>n?t:n}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let n=null;if(t.count>1){const i=this.minNode.value,r=this.maxNode.value,s=e.getTypeLength(IO(i)),o=e.getTypeLength(IO(r));iZ=iZ||new PD,rZ=rZ||new PD,iZ.setScalar(0),rZ.setScalar(0),1===s?iZ.setScalar(i):i.isColor?iZ.set(i.r,i.g,i.b):iZ.set(i.x,i.y,i.z||0,i.w||0),1===o?rZ.setScalar(r):r.isColor?rZ.set(r.r,r.g,r.b):rZ.set(r.x,r.y,r.z||0,r.w||0);const a=4,l=a*t.count,c=new Float32Array(l);for(let e=0;e<l;e++){const t=e%a,n=iZ.getComponent(t),i=rZ.getComponent(t);c[e]=cD.lerp(n,i,Math.random())}const u=this.getNodeType(e);if(t.count<=4096)n=Kz(c,"vec4",t.count).element(cV).convert(u);else{const t=new aO(c,4);e.geometry.setAttribute("__range"+this.id,t),n=zU(t).convert(u)}}else n=jk(0);return n}}sZ.type=QO("Range",sZ);class oZ extends YO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oZ.TARGET_DIRECTION,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.light=t}setup(){const{scope:e,light:t}=this;let n=null;return e===oZ.TARGET_DIRECTION&&(n=Az.transformDirection(gz(t).sub(gz(t.target)))),n}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}oZ.TARGET_DIRECTION="targetDirection",oZ.type=QO("Light",oZ);const aZ=Bk(oZ,oZ.TARGET_DIRECTION),lZ=Uk((e=>{let{depthTexture:t,shadowCoord:n}=e;return az(t,n.xy).compare(n.z)})),cZ=Uk((e=>{let{depthTexture:t,shadowCoord:n,shadow:i}=e;const r=(e,n)=>az(t,e).compare(n),s=nq("mapSize","vec2",i),o=nq("radius","float",i),a=Yk(1).div(s),l=a.x.negate().mul(o),c=a.y.negate().mul(o),u=a.x.mul(o),h=a.y.mul(o),d=l.div(2),p=c.div(2),A=u.div(2),f=h.div(2);return KB(r(n.xy.add(Yk(l,c)),n.z),r(n.xy.add(Yk(0,c)),n.z),r(n.xy.add(Yk(u,c)),n.z),r(n.xy.add(Yk(d,p)),n.z),r(n.xy.add(Yk(0,p)),n.z),r(n.xy.add(Yk(A,p)),n.z),r(n.xy.add(Yk(l,0)),n.z),r(n.xy.add(Yk(d,0)),n.z),r(n.xy,n.z),r(n.xy.add(Yk(A,0)),n.z),r(n.xy.add(Yk(u,0)),n.z),r(n.xy.add(Yk(d,f)),n.z),r(n.xy.add(Yk(0,f)),n.z),r(n.xy.add(Yk(A,f)),n.z),r(n.xy.add(Yk(l,h)),n.z),r(n.xy.add(Yk(0,h)),n.z),r(n.xy.add(Yk(u,h)),n.z)).mul(1/17)})),uZ=Uk((e=>{let{depthTexture:t,shadowCoord:n,shadow:i}=e;const r=(e,n)=>az(t,e).compare(n),s=nq("mapSize","vec2",i),o=Yk(1).div(s),a=o.x,l=o.y,c=n.xy,u=IF(c.mul(s).add(.5));return c.subAssign(u.mul(o)),KB(r(c,n.z),r(c.add(Yk(a,0)),n.z),r(c.add(Yk(0,l)),n.z),r(c.add(o),n.z),AU(r(c.add(Yk(a.negate(),0)),n.z),r(c.add(Yk(a.mul(2),0)),n.z),u.x),AU(r(c.add(Yk(a.negate(),l)),n.z),r(c.add(Yk(a.mul(2),l)),n.z),u.x),AU(r(c.add(Yk(0,l.negate())),n.z),r(c.add(Yk(0,l.mul(2))),n.z),u.y),AU(r(c.add(Yk(a,l.negate())),n.z),r(c.add(Yk(a,l.mul(2))),n.z),u.y),AU(AU(r(c.add(Yk(a.negate(),l.negate())),n.z),r(c.add(Yk(a.mul(2),l.negate())),n.z),u.x),AU(r(c.add(Yk(a.negate(),l.mul(2))),n.z),r(c.add(Yk(a.mul(2),l.mul(2))),n.z),u.x),u.y)).mul(1/9)})),hZ=[lZ,cZ,uZ];let dZ=null;class pZ extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.updateType=zO,this.light=e,this.color=new eI,this.colorNode=mB(this.color),this.baseColorNode=null,this.shadowMap=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0}getCacheKey(){return super.getCacheKey()+"-"+this.light.id+"-"+(this.light.castShadow?"1":"0")}getHash(){return this.light.uuid}setupShadow(e){const{object:t,renderer:n}=e;let i=this.shadowColorNode;if(null===i){null===dZ&&(dZ=new nG,dZ.fragmentNode=nB(0,0,0,1),dZ.isShadowNodeMaterial=!0,dZ.name="ShadowMaterial");const r=new vO;r.compareFunction=513;const s=this.light.shadow,o=e.createRenderTarget(s.mapSize.width,s.mapSize.height);o.depthTexture=r,s.camera.updateProjectionMatrix();const a=nq("intensity","float",s),l=nq("bias","float",s),c=nq("normalBias","float",s),u=t.material.shadowPositionNode||Ez;let h=mB(s.matrix).mul(u.add(Fz.mul(c)));h=h.xyz.div(h.w);let d=h.z.add(l);n.coordinateSystem===ZN&&(d=d.mul(2).sub(1)),h=Jk(h.x,h.y.oneMinus(),d);const p=h.x.greaterThanEqual(0).and(h.x.lessThanEqual(1)).and(h.y.greaterThanEqual(0)).and(h.y.lessThanEqual(1)).and(h.z.lessThanEqual(1)),A=s.filterNode||hZ[n.shadowMap.type]||null;if(null===A)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const f=az(o.texture,h),m=p.select(A({depthTexture:r,shadowCoord:h,shadow:s}),jk(1));this.shadowMap=o,this.shadowNode=m,this.shadowColorNode=i=this.colorNode.mul(AU(1,m.rgb.mix(f,1),a.mul(f.a))),this.baseColorNode=this.colorNode}this.colorNode=i,this.updateBeforeType=qO}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&this.disposeShadow()}updateShadow(e){const{shadowMap:t,light:n}=this,{renderer:i,scene:r,camera:s}=e,o=t.depthTexture.version;this._depthVersionCached=o;const a=r.overrideMaterial;r.overrideMaterial=dZ,t.setSize(n.shadow.mapSize.width,n.shadow.mapSize.height),n.shadow.updateMatrices(n),n.shadow.camera.layers.mask=s.layers.mask;const l=i.getRenderTarget(),c=i.getRenderObjectFunction();i.setRenderObjectFunction((function(e){if(!0===e.castShadow){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.renderObject(e,...n)}})),i.setRenderTarget(t),i.render(r,n.shadow.camera),i.setRenderTarget(l),i.setRenderObjectFunction(c),r.overrideMaterial=a}disposeShadow(){this.shadowMap.dispose(),this.shadowMap=null,this.shadowNode=null,this.shadowColorNode=null,this.baseColorNode=null,this.updateBeforeType=UO}updateBefore(e){const t=this.light.shadow;(t.needsUpdate||t.autoUpdate)&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}pZ.type=QO("AnalyticLight",pZ);const AZ=Uk((e=>{const{lightDistance:t,cutoffDistance:n,decayExponent:i}=e,r=t.pow(i).max(.01).reciprocal();return n.greaterThan(0).select(r.mul(t.div(n).pow4().oneMinus().clamp().pow2()),r)}));class fZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.cutoffDistanceNode=mB(0),this.decayExponentNode=mB(0)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setup(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:i,light:r}=this,s=e.context.lightingModel,o=vz(r).sub(Rz),a=o.normalize(),l=o.length(),c=AZ({lightDistance:l,cutoffDistance:n,decayExponent:i}),u=t.mul(c),h=e.context.reflectedLight;s.direct({lightDirection:a,lightColor:u,reflectedLight:h},e.stack,e)}}fZ.type=QO("PointLight",fZ);class mZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}setup(e){super.setup(e);const t=e.context.lightingModel,n=this.colorNode,i=aZ(this.light),r=e.context.reflectedLight;t.direct({lightDirection:i,lightColor:n,reflectedLight:r},e.stack,e)}}mZ.type=QO("DirectionalLight",mZ);const gZ=new hL,vZ=new hL;let yZ=null;class bZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.halfHeight=mB(new OD),this.halfWidth=mB(new OD)}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;vZ.identity(),gZ.copy(t.matrixWorld),gZ.premultiply(n),vZ.extractRotation(gZ),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(vZ),this.halfHeight.value.applyMatrix4(vZ)}setup(e){let t,n;super.setup(e),e.isAvailable("float32Filterable")?(t=az(yZ.LTC_FLOAT_1),n=az(yZ.LTC_FLOAT_2)):(t=az(yZ.LTC_HALF_1),n=az(yZ.LTC_HALF_2));const{colorNode:i,light:r}=this,s=e.context.lightingModel,o=vz(r),a=e.context.reflectedLight;s.directRectArea({lightColor:i,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,reflectedLight:a,ltc_1:t,ltc_2:n},e.stack,e)}static setLTC(e){yZ=e}}bZ.type=QO("RectAreaLight",bZ);class xZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.coneCosNode=mB(0),this.penumbraCosNode=mB(0),this.cutoffDistanceNode=mB(0),this.decayExponentNode=mB(0)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:n}=this;return gU(t,n,e)}setup(e){super.setup(e);const t=e.context.lightingModel,{colorNode:n,cutoffDistanceNode:i,decayExponentNode:r,light:s}=this,o=vz(s).sub(Rz),a=o.normalize(),l=a.dot(aZ(s)),c=this.getSpotAttenuation(l),u=o.length(),h=AZ({lightDistance:u,cutoffDistance:i,decayExponent:r}),d=n.mul(c).mul(h),p=e.context.reflectedLight;t.direct({lightDirection:a,lightColor:d,reflectedLight:p},e.stack,e)}}xZ.type=QO("SpotLight",xZ);class _Z extends xZ{getSpotAttenuation(e){const t=this.light.iesMap;let n=null;if(t&&!0===t.isTexture){const i=e.acos().mul(1/Math.PI);n=az(t,Yk(i,0),0).r}else n=super.getSpotAttenuation(e);return n}}_Z.type=QO("IESSpotLight",_Z);class wZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}setup(e){let{context:t}=e;t.irradiance.addAssign(this.colorNode)}}wZ.type=QO("AmbientLight",wZ);class SZ extends pZ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(e),this.lightPositionNode=gz(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=mB(new eI)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:i}=this,r=Bz.dot(i).mul(.5).add(.5),s=AU(n,t,r);e.context.irradiance.addAssign(s)}}SZ.type=QO("HemisphereLight",SZ);class TZ extends pZ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null);const e=[];for(let t=0;t<9;t++)e.push(new OD);this.lightProbe=$z(e)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=MZ(Fz,this.lightProbe);e.context.irradiance.addAssign(t)}}TZ.type=QO("LightProbe",TZ);const MZ=Uk((e=>{let[t,n]=e;const i=t.x,r=t.y,s=t.z,o=n.element(0).mul(.886227);return o.addAssign(n.element(1).mul(1.023328).mul(r)),o.addAssign(n.element(2).mul(1.023328).mul(s)),o.addAssign(n.element(3).mul(1.023328).mul(i)),o.addAssign(n.element(4).mul(.858086).mul(i).mul(r)),o.addAssign(n.element(5).mul(.858086).mul(r).mul(s)),o.addAssign(n.element(6).mul(s.mul(s).mul(.743125).sub(.247708))),o.addAssign(n.element(7).mul(.858086).mul(i).mul(s)),o.addAssign(n.element(8).mul(.429043).mul(JB(i,i).sub(JB(r,r)))),o}));class EZ{parseFunction(){console.warn("Abstract function.")}}class CZ{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.type=e,this.inputs=t,this.name=n,this.precision=i}getCode(){console.warn("Abstract function.")}}CZ.isNodeFunction=!0;const RZ=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,PZ=/[a-z_0-9]+/gi,NZ="#pragma main";class DZ extends CZ{constructor(e){const{type:t,inputs:n,name:i,precision:r,inputsCode:s,blockCode:o,headerCode:a}=(e=>{const t=(e=e.trim()).indexOf(NZ),n=-1!==t?e.slice(t+12):e,i=n.match(RZ);if(null!==i&&5===i.length){const r=i[4],s=[];let o=null;for(;null!==(o=PZ.exec(r));)s.push(o);const a=[];let l=0;for(;l<s.length;){const e="const"===s[l][0];!0===e&&l++;let t=s[l][0];"in"===t||"out"===t||"inout"===t?l++:t="";const n=s[l++][0];let i=Number.parseInt(s[l][0]);!1===Number.isNaN(i)?l++:i=null;const r=s[l++][0];a.push(new JX(n,r,i,t,e))}const c=n.substring(i[0].length),u=void 0!==i[3]?i[3]:"";return{type:i[2],inputs:a,name:u,precision:void 0!==i[1]?i[1]:"",inputsCode:r,blockCode:c,headerCode:-1!==t?e.slice(0,t):""}}throw new Error("FunctionNode: Function is not a GLSL code.")})(e);super(t,n,i,r),this.inputsCode=s,this.blockCode=o,this.headerCode=a}getCode(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name;const n=this.blockCode;if(""!==n){const{type:i,inputsCode:r,headerCode:s,precision:o}=this;let a="".concat(i," ").concat(t," ( ").concat(r.trim()," )");""!==o&&(a="".concat(o," ").concat(a)),e=s+a+n}else e="";return e}}class LZ extends EZ{parseFunction(e){return new DZ(e)}}function IZ(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function OZ(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}class kZ{constructor(){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparent=[],this.bundles=[],this.lightsNode=new EV([]),this.lightsArray=[],this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,i,r,s){let o=this.renderItems[this.renderItemsIndex];return void 0===o?(o={id:e.id,object:e,geometry:t,material:n,groupOrder:i,renderOrder:e.renderOrder,z:r,group:s},this.renderItems[this.renderItemsIndex]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=n,o.groupOrder=i,o.renderOrder=e.renderOrder,o.z=r,o.group=s),this.renderItemsIndex++,o}push(e,t,n,i,r,s){const o=this.getNextRenderItem(e,t,n,i,r,s);!0===e.occlusionTest&&this.occlusionQueryCount++,(!0===n.transparent||n.transmission>0?this.transparent:this.opaque).push(o)}unshift(e,t,n,i,r,s){const o=this.getNextRenderItem(e,t,n,i,r,s);(!0===n.transparent?this.transparent:this.opaque).unshift(o)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}getLightsNode(){return this.lightsNode.fromLights(this.lightsArray)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||IZ),this.transparent.length>1&&this.transparent.sort(t||OZ)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const t=this.renderItems[e];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.groupOrder=null,t.renderOrder=null,t.z=null,t.group=null}}}class BZ{constructor(){this.lists=new CW}get(e,t){const n=this.lists,i=[e,t];let r=n.get(i);return void 0===r&&(r=new kZ,n.set(i,r)),r}dispose(){this.lists=new CW}}let FZ=0;class UZ{constructor(){this.id=FZ++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new PD,this.scissor=!1,this.scissorValue=new PD,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.sampleCount=1,this.width=0,this.height=0,this.isRenderContext=!0}getCacheKey(){return zZ(this)}}function zZ(e){const{textures:t,activeCubeFace:n}=e;let i="";for(const r of t)i+=r.id+",";return i+=n,i}class qZ{constructor(){this.chainMaps={}}get(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=[e,t];let r;if(null===n)r="default";else{const e=n.texture.format,t=n.textures.length;r="".concat(t,":").concat(e,":").concat(n.samples,":").concat(n.depthBuffer,":").concat(n.stencilBuffer)}const s=this.getChainMap(r);let o=s.get(i);return void 0===o&&(o=new UZ,s.set(i,o)),null!==n&&(o.sampleCount=0===n.samples?1:n.samples),o}getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new CW)}dispose(){this.chainMaps={}}}const VZ=new OD;class GZ extends IW{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.get(e),i=0===e.samples?1:e.samples,r=n.depthTextureMips||(n.depthTextureMips={}),s=e.textures,o=this.getSize(s[0]),a=o.width>>t,l=o.height>>t;let c=e.depthTexture||r[t],u=!1;void 0===c&&(c=new vO,c.format=e.stencilBuffer?$P:JP,c.type=e.stencilBuffer?QP:WP,c.image.width=a,c.image.height=l,r[t]=c),n.width===o.width&&o.height===n.height||(u=!0,c.needsUpdate=!0,c.image.width=a,c.image.height=l),n.width=o.width,n.height=o.height,n.textures=s,n.depthTexture=c,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==i&&(u=!0,c.needsUpdate=!0,n.sampleCount=i);const h={sampleCount:i};for(let d=0;d<s.length;d++){const e=s[d];u&&(e.needsUpdate=!0),this.updateTexture(e,h)}if(this.updateTexture(c,h),!0!==n.initialized){n.initialized=!0;const t=()=>{e.removeEventListener("dispose",t);for(let e=0;e<s.length;e++)this._destroyTexture(s[e]);this._destroyTexture(c),this.delete(e)};e.addEventListener("dispose",t)}}updateTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.get(e);if(!0===n.initialized&&n.version===e.version)return;const i=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,r=this.backend;if(i&&!0===n.initialized&&(r.destroySampler(e),r.destroyTexture(e)),e.isFramebufferTexture){const t=this.renderer.getRenderTarget();e.type=t?t.texture.type:qP}const{width:s,height:o,depth:a}=this.getSize(e);if(t.width=s,t.height=o,t.depth=a,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,s,o):1,i||!0===e.isStorageTexture)r.createSampler(e),r.createTexture(e,t),n.generation=e.version;else{if(!0!==n.initialized&&r.createSampler(e),e.version>0){const i=e.image;if(void 0===i)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===i.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const n=[];for(const t of e.images)n.push(t);t.images=n}else t.image=i;void 0!==n.isDefaultTexture&&!0!==n.isDefaultTexture||(r.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),!0===e.source.dataReady&&r.updateTexture(e,t),t.needsMipmaps&&0===e.mipmaps.length&&r.generateMipmaps(e)}}else r.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version}if(!0!==n.initialized){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const t=()=>{e.removeEventListener("dispose",t),this._destroyTexture(e),this.info.memory.textures--};e.addEventListener("dispose",t)}n.version=e.version}getSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:VZ,n=e.images?e.images[0]:e.image;return n?(void 0!==n.image&&(n=n.image),t.width=n.width,t.height=n.height,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let i;return i=e.isCompressedTexture?e.mipmaps.length:Math.floor(Math.log2(Math.max(t,n)))+1,i}needsMipmaps(e){return!!this.isEnvironmentTexture(e)||(!0===e.isCompressedTexture||e.minFilter!==OP&&e.minFilter!==FP)}isEnvironmentTexture(e){const t=e.mapping;return t===PP||t===NP||t===CP||t===RP}_destroyTexture(e){this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e)}}class jZ extends eI{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.a=i}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.a=i,super.set(e,t,n)}copy(e){return void 0!==e.a&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}const HZ=new WeakMap;class WZ extends JO{constructor(){super("vec2"),this.updateType=VO,this.updateAfterType=VO,this.previousProjectionMatrix=mB(new hL),this.previousModelViewMatrix=mB(new hL)}update(e){let{camera:t,object:n}=e;const i=XZ(n),r=XZ(t);this.previousModelViewMatrix.value.copy(i),this.previousProjectionMatrix.value.copy(r)}updateAfter(e){let{camera:t,object:n}=e;const i=XZ(n),r=XZ(t);i.copy(n.modelViewMatrix),r.copy(t.projectionMatrix)}setup(){const e=pz.mul(bz).mul(Tz),t=this.previousProjectionMatrix.mul(this.previousModelViewMatrix).mul(Mz),n=e.xy.div(e.w),i=t.xy.div(t.w);return ZB(n,i)}}function XZ(e){let t=HZ.get(e);return void 0===t&&(t=new hL,HZ.set(e,t)),t}WZ.type=QO("Velocity",WZ);const YZ=Uk((e=>{let[t]=e;const n=t.mul(.9478672986).add(.0521327014).pow(2.4),i=t.mul(.0773993808),r=t.lessThanEqual(.04045);return AU(n,i,r)})).setLayout({name:"sRGBToLinear",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),QZ=Uk((e=>{let[t]=e;const n=t.pow(.41666).mul(1.055).sub(.055),i=t.mul(12.92),r=t.lessThanEqual(.0031308);return AU(n,i,r)})).setLayout({name:"LinearTosRGB",type:"vec3",inputs:[{name:"color",type:"vec3"}]});const KZ=Uk((e=>{let[t,n]=e;return t.mul(n).clamp()})).setLayout({name:"LinearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),ZZ=Uk((e=>{let[t,n]=e;return t=t.mul(n),t.div(t.add(1)).clamp()})).setLayout({name:"ReinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),JZ=Uk((e=>{let[t,n]=e;t=t.mul(n),t=t.sub(.004).max(0);const i=t.mul(t.mul(6.2).add(.5)),r=t.mul(t.mul(6.2).add(1.7)).add(.06);return i.div(r).pow(2.2)})).setLayout({name:"CineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),$Z=Uk((e=>{let[t]=e;const n=t.mul(t.add(.0245786)).sub(90537e-9),i=t.mul(t.add(.432951).mul(.983729)).add(.238081);return n.div(i)})),eJ=Uk((e=>{let[t,n]=e;const i=aB(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),r=aB(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return t=t.mul(n).div(.6),t=i.mul(t),t=$Z(t),t=r.mul(t),t.clamp()})).setLayout({name:"ACESFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),tJ=aB(Jk(1.6605,-.1246,-.0182),Jk(-.5876,1.1329,-.1006),Jk(-.0728,-.0083,1.1187)),nJ=aB(Jk(.6274,.0691,.0164),Jk(.3293,.9195,.088),Jk(.0433,.0113,.8956)),iJ=Uk((e=>{let[t]=e;const n=Jk(t).toVar(),i=Jk(n.mul(n)).toVar(),r=Jk(i.mul(i)).toVar();return jk(15.5).mul(r.mul(i)).sub(JB(40.14,r.mul(n))).add(JB(31.96,r).sub(JB(6.868,i.mul(n))).add(JB(.4298,i).add(JB(.1191,n).sub(.00232))))})),rJ=Uk((e=>{let[t,n]=e;const i=Jk(t).toVar(),r=aB(Jk(.856627153315983,.137318972929847,.11189821299995),Jk(.0951212405381588,.761241990602591,.0767994186031903),Jk(.0482516061458583,.101439036467562,.811302368396859)),s=aB(Jk(1.1271005818144368,-.1413297634984383,-.14132976349843826),Jk(-.11060664309660323,1.157823702216272,-.11060664309660294),Jk(-.016493938717834573,-.016493938717834257,1.2519364065950405)),o=jk(-12.47393),a=jk(4.026069);return i.mulAssign(n),i.assign(nJ.mul(i)),i.assign(r.mul(i)),i.assign(tU(i,1e-10)),i.assign(CF(i)),i.assign(i.sub(o).div(a.sub(o))),i.assign(fU(i,0,1)),i.assign(iJ(i)),i.assign(s.mul(i)),i.assign(cU(tU(Jk(0),i),Jk(2.2))),i.assign(tJ.mul(i)),i.assign(fU(i,0,1)),i})).setLayout({name:"AgXToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),sJ=Uk((e=>{let[t,n]=e;const i=jk(.76),r=jk(.15);t=t.mul(n);const s=eU(t.r,eU(t.g,t.b)),o=xU(s.lessThan(.08),s.sub(JB(6.25,s.mul(s))),.04);t.subAssign(o);const a=tU(t.r,tU(t.g,t.b));Vk(a.lessThan(i),(()=>t));const l=ZB(1,i),c=ZB(1,l.mul(l).div(a.add(l.sub(i))));t.mulAssign(c.div(a));const u=ZB(1,$B(1,r.mul(a.sub(c)).add(1)));return AU(t,Jk(c),u)})).setLayout({name:"NeutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});const oJ=new jZ;class aJ extends IW{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const i=this.renderer,r=this.nodes.getBackgroundNode(e)||e.background;let s=!1;if(null===r)i._clearColor.getRGB(oJ,LN),oJ.a=i._clearColor.a;else if(!0===r.isColor)r.getRGB(oJ,LN),oJ.a=1,s=!0;else if(!0===r.isNode){const n=this.get(e),s=r;oJ.copy(i._clearColor);let o=n.backgroundMesh;if(void 0===o){const e=wU(nB(s).mul(FY),{getUV:()=>Fz,getTextureLevel:()=>BY});let t=oV();t=t.setZ(t.w);const i=new nG;i.name="Background.material",i.side=1,i.depthTest=!1,i.depthWrite=!1,i.fog=!1,i.lights=!1,i.vertexNode=t,i.colorNode=e,n.backgroundMeshNode=e,n.backgroundMesh=o=new qI(new yO(1,32,32),i),o.frustumCulled=!1,o.name="Background.mesh",o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)}}const a=s.getCacheKey();n.backgroundCacheKey!==a&&(n.backgroundMeshNode.node=nB(s).mul(FY),n.backgroundMeshNode.needsUpdate=!0,o.material.needsUpdate=!0,n.backgroundCacheKey=a),t.unshift(o,o.geometry,o.material,0,0,null)}else console.error("THREE.Renderer: Unsupported background configuration.",r);if(!0===i.autoClear||!0===s){oJ.multiplyScalar(oJ.a);const e=n.clearColorValue;e.r=oJ.r,e.g=oJ.g,e.b=oJ.b,e.a=oJ.a,n.depthClearValue=i._clearDepth,n.stencilClearValue=i._clearStencil,n.clearColor=!0===i.autoClearColor,n.clearDepth=!0===i.autoClearDepth,n.clearStencil=!0===i.autoClearStencil}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}class lJ{constructor(e,t,n,i,r,s,o,a){let l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=c,this.nodeAttributes=i,this.bindings=r,this.updateNodes=s,this.updateBeforeNodes=o,this.updateAfterNodes=a,this.instanceBindGroups=l,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings){if(!0!==(this.instanceBindGroups&&t.bindings[0].groupNode.shared)){const n=new HX(t.name,[],t.index,t);e.push(n);for(const e of t.bindings)n.bindings.push(e.clone())}else e.push(t)}return e}}const cJ=new WeakMap;class uJ extends IW{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new ZX,this.nodeBuilderCache=new Map,this.callHashCache=new CW,this.groupsData=new CW}updateGroup(e){const t=e.groupNode,n=t.name;if(n===AB.name)return!0;if(n===pB.name){const t=this.get(e),n=this.nodeFrame.renderId;return t.renderId!==n&&(t.renderId=n,!0)}if(n===dB.name){const t=this.get(e),n=this.nodeFrame.frameId;return t.frameId!==n&&(t.frameId=n,!0)}const i=[t,e];let r=this.groupsData.get(i);return void 0===r&&this.groupsData.set(i,r={}),r.version!==t.version&&(r.version=t.version,!0)}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(void 0===n){const{nodeBuilderCache:i}=this,r=this.getForRenderCacheKey(e);if(n=i.get(r),void 0===n){const t=this.backend.createNodeBuilder(e.object,this.renderer);t.scene=e.scene,t.material=e.material,t.camera=e.camera,t.context.material=e.material,t.lightsNode=e.lightsNode,t.environmentNode=this.getEnvironmentNode(e.scene),t.fogNode=this.getFogNode(e.scene),t.clippingContext=e.clippingContext,t.build(),n=this._createNodeBuilderState(t),i.set(r,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(void 0===n){const i=this.backend.createNodeBuilder(e,this.renderer);i.build(),n=this._createNodeBuilderState(i),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new lJ(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.instanceBindGroups,e.transforms)}getEnvironmentNode(e){return e.environmentNode||this.get(e).environmentNode||null}getBackgroundNode(e){return e.backgroundNode||this.get(e).backgroundNode||null}getFogNode(e){return e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){const n=[e,t],i=this.renderer.info.calls;let r=this.callHashCache.get(n);if(void 0===r||r.callId!==i){const s=this.getEnvironmentNode(e),o=this.getFogNode(e),a=[];t&&a.push(t.getCacheKey(!0)),s&&a.push(s.getCacheKey()),o&&a.push(o.getCacheKey()),r={callId:i,cacheKey:a.join(",")},this.callHashCache.set(n,r)}return r.cacheKey}updateScene(e){this.updateEnvironment(e),this.updateFog(e),this.updateBackground(e)}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const i=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;if(t.background!==n||i){let i=null;if(!0===n.isCubeTexture||n.mapping===PP||n.mapping===NP)if(e.backgroundBlurriness>0)i=Kj(n,Fz);else{let e;e=!0===n.isCubeTexture?Yz(n):az(n),i=xG(e)}else!0===n.isTexture?i=az(n,zV.flipY()).setUpdateMatrix(!0):!0!==n.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",n);t.backgroundNode=i,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){let e=null;n.isFogExp2?e=nZ(nq("color","color",n),nq("density","float",n)):n.isFog?e=eZ(nq("color","color",n),nq("near","float",n),nq("far","float",n)):console.error("WebGPUNodes: Unsupported fog configuration.",n),t.fogNode=e,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){let e=null;!0===n.isCubeTexture?e=Yz(n):!0===n.isTexture?e=az(n):console.error("Nodes: Unsupported environment configuration.",n),t.environmentNode=e,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderer,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const s=this.nodeFrame;return s.renderer=e,s.scene=t,s.object=n,s.camera=i,s.material=r,s}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace}hasOutputChange(e){return cJ.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),i=az(e,zV).renderOutput(t.toneMapping,t.currentColorSpace);return cJ.set(e,n),i}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const i of n.updateNodes)t.updateNode(i)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const i of n.updateNodes)t.updateNode(i)}dispose(){super.dispose(),this.nodeFrame=new ZX,this.nodeBuilderCache=new Map}}class hJ{constructor(e,t){this.scene=e,this.camera=t}clone(){return Object.assign(new this.constructor,this)}}class dJ{constructor(){this.lists=new CW}get(e,t){const n=this.lists,i=[e,t];let r=n.get(i);return void 0===r&&(r=new hJ(e,t),n.set(i,r)),r}dispose(){this.lists=new CW}}class pJ{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map,this.colorSpaceNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(null!==n){t=new n;for(const n in e)t[n]=e[n]}return t}addColorSpace(e,t){this.addType(e,t,this.colorSpaceNodes)}getColorSpaceFunction(e){return this.colorSpaceNodes.get(e)||null}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t.name,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t))console.warn("Redefinition of node ".concat(t));else{if("function"!==typeof e)throw new Error("Node class ".concat(e.name," is not a class."));if("function"===typeof t||"object"===typeof t)throw new Error("Base class ".concat(t," is not a class."));n.set(t,e)}}addClass(e,t,n){if(n.has(t))console.warn("Redefinition of node ".concat(t.name));else{if("function"!==typeof e)throw new Error("Node class ".concat(e.name," is not a class."));if("function"!==typeof t)throw new Error("Base class ".concat(t.name," is not a class."));n.set(t,e)}}}const AJ=new tO,fJ=new uD,mJ=new PD,gJ=new AO,vJ=new hL,yJ=new OD;class bJ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:i=!0,antialias:r=!1,samples:s=0,getFallback:o=null}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=s||!0===r?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=i,this.logarithmicDepthBuffer=n,this.outputColorSpace=DN,this.toneMapping=0,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=!0,this.stencil=!1,this.clippingPlanes=[],this.info=new GW,this.nodes={library:new pJ},this._getFallback=o,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new PD(0,0,this._width,this._height),this._scissor=new PD(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new PY(new nG),this._quad.material.type="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const a=!0===this.alpha?0:1;this._clearColor=new jZ(0,0,0,a),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:1},this.xr={enabled:!1},this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(e,t,n)=>{await this.compileAsync(e,t);const i=this._renderLists.get(e,t),r=this._renderContexts.get(e,t,this._renderTarget),s=e.overrideMaterial||n.material,o=this._objects.get(n,s,e,t,i.lightsNode,r),{fragmentShader:a,vertexShader:l}=o.getNodeBuilderState();return{fragmentShader:a,vertexShader:l}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return null!==this._initPromise||(this._initPromise=new Promise((async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(i){if(null===this._getFallback)return void t(i);try{this.backend=n=this._getFallback(i),await n.init(this)}catch(i){return void t(i)}}this._nodes=new uJ(this,n),this._animation=new EW(this._nodes,this.info),this._attributes=new UW(n),this._background=new aJ(this,this._nodes),this._geometries=new VW(this._attributes,this.info),this._textures=new GZ(this,n,this.info),this._pipelines=new QW(n,this._nodes),this._bindings=new KW(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new LW(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new BZ,this._bundles=new dJ,this._renderContexts=new qZ,this._initialized=!0,e()}))),this._initPromise}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!1===this._initialized&&await this.init();const i=this._nodes.nodeFrame,r=i.renderId,s=this._currentRenderContext,o=this._currentRenderObjectFunction,a=this._compilationPromises,l=!0===e.isScene?e:AJ;null===n&&(n=e);const c=this._renderTarget,u=this._renderContexts.get(n,t,c),h=this._activeMipmapLevel,d=[];this._currentRenderContext=u,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=d,i.renderId++,i.update(),u.depth=this.depth,u.stencil=this.stencil,u.clippingContext||(u.clippingContext=new PW),u.clippingContext.updateGlobal(this,t),l.onBeforeRender(this,e,t,c);const p=this._renderLists.get(e,t);if(p.begin(),this._projectObject(e,t,0,p),n!==e&&n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&p.pushLight(e)})),p.finish(),null!==c){this._textures.updateRenderTarget(c,h);const e=this._textures.get(c);u.textures=e.textures,u.depthTexture=e.depthTexture}else u.textures=null,u.depthTexture=null;this._nodes.updateScene(l),this._background.update(l,p,u);const A=p.opaque,f=p.transparent,m=p.lightsNode;!0===this.opaque&&A.length>0&&this._renderObjects(A,t,l,m),!0===this.transparent&&f.length>0&&this._renderObjects(f,t,l,m),i.renderId=r,this._currentRenderContext=s,this._currentRenderObjectFunction=o,this._compilationPromises=a,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(d)}async renderAsync(e,t){!1===this._initialized&&await this.init();const n=this._renderScene(e,t);await this.backend.resolveTimestampAsync(n,"render")}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}_renderBundle(e,t,n){const{object:i,camera:r,renderList:s}=e,o=this._currentRenderContext,a=this._bundles.get(i,r),l=this.backend.get(a);void 0===l.renderContexts&&(l.renderContexts=new Set);const c=!1===l.renderContexts.has(o)||!0===i.needsUpdate;if(l.renderContexts.add(o),c){this.backend.beginBundle(o),void 0!==l.renderObjects&&!0!==i.needsUpdate||(l.renderObjects=[]),this._currentRenderBundle=a;const e=s.opaque;e.length>0&&this._renderObjects(e,r,t,n),this._currentRenderBundle=null,this.backend.finishBundle(o,a),i.needsUpdate=!1}else{const e=l.renderObjects;for(let t=0,n=e.length;t<n;t++){const n=e[t];this._nodes.updateBefore(n),n.object.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,n.object.matrixWorld),n.object.normalMatrix.getNormalMatrix(n.object.modelViewMatrix),this._nodes.updateForRender(n),this._bindings.updateForRender(n),this._nodes.updateAfter(n)}}this.backend.addBundle(o,a)}render(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(!1===(0!==e)&&!1===(t!==LN))return null;const{width:n,height:i}=this.getDrawingBufferSize(fJ),{depth:r,stencil:s}=this;let o=this._frameBufferTarget;return null===o&&(o=new ND(n,i,{depthBuffer:r,stencilBuffer:s,type:YP,format:ZP,colorSpace:LN,generateMipmaps:!1,minFilter:FP,magFilter:FP,samples:this.samples}),o.isPostProcessingRenderTarget=!0,this._frameBufferTarget=o),o.depthBuffer=r,o.stencilBuffer=s,o.setSize(n,i),o.viewport.copy(this._viewport),o.scissor.copy(this._scissor),o.viewport.multiplyScalar(this._pixelRatio),o.scissor.multiplyScalar(this._pixelRatio),o.scissorTest=this._scissorTest,o}_renderScene(e,t){const n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,r=i.renderId,s=this._currentRenderContext,o=this._currentRenderObjectFunction,a=!0===e.isScene?e:AJ,l=this._renderTarget,c=this._activeCubeFace,u=this._activeMipmapLevel;let h;null!==n?(h=n,this.setRenderTarget(h)):h=l;const d=this._renderContexts.get(e,t,h);this._currentRenderContext=d,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const p=this.coordinateSystem;t.coordinateSystem!==p&&(t.coordinateSystem=p,t.updateProjectionMatrix()),!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld();let A=this._viewport,f=this._scissor,m=this._pixelRatio;null!==h&&(A=h.viewport,f=h.scissor,m=1),this.getDrawingBufferSize(fJ),mJ.set(0,0,fJ.width,fJ.height);const g=void 0===A.minDepth?0:A.minDepth,v=void 0===A.maxDepth?1:A.maxDepth;d.viewportValue.copy(A).multiplyScalar(m).floor(),d.viewportValue.width>>=u,d.viewportValue.height>>=u,d.viewportValue.minDepth=g,d.viewportValue.maxDepth=v,d.viewport=!1===d.viewportValue.equals(mJ),d.scissorValue.copy(f).multiplyScalar(m).floor(),d.scissor=this._scissorTest&&!1===d.scissorValue.equals(mJ),d.scissorValue.width>>=u,d.scissorValue.height>>=u,d.clippingContext||(d.clippingContext=new PW),d.clippingContext.updateGlobal(this,t),a.onBeforeRender(this,e,t,h),vJ.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),gJ.setFromProjectionMatrix(vJ,p);const y=this._renderLists.get(e,t);if(y.begin(),this._projectObject(e,t,0,y),y.finish(),!0===this.sortObjects&&y.sort(this._opaqueSort,this._transparentSort),null!==h){this._textures.updateRenderTarget(h,u);const e=this._textures.get(h);d.textures=e.textures,d.depthTexture=e.depthTexture,d.width=e.width,d.height=e.height,d.renderTarget=h,d.depth=h.depthBuffer,d.stencil=h.stencilBuffer}else d.textures=null,d.depthTexture=null,d.width=this.domElement.width,d.height=this.domElement.height,d.depth=this.depth,d.stencil=this.stencil;d.width>>=u,d.height>>=u,d.activeCubeFace=c,d.activeMipmapLevel=u,d.occlusionQueryCount=y.occlusionQueryCount,this._nodes.updateScene(a),this._background.update(a,y,d),this.backend.beginRender(d);const b=y.opaque,x=y.transparent,_=y.bundles,w=y.lightsNode;if(_.length>0&&this._renderBundles(_,a,w),!0===this.opaque&&b.length>0&&this._renderObjects(b,t,a,w),!0===this.transparent&&x.length>0&&this._renderObjects(x,t,a,w),this.backend.finishRender(d),i.renderId=r,this._currentRenderContext=s,this._currentRenderObjectFunction=o,null!==n){this.setRenderTarget(l,c,u);const e=this._quad;this._nodes.hasOutputChange(h.texture)&&(e.material.fragmentNode=this._nodes.getOutputNode(h.texture),e.material.needsUpdate=!0),this._renderScene(e,e.camera,!1)}return a.onAfterRender(this,e,t,h),d}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){!1===this._initialized&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._pixelRatio=e,this.setSize(this._width,this._height,!1)}setDrawingBufferSize(e,t,n){this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setSize(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===n&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,i){const r=this._scissor;e.isVector4?r.copy(e):r.set(e,t,n,i)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;const o=this._viewport;e.isVector4?o.copy(e):o.set(e,t,n,i),o.minDepth=r,o.maxDepth=s}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const i=this._renderTarget||this._getFrameBufferTarget();let r=null;if(null!==i&&(this._textures.updateRenderTarget(i),r=this._textures.get(i)),this.backend.clear(e,t,n,r),null!==i&&null===this._renderTarget){const e=this._quad;this._nodes.hasOutputChange(i.texture)&&(e.material.fragmentNode=this._nodes.getOutputNode(i.texture),e.material.needsUpdate=!0),this._renderScene(e,e.camera,!1)}}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===this._initialized&&await this.init(),this.clear(e,t,n)}clearColorAsync(){return this.clearAsync(!0,!1,!1)}clearDepthAsync(){return this.clearAsync(!1,!0,!1)}clearStencilAsync(){return this.clearAsync(!1,!1,!0)}get currentToneMapping(){return null!==this._renderTarget?0:this.toneMapping}get currentColorSpace(){return null!==this._renderTarget?LN:this.outputColorSpace}dispose(){this.info.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}async computeAsync(e){!1===this._initialized&&await this.init();const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const i=this.backend,r=this._pipelines,s=this._bindings,o=this._nodes,a=Array.isArray(e)?e:[e];if(void 0===a[0]||!0!==a[0].isComputeNode)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");i.beginCompute(e);for(const l of a){if(!1===r.has(l)){const e=()=>{l.removeEventListener("dispose",e),r.delete(l),s.delete(l),o.delete(l)};l.addEventListener("dispose",e),l.onInit({renderer:this})}o.updateForCompute(l),s.updateForCompute(l);const t=s.getForCompute(l),n=r.getForCompute(l,t);i.compute(e,l,t,n)}i.finishCompute(e),await this.backend.resolveTimestampAsync(e,"compute"),t.renderId=n}async hasFeatureAsync(e){return!1===this._initialized&&await this.init(),this.backend.hasFeature(e)}hasFeature(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}copyFramebufferToTexture(e){const t=this._currentRenderContext;this._textures.updateTexture(e),this.backend.copyFramebufferToTexture(e,t)}copyTextureToTexture(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,i,r)}readRenderTargetPixelsAsync(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this.backend.copyTextureToBuffer(e.textures[s],t,n,i,r)}_projectObject(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)i.pushLight(e);else if(e.isSprite){if(!e.frustumCulled||gJ.intersectsSprite(e)){!0===this.sortObjects&&yJ.setFromMatrixPosition(e.matrixWorld).applyMatrix4(vJ);const t=e.geometry,r=e.material;r.visible&&i.push(e,t,r,n,yJ.z,null)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||gJ.intersectsObject(e))){const t=e.geometry,r=e.material;if(!0===this.sortObjects&&(null===t.boundingSphere&&t.computeBoundingSphere(),yJ.copy(t.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(vJ)),Array.isArray(r)){const s=t.groups;for(let o=0,a=s.length;o<a;o++){const a=s[o],l=r[a.materialIndex];l&&l.visible&&i.push(e,t,l,n,yJ.z,a)}}else r.visible&&i.push(e,t,r,n,yJ.z,null)}if(!0===e.static&&void 0!==this.backend.beginBundle){const n=i;(i=this._renderLists.get(e,t)).begin(),n.pushBundle({object:e,camera:t,renderList:i}),i.finish()}const r=e.children;for(let s=0,o=r.length;s<o;s++)this._projectObject(r[s],t,n,i)}_renderBundles(e,t,n){for(const i of e)this._renderBundle(i,t,n)}_renderObjects(e,t,n,i){for(let r=0,s=e.length;r<s;r++){const s=e[r],{object:o,geometry:a,material:l,group:c}=s;if(t.isArrayCamera){const e=t.cameras;for(let t=0,r=e.length;t<r;t++){const r=e[t];if(o.layers.test(r.layers)){const e=r.viewport,t=void 0===e.minDepth?0:e.minDepth,s=void 0===e.maxDepth?1:e.maxDepth,u=this._currentRenderContext.viewportValue;u.copy(e).multiplyScalar(this._pixelRatio).floor(),u.minDepth=t,u.maxDepth=s,this.backend.updateViewport(this._currentRenderContext),this._currentRenderObjectFunction(o,n,r,a,l,c,i)}}}else this._currentRenderObjectFunction(o,n,t,a,l,c,i)}}renderObject(e,t,n,i,r,s,o){let a,l,c;if(e.onBeforeRender(this,t,n,i,r,s),null!==t.overrideMaterial){const e=t.overrideMaterial;r.positionNode&&r.positionNode.isNode&&(a=e.positionNode,e.positionNode=r.positionNode),e.isShadowNodeMaterial&&(e.side=null===r.shadowSide?r.side:r.shadowSide,r.depthNode&&r.depthNode.isNode&&(c=e.depthNode,e.depthNode=r.depthNode),r.shadowNode&&r.shadowNode.isNode&&(l=e.fragmentNode,e.fragmentNode=r.shadowNode),this.localClippingEnabled&&(r.clipShadows?(e.clippingPlanes!==r.clippingPlanes&&(e.clippingPlanes=r.clippingPlanes,e.needsUpdate=!0),e.clipIntersection!==r.clipIntersection&&(e.clipIntersection=r.clipIntersection)):Array.isArray(e.clippingPlanes)&&(e.clippingPlanes=null,e.needsUpdate=!0))),r=e}!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,this._handleObjectFunction(e,r,t,n,o,s,"backSide"),r.side=0,this._handleObjectFunction(e,r,t,n,o,s),r.side=2):this._handleObjectFunction(e,r,t,n,o,s),void 0!==a&&(t.overrideMaterial.positionNode=a),void 0!==c&&(t.overrideMaterial.depthNode=c),void 0!==l&&(t.overrideMaterial.fragmentNode=l),e.onAfterRender(this,t,n,i,r,s)}_renderObjectDirect(e,t,n,i,r,s,o){const a=this._objects.get(e,t,n,i,r,this._currentRenderContext,o);if(a.drawRange=s||e.geometry.drawRange,this._nodes.updateBefore(a),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),this._nodes.updateForRender(a),this._geometries.updateForRender(a),this._bindings.updateForRender(a),this._pipelines.updateForRender(a),null!==this._currentRenderBundle){this.backend.get(this._currentRenderBundle).renderObjects.push(a)}this.backend.draw(a,this.info),this._nodes.updateAfter(a)}_createObjectPipeline(e,t,n,i,r,s){const o=this._objects.get(e,t,n,i,r,this._currentRenderContext,s);this._nodes.updateBefore(o),this._nodes.updateForRender(o),this._geometries.updateForRender(o),this._bindings.updateForRender(o),this._pipelines.getForRender(o,this._compilationPromises),this._nodes.updateAfter(o)}get compute(){return this.computeAsync}get compile(){return this.compileAsync}}class xJ extends nW{constructor(e,t,n,i,r,s){super(e,t,n,i,r,s),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class _J extends pJ{constructor(){super(),this.addMaterial(kG,SO),this.addMaterial(nH,_O),this.addMaterial(rH,wO),this.addMaterial(uH,TO),this.addMaterial(EG,rI),this.addMaterial(IG,EO),this.addMaterial(pG,MO),this.addMaterial(AH,PO),this.addMaterial(aG,fO),this.addMaterial(cG,NO),this.addMaterial(mH,mO),this.addMaterial(bH,sO),this.addMaterial(wH,bO),this.addLight(fZ,aW),this.addLight(mZ,uW),this.addLight(bZ,dW),this.addLight(xZ,nW),this.addLight(wZ,hW),this.addLight(SZ,KH),this.addLight(TZ,AW),this.addLight(_Z,xJ),this.addToneMapping(KZ,1),this.addToneMapping(ZZ,2),this.addToneMapping(JZ,3),this.addToneMapping(eJ,4),this.addToneMapping(rJ,6),this.addToneMapping(sJ,7),this.addColorSpace(QZ,RU(LN,DN)),this.addColorSpace(YZ,RU(DN,LN))}}class wJ extends bJ{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.isStandardRenderer=!0,this.nodes.library=new _J}}class SJ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}class TJ extends SJ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return(e=this._buffer.byteLength)+(FW-e%FW)%FW;var e}get buffer(){return this._buffer}update(){return!0}}class MJ extends TJ{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isUniformBuffer=!0}}let EJ=0;class CJ extends MJ{constructor(e,t){super("UniformBuffer_"+EJ++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class RJ extends MJ{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}get values(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(null===e){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){let e=0;for(let t=0,n=this.uniforms.length;t<n;t++){const n=this.uniforms[t],{boundary:i,itemSize:r}=n,s=e%FW;0!==s&&FW-s-i<0?e+=FW-s:s%i!==0&&(e+=s%i),n.offset=e/this.bytesPerElement,e+=r*this.bytesPerElement}return Math.ceil(e/FW)*FW}update(){let e=!1;for(const t of this.uniforms)!0===this.updateByType(t)&&(e=!0);return e}updateByType(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,i=e.getValue(),r=e.offset;if(n[r]!==i){this.buffer[r]=n[r]=i,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,i=e.getValue(),r=e.offset;if(n[r+0]!==i.x||n[r+1]!==i.y){const e=this.buffer;e[r+0]=n[r+0]=i.x,e[r+1]=n[r+1]=i.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,i=e.getValue(),r=e.offset;if(n[r+0]!==i.x||n[r+1]!==i.y||n[r+2]!==i.z){const e=this.buffer;e[r+0]=n[r+0]=i.x,e[r+1]=n[r+1]=i.y,e[r+2]=n[r+2]=i.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,i=e.getValue(),r=e.offset;if(n[r+0]!==i.x||n[r+1]!==i.y||n[r+2]!==i.z||n[r+4]!==i.w){const e=this.buffer;e[r+0]=n[r+0]=i.x,e[r+1]=n[r+1]=i.y,e[r+2]=n[r+2]=i.z,e[r+3]=n[r+3]=i.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,i=e.getValue(),r=e.offset;if(n[r+0]!==i.r||n[r+1]!==i.g||n[r+2]!==i.b){const e=this.buffer;e[r+0]=n[r+0]=i.r,e[r+1]=n[r+1]=i.g,e[r+2]=n[r+2]=i.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,i=e.getValue().elements,r=e.offset;if(n[r+0]!==i[0]||n[r+1]!==i[1]||n[r+2]!==i[2]||n[r+4]!==i[3]||n[r+5]!==i[4]||n[r+6]!==i[5]||n[r+8]!==i[6]||n[r+9]!==i[7]||n[r+10]!==i[8]){const e=this.buffer;e[r+0]=n[r+0]=i[0],e[r+1]=n[r+1]=i[1],e[r+2]=n[r+2]=i[2],e[r+4]=n[r+4]=i[3],e[r+5]=n[r+5]=i[4],e[r+6]=n[r+6]=i[5],e[r+8]=n[r+8]=i[6],e[r+9]=n[r+9]=i[7],e[r+10]=n[r+10]=i[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,i=e.getValue().elements,r=e.offset;if(!1===function(e,t,n){for(let i=0,r=t.length;i<r;i++)if(e[n+i]!==t[i])return!1;return!0}(n,i,r)){this.buffer.set(i,r),function(e,t,n){for(let i=0,r=t.length;i<r;i++)e[n+i]=t[i]}(n,i,r),t=!0}return t}}let PJ=0;class NJ extends RJ{constructor(e,t){super(e),this.id=PJ++,this.groupNode=t,this.isNodeUniformsGroup=!0}getNodes(){const e=[];for(const t of this.uniforms){const n=t.nodeUniform.node;if(!n)throw new Error("NodeUniformsGroup: Uniform has no node.");e.push(n)}return e}}let DJ=0;class LJ extends SJ{constructor(e,t){super(e),this.id=DJ++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version&&(this.version=e.version,!0)}}class IJ extends LJ{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=i}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class OJ extends IJ{constructor(e,t,n,i){super(e,t,n,i),this.isSampledCubeTexture=!0}}class kJ extends IJ{constructor(e,t,n,i){super(e,t,n,i),this.isSampledTexture3D=!0}}const BJ={atan2:"atan",textureDimensions:"textureSize",equals:"equal"},FJ={low:"lowp",medium:"mediump",high:"highp"},UJ={swizzleAssign:!0,storageBuffer:!1},zJ="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\n";class qJ extends KX{constructor(e,t){super(e,t,new LZ),this.uniformGroups={},this.transforms=[],this.extensions={},this.instanceBindGroups=!1,this.useComparisonMethod=!0}needsColorSpaceToLinearSRGB(e){return!0===e.isVideoTexture&&""!==e.colorSpace}getMethod(e){return BJ[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),i=[];for(const r of t.inputs)i.push(this.getType(r.type)+" "+r.name);return"".concat(this.getType(t.type)," ").concat(t.name,"( ").concat(i.join(", ")," ) {\n\n\t").concat(n.vars,"\n\n").concat(n.code,"\n\treturn ").concat(n.result,";\n\n}")}setupPBO(e){const t=e.value;if(void 0===t.pbo){const e=t.array,n=t.count*t.itemSize,{itemSize:i}=t,r=t.array.constructor.name.toLowerCase().includes("int");let s=r?tN:eN;2===i?s=r?iN:nN:3===i?s=r?1032:KP:4===i&&(s=r?rN:ZP);const o={Float32Array:XP,Uint8Array:qP,Uint16Array:jP,Uint32Array:WP,Int8Array:VP,Int16Array:GP,Int32Array:HP,Uint8ClampedArray:qP},a=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(n/i))));let l=Math.ceil(n/i/a);a*l*i<n&&l++;const c=a*l*i,u=new e.constructor(c);u.set(e,0),t.array=u;const h=new oO(t.array,a,l,s,o[t.array.constructor.name]||XP);h.needsUpdate=!0,h.isPBOTexture=!0;const d=new oz(h,null,null);d.setPrecision("high"),t.pboNode=d,t.pbo=d.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,i=t.value;if(this.renderer.backend.has(i)){this.renderer.backend.get(i).pbo=i.pbo}const r=this.getUniformFromNode(i.pboNode,"texture",this.shaderStage,this.context.label),s=this.getPropertyName(r);this.increaseUsage(n);const o=n.build(this,"uint"),a=this.getDataFromNode(e);let l=a.propertyName;if(void 0===l){const n=this.getVarFromNode(e);l=this.getPropertyName(n);const r=this.getDataFromNode(t);let c=r.propertySizeName;void 0===c&&(c=l+"Size",this.getVarFromNode(t,c,"uint"),this.addLineFlowCode("".concat(c," = uint( textureSize( ").concat(s,", 0 ).x )")),r.propertySizeName=c);const{itemSize:u}=i,h="."+HO.join("").slice(0,u),d="ivec2(".concat(o," % ").concat(c,", ").concat(o," / ").concat(c,")"),p=this.generateTextureLoad(null,s,d,null,"0");let A="vec4";i.pbo.type===WP?A="uvec4":i.pbo.type===HP&&(A="ivec4"),this.addLineFlowCode("".concat(l," = ").concat(A,"(").concat(p,")").concat(h)),a.propertyName=l}return l}generateTextureLoad(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0";return i?"texelFetch( ".concat(t,", ivec3( ").concat(n,", ").concat(i," ), ").concat(r," )"):"texelFetch( ".concat(t,", ").concat(n,", ").concat(r," )")}generateTexture(e,t,n,i){return e.isDepthTexture?"texture( ".concat(t,", ").concat(n," ).x"):(i&&(n="vec3( ".concat(n,", ").concat(i," )")),"texture( ".concat(t,", ").concat(n," )"))}generateTextureLevel(e,t,n,i){return"textureLod( ".concat(t,", ").concat(n,", ").concat(i," )")}generateTextureBias(e,t,n,i){return"texture( ".concat(t,", ").concat(n,", ").concat(i," )")}generateTextureGrad(e,t,n,i){return"textureGrad( ".concat(t,", ").concat(n,", ").concat(i[0],", ").concat(i[1]," )")}generateTextureCompare(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===s)return"texture( ".concat(t,", vec3( ").concat(n,", ").concat(i," ) )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(s," shader."))}getVars(e){const t=[],n=this.vars[e];if(void 0!==n)for(const i of n)t.push("".concat(this.getVar(i.type,i.name),";"));return t.join("\n\t")}getUniforms(e){const t=this.uniforms[e],n=[],i={};for(const s of t){let t=null,r=!1;if("texture"===s.type){const e=s.node.value;let n="";!0===e.isDataTexture&&(e.type===WP?n="u":e.type===HP&&(n="i")),t=e.compareFunction?"sampler2DShadow ".concat(s.name,";"):!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?"".concat(n,"sampler2DArray ").concat(s.name,";"):"".concat(n,"sampler2D ").concat(s.name,";")}else if("cubeTexture"===s.type)t="samplerCube ".concat(s.name,";");else if("texture3D"===s.type)t="sampler3D ".concat(s.name,";");else if("buffer"===s.type){const e=s.node,n=this.getType(e.bufferType),i=e.bufferCount,r=i>0?i:"";t="".concat(e.name," {\n\t").concat(n," ").concat(s.name,"[").concat(r,"];\n};\n")}else{const n=this.getVectorType(s.type);t="".concat(n," ").concat(this.getPropertyName(s,e),";"),r=!0}const o=s.node.precision;if(null!==o&&(t=FJ[o]+" "+t),r){t="\t"+t;const e=s.groupNode.name;(i[e]||(i[e]=[])).push(t)}else t="uniform "+t,n.push(t)}let r="";for(const s in i){const t=i[s];r+=this._getGLSLUniformStruct(e+"_"+s,t.join("\n"))+"\n"}return r+=n.join("\n"),r}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==HP){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const i=n.array;!1===(i instanceof Uint32Array||i instanceof Int32Array)&&(t=t.slice(1))}return t}getAttributes(e){let t="";if("vertex"===e||"compute"===e){const e=this.getAttributesArray();let n=0;for(const i of e)t+="layout( location = ".concat(n++," ) in ").concat(i.type," ").concat(i.name,";\n")}return t}getStructMembers(e){const t=[],n=e.getMemberTypes();for(let i=0;i<n.length;i++){const e=n[i];t.push("layout( location = ".concat(i," ) out ").concat(e," m").concat(i,";"))}return t.join("\n")}getStructs(e){const t=[],n=this.structs[e];if(0===n.length)return"layout( location = 0 ) out vec4 fragColor;\n";for(let i=0,r=n.length;i<r;i++){const e=n[i];let r="\n";r+=this.getStructMembers(e),r+="\n",t.push(r)}return t.join("\n\n")}getVaryings(e){let t="";const n=this.varyings;if("vertex"===e||"compute"===e)for(const i of n){"compute"===e&&(i.needsInterpolation=!0);const n=i.type,r=n.includes("int")||n.includes("uv")||n.includes("iv")?"flat ":"";t+="".concat(r).concat(i.needsInterpolation?"out":"/*out*/"," ").concat(n," ").concat(i.name,";\n")}else if("fragment"===e)for(const i of n)if(i.needsInterpolation){const e=i.type,n=e.includes("int")||e.includes("uv")||e.includes("iv")?"flat ":"";t+="".concat(n,"in ").concat(e," ").concat(i.name,";\n")}return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){const e=this.object.workgroupSize.reduce(((e,t)=>e*t),1);return"uint( gl_InstanceID ) % ".concat(e,"u")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage;const i=this.extensions[n]||(this.extensions[n]=new Map);!1===i.has(e)&&i.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if("vertex"===e){const t=this.renderer.backend.extensions;this.object.isBatchedMesh&&t.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(void 0!==n)for(const{name:i,behavior:r}of n.values())t.push("#extension ".concat(i," : ").concat(r));return t.join("\n")}isAvailable(e){let t=UJ[e];if(void 0===t){if("float32Filterable"===e){const e=this.renderer.backend.extensions;e.has("OES_texture_float_linear")?(e.get("OES_texture_float_linear"),t=!0):t=!1}UJ[e]=t}return t}isFlipY(){return!0}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const i=e[n],r=this.getPropertyName(i.attributeNode);t+="".concat(i.varyingName," = ").concat(r,";\n\t")}return t}_getGLSLUniformStruct(e,t){return"\nlayout( std140 ) uniform ".concat(e," {\n").concat(t,"\n};")}_getGLSLVertexCode(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// extensions \n").concat(e.extensions,"\n\n// precision\n").concat(zJ,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// attributes\n").concat(e.attributes,"\n\n// codes\n").concat(e.codes,"\n\nvoid main() {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// transforms\n\t").concat(e.transforms,"\n\n\t// flow\n\t").concat(e.flow,"\n\n\tgl_PointSize = 1.0;\n\n}\n")}_getGLSLFragmentCode(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// precision\n").concat(zJ,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// codes\n").concat(e.codes,"\n\n").concat(e.structs,"\n\nvoid main() {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(const t in e){let n="// code\n\n";n+=this.flowCode[t];const i=this.flowNodes[t],r=i[i.length-1];for(const e of i){const i=this.getFlowData(e),s=e.name;s&&(n.length>0&&(n+="\n"),n+="\t// flow -> ".concat(s,"\n\t")),n+="".concat(i.code,"\n\t"),e===r&&"compute"!==t&&(n+="// result\n\t","vertex"===t?(n+="gl_Position = ",n+="".concat(i.result,";")):"fragment"===t&&(e.outputNode.isOutputStructNode||(n+="fragColor = ",n+="".concat(i.result,";"))))}const s=e[t];s.extensions=this.getExtensions(t),s.uniforms=this.getUniforms(t),s.attributes=this.getAttributes(t),s.varyings=this.getVaryings(t),s.vars=this.getVars(t),s.structs=this.getStructs(t),s.codes=this.getCodes(t),s.transforms=this.getTransforms(t),s.flow=n}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=super.getUniformFromNode(e,t,n,i),s=this.getDataFromNode(e,n,this.globalCache);let o=s.uniformGPU;if(void 0===o){const i=e.groupNode,a=i.name,l=this.getBindGroupArray(a,n);if("texture"===t)o=new IJ(r.name,r.node,i),l.push(o);else if("cubeTexture"===t)o=new OJ(r.name,r.node,i),l.push(o);else if("texture3D"===t)o=new kJ(r.name,r.node,i),l.push(o);else if("buffer"===t){e.name="NodeBuffer_".concat(e.id),r.name="buffer".concat(e.id);const t=new CJ(e,i);t.name=e.name,l.push(t),o=t}else{const e=this.uniformGroups[n]||(this.uniformGroups[n]={});let s=e[a];void 0===s&&(s=new NJ(n+"_"+a,i),e[a]=s,l.push(s)),o=this.getNodeUniform(r,t),s.addUniform(o)}s.uniformGPU=o}return r}}let VJ=null,GJ=null,jJ=null;class HJ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null}async init(e){this.renderer=e}begin(){}finish(){}draw(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}createRenderPipeline(){}createComputePipeline(){}destroyPipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}createDefaultTexture(){}createTexture(){}copyTextureToBuffer(){}createAttribute(){}createIndexAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}resolveTimestampAsync(){}hasFeatureAsync(){}hasFeature(){}getInstanceCount(e){const{object:t,geometry:n}=e;return n.isInstancedBufferGeometry?n.instanceCount:t.count>1?t.count:1}getDrawingBufferSize(){return VJ=VJ||new uD,this.renderer.getDrawingBufferSize(VJ)}getScissor(){return GJ=GJ||new PD,this.renderer.getScissor(GJ)}setScissorTest(){}getClearColor(){const e=this.renderer;return jJ=jJ||new jZ,e.getClearColor(jJ),jJ.getRGB(jJ,this.renderer.currentColorSpace),jJ}getDomElement(){let e=this.domElement;return null===e&&(e=void 0!==this.parameters.canvas?this.parameters.canvas:function(){const e=pD("canvas");return e.style.display="block",e}(),"setAttribute"in e&&e.setAttribute("data-engine","three.js r".concat(pP," webgpu")),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}}let WJ=0;class XJ{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return"".concat(this.baseId,"|").concat(this.activeBufferIndex)}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[1^this.activeBufferIndex]}switchBuffers(){this.activeBufferIndex^=1}}class YJ{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:i}=n,r=e.array,s=e.usage||i.STATIC_DRAW,o=e.isInterleavedBufferAttribute?e.data:e,a=n.get(o);let l,c=a.bufferGPU;if(void 0===c&&(c=this._createBuffer(i,t,r,s),a.bufferGPU=c,a.bufferType=t,a.version=o.version),r instanceof Float32Array)l=i.FLOAT;else if(r instanceof Uint16Array)l=e.isFloat16BufferAttribute?i.HALF_FLOAT:i.UNSIGNED_SHORT;else if(r instanceof Int16Array)l=i.SHORT;else if(r instanceof Uint32Array)l=i.UNSIGNED_INT;else if(r instanceof Int32Array)l=i.INT;else if(r instanceof Int8Array)l=i.BYTE;else if(r instanceof Uint8Array)l=i.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+r);l=i.UNSIGNED_BYTE}let u={bufferGPU:c,bufferType:t,type:l,byteLength:r.byteLength,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:l===i.INT||l===i.UNSIGNED_INT||e.gpuType===HP,id:WJ++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const e=this._createBuffer(i,t,r,s);u=new XJ(u,e)}n.set(e,u)}updateAttribute(e){const t=this.backend,{gl:n}=t,i=e.array,r=e.isInterleavedBufferAttribute?e.data:e,s=t.get(r),o=s.bufferType,a=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(o,s.bufferGPU),0===a.length)n.bufferSubData(o,0,i);else{for(let e=0,t=a.length;e<t;e++){const t=a[e];n.bufferSubData(o,t.start*i.BYTES_PER_ELEMENT,i,t.start,t.count)}r.clearUpdateRanges()}n.bindBuffer(o,null),s.version=r.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const i=t.get(e);n.deleteBuffer(i.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,i=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:r}=t.get(i),s=e.array,o=s.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,r);const a=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,a),n.bufferData(n.COPY_WRITE_BUFFER,o,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,o),await t.utils._clientWaitAsync();const l=new e.array.constructor(s.length);return n.getBufferSubData(n.COPY_WRITE_BUFFER,0,l),n.deleteBuffer(a),l.buffer}_createBuffer(e,t,n,i){const r=e.createBuffer();return e.bindBuffer(t,r),e.bufferData(t,n,i),e.bindBuffer(t,null),r}}let QJ,KJ,ZJ=!1;class JJ{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},!1===ZJ&&(this._init(this.gl),ZJ=!0)}_init(e){QJ={[AP]:e.FUNC_ADD,[fP]:e.FUNC_SUBTRACT,[mP]:e.FUNC_REVERSE_SUBTRACT},KJ={[gP]:e.ZERO,[vP]:e.ONE,[yP]:e.SRC_COLOR,[xP]:e.SRC_ALPHA,[EP]:e.SRC_ALPHA_SATURATE,[TP]:e.DST_COLOR,[wP]:e.DST_ALPHA,[bP]:e.ONE_MINUS_SRC_COLOR,[_P]:e.ONE_MINUS_SRC_ALPHA,[MP]:e.ONE_MINUS_DST_COLOR,[SP]:e.ONE_MINUS_DST_ALPHA}}enable(e){const{enabled:t}=this;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;0!==e?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,i,r,s,o,a){const{gl:l}=this;if(0!==e){if(!1===this.currentBlendingEnabled&&(this.enable(l.BLEND),this.currentBlendingEnabled=!0),5===e)r=r||t,s=s||n,o=o||i,t===this.currentBlendEquation&&r===this.currentBlendEquationAlpha||(l.blendEquationSeparate(QJ[t],QJ[r]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=r),n===this.currentBlendSrc&&i===this.currentBlendDst&&s===this.currentBlendSrcAlpha&&o===this.currentBlendDstAlpha||(l.blendFuncSeparate(KJ[n],KJ[i],KJ[s],KJ[o]),this.currentBlendSrc=n,this.currentBlendDst=i,this.currentBlendSrcAlpha=s,this.currentBlendDstAlpha=o),this.currentBlending=e,this.currentPremultipledAlpha=!1;else if(e!==this.currentBlending||a!==this.currentPremultipledAlpha){if(this.currentBlendEquation===AP&&this.currentBlendEquationAlpha===AP||(l.blendEquation(l.FUNC_ADD),this.currentBlendEquation=AP,this.currentBlendEquationAlpha=AP),a)switch(e){case 1:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.ONE,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.SRC_ALPHA,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFunc(l.ZERO,l.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=a}}else!0===this.currentBlendingEnabled&&(this.disable(l.BLEND),this.currentBlendingEnabled=!1)}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}this.currentDepthFunc=e}}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){this.currentStencilFunc===e&&this.currentStencilRef===t&&this.currentStencilFuncMask===n||(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){this.currentStencilFail===e&&this.currentStencilZFail===t&&this.currentStencilZPass===n||(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t){const{gl:n}=this;2===e.side?this.disable(n.CULL_FACE):this.enable(n.CULL_FACE);let i=1===e.side;t&&(i=!i),this.setFlipSided(i),1===e.blending&&!1===e.transparent?this.setBlending(0):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const r=e.stencilWrite;this.setStencilTest(r),r&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?this.enable(n.SAMPLE_ALPHA_TO_COVERAGE):this.disable(n.SAMPLE_ALPHA_TO_COVERAGE)}setPolygonOffset(e,t,n){const{gl:i}=this;e?(this.enable(i.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor===t&&this.currentPolygonOffsetUnits===n||(i.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(i.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:i}=this;return i[e]!==t&&(n.bindFramebuffer(e,t),i[e]=t,e===n.DRAW_FRAMEBUFFER&&(i[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(i[n.DRAW_FRAMEBUFFER]=t),!0)}drawBuffers(e,t){const{gl:n}=this;let i=[],r=!1;if(null!==e.textures){i=this.currentDrawbuffers.get(t),void 0===i&&(i=[],this.currentDrawbuffers.set(t,i));const s=e.textures;if(i.length!==s.length||i[0]!==n.COLOR_ATTACHMENT0){for(let e=0,t=s.length;e<t;e++)i[e]=n.COLOR_ATTACHMENT0+e;i.length=s.length,r=!0}}else i[0]!==n.BACK&&(i[0]=n.BACK,r=!0);r&&n.drawBuffers(i)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:i}=this;void 0===e&&(e=t.TEXTURE0+i-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:i,currentTextureSlot:r,currentBoundTextures:s,maxTextures:o}=this;void 0===n&&(n=null===r?i.TEXTURE0+o-1:r);let a=s[n];void 0===a&&(a={type:void 0,texture:void 0},s[n]=a),a.type===e&&a.texture===t||(r!==n&&(i.activeTexture(n),this.currentTextureSlot=n),i.bindTexture(e,t),a.type=e,a.texture=t)}bindBufferBase(e,t,n){const{gl:i}=this,r="".concat(e,"-").concat(t);return this.currentBoundBufferBases[r]!==n&&(i.bindBufferBase(e,t,n),this.currentBoundBufferBases[r]=n,!0)}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,i=n[t];void 0!==i&&void 0!==i.type&&(e.bindTexture(i.type,null),i.type=void 0,i.texture=void 0)}}class $J{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{gl:n,extensions:i}=this;let r;if(e===qP)return n.UNSIGNED_BYTE;if(1017===e)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return n.UNSIGNED_SHORT_5_5_5_1;if(35902===e)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===VP)return n.BYTE;if(e===GP)return n.SHORT;if(e===jP)return n.UNSIGNED_SHORT;if(e===HP)return n.INT;if(e===WP)return n.UNSIGNED_INT;if(e===XP)return n.FLOAT;if(e===YP)return n.HALF_FLOAT;if(1021===e)return n.ALPHA;if(e===KP)return n.RGB;if(e===ZP)return n.RGBA;if(1024===e)return n.LUMINANCE;if(1025===e)return n.LUMINANCE_ALPHA;if(e===JP)return n.DEPTH_COMPONENT;if(e===$P)return n.DEPTH_STENCIL;if(e===eN)return n.RED;if(e===tN)return n.RED_INTEGER;if(e===nN)return n.RG;if(e===iN)return n.RG_INTEGER;if(e===rN)return n.RGBA_INTEGER;if(e===sN||e===oN||e===aN||e===lN)if(t===DN){if(r=i.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(e===sN)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===oN)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===aN)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===lN)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=i.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(e===sN)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===oN)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===aN)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===lN)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(r=i.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(35840===e)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e||e===cN||e===uN){if(r=i.get("WEBGL_compressed_texture_etc"),null===r)return null;if(36196===e||e===cN)return t===DN?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(e===uN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(e===hN||e===dN||e===pN||e===AN||e===fN||e===mN||e===gN||e===vN||e===yN||e===bN||e===xN||e===_N||e===wN||e===SN){if(r=i.get("WEBGL_compressed_texture_astc"),null===r)return null;if(e===hN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===dN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===pN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===AN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===fN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===mN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===gN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===vN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===yN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===bN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===xN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===_N)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===wN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===SN)return t===DN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===TN){if(r=i.get("EXT_texture_compression_bptc"),null===r)return null;if(e===TN)return t===DN?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===e||36284===e||36285===e||36286===e){if(r=i.get("EXT_texture_compression_rgtc"),null===r)return null;if(e===TN)return r.COMPRESSED_RED_RGTC1_EXT;if(36284===e)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===e)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===e)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return e===QP?n.UNSIGNED_INT_24_8:void 0!==n[e]?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise(((n,i)=>{!function r(){const s=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(s===e.WAIT_FAILED)return e.deleteSync(t),void i();s!==e.TIMEOUT_EXPIRED?(e.deleteSync(t),n()):requestAnimationFrame(r)}()}))}}let e$,t$,n$,i$=!1;class r${constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},!1===i$&&(this._init(this.gl),i$=!0)}_init(e){e$={[DP]:e.REPEAT,[LP]:e.CLAMP_TO_EDGE,[IP]:e.MIRRORED_REPEAT},t$={[OP]:e.NEAREST,[kP]:e.NEAREST_MIPMAP_NEAREST,[BP]:e.NEAREST_MIPMAP_LINEAR,[FP]:e.LINEAR,[UP]:e.LINEAR_MIPMAP_NEAREST,[zP]:e.LINEAR_MIPMAP_LINEAR},n$={[zN]:e.NEVER,[XN]:e.ALWAYS,[qN]:e.LESS,[GN]:e.LEQUAL,[VN]:e.EQUAL,[WN]:e.GEQUAL,[jN]:e.GREATER,[HN]:e.NOTEQUAL}}filterFallback(e){const{gl:t}=this;return e===OP||e===kP||e===BP?t.NEAREST:t.LINEAR}getGLTextureType(e){const{gl:t}=this;let n;return n=!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D,n}getInternalFormat(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{gl:s,extensions:o}=this;if(null!==e){if(void 0!==s[e])return s[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let a=t;return t===s.RED&&(n===s.FLOAT&&(a=s.R32F),n===s.HALF_FLOAT&&(a=s.R16F),n===s.UNSIGNED_BYTE&&(a=s.R8),n===s.UNSIGNED_SHORT&&(a=s.R16),n===s.UNSIGNED_INT&&(a=s.R32UI),n===s.BYTE&&(a=s.R8I),n===s.SHORT&&(a=s.R16I),n===s.INT&&(a=s.R32I)),t===s.RED_INTEGER&&(n===s.UNSIGNED_BYTE&&(a=s.R8UI),n===s.UNSIGNED_SHORT&&(a=s.R16UI),n===s.UNSIGNED_INT&&(a=s.R32UI),n===s.BYTE&&(a=s.R8I),n===s.SHORT&&(a=s.R16I),n===s.INT&&(a=s.R32I)),t===s.RG&&(n===s.FLOAT&&(a=s.RG32F),n===s.HALF_FLOAT&&(a=s.RG16F),n===s.UNSIGNED_BYTE&&(a=s.RG8),n===s.UNSIGNED_SHORT&&(a=s.RG16),n===s.UNSIGNED_INT&&(a=s.RG32UI),n===s.BYTE&&(a=s.RG8I),n===s.SHORT&&(a=s.RG16I),n===s.INT&&(a=s.RG32I)),t===s.RG_INTEGER&&(n===s.UNSIGNED_BYTE&&(a=s.RG8UI),n===s.UNSIGNED_SHORT&&(a=s.RG16UI),n===s.UNSIGNED_INT&&(a=s.RG32UI),n===s.BYTE&&(a=s.RG8I),n===s.SHORT&&(a=s.RG16I),n===s.INT&&(a=s.RG32I)),t===s.RGB&&(n===s.FLOAT&&(a=s.RGB32F),n===s.HALF_FLOAT&&(a=s.RGB16F),n===s.UNSIGNED_BYTE&&(a=s.RGB8),n===s.UNSIGNED_SHORT&&(a=s.RGB16),n===s.UNSIGNED_INT&&(a=s.RGB32UI),n===s.BYTE&&(a=s.RGB8I),n===s.SHORT&&(a=s.RGB16I),n===s.INT&&(a=s.RGB32I),n===s.UNSIGNED_BYTE&&(a=i===DN&&!1===r?s.SRGB8:s.RGB8),n===s.UNSIGNED_SHORT_5_6_5&&(a=s.RGB565),n===s.UNSIGNED_SHORT_5_5_5_1&&(a=s.RGB5_A1),n===s.UNSIGNED_SHORT_4_4_4_4&&(a=s.RGB4),n===s.UNSIGNED_INT_5_9_9_9_REV&&(a=s.RGB9_E5)),t===s.RGB_INTEGER&&(n===s.UNSIGNED_BYTE&&(a=s.RGB8UI),n===s.UNSIGNED_SHORT&&(a=s.RGB16UI),n===s.UNSIGNED_INT&&(a=s.RGB32UI),n===s.BYTE&&(a=s.RGB8I),n===s.SHORT&&(a=s.RGB16I),n===s.INT&&(a=s.RGB32I)),t===s.RGBA&&(n===s.FLOAT&&(a=s.RGBA32F),n===s.HALF_FLOAT&&(a=s.RGBA16F),n===s.UNSIGNED_BYTE&&(a=s.RGBA8),n===s.UNSIGNED_SHORT&&(a=s.RGBA16),n===s.UNSIGNED_INT&&(a=s.RGBA32UI),n===s.BYTE&&(a=s.RGBA8I),n===s.SHORT&&(a=s.RGBA16I),n===s.INT&&(a=s.RGBA32I),n===s.UNSIGNED_BYTE&&(a=i===DN&&!1===r?s.SRGB8_ALPHA8:s.RGBA8),n===s.UNSIGNED_SHORT_4_4_4_4&&(a=s.RGBA4),n===s.UNSIGNED_SHORT_5_5_5_1&&(a=s.RGB5_A1)),t===s.RGBA_INTEGER&&(n===s.UNSIGNED_BYTE&&(a=s.RGBA8UI),n===s.UNSIGNED_SHORT&&(a=s.RGBA16UI),n===s.UNSIGNED_INT&&(a=s.RGBA32UI),n===s.BYTE&&(a=s.RGBA8I),n===s.SHORT&&(a=s.RGBA16I),n===s.INT&&(a=s.RGBA32I)),t===s.DEPTH_COMPONENT&&(n===s.UNSIGNED_INT&&(a=s.DEPTH24_STENCIL8),n===s.FLOAT&&(a=s.DEPTH_COMPONENT32F)),t===s.DEPTH_STENCIL&&n===s.UNSIGNED_INT_24_8&&(a=s.DEPTH24_STENCIL8),a!==s.R16F&&a!==s.R32F&&a!==s.RG16F&&a!==s.RG32F&&a!==s.RGBA16F&&a!==s.RGBA32F||o.get("EXT_color_buffer_float"),a}setTextureParameters(e,t){const{gl:n,extensions:i,backend:r}=this;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texParameteri(e,n.TEXTURE_WRAP_S,e$[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,e$[t.wrapT]),e!==n.TEXTURE_3D&&e!==n.TEXTURE_2D_ARRAY||n.texParameteri(e,n.TEXTURE_WRAP_R,e$[t.wrapR]),n.texParameteri(e,n.TEXTURE_MAG_FILTER,t$[t.magFilter]);const s=void 0!==t.mipmaps&&t.mipmaps.length>0,o=t.minFilter===FP&&s?zP:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,t$[o]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,n$[t.compareFunction])),!0===i.has("EXT_texture_filter_anisotropic")){if(t.magFilter===OP)return;if(t.minFilter!==BP&&t.minFilter!==zP)return;if(t.type===XP&&!1===i.has("OES_texture_float_linear"))return;if(t.anisotropy>1){const s=i.get("EXT_texture_filter_anisotropic");n.texParameterf(e,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,r.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:i}=this,r=this.getGLTextureType(e);let s=i[r];void 0===s&&(s=t.createTexture(),n.state.bindTexture(r,s),t.texParameteri(r,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(r,t.TEXTURE_MAG_FILTER,t.NEAREST),i[r]=s),n.set(e,{textureGPU:s,glTextureType:r,isDefault:!0})}createTexture(e,t){const{gl:n,backend:i}=this,{levels:r,width:s,height:o,depth:a}=t,l=i.utils.convert(e.format,e.colorSpace),c=i.utils.convert(e.type),u=this.getInternalFormat(e.internalFormat,l,c,e.colorSpace,e.isVideoTexture),h=n.createTexture(),d=this.getGLTextureType(e);i.state.bindTexture(d,h),this.setTextureParameters(d,e),e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,r,u,s,o,a):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,r,u,s,o,a):e.isVideoTexture||n.texStorage2D(d,r,u,s,o),i.set(e,{textureGPU:h,glTextureType:d,glFormat:l,glType:c,glInternalFormat:u})}copyBufferToTexture(e,t){const{gl:n,backend:i}=this,{textureGPU:r,glTextureType:s,glFormat:o,glType:a}=i.get(t),{width:l,height:c}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),i.state.bindTexture(s,r),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(s,0,0,0,l,c,o,a,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),i.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:i,height:r}=t,{textureGPU:s,glTextureType:o,glFormat:a,glType:l,glInternalFormat:c}=this.backend.get(e);if(e.isRenderTargetTexture||void 0===s)return;const u=e=>e.isDataTexture?e.image.data:e instanceof ImageBitmap||e instanceof OffscreenCanvas||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement?e:e.data;if(this.backend.state.bindTexture(o,s),this.setTextureParameters(o,e),e.isCompressedTexture){const i=e.mipmaps,r=t.image;for(let t=0;t<i.length;t++){const s=i[t];e.isCompressedArrayTexture?e.format!==n.RGBA?null!==a?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,t,0,0,0,s.width,s.height,r.depth,a,s.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,t,0,0,0,s.width,s.height,r.depth,a,l,s.data):null!==a?n.compressedTexSubImage2D(n.TEXTURE_2D,t,0,0,s.width,s.height,a,s.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const e=t.images;for(let t=0;t<6;t++){const s=u(e[t]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,i,r,a,l,s)}}else if(e.isDataArrayTexture){const e=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,e.width,e.height,e.depth,a,l,e.data)}else if(e.isData3DTexture){const e=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,e.width,e.height,e.depth,a,l,e.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(o,0,c,a,l,t.image);else{const e=u(t.image);n.texSubImage2D(o,0,0,0,i,r,a,l,e)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:i,glTextureType:r}=n.get(e);n.state.bindTexture(r,i),t.generateMipmap(r)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const i=n.get(e);if(i.renderBufferStorageSetup=void 0,i.framebuffers){for(const e in i.framebuffers)t.deleteFramebuffer(i.framebuffers[e]);delete i.framebuffers}if(i.depthRenderbuffer&&(t.deleteRenderbuffer(i.depthRenderbuffer),delete i.depthRenderbuffer),i.stencilRenderbuffer&&(t.deleteRenderbuffer(i.stencilRenderbuffer),delete i.stencilRenderbuffer),i.msaaFrameBuffer&&(t.deleteFramebuffer(i.msaaFrameBuffer),delete i.msaaFrameBuffer),i.msaaRenderbuffers){for(let e=0;e<i.msaaRenderbuffers.length;e++)t.deleteRenderbuffer(i.msaaRenderbuffers[e]);delete i.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:i,renderTarget:r}=n.get(e);this.deallocateRenderBuffers(r),t.deleteTexture(i),n.delete(e)}copyTextureToTexture(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const{gl:s,backend:o}=this,{state:a}=this.backend,{textureGPU:l,glTextureType:c,glType:u,glFormat:h}=o.get(t);let d,p,A,f,m,g;null!==n?(d=n.max.x-n.min.x,p=n.max.y-n.min.y,A=n.min.x,f=n.min.y):(d=e.image.width,p=e.image.height,A=0,f=0),null!==i?(m=i.x,g=i.y):(m=0,g=0),a.bindTexture(c,l),s.pixelStorei(s.UNPACK_ALIGNMENT,t.unpackAlignment),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,t.unpackAlignment);const v=s.getParameter(s.UNPACK_ROW_LENGTH),y=s.getParameter(s.UNPACK_IMAGE_HEIGHT),b=s.getParameter(s.UNPACK_SKIP_PIXELS),x=s.getParameter(s.UNPACK_SKIP_ROWS),_=s.getParameter(s.UNPACK_SKIP_IMAGES),w=e.isCompressedTexture?e.mipmaps[r]:e.image;s.pixelStorei(s.UNPACK_ROW_LENGTH,w.width),s.pixelStorei(s.UNPACK_IMAGE_HEIGHT,w.height),s.pixelStorei(s.UNPACK_SKIP_PIXELS,A),s.pixelStorei(s.UNPACK_SKIP_ROWS,f),e.isDataTexture?s.texSubImage2D(s.TEXTURE_2D,r,m,g,d,p,h,u,w.data):e.isCompressedTexture?s.compressedTexSubImage2D(s.TEXTURE_2D,r,m,g,w.width,w.height,h,w.data):s.texSubImage2D(s.TEXTURE_2D,r,m,g,d,p,h,u,w),s.pixelStorei(s.UNPACK_ROW_LENGTH,v),s.pixelStorei(s.UNPACK_IMAGE_HEIGHT,y),s.pixelStorei(s.UNPACK_SKIP_PIXELS,b),s.pixelStorei(s.UNPACK_SKIP_ROWS,x),s.pixelStorei(s.UNPACK_SKIP_IMAGES,_),0===r&&t.generateMipmaps&&s.generateMipmap(s.TEXTURE_2D),a.unbindTexture()}copyFramebufferToTexture(e,t){const{gl:n}=this,{state:i}=this.backend,{textureGPU:r}=this.backend.get(e),s=e.image.width,o=e.image.height;if(!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0){let a,l;!0===e.isDepthTexture?(a=n.DEPTH_BUFFER_BIT,l=n.DEPTH_ATTACHMENT,t.stencil&&(a|=n.STENCIL_BUFFER_BIT)):(a=n.COLOR_BUFFER_BIT,l=n.COLOR_ATTACHMENT0);const c=n.createFramebuffer();i.bindFramebuffer(n.DRAW_FRAMEBUFFER,c),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,l,n.TEXTURE_2D,r,0),n.blitFramebuffer(0,0,s,o,0,0,s,o,a,n.NEAREST),n.deleteFramebuffer(c)}else i.bindTexture(n.TEXTURE_2D,r),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,0,0,s,o),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t){const{gl:n}=this,i=t.renderTarget,{samples:r,depthTexture:s,depthBuffer:o,stencilBuffer:a,width:l,height:c}=i;if(n.bindRenderbuffer(n.RENDERBUFFER,e),o&&!a){let t=n.DEPTH_COMPONENT24;r>0?(s&&s.isDepthTexture&&s.type===n.FLOAT&&(t=n.DEPTH_COMPONENT32F),n.renderbufferStorageMultisample(n.RENDERBUFFER,r,t,l,c)):n.renderbufferStorage(n.RENDERBUFFER,t,l,c),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e)}else o&&a&&(r>0?n.renderbufferStorageMultisample(n.RENDERBUFFER,r,n.DEPTH24_STENCIL8,l,c):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,l,c),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,n,i,r){const{backend:s,gl:o}=this,{textureGPU:a,glFormat:l,glType:c}=this.backend.get(e),u=o.createFramebuffer();o.bindFramebuffer(o.READ_FRAMEBUFFER,u),o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,a,0);const h=this._getTypedArrayType(c),d=i*r*this._getBytesPerTexel(l),p=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,p),o.bufferData(o.PIXEL_PACK_BUFFER,d,o.STREAM_READ),o.readPixels(t,n,i,r,l,c,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),await s.utils._clientWaitAsync();const A=new h(d/h.BYTES_PER_ELEMENT);return o.bindBuffer(o.PIXEL_PACK_BUFFER,p),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,A),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteFramebuffer(u),A}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_5_5_1)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_6_5)return Uint16Array;if(e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.FLOAT)return Float32Array;throw new Error("Unsupported WebGL type: ".concat(e))}_getBytesPerTexel(e){const{gl:t}=this;return e===t.RGBA?4:e===t.RGB?3:e===t.ALPHA?1:void 0}}class s${constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class o${constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const a$={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"};class l${constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:i,object:r,type:s,info:o,index:a}=this;0!==a?n.drawElements(i,t,s,e):n.drawArrays(i,e,t),o.update(r,t,i,1)}renderInstances(e,t,n){const{gl:i,mode:r,type:s,index:o,object:a,info:l}=this;0!==n&&(0!==o?i.drawElementsInstanced(r,t,s,e,n):i.drawArraysInstanced(r,e,t,n),l.update(a,t,r,n))}renderMultiDraw(e,t,n){const{extensions:i,mode:r,object:s,info:o}=this;if(0===n)return;const a=i.get("WEBGL_multi_draw");if(null===a)for(let l=0;l<n;l++)this.render(e[l],t[l]);else{0!==this.index?a.multiDrawElementsWEBGL(r,t,0,this.type,e,0,n):a.multiDrawArraysWEBGL(r,e,0,t,0,n);let i=0;for(let e=0;e<n;e++)i+=t[e];o.update(s,i,r,1)}}renderMultiDrawInstances(e,t,n,i){const{extensions:r,mode:s,object:o,info:a}=this;if(0===n)return;const l=r.get("WEBGL_multi_draw");if(null===l)for(let c=0;c<n;c++)this.renderInstances(e[c],t[c],i[c]);else{0!==this.index?l.multiDrawElementsInstancedWEBGL(s,t,0,this.type,e,0,i,0,n):l.multiDrawArraysInstancedWEBGL(s,e,0,t,0,i,0,n);let r=0;for(let e=0;e<n;e++)r+=t[e];for(let e=0;e<i.length;e++)a.update(o,r,s,i[e])}}}class c$ extends HJ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.isWebGLBackend=!0}init(e){super.init(e);const t=this.parameters,n=void 0!==t.context?t.context:e.domElement.getContext("webgl2");this.gl=n,this.extensions=new s$(this),this.capabilities=new o$(this),this.attributeUtils=new YJ(this),this.textureUtils=new r$(this),this.bufferRenderer=new l$(this),this.state=new JJ(this),this.utils=new $J(this),this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.trackTimestamp=!0===t.trackTimestamp,this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this._currentContext=null}get coordinateSystem(){return KN}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(this.queryRunning)return t.queryQueue||(t.queryQueue=[]),void t.queryQueue.push(e);t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.activeQuery=null),t.activeQuery=this.gl.createQuery(),null!==t.activeQuery&&(this.gl.beginQuery(this.disjoint.TIME_ELAPSED_EXT,t.activeQuery),this.queryRunning=!0)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.gpuQueries||(t.gpuQueries=[]),t.gpuQueries.push({query:t.activeQuery}),t.activeQuery=null,this.queryRunning=!1,t.queryQueue&&t.queryQueue.length>0)){const e=t.queryQueue.shift();this.initTimestampQuery(e)}}async resolveTimestampAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"render";if(!this.disjoint||!this.trackTimestamp)return;const n=this.get(e);n.gpuQueries||(n.gpuQueries=[]);for(let i=0;i<n.gpuQueries.length;i++){const e=n.gpuQueries[i],r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),s=this.gl.getParameter(this.disjoint.GPU_DISJOINT_EXT);if(r&&!s){const r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT),s=Number(r)/1e6;this.gl.deleteQuery(e.query),n.gpuQueries.splice(i,1),i--,this.renderer.info.updateTimestamp(t,s)}}}getContext(){return this.gl}beginRender(e){const{gl:t}=this,n=this.get(e);if(this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1),e.viewport?this.updateViewport(e):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),e.scissor){const{x:n,y:i,width:r,height:s}=e.scissorValue;t.scissor(n,e.height-s-i,r,s)}const i=e.occlusionQueryCount;i>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(i),n.occlusionQueryObjects=new Array(i),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,i=this.get(e),r=i.previousContext,s=e.occlusionQueryCount;s>0&&(s>i.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const o=e.textures;if(null!==o)for(let a=0;a<o.length;a++){const e=o[a];e.generateMipmaps&&this.generateMipmaps(e)}if(this._currentContext=r,null!==e.textures&&e.renderTarget){const i=this.get(e.renderTarget),{samples:r}=e.renderTarget;if(r>0){const r=i.framebuffers[e.getCacheKey()],s=t.COLOR_BUFFER_BIT,o=i.msaaFrameBuffer,a=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,o),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,r);for(let n=0;n<a.length;n++)if(e.scissor){const{x:n,y:r,width:o,height:a}=e.scissorValue,l=e.height-a-r;t.blitFramebuffer(n,l,n+o,l+a,n,l,n+o,l+a,s,t.NEAREST),t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,i.invalidationArray,n,l,o,a)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,s,t.NEAREST),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,i.invalidationArray)}}null!==r&&(this._setFramebuffer(r),r.viewport?this.updateViewport(r):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:i}=t;if(n&&i){const e=new WeakSet,{gl:r}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const s=()=>{let o=0;for(let t=0;t<n.length;t++){const s=n[t];null!==s&&(r.getQueryParameter(s,r.QUERY_RESULT_AVAILABLE)&&(r.getQueryParameter(s,r.QUERY_RESULT)>0&&e.add(i[t]),n[t]=null,r.deleteQuery(s),o++))}o<n.length?requestAnimationFrame(s):t.occluded=e};s()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const t=this.gl,{x:n,y:i,width:r,height:s}=e.viewportValue;t.viewport(n,e.height-s-i,r,s)}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}clear(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const{gl:s}=this;null===i&&(i={textures:null,clearColorValue:this.getClearColor()});let o=0;if(e&&(o|=s.COLOR_BUFFER_BIT),t&&(o|=s.DEPTH_BUFFER_BIT),n&&(o|=s.STENCIL_BUFFER_BIT),0!==o){const a=i.clearColorValue||this.getClearColor();if(a.r*=a.a,a.g*=a.a,a.b*=a.a,t&&this.state.setDepthMask(!0),null===i.textures)s.clearColor(a.r,a.g,a.b,a.a),s.clear(o);else{if(r&&this._setFramebuffer(i),e)for(let e=0;e<i.textures.length;e++)s.clearBufferfv(s.COLOR,e,[a.r,a.g,a.b,a.a]);t&&n?s.clearBufferfi(s.DEPTH_STENCIL,0,1,0):t?s.clearBufferfv(s.DEPTH,0,[1]):n&&s.clearBufferiv(s.STENCIL,0,[0])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,i){const{state:r,gl:s}=this;this.discard||(s.enable(s.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:o,transformBuffers:a,attributes:l}=this.get(i),c=this._getVaoKey(null,l),u=this.vaoCache[c];void 0===u?this._createVao(null,l):s.bindVertexArray(u),r.useProgram(o),this._bindUniforms(n);const h=this._getTransformFeedback(a);s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,h),s.beginTransformFeedback(s.POINTS),l[0].isStorageInstancedBufferAttribute?s.drawArraysInstanced(s.POINTS,0,1,t.count):s.drawArrays(s.POINTS,0,t.count),s.endTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null);for(let d=0;d<a.length;d++){const e=a[d];e.pbo&&this.textureUtils.copyBufferToTexture(e.transformBuffer,e.pbo),e.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e)}draw(e){const{object:t,pipeline:n,material:i,context:r}=e,{programGPU:s}=this.get(n),{gl:o,state:a}=this,l=this.get(r);this._bindUniforms(e.getBindings());const c=t.isMesh&&t.matrixWorld.determinant()<0;a.setMaterial(i,c),a.useProgram(s);let u=e.staticVao;if(void 0===u){const t=this._getVaoKey(e.getIndex(),e.getAttributes());if(u=this.vaoCache[t],void 0===u){let t;({vaoGPU:u,staticVao:t}=this._createVao(e.getIndex(),e.getAttributes())),t&&(e.staticVao=u)}}o.bindVertexArray(u);const h=e.getIndex(),d=e.geometry,p=e.drawRange,A=p.start,f=l.lastOcclusionObject;if(f!==t&&void 0!==f){if(null!==f&&!0===f.occlusionTest&&(o.endQuery(o.ANY_SAMPLES_PASSED),l.occlusionQueryIndex++),!0===t.occlusionTest){const e=o.createQuery();o.beginQuery(o.ANY_SAMPLES_PASSED,e),l.occlusionQueries[l.occlusionQueryIndex]=e,l.occlusionQueryObjects[l.occlusionQueryIndex]=t}l.lastOcclusionObject=t}const m=this.bufferRenderer;let g;if(t.isPoints?m.mode=o.POINTS:t.isLineSegments?m.mode=o.LINES:t.isLine?m.mode=o.LINE_STRIP:t.isLineLoop?m.mode=o.LINE_LOOP:!0===i.wireframe?(a.setLineWidth(i.wireframeLinewidth*this.renderer.getPixelRatio()),m.mode=o.LINES):m.mode=o.TRIANGLES,m.object=t,null!==h){const e=this.get(h),t=p.count!==1/0?p.count:h.count;m.index=h.count,m.type=e.type,g=t}else{m.index=0;g=p.count!==1/0?p.count:d.attributes.position.count}const v=this.getInstanceCount(e);t.isBatchedMesh?null!==t._multiDrawInstances?m.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances):this.hasFeature("WEBGL_multi_draw")?m.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):fD("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):v>1?m.renderInstances(A,g,v):m.render(A,g),o.bindVertexArray(null)}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,n,i,r){return this.textureUtils.copyTextureToBuffer(e,t,n,i,r)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new qJ(e,t)}createProgram(e){const t=this.gl,{stage:n,code:i}=e,r="fragment"===n?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(r,i),t.compileShader(r),this.set(e,{shaderGPU:r})}destroyProgram(){console.warn("Abstract class.")}createRenderPipeline(e,t){const n=this.gl,i=e.pipeline,{fragmentProgram:r,vertexProgram:s}=i,o=n.createProgram(),a=this.get(r).shaderGPU,l=this.get(s).shaderGPU;if(n.attachShader(o,a),n.attachShader(o,l),n.linkProgram(o),this.set(i,{programGPU:o,fragmentShader:a,vertexShader:l}),null!==t&&this.parallel){const r=new Promise((t=>{const r=this.parallel,s=()=>{n.getProgramParameter(o,r.COMPLETION_STATUS_KHR)?(this._completeCompile(e,i),t()):requestAnimationFrame(s)};s()}));t.push(r)}else this._completeCompile(e,i)}_handleSource(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let o=r;o<s;o++){const e=o+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[o]))}return i.join("\n")}_getShaderErrors(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+this._handleSource(e.getShaderSource(t),i)}return r}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const i=this.gl,r=i.getProgramInfoLog(e).trim();if(!1===i.getProgramParameter(e,i.LINK_STATUS))if("function"===typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(i,e,n,t);else{const s=this._getShaderErrors(i,n,"vertex"),o=this._getShaderErrors(i,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(e,i.VALIDATE_STATUS)+"\n\nProgram Info Log: "+r+"\n"+s+"\n"+o)}else""!==r&&console.warn("THREE.WebGLProgram: Program Info Log:",r)}}_completeCompile(e,t){const{state:n,gl:i}=this,r=this.get(t),{programGPU:s,fragmentShader:o,vertexShader:a}=r;!1===i.getProgramParameter(s,i.LINK_STATUS)&&this._logProgramError(s,o,a),n.useProgram(s);const l=e.getBindings();this._setupBindings(l,s),this.set(t,{programGPU:s})}createComputePipeline(e,t){const{state:n,gl:i}=this,r={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(r);const{computeProgram:s}=e,o=i.createProgram(),a=this.get(r).shaderGPU,l=this.get(s).shaderGPU,c=s.transforms,u=[],h=[];for(let f=0;f<c.length;f++){const e=c[f];u.push(e.varyingName),h.push(e.attributeNode)}i.attachShader(o,a),i.attachShader(o,l),i.transformFeedbackVaryings(o,u,i.SEPARATE_ATTRIBS),i.linkProgram(o),!1===i.getProgramParameter(o,i.LINK_STATUS)&&this._logProgramError(o,a,l),n.useProgram(o),this.createBindings(null,t),this._setupBindings(t,o);const d=s.attributes,p=[],A=[];for(let f=0;f<d.length;f++){const e=d[f].node.attribute;p.push(e),this.has(e)||this.attributeUtils.createAttribute(e,i.ARRAY_BUFFER)}for(let f=0;f<h.length;f++){const e=h[f].attribute;this.has(e)||this.attributeUtils.createAttribute(e,i.ARRAY_BUFFER);const t=this.get(e);A.push(t)}this.set(e,{programGPU:o,transformBuffers:A,attributes:p})}createBindings(e,t){this.updateBindings(e,t)}updateBindings(e,t){const{state:n,gl:i}=this;let r=0,s=0;for(const o of t)for(const e of o.bindings)if(e.isUniformsGroup||e.isUniformBuffer){const t=i.createBuffer(),s=e.buffer;i.bindBuffer(i.UNIFORM_BUFFER,t),i.bufferData(i.UNIFORM_BUFFER,s,i.DYNAMIC_DRAW),n.bindBufferBase(i.UNIFORM_BUFFER,r,t),this.set(e,{index:r++,bufferGPU:t})}else if(e.isSampledTexture){const{textureGPU:t,glTextureType:n}=this.get(e.texture);this.set(e,{index:s++,textureGPU:t,glTextureType:n})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const n=this.get(e).bufferGPU,i=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){}hasFeature(e){const t=Object.keys(a$).filter((t=>a$[t]===e)),n=this.extensions;for(let i=0;i<t.length;i++)if(n.has(t[i]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n,i){this.textureUtils.copyTextureToTexture(e,t,n,i)}copyFramebufferToTexture(e,t){this.textureUtils.copyFramebufferToTexture(e,t)}_setFramebuffer(e){const{gl:t,state:n}=this;let i=null;if(null!==e.textures){const r=e.renderTarget,s=this.get(r),{samples:o,depthBuffer:a,stencilBuffer:l}=r,c=!0===r.isWebGLCubeRenderTarget;let u=s.msaaFrameBuffer,h=s.depthRenderbuffer;const d=zZ(e);let p;if(c?(s.cubeFramebuffers||(s.cubeFramebuffers={}),p=s.cubeFramebuffers[d]):(s.framebuffers||(s.framebuffers={}),p=s.framebuffers[d]),void 0===p){p=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,p);const i=e.textures;if(c){s.cubeFramebuffers[d]=p;const{textureGPU:e}=this.get(i[0]),n=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,e,0)}else{s.framebuffers[d]=p;for(let n=0;n<i.length;n++){const r=i[n],s=this.get(r);s.renderTarget=e.renderTarget;const o=t.COLOR_ATTACHMENT0+n;t.framebufferTexture2D(t.FRAMEBUFFER,o,t.TEXTURE_2D,s.textureGPU,0)}n.drawBuffers(e,p)}if(null!==e.depthTexture){const n=this.get(e.depthTexture),i=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,n.textureGPU,0)}}if(o>0){if(void 0===u){const i=[];u=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,u);const r=[],c=e.textures;for(let n=0;n<c.length;n++){if(r[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r[n]),i.push(t.COLOR_ATTACHMENT0+n),a){const e=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;i.push(e)}const s=e.textures[n],c=this.get(s);t.renderbufferStorageMultisample(t.RENDERBUFFER,o,c.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,r[n])}if(s.msaaFrameBuffer=u,s.msaaRenderbuffers=r,void 0===h){h=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(h,e),s.depthRenderbuffer=h;const n=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;i.push(n)}s.invalidationArray=i}i=s.msaaFrameBuffer}else i=p}n.bindFramebuffer(t.FRAMEBUFFER,i)}_getVaoKey(e,t){let n=[];if(null!==e){n+=":"+this.get(e).id}for(let i=0;i<t.length;i++){n+=":"+this.get(t[i]).id}return n}_createVao(e,t){const{gl:n}=this,i=n.createVertexArray();let r="",s=!0;if(n.bindVertexArray(i),null!==e){const t=this.get(e);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.bufferGPU),r+=":"+t.id}for(let o=0;o<t.length;o++){const e=t[o],i=this.get(e);let a,l;r+=":"+i.id,n.bindBuffer(n.ARRAY_BUFFER,i.bufferGPU),n.enableVertexAttribArray(o),(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(s=!1),!0===e.isInterleavedBufferAttribute?(a=e.data.stride*i.bytesPerElement,l=e.offset*i.bytesPerElement):(a=0,l=0),i.isInteger?n.vertexAttribIPointer(o,e.itemSize,i.type,a,l):n.vertexAttribPointer(o,e.itemSize,i.type,e.normalized,a,l),e.isInstancedBufferAttribute&&!e.isInterleavedBufferAttribute?n.vertexAttribDivisor(o,e.meshPerAttribute):e.isInterleavedBufferAttribute&&e.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(o,e.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),this.vaoCache[r]=i,{vaoGPU:i,staticVao:s}}_getTransformFeedback(e){let t="";for(let r=0;r<e.length;r++)t+=":"+e[r].id;let n=this.transformFeedbackCache[t];if(void 0!==n)return n;const{gl:i}=this;n=i.createTransformFeedback(),i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,n);for(let r=0;r<e.length;r++){const t=e[r];i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,r,t.transformBuffer)}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const i of e)for(const e of i.bindings){const i=this.get(e).index;if(e.isUniformsGroup||e.isUniformBuffer){const r=n.getUniformBlockIndex(t,e.name);n.uniformBlockBinding(t,r,i)}else if(e.isSampledTexture){const r=n.getUniformLocation(t,e.name);n.uniform1i(r,i)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const i of e)for(const e of i.bindings){const i=this.get(e),r=i.index;e.isUniformsGroup||e.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,r,i.bufferGPU):e.isSampledTexture&&n.bindTexture(i.glTextureType,i.textureGPU,t.TEXTURE0+r)}}}class u$ extends SJ{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class h$ extends u${constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class d$ extends TJ{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let p$=0;class A$ extends d${constructor(e,t){super("StorageBuffer_"+p$++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:qQ,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class f$ extends IW{constructor(e){super(),this.device=e;this.mipmapSampler=e.createSampler({minFilter:hQ}),this.flipYSampler=e.createSampler({minFilter:dQ}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n"}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n"}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"})}getTransferPipeline(e){let t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"mipmap-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:GY,stripIndexFormat:oQ},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"flipY-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:GY,stripIndexFormat:oQ},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t.format,{width:r,height:s}=t.size,o=this.getTransferPipeline(i),a=this.getFlipYPipeline(i),l=this.device.createTexture({size:{width:r,height:s,depthOrArrayLayers:1},format:i,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),c=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:JQ,baseArrayLayer:n}),u=l.createView({baseMipLevel:0,mipLevelCount:1,dimension:JQ,baseArrayLayer:0}),h=this.device.createCommandEncoder({}),d=(e,t,n)=>{const i=e.getBindGroupLayout(0),r=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:t}]}),s=h.beginRenderPass({colorAttachments:[{view:n,loadOp:eQ,storeOp:JY,clearValue:[0,0,0,0]}]});s.setPipeline(e),s.setBindGroup(0,r),s.draw(4,1,0,0),s.end()};d(o,c,u),d(a,u,c),this.device.queue.submit([h.finish()]),l.destroy()}generateMipmaps(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.get(e);void 0===i.useCount&&(i.useCount=0,i.layers=[]);const r=i.layers[n]||this._mipmapCreateBundles(e,t,n),s=this.device.createCommandEncoder({});this._mipmapRunBundles(s,r),this.device.queue.submit([s.finish()]),0!==i.useCount&&(i.layers[n]=r),i.useCount++}_mipmapCreateBundles(e,t,n){const i=this.getTransferPipeline(t.format),r=i.getBindGroupLayout(0);let s=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:JQ,baseArrayLayer:n});const o=[];for(let a=1;a<t.mipLevelCount;a++){const l=this.device.createBindGroup({layout:r,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:s}]}),c=e.createView({baseMipLevel:a,mipLevelCount:1,dimension:JQ,baseArrayLayer:n}),u={colorAttachments:[{view:c,loadOp:eQ,storeOp:JY,clearValue:[0,0,0,0]}]},h=this.device.createRenderBundleEncoder({colorFormats:[t.format]});h.setPipeline(i),h.setBindGroup(0,l),h.draw(4,1,0,0),o.push({renderBundles:[h.finish()],passDescriptor:u}),s=c}return o}_mipmapRunBundles(e,t){const n=t.length;for(let i=0;i<n;i++){const n=t[i],r=e.beginRenderPass(n.passDescriptor);r.executeBundles(n.renderBundles),r.end()}}}const m$={[zN]:"never",[qN]:"less",[VN]:"equal",[GN]:"less-equal",[jN]:"greater",[WN]:"greater-equal",[XN]:"always",[HN]:"not-equal"},g$=[0,1,3,2,4,5];class v${constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new vO,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,i=t.get(e),r={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:e.anisotropy};e.isDepthTexture&&null!==e.compareFunction&&(r.compare=m$[e.compareFunction]),i.sampler=n.createSampler(r)}createDefaultTexture(e){let t;const n=y$(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.backend,i=n.get(e);if(i.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);const{width:r,height:s,depth:o,levels:a}=t,l=this._getDimension(e),c=e.internalFormat||t.format||y$(e,n.device);let u=void 0!==t.sampleCount?t.sampleCount:1;u=n.utils.getSampleCount(u);const h=e.isRenderTargetTexture&&!e.isMultisampleRenderTargetTexture?1:u;let d=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(d|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&(d|=GPUTextureUsage.RENDER_ATTACHMENT);const p={label:e.name,size:{width:r,height:s,depthOrArrayLayers:o},mipLevelCount:a,sampleCount:h,dimension:l,format:c,usage:d};if(e.isVideoTexture){const t=e.source.data,n=new VideoFrame(t);p.size.width=n.displayWidth,p.size.height=n.displayHeight,n.close(),i.externalTexture=t}else{if(void 0===c)return console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);i.texture=n.device.createTexture(p)}if(e.isRenderTargetTexture&&u>1&&!e.isMultisampleRenderTargetTexture){const e=Object.assign({},p);e.label=e.label+"-msaa",e.sampleCount=u,i.msaaTexture=n.device.createTexture(e)}i.initialized=!0,i.textureDescriptorGPU=p}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture.destroy(),void 0!==n.msaaTexture&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){delete this.backend.get(e).sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let e=0;e<n;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.backend,{width:i,height:r}=n.getDrawingBufferSize(),s=this.depthTexture,o=n.get(s).texture;let a,l;if(t?(a=$P,l=QP):e&&(a=JP,l=WP),void 0!==o){if(s.image.width===i&&s.image.height===r&&s.format===a&&s.type===l)return o;this.destroyTexture(s)}return s.name="depthBuffer",s.format=a,s.type=l,s.image.width=i,s.image.height=r,this.createTexture(s,{sampleCount:n.utils.getSampleCount(n.renderer.samples),width:i,height:r}),n.get(s).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:i}=n;if(!e.isRenderTargetTexture&&void 0!==i){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,i,0,e.flipY);else if(e.isDataArrayTexture||e.isData3DTexture)for(let r=0;r<t.image.depth;r++)this._copyBufferToTexture(t.image,n.texture,i,r,e.flipY,r);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,i);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,i,e.flipY);else if(e.isVideoTexture){const t=e.source.data;n.externalTexture=t}else this._copyImageToTexture(t.image,n.texture,i,0,e.flipY);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,i,r){const s=this.backend.device,o=this.backend.get(e),a=o.texture,l=o.textureDescriptorGPU.format,c=this._getBytesPerTexel(l);let u=i*c;u=256*Math.ceil(u/256);const h=s.createBuffer({size:i*r*c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),d=s.createCommandEncoder();d.copyTextureToBuffer({texture:a,origin:{x:t,y:n}},{buffer:h,bytesPerRow:u},{width:i,height:r});const p=this._getTypedArrayType(l);s.queue.submit([d.finish()]),await h.mapAsync(GPUMapMode.READ);return new p(h.getMappedRange())}_isEnvironmentTexture(e){const t=e.mapping;return t===PP||t===NP||t===CP||t===RP}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const n=new RD;n.minFilter=OP,n.magFilter=OP,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const n=new $I;n.minFilter=OP,n.magFilter=OP,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(null===e){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,i){for(let r=0;r<6;r++){const s=e[r],o=!0===i?g$[r]:r;s.isDataTexture?this._copyBufferToTexture(s.image,t,n,o,i):this._copyImageToTexture(s,t,n,o,i)}}_copyImageToTexture(e,t,n,i,r){this.backend.device.queue.copyExternalImageToTexture({source:e},{texture:t,mipLevel:0,origin:{x:0,y:0,z:i}},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===r&&this._flipY(t,n,i)}_getPassUtils(){let e=this._passUtils;return null===e&&(this._passUtils=e=new f$(this.backend.device)),e}_generateMipmaps(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=this.backend.device,a=e.data,l=this._getBytesPerTexel(n.format),c=e.width*l;o.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:i}},a,{offset:e.width*e.height*l*s,bytesPerRow:c},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===r&&this._flipY(t,n,i)}_copyCompressedBufferToTexture(e,t,n){const i=this.backend.device,r=this._getBlockData(n.format),s=n.size.depthOrArrayLayers>1;for(let o=0;o<e.length;o++){const a=e[o],l=a.width,c=a.height,u=s?n.size.depthOrArrayLayers:1,h=Math.ceil(l/r.width)*r.byteLength,d=h*Math.ceil(c/r.height);for(let e=0;e<u;e++)i.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:e}},a.data,{offset:e*d,bytesPerRow:h,rowsPerImage:Math.ceil(c/r.height)},{width:Math.ceil(l/r.width)*r.width,height:Math.ceil(c/r.height)*r.height,depthOrArrayLayers:1})}}_getBlockData(e){return e===aQ.BC1RGBAUnorm||e===aQ.BC1RGBAUnormSRGB?{byteLength:8,width:4,height:4}:e===aQ.BC2RGBAUnorm||e===aQ.BC2RGBAUnormSRGB||e===aQ.BC3RGBAUnorm||e===aQ.BC3RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===aQ.BC4RUnorm||e===aQ.BC4RSNorm?{byteLength:8,width:4,height:4}:e===aQ.BC5RGUnorm||e===aQ.BC5RGSnorm||e===aQ.BC6HRGBUFloat||e===aQ.BC6HRGBFloat||e===aQ.BC7RGBAUnorm||e===aQ.BC7RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===aQ.ETC2RGB8Unorm||e===aQ.ETC2RGB8UnormSRGB||e===aQ.ETC2RGB8A1Unorm||e===aQ.ETC2RGB8A1UnormSRGB?{byteLength:8,width:4,height:4}:e===aQ.ETC2RGBA8Unorm||e===aQ.ETC2RGBA8UnormSRGB?{byteLength:16,width:4,height:4}:e===aQ.EACR11Unorm||e===aQ.EACR11Snorm?{byteLength:8,width:4,height:4}:e===aQ.EACRG11Unorm||e===aQ.EACRG11Snorm||e===aQ.ASTC4x4Unorm||e===aQ.ASTC4x4UnormSRGB?{byteLength:16,width:4,height:4}:e===aQ.ASTC5x4Unorm||e===aQ.ASTC5x4UnormSRGB?{byteLength:16,width:5,height:4}:e===aQ.ASTC5x5Unorm||e===aQ.ASTC5x5UnormSRGB?{byteLength:16,width:5,height:5}:e===aQ.ASTC6x5Unorm||e===aQ.ASTC6x5UnormSRGB?{byteLength:16,width:6,height:5}:e===aQ.ASTC6x6Unorm||e===aQ.ASTC6x6UnormSRGB?{byteLength:16,width:6,height:6}:e===aQ.ASTC8x5Unorm||e===aQ.ASTC8x5UnormSRGB?{byteLength:16,width:8,height:5}:e===aQ.ASTC8x6Unorm||e===aQ.ASTC8x6UnormSRGB?{byteLength:16,width:8,height:6}:e===aQ.ASTC8x8Unorm||e===aQ.ASTC8x8UnormSRGB?{byteLength:16,width:8,height:8}:e===aQ.ASTC10x5Unorm||e===aQ.ASTC10x5UnormSRGB?{byteLength:16,width:10,height:5}:e===aQ.ASTC10x6Unorm||e===aQ.ASTC10x6UnormSRGB?{byteLength:16,width:10,height:6}:e===aQ.ASTC10x8Unorm||e===aQ.ASTC10x8UnormSRGB?{byteLength:16,width:10,height:8}:e===aQ.ASTC10x10Unorm||e===aQ.ASTC10x10UnormSRGB?{byteLength:16,width:10,height:10}:e===aQ.ASTC12x10Unorm||e===aQ.ASTC12x10UnormSRGB?{byteLength:16,width:12,height:10}:e===aQ.ASTC12x12Unorm||e===aQ.ASTC12x12UnormSRGB?{byteLength:16,width:12,height:12}:void 0}_convertAddressMode(e){let t=lQ;return e===DP?t=cQ:e===IP&&(t=uQ),t}_convertFilterMode(e){let t=hQ;return e!==OP&&e!==kP&&e!==BP||(t=dQ),t}_getBytesPerTexel(e){return e===aQ.R8Unorm||e===aQ.R8Snorm||e===aQ.R8Uint||e===aQ.R8Sint?1:e===aQ.R16Uint||e===aQ.R16Sint||e===aQ.R16Float||e===aQ.RG8Unorm||e===aQ.RG8Snorm||e===aQ.RG8Uint||e===aQ.RG8Sint?2:e===aQ.R32Uint||e===aQ.R32Sint||e===aQ.R32Float||e===aQ.RG16Uint||e===aQ.RG16Sint||e===aQ.RG16Float||e===aQ.RGBA8Unorm||e===aQ.RGBA8UnormSRGB||e===aQ.RGBA8Snorm||e===aQ.RGBA8Uint||e===aQ.RGBA8Sint||e===aQ.BGRA8Unorm||e===aQ.BGRA8UnormSRGB||e===aQ.RGB9E5UFloat||e===aQ.RGB10A2Unorm||e===aQ.RG11B10UFloat||e===aQ.Depth32Float||e===aQ.Depth24Plus||e===aQ.Depth24PlusStencil8||e===aQ.Depth32FloatStencil8?4:e===aQ.RG32Uint||e===aQ.RG32Sint||e===aQ.RG32Float||e===aQ.RGBA16Uint||e===aQ.RGBA16Sint||e===aQ.RGBA16Float?8:e===aQ.RGBA32Uint||e===aQ.RGBA32Sint||e===aQ.RGBA32Float?16:void 0}_getTypedArrayType(e){return e===aQ.R8Uint?Uint8Array:e===aQ.R8Sint?Int8Array:e===aQ.R8Unorm?Uint8Array:e===aQ.R8Snorm?Int8Array:e===aQ.RG8Uint?Uint8Array:e===aQ.RG8Sint?Int8Array:e===aQ.RG8Unorm?Uint8Array:e===aQ.RG8Snorm?Int8Array:e===aQ.RGBA8Uint?Uint8Array:e===aQ.RGBA8Sint?Int8Array:e===aQ.RGBA8Unorm?Uint8Array:e===aQ.RGBA8Snorm?Int8Array:e===aQ.R16Uint?Uint16Array:e===aQ.R16Sint?Int16Array:e===aQ.RG16Uint?Uint16Array:e===aQ.RG16Sint?Int16Array:e===aQ.RGBA16Uint?Uint16Array:e===aQ.RGBA16Sint?Int16Array:e===aQ.R16Float||e===aQ.RG16Float||e===aQ.RGBA16Float?Float32Array:e===aQ.R32Uint?Uint32Array:e===aQ.R32Sint?Int32Array:e===aQ.R32Float?Float32Array:e===aQ.RG32Uint?Uint32Array:e===aQ.RG32Sint?Int32Array:e===aQ.RG32Float?Float32Array:e===aQ.RGBA32Uint?Uint32Array:e===aQ.RGBA32Sint?Int32Array:e===aQ.RGBA32Float?Float32Array:e===aQ.BGRA8Unorm||e===aQ.BGRA8UnormSRGB?Uint8Array:e===aQ.RGB10A2Unorm||e===aQ.RGB9E5UFloat||e===aQ.RG11B10UFloat?Uint32Array:e===aQ.Depth32Float?Float32Array:e===aQ.Depth24Plus||e===aQ.Depth24PlusStencil8?Uint32Array:e===aQ.Depth32FloatStencil8?Float32Array:void 0}_getDimension(e){let t;return t=e.isData3DTexture?ZQ:KQ,t}}function y$(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e.format,i=e.type,r=e.colorSpace;let s;if(!0===e.isFramebufferTexture&&e.type===qP)s=aQ.BGRA8Unorm;else if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(n){case oN:s=r===DN?aQ.BC1RGBAUnormSRGB:aQ.BC1RGBAUnorm;break;case aN:s=r===DN?aQ.BC2RGBAUnormSRGB:aQ.BC2RGBAUnorm;break;case lN:s=r===DN?aQ.BC3RGBAUnormSRGB:aQ.BC3RGBAUnorm;break;case cN:s=r===DN?aQ.ETC2RGB8UnormSRGB:aQ.ETC2RGB8Unorm;break;case uN:s=r===DN?aQ.ETC2RGBA8UnormSRGB:aQ.ETC2RGBA8Unorm;break;case hN:s=r===DN?aQ.ASTC4x4UnormSRGB:aQ.ASTC4x4Unorm;break;case dN:s=r===DN?aQ.ASTC5x4UnormSRGB:aQ.ASTC5x4Unorm;break;case pN:s=r===DN?aQ.ASTC5x5UnormSRGB:aQ.ASTC5x5Unorm;break;case AN:s=r===DN?aQ.ASTC6x5UnormSRGB:aQ.ASTC6x5Unorm;break;case fN:s=r===DN?aQ.ASTC6x6UnormSRGB:aQ.ASTC6x6Unorm;break;case mN:s=r===DN?aQ.ASTC8x5UnormSRGB:aQ.ASTC8x5Unorm;break;case gN:s=r===DN?aQ.ASTC8x6UnormSRGB:aQ.ASTC8x6Unorm;break;case vN:s=r===DN?aQ.ASTC8x8UnormSRGB:aQ.ASTC8x8Unorm;break;case yN:s=r===DN?aQ.ASTC10x5UnormSRGB:aQ.ASTC10x5Unorm;break;case bN:s=r===DN?aQ.ASTC10x6UnormSRGB:aQ.ASTC10x6Unorm;break;case xN:s=r===DN?aQ.ASTC10x8UnormSRGB:aQ.ASTC10x8Unorm;break;case _N:s=r===DN?aQ.ASTC10x10UnormSRGB:aQ.ASTC10x10Unorm;break;case wN:s=r===DN?aQ.ASTC12x10UnormSRGB:aQ.ASTC12x10Unorm;break;case SN:s=r===DN?aQ.ASTC12x12UnormSRGB:aQ.ASTC12x12Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case ZP:switch(i){case VP:s=aQ.RGBA8Snorm;break;case GP:s=aQ.RGBA16Sint;break;case jP:s=aQ.RGBA16Uint;break;case WP:s=aQ.RGBA32Uint;break;case HP:s=aQ.RGBA32Sint;break;case qP:s=r===DN?aQ.RGBA8UnormSRGB:aQ.RGBA8Unorm;break;case YP:s=aQ.RGBA16Float;break;case XP:s=aQ.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case KP:if(35902===i)s=aQ.RGB9E5UFloat;else console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i);break;case eN:switch(i){case VP:s=aQ.R8Snorm;break;case GP:s=aQ.R16Sint;break;case jP:s=aQ.R16Uint;break;case WP:s=aQ.R32Uint;break;case HP:s=aQ.R32Sint;break;case qP:s=aQ.R8Unorm;break;case YP:s=aQ.R16Float;break;case XP:s=aQ.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case nN:switch(i){case VP:s=aQ.RG8Snorm;break;case GP:s=aQ.RG16Sint;break;case jP:s=aQ.RG16Uint;break;case WP:s=aQ.RG32Uint;break;case HP:s=aQ.RG32Sint;break;case qP:s=aQ.RG8Unorm;break;case YP:s=aQ.RG16Float;break;case XP:s=aQ.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case JP:switch(i){case jP:s=aQ.Depth16Unorm;break;case WP:s=aQ.Depth24Plus;break;case XP:s=aQ.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case $P:switch(i){case QP:s=aQ.Depth24PlusStencil8;break;case XP:t&&!1===t.features.has(sK.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),s=aQ.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case tN:switch(i){case HP:s=aQ.R32Sint;break;case WP:s=aQ.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case iN:switch(i){case HP:s=aQ.RG32Sint;break;case WP:s=aQ.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case rN:switch(i){case HP:s=aQ.RGBA32Sint;break;case WP:s=aQ.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}return s}const b$=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,x$=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/gi,_$={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"};class w$ extends CZ{constructor(e){const{type:t,inputs:n,name:i,inputsCode:r,blockCode:s,outputType:o}=(e=>{const t=(e=e.trim()).match(b$);if(null!==t&&4===t.length){const n=t[2],i=[];let r=null;for(;null!==(r=x$.exec(n));)i.push({name:r[1],type:r[2]});const s=[];for(let e=0;e<i.length;e++){const{name:t,type:n}=i[e];let r=n;r.startsWith("texture")&&(r=n.split("<")[0]),r=_$[r]||r,s.push(new JX(r,t))}const o=e.substring(t[0].length),a=t[3]||"void",l=void 0!==t[1]?t[1]:"";return{type:_$[a]||a,inputs:s,name:l,inputsCode:n,blockCode:o,outputType:a}}throw new Error("FunctionNode: Function is not a WGSL code.")})(e);super(t,n,i),this.inputsCode=r,this.blockCode=s,this.outputType=o}getCode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name;const t="void"!==this.outputType?"-> "+this.outputType:"";return"fn ".concat(e," ( ").concat(this.inputsCode.trim()," ) ").concat(t)+this.blockCode}}class S$ extends EZ{parseFunction(e){return new w$(e)}}const T$=self.GPUShaderStage,M$={vertex:T$?T$.VERTEX:1,fragment:T$?T$.FRAGMENT:2,compute:T$?T$.COMPUTE:4},E$={instance:!0,swizzleAssign:!1,storageBuffer:!0},C$={"^^":"tsl_xor"},R$={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",imat2:"mat2x2<i32>",umat2:"mat2x2<u32>",bmat2:"mat2x2<bool>",mat3:"mat3x3<f32>",imat3:"mat3x3<i32>",umat3:"mat3x3<u32>",bmat3:"mat3x3<bool>",mat4:"mat4x4<f32>",imat4:"mat4x4<i32>",umat4:"mat4x4<u32>",bmat4:"mat4x4<bool>"},P$={tsl_xor:new sX("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new sX("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new sX("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new sX("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new sX("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new sX("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new sX("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new sX("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new sX("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping:new sX("\nfn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {\n\n\tlet uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );\n\n\treturn ( ( uvScaled % dimension ) + dimension ) % dimension;\n\n}\n"),biquadraticTexture:new sX("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {\n\n\tlet res = vec2f( textureDimensions( map, level ) );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ), level );\n\tlet rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ), level );\n\tlet rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ), level );\n\tlet rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ), level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},N$={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};/Windows/g.test(navigator.userAgent)&&(P$.pow_float=new sX("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),P$.pow_vec2=new sX("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[P$.pow_float]),P$.pow_vec3=new sX("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[P$.pow_float]),P$.pow_vec4=new sX("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[P$.pow_float]),N$.pow_float="tsl_pow_float",N$.pow_vec2="tsl_pow_vec2",N$.pow_vec3="tsl_pow_vec3",N$.pow_vec4="tsl_pow_vec4");class D$ extends KX{constructor(e,t){super(e,t,new S$),this.uniformGroups={},this.builtins={},this.directives={}}needsToWorkingColorSpace(e){return!0===e.isVideoTexture&&""!==e.colorSpace}_generateTextureSample(e,t,n,i){return"fragment"===(arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.shaderStage)?i?"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(i," )"):"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(n," )"):this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n):this.generateTextureLod(e,t,n,"0")}_generateVideoSample(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage;if("fragment"===n)return"textureSampleBaseClampToEdge( ".concat(e,", ").concat(e,"_sampler, vec2<f32>( ").concat(t,".x, 1.0 - ").concat(t,".y ) )");console.error("WebGPURenderer: THREE.VideoTexture does not support ".concat(n," shader."))}_generateTextureSampleLevel(e,t,n,i,r){return"fragment"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage)&&!1===this.isUnfilterable(e)?"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(i," )"):this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,i):this.generateTextureLod(e,t,n,i)}generateFilteredTexture(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0";return this._include("biquadraticTexture"),"tsl_biquadraticTexture( ".concat(t,", ").concat(n,", i32( ").concat(i," ) )")}generateTextureLod(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0";this._include("repeatWrapping");const r=!0===e.isMultisampleRenderTargetTexture?"textureDimensions( ".concat(t," )"):"textureDimensions( ".concat(t,", 0 )");return"textureLoad( ".concat(t,", tsl_repeatWrapping( ").concat(n,", ").concat(r," ), i32( ").concat(i," ) )")}generateTextureLoad(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0u";return i?"textureLoad( ".concat(t,", ").concat(n,", ").concat(i,", ").concat(r," )"):"textureLoad( ".concat(t,", ").concat(n,", ").concat(r," )")}generateTextureStore(e,t,n,i){return"textureStore( ".concat(t,", ").concat(n,", ").concat(i," )")}isUnfilterable(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&e.type===XP||!0===e.isMultisampleRenderTargetTexture}generateTexture(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.shaderStage,s=null;return s=!0===e.isVideoTexture?this._generateVideoSample(t,n,r):this.isUnfilterable(e)?this.generateTextureLod(e,t,n,"0",i,r):this._generateTextureSample(e,t,n,i,r),s}generateTextureGrad(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===s)return"textureSampleGrad( ".concat(t,", ").concat(t,"_sampler, ").concat(n,",  ").concat(i[0],", ").concat(i[1]," )");console.error("WebGPURenderer: THREE.TextureNode.gradient() does not support ".concat(s," shader."))}generateTextureCompare(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===s)return"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(i," )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(s," shader."))}generateTextureLevel(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage,o=null;return o=!0===e.isVideoTexture?this._generateVideoSample(t,n,s):this._generateTextureSampleLevel(e,t,n,i,r,s),o}generateTextureBias(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===s)return"textureSampleBias( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(i," )");console.error("WebGPURenderer: THREE.TextureNode.biasNode does not support ".concat(s," shader."))}getPropertyName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return"varyings.".concat(e.name)}else if(!0===e.isNodeUniform){const t=e.name,n=e.type;return"texture"===n||"cubeTexture"===n||"storageTexture"===n||"texture3D"===n?t:"buffer"===n||"storageBuffer"===n?"NodeBuffer_".concat(e.id,".").concat(t):e.groupNode.name+"."+t}return super.getPropertyName(e)}getOutputStructName(){return"output"}_getUniformGroupCount(e){return Object.keys(this.uniforms[e]).length}getFunctionOperator(e){const t=C$[e];return void 0!==t?(this._include(t),t):null}getStorageAccess(e){if(e.isStorageTextureNode)switch(e.access){case jQ:return"read";case GQ:return"write";default:return"read_write"}else switch(e.access){case qQ:return"read_write";case VQ:return"read";default:return"write"}}getUniformFromNode(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=super.getUniformFromNode(e,t,n,i),s=this.getDataFromNode(e,n,this.globalCache);if(void 0===s.uniformGPU){let i;const o=e.groupNode,a=o.name,l=this.getBindGroupArray(a,n);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){let s=null;if("texture"===t||"storageTexture"===t?s=new IJ(r.name,r.node,o,e.access?e.access:null):"cubeTexture"===t?s=new OJ(r.name,r.node,o,e.access?e.access:null):"texture3D"===t&&(s=new kJ(r.name,r.node,o,e.access?e.access:null)),s.store=!0===e.isStorageTextureNode,s.setVisibility(M$[n]),"fragment"===n&&!1===this.isUnfilterable(e.value)&&!1===s.store){const e=new h$("".concat(r.name,"_sampler"),r.node,o);e.setVisibility(M$[n]),l.push(e,s),i=[e,s]}else l.push(s),i=[s]}else if("buffer"===t||"storageBuffer"===t){const r=new("storageBuffer"===t?A$:CJ)(e,o);r.setVisibility(M$[n]),l.push(r),i=r}else{const e=this.uniformGroups[n]||(this.uniformGroups[n]={});let s=e[a];void 0===s&&(s=new NJ(a,o),s.setVisibility(M$[n]),e[a]=s,l.push(s)),i=this.getNodeUniform(r,t),s.addUniform(i)}s.uniformGPU=i}return r}getBuiltin(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage;const r=this.builtins[i]||(this.builtins[i]=new Map);return!1===r.has(e)&&r.set(e,{name:e,property:t,type:n}),t}getVertexIndex(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),i=[];for(const s of t.inputs)i.push(s.name+" : "+this.getType(s.type));let r="fn ".concat(t.name,"( ").concat(i.join(", ")," ) -> ").concat(this.getType(t.type)," {\n").concat(n.vars,"\n").concat(n.code,"\n");return n.result&&(r+="\treturn ".concat(n.result,";\n")),r+="\n}\n",r}getInstanceIndex(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}isFlipY(){return!1}enableDirective(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(void 0!==n)for(const i of n)t.push("enable ".concat(i,";"));return t.join("\n")}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}getBuiltins(e){const t=[],n=this.builtins[e];if(void 0!==n)for(const{name:i,property:r,type:s}of n.values())t.push("@builtin( ".concat(i," ) ").concat(r," : ").concat(s));return t.join(",\n\t")}getAttributes(e){const t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","id","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute")),"vertex"===e||"compute"===e){const e=this.getBuiltins("attribute");e&&t.push(e);const n=this.getAttributesArray();for(let i=0,r=n.length;i<r;i++){const e=n[i],r=e.name,s=this.getType(e.type);t.push("@location( ".concat(i," ) ").concat(r," : ").concat(s))}}return t.join(",\n\t")}getStructMembers(e){const t=[],n=e.getMemberTypes();for(let r=0;r<n.length;r++){const e=n[r];t.push("\t@location( ".concat(r," ) m").concat(r," : ").concat(e,"<f32>"))}const i=this.getBuiltins("output");return i&&t.push("\t"+i),t.join(",\n")}getStructs(e){const t=[],n=this.structs[e];for(let i=0,r=n.length;i<r;i++){const e=n[i],r=e.name;let s="struct ".concat(r," {\n");s+=this.getStructMembers(e),s+="\n}",t.push(s),t.push("\nvar<private> output : ".concat(r,";\n\n"))}return t.join("\n\n")}getVar(e,t){return"var ".concat(t," : ").concat(this.getType(e))}getVars(e){const t=[],n=this.vars[e];if(void 0!==n)for(const i of n)t.push("\t".concat(this.getVar(i.type,i.name),";"));return"\n".concat(t.join("\n"),"\n")}getVaryings(e){const t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e){const n=this.varyings,i=this.vars[e];for(let r=0;r<n.length;r++){const s=n[r];if(s.needsInterpolation){let e="@location( ".concat(r," )");/^(int|uint|ivec|uvec)/.test(s.type)&&(e+=" @interpolate( flat )"),t.push("".concat(e," ").concat(s.name," : ").concat(this.getType(s.type)))}else"vertex"===e&&!1===i.includes(s)&&i.push(s)}}const n=this.getBuiltins(e);n&&t.push(n);const i=t.join(",\n\t");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","\t"+i):i}getUniforms(e){const t=this.uniforms[e],n=[],i=[],r=[],s={};for(const a of t){const t=a.groupNode.name,r=this.bindingsIndexes[t];if("texture"===a.type||"cubeTexture"===a.type||"storageTexture"===a.type||"texture3D"===a.type){const t=a.node.value;let i;"fragment"===e&&!1===this.isUnfilterable(t)&&!0!==a.node.isStorageTextureNode&&(!0===t.isDepthTexture&&null!==t.compareFunction?n.push("@binding( ".concat(r.binding++," ) @group( ").concat(r.group," ) var ").concat(a.name,"_sampler : sampler_comparison;")):n.push("@binding( ".concat(r.binding++," ) @group( ").concat(r.group," ) var ").concat(a.name,"_sampler : sampler;")));let s="";if(!0===t.isMultisampleRenderTargetTexture&&(s="_multisampled"),!0===t.isCubeTexture)i="texture_cube<f32>";else if(!0===t.isDataArrayTexture||!0===t.isCompressedArrayTexture)i="texture_2d_array<f32>";else if(!0===t.isDepthTexture)i="texture_depth".concat(s,"_2d");else if(!0===t.isVideoTexture)i="texture_external";else if(!0===t.isData3DTexture)i="texture_3d<f32>";else if(!0===a.node.isStorageTextureNode){const e=y$(t),n=this.getStorageAccess(a.node);i="texture_storage_2d<".concat(e,", ").concat(n,">")}else{const e=this.getComponentTypeFromTexture(t).charAt(0);i="texture".concat(s,"_2d<").concat(e,"32>")}n.push("@binding( ".concat(r.binding++," ) @group( ").concat(r.group," ) var ").concat(a.name," : ").concat(i,";"))}else if("buffer"===a.type||"storageBuffer"===a.type){const e=a.node,t=this.getType(e.bufferType),n=e.bufferCount,s=n>0?", "+n:"",o="\t".concat(a.name," : array< ").concat(t).concat(s," >\n"),l=e.isStorageBufferNode?"storage, ".concat(this.getStorageAccess(e)):"uniform";i.push(this._getWGSLStructBinding("NodeBuffer_"+e.id,o,l,r.binding++,r.group))}else{const e=this.getType(this.getVectorType(a.type)),t=a.groupNode.name;(s[t]||(s[t]={index:r.binding++,id:r.group,snippets:[]})).snippets.push("\t".concat(a.name," : ").concat(e))}}for(const a in s){const e=s[a];r.push(this._getWGSLStructBinding(a,e.snippets.join(",\n"),"uniform",e.index,e.id))}let o=n.join("\n");return o+=i.join("\n"),o+=r.join("\n"),o}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(const t in e){const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t);let i="// code\n\n";i+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1],o=s.outputNode,a=void 0!==o&&!0===o.isOutputStructNode;for(const e of r){const r=this.getFlowData(e),l=e.name;if(l&&(i.length>0&&(i+="\n"),i+="\t// flow -> ".concat(l,"\n\t")),i+="".concat(r.code,"\n\t"),e===s&&"compute"!==t)if(i+="// result\n\n\t","vertex"===t)i+="varyings.Vertex = ".concat(r.result,";");else if("fragment"===t)if(a)n.returnType=o.nodeType,i+="return ".concat(r.result,";");else{let e="\t@location(0) color: vec4<f32>";const t=this.getBuiltins("output");t&&(e+=",\n\t"+t),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",e),n.structs+="\nvar<private> output : OutputStruct;\n\n",i+="output.color = ".concat(r.result,";\n\n\treturn output;")}}n.flow=i}null!==this.material?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==n&&(t=this._getWGSLMethod(e+"_"+n)),void 0===t&&(t=this._getWGSLMethod(e)),t||e}getType(e){return R$[e]||e}isAvailable(e){let t=E$[e];return void 0===t&&("float32Filterable"===e&&(t=this.renderer.hasFeature("float32-filterable")),E$[e]=t),t}_getWGSLMethod(e){return void 0!==P$[e]&&this._include(e),N$[e]}_include(e){const t=P$[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\nvar<private> varyings : VaryingsStruct;\n\n// codes\n").concat(e.codes,"\n\n@vertex\nfn main( ").concat(e.attributes," ) -> VaryingsStruct {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n\treturn varyings;\n\n}\n")}_getWGSLFragmentCode(e){return"".concat(this.getSignature(),"\n\ndiagnostic( off, derivative_uniformity );\n\n// uniforms\n").concat(e.uniforms,"\n\n// structs\n").concat(e.structs,"\n\n// codes\n").concat(e.codes,"\n\n@fragment\nfn main( ").concat(e.varyings," ) -> ").concat(e.returnType," {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}_getWGSLComputeCode(e,t){return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// system\nvar<private> instanceIndex : u32;\n\n// uniforms\n").concat(e.uniforms,"\n\n// codes\n").concat(e.codes,"\n\n@compute @workgroup_size( ").concat(t," )\nfn main( ").concat(e.attributes," ) {\n\n\t// system\n\tinstanceIndex = id.x + id.y * numWorkgroups.x * u32(").concat(t,") + id.z * numWorkgroups.x * numWorkgroups.y * u32(").concat(t,");\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}_getWGSLStruct(e,t){return"\nstruct ".concat(e," {\n").concat(t,"\n};")}_getWGSLStructBinding(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const s=e+"Struct",o=this._getWGSLStruct(s,t);return"".concat(o,"\n@binding( ").concat(i," ) @group( ").concat(r," )\nvar<").concat(n,"> ").concat(e," : ").concat(s,";")}}class L${constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=aQ.Depth24PlusStencil8:e.depth&&(t=aQ.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).texture.format}getCurrentColorFormat(e){let t;return t=null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){return e.isPoints?UY:e.isLineSegments||e.isMesh&&!0===t.wireframe?zY:e.isLine?qY:e.isMesh?VY:void 0}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),2===t&&(t=4)),t}getSampleCountRenderContext(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){return navigator.userAgent.includes("Quest")?aQ.BGRA8Unorm:navigator.gpu.getPreferredCanvasFormat()}}const I$=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),O$=new Map([[AI,["float16"]]]),k$=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class B${constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),i=this.backend,r=i.get(n);let s=r.buffer;if(void 0===s){const o=i.device;let a=n.array;if(!1===e.normalized&&(a.constructor===Int16Array||a.constructor===Uint16Array)){const e=new Uint32Array(a.length);for(let t=0;t<a.length;t++)e[t]=a[t];a=e}if(n.array=a,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&3===n.itemSize){a=new a.constructor(4*n.count);for(let e=0;e<n.count;e++)a.set(n.array.subarray(3*e,3*e+3),4*e);n.itemSize=4,n.array=a}const l=a.byteLength+(4-a.byteLength%4)%4;s=o.createBuffer({label:n.name,size:l,usage:t,mappedAtCreation:!0}),new a.constructor(s.getMappedRange()).set(a),s.unmap(),r.buffer=s}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,i=n.device,r=n.get(t).buffer,s=t.array,o=t.updateRanges;if(0===o.length)i.queue.writeBuffer(r,0,s,0);else{for(let e=0,t=o.length;e<t;e++){const t=o[e];i.queue.writeBuffer(r,0,s,t.start*s.BYTES_PER_ELEMENT,t.count*s.BYTES_PER_ELEMENT)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let i=0;i<t.length;i++){const e=t[i],r=e.array.BYTES_PER_ELEMENT,s=this._getBufferAttribute(e);let o=n.get(s);if(void 0===o){let t,i;!0===e.isInterleavedBufferAttribute?(t=e.data.stride*r,i=e.data.isInstancedInterleavedBuffer?rK:iK):(t=e.itemSize*r,i=e.isInstancedBufferAttribute?rK:iK),!1!==e.normalized||e.array.constructor!==Int16Array&&e.array.constructor!==Uint16Array||(t=4),o={arrayStride:t,attributes:[],stepMode:i},n.set(s,o)}const a=this._getVertexFormat(e),l=!0===e.isInterleavedBufferAttribute?e.offset*r:0;o.attributes.push({shaderLocation:i,offset:l,format:a})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,i=t.get(this._getBufferAttribute(e)),r=i.buffer,s=r.size;let o=i.readBuffer,a=!0;void 0===o&&(o=n.createBuffer({label:e.name,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),a=!1,i.readBuffer=o);const l=n.createCommandEncoder({});l.copyBufferToBuffer(r,0,o,0,s),a&&o.unmap();const c=l.finish();n.queue.submit([c]),await o.mapAsync(GPUMapMode.READ);return o.getMappedRange()}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,i=e.array.constructor,r=e.constructor;let s;if(1==t)s=k$.get(i);else{const e=(O$.get(r)||I$.get(i))[n?1:0];if(e){const n=i.BYTES_PER_ELEMENT*t,r=4*Math.floor((n+3)/4)/i.BYTES_PER_ELEMENT;if(r%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");s="".concat(e,"x").concat(r)}}return s||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),s}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class F${constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend.device,n=[];let i=0;for(const r of e.bindings){const e={binding:i++,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){const t={};r.isStorageBuffer&&(t.type=r.access),e.buffer=t}else if(r.isSampler){const t={};r.texture.isDepthTexture&&null!==r.texture.compareFunction&&(t.type="comparison"),e.sampler=t}else if(r.isSampledTexture&&r.texture.isVideoTexture)e.externalTexture={};else if(r.isSampledTexture&&r.store){const t=this.backend.get(r.texture).texture.format,n=r.access;e.storageTexture={format:t,access:n}}else if(r.isSampledTexture){const t={};if(!0===r.texture.isMultisampleRenderTargetTexture&&(t.multisampled=!0),r.texture.isDepthTexture)t.sampleType=XQ;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){const e=r.texture.type;e===HP?t.sampleType=YQ:e===WP?t.sampleType=QQ:e===XP&&(this.backend.hasFeature("float32-filterable")?t.sampleType=HQ:t.sampleType=WQ)}r.isSampledCubeTexture?t.viewDimension=eK:r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?t.viewDimension=$Q:r.isSampledTexture3D&&(t.viewDimension=tK),e.texture=t}else console.error('WebGPUBindingUtils: Unsupported binding "'.concat(r,'".'));n.push(e)}return t.createBindGroupLayout({entries:n})}createBindings(e){const{backend:t,bindGroupLayoutCache:n}=this,i=t.get(e);let r=n.get(e.bindingsReference);void 0===r&&(r=this.createBindingsLayout(e),n.set(e.bindingsReference,r));const s=this.createBindGroup(e,r);i.layout=r,i.group=s}updateBinding(e){const t=this.backend,n=t.device,i=e.buffer,r=t.get(e).buffer;n.queue.writeBuffer(r,0,i,0)}createBindGroup(e,t){const n=this.backend,i=n.device;let r=0;const s=[];for(const o of e.bindings){if(o.isUniformBuffer){const e=n.get(o);if(void 0===e.buffer){const t=o.byteLength,n=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,r=i.createBuffer({label:"bindingBuffer_"+o.name,size:t,usage:n});e.buffer=r}s.push({binding:r,resource:{buffer:e.buffer}})}else if(o.isStorageBuffer){const e=n.get(o);if(void 0===e.buffer){const t=o.attribute;e.buffer=n.get(t).buffer}s.push({binding:r,resource:{buffer:e.buffer}})}else if(o.isSampler){const e=n.get(o.texture);s.push({binding:r,resource:e.sampler})}else if(o.isSampledTexture){const e=n.get(o.texture);let t;if(void 0!==e.externalTexture)t=i.importExternalTexture({source:e.externalTexture});else{const n=o.store?1:e.texture.mipLevelCount,i="view-".concat(e.texture.width,"-").concat(e.texture.height,"-").concat(n);if(t=e[i],void 0===t){const r=nK;let s;s=o.isSampledCubeTexture?eK:o.isSampledTexture3D?tK:o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?$Q:JQ,t=e[i]=e.texture.createView({aspect:r,dimension:s,mipLevelCount:n})}}s.push({binding:r,resource:t})}r++}return i.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:s})}}class U${constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:i,geometry:r,pipeline:s}=e,{vertexProgram:o,fragmentProgram:a}=s,l=this.backend,c=l.device,u=l.utils,h=l.get(s),d=[];for(const T of e.getBindings()){const e=l.get(T);d.push(e.layout)}const p=l.attributeUtils.createShaderVertexBuffers(e);let A;!0===i.transparent&&0!==i.blending&&(A=this._getBlending(i));let f={};!0===i.stencilWrite&&(f={compare:this._getStencilCompare(i),failOp:this._getStencilOperation(i.stencilFail),depthFailOp:this._getStencilOperation(i.stencilZFail),passOp:this._getStencilOperation(i.stencilZPass)});const m=this._getColorWriteMask(i),g=[];if(null!==e.context.textures){const t=e.context.textures;for(let e=0;e<t.length;e++){const n=u.getTextureFormatGPU(t[e]);g.push({format:n,blend:A,writeMask:m})}}else{const t=u.getCurrentColorFormat(e.context);g.push({format:t,blend:A,writeMask:m})}const v=l.get(o).module,y=l.get(a).module,b=this._getPrimitiveState(n,r,i),x=this._getDepthCompare(i),_=u.getCurrentDepthStencilFormat(e.context),w=this._getSampleCount(e.context),S={label:"renderPipeline_".concat(i.name||i.type,"_").concat(i.id),vertex:Object.assign({},v,{buffers:p}),fragment:Object.assign({},y,{targets:g}),primitive:b,depthStencil:{format:_,depthWriteEnabled:i.depthWrite,depthCompare:x,stencilFront:f,stencilBack:{},stencilReadMask:i.stencilFuncMask,stencilWriteMask:i.stencilWriteMask},multisample:{count:w,alphaToCoverageEnabled:i.alphaToCoverage},layout:c.createPipelineLayout({bindGroupLayouts:d})};if(null===t)h.pipeline=c.createRenderPipeline(S);else{const e=new Promise((e=>{c.createRenderPipelineAsync(S).then((t=>{h.pipeline=t,e()}))}));t.push(e)}}createBundleEncoder(e){const t=this.backend,{utils:n,device:i}=t,r=n.getCurrentDepthStencilFormat(e),s={label:"renderBundleEncoder",colorFormats:[n.getCurrentColorFormat(e)],depthStencilFormat:r,sampleCount:this._getSampleCount(e)};return i.createRenderBundleEncoder(s)}createComputePipeline(e,t){const n=this.backend,i=n.device,r=n.get(e.computeProgram).module,s=n.get(e),o=[];for(const a of t){const e=n.get(a);o.push(e.layout)}s.pipeline=i.createComputePipeline({compute:r,layout:i.createPipelineLayout({bindGroupLayouts:o})})}_getBlending(e){let t,n;const i=e.blending,r=e.blendSrc,s=e.blendDst,o=e.blendEquation;if(5===i){const i=null!==e.blendSrcAlpha?e.blendSrcAlpha:r,a=null!==e.blendDstAlpha?e.blendDstAlpha:s,l=null!==e.blendEquationAlpha?e.blendEquationAlpha:o;t={srcFactor:this._getBlendFactor(r),dstFactor:this._getBlendFactor(s),operation:this._getBlendOperation(o)},n={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(l)}}else{const r=(e,i,r,s)=>{t={srcFactor:e,dstFactor:i,operation:MQ},n={srcFactor:r,dstFactor:s,operation:MQ}};if(e.premultipliedAlpha)switch(i){case 1:r(AQ,vQ,AQ,vQ);break;case 2:r(AQ,AQ,AQ,AQ);break;case 3:r(pQ,mQ,pQ,AQ);break;case 4:r(pQ,fQ,pQ,gQ)}else switch(i){case 1:r(gQ,vQ,AQ,vQ);break;case 2:r(gQ,AQ,gQ,AQ);break;case 3:r(pQ,mQ,pQ,AQ);break;case 4:r(pQ,fQ,pQ,fQ)}}if(void 0!==t&&void 0!==n)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",i)}_getBlendFactor(e){let t;switch(e){case 200:t=pQ;break;case 201:t=AQ;break;case 202:t=fQ;break;case 203:t=mQ;break;case xP:t=gQ;break;case _P:t=vQ;break;case 208:t=yQ;break;case 209:t=bQ;break;case 206:t=xQ;break;case 207:t=_Q;break;case 210:t=wQ;break;case 211:t=SQ;break;case 212:t=TQ;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case 512:t=jY;break;case 519:t=ZY;break;case 513:t=HY;break;case 515:t=XY;break;case 514:t=WY;break;case 518:t=KY;break;case 516:t=YY;break;case 517:t=QY;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case UN:t=LQ;break;case 0:t=IQ;break;case 7681:t=OQ;break;case 5386:t=kQ;break;case 7682:t=BQ;break;case 7683:t=FQ;break;case 34055:t=UQ;break;case 34056:t=zQ;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case AP:t=MQ;break;case 101:t=EQ;break;case 102:t=CQ;break;case 103:t=RQ;break;case 104:t=PQ;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const i={},r=this.backend.utils;switch(i.topology=r.getPrimitiveTopology(e,n),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(i.stripIndexFormat=t.index.array instanceof Uint16Array?sQ:oQ),n.side){case 0:i.frontFace=tQ,i.cullMode=rQ;break;case 1:i.frontFace=tQ,i.cullMode=iQ;break;case 2:i.frontFace=tQ,i.cullMode=nQ;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side)}return i}_getColorWriteMask(e){return!0===e.colorWrite?DQ:NQ}_getDepthCompare(e){let t;if(!1===e.depthTest)t=ZY;else{const n=e.depthFunc;switch(n){case 0:t=jY;break;case 1:t=ZY;break;case 2:t=HY;break;case 3:t=XY;break;case 4:t=WY;break;case 5:t=KY;break;case 6:t=YY;break;case 7:t=QY;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class z$ extends HJ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.isWebGPUBackend=!0,this.parameters.alpha=void 0===e.alpha||e.alpha,this.parameters.requiredLimits=void 0===e.requiredLimits?{}:e.requiredLimits,this.trackTimestamp=!0===e.trackTimestamp,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new L$(this),this.attributeUtils=new B$(this),this.bindingUtils=new F$(this),this.pipelineUtils=new U$(this),this.textureUtils=new v$(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(void 0===t.device){const e={powerPreference:t.powerPreference},i=await navigator.gpu.requestAdapter(e);if(null===i)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const r=Object.values(sK),s=[];for(const t of r)i.features.has(t)&&s.push(t);const o={requiredFeatures:s,requiredLimits:t.requiredLimits};n=await i.requestDevice(o)}else n=t.device;const i=void 0!==t.context?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=i;const r=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(sK.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:r}),this.updateSize()}get coordinateSystem(){return ZN}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(null===e){const t=this.renderer;e={colorAttachments:[{view:null}],depthStencilAttachment:{view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()}};const n=e.colorAttachments[0];this.renderer.samples>0?n.view=this.colorBuffer.createView():n.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_getRenderPassDescriptor(e){const t=e.renderTarget,n=this.get(t);let i=n.descriptors;if(void 0===i||n.width!==t.width||n.height!==t.height||n.activeMipmapLevel!==t.activeMipmapLevel||n.samples!==t.samples){i={},n.descriptors=i;const e=()=>{t.removeEventListener("dispose",e),this.delete(t)};t.addEventListener("dispose",e)}const r=e.getCacheKey();let s=i[r];if(void 0===s){const o=e.textures,a=[];for(let t=0;t<o.length;t++){const n=this.get(o[t]),i=n.texture.createView({baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,dimension:JQ});let r,s;void 0!==n.msaaTexture?(r=n.msaaTexture.createView(),s=i):(r=i,s=void 0),a.push({view:r,resolveTarget:s,loadOp:$Y,storeOp:JY})}s={colorAttachments:a,depthStencilAttachment:{view:this.get(e.depthTexture).texture.createView()}},i[r]=s,n.width=t.width,n.height=t.height,n.samples=t.samples,n.activeMipmapLevel=t.activeMipmapLevel}return s}beginRender(e){const t=this.get(e),n=this.device,i=e.occlusionQueryCount;let r,s;i>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,r=n.createQuerySet({type:"occlusion",count:i}),t.occlusionQuerySet=r,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(i),t.lastOcclusionObject=null),s=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e),this.initTimestampQuery(e,s),s.occlusionQuerySet=r;const o=s.depthStencilAttachment;if(null!==e.textures){const t=s.colorAttachments;for(let n=0;n<t.length;n++){const i=t[n];e.clearColor?(i.clearValue=0===n?e.clearColorValue:{r:0,g:0,b:0,a:1},i.loadOp=eQ,i.storeOp=JY):(i.loadOp=$Y,i.storeOp=JY)}}else{const t=s.colorAttachments[0];e.clearColor?(t.clearValue=e.clearColorValue,t.loadOp=eQ,t.storeOp=JY):(t.loadOp=$Y,t.storeOp=JY)}e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=eQ,o.depthStoreOp=JY):(o.depthLoadOp=$Y,o.depthStoreOp=JY)),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=eQ,o.stencilStoreOp=JY):(o.stencilLoadOp=$Y,o.stencilStoreOp=JY));const a=n.createCommandEncoder({label:"renderContext_"+e.id}),l=a.beginRenderPass(s);if(t.descriptor=s,t.encoder=a,t.currentPass=l,t.currentSets={attributes:{},pipeline:null,index:null},t.renderBundles=[],e.viewport&&this.updateViewport(e),e.scissor){const{x:t,y:n,width:i,height:r}=e.scissorValue;l.setScissorRect(t,n,i,r)}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;if(t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery(),t.currentPass.end(),n>0){const i=8*n;let r=this.occludedResolveCache.get(i);void 0===r&&(r=this.device.createBuffer({size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(i,r));const s=this.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,r,0),t.encoder.copyBufferToBuffer(r,0,s,0,i),t.occlusionQueryBuffer=s,this.resolveOccludedAsync(e)}if(this.prepareTimestampBuffer(e,t.encoder),this.device.queue.submit([t.encoder.finish()]),null!==e.textures){const t=e.textures;for(let e=0;e<t.length;e++){const n=t[e];!0===n.generateMipmaps&&this.textureUtils.generateMipmaps(n)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:i}=t;if(n&&i){const e=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const r=n.getMappedRange(),s=new BigUint64Array(r);for(let t=0;t<i.length;t++)s[t]!==BigInt(0)&&e.add(i[t]);n.destroy(),t.occluded=e}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:i,width:r,height:s,minDepth:o,maxDepth:a}=e.viewportValue;t.setViewport(n,i,r,s,o,a)}clear(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.device,s=this.renderer;let o,a,l,c,u=[];if(e){const e=this.getClearColor();if(!0===this.renderer.alpha){const t=e.a;a={r:e.r*t,g:e.g*t,b:e.b*t,a:t}}else a={r:e.r,g:e.g,b:e.b,a:e.a}}if(null===i){l=s.depth,c=s.stencil;const t=this._getDefaultRenderPassDescriptor();if(e){u=t.colorAttachments;const e=u[0];e.clearValue=a,e.loadOp=eQ,e.storeOp=JY}(l||c)&&(o=t.depthStencilAttachment)}else{if(l=i.depth,c=i.stencil,e)for(const e of i.textures){const t=this.get(e),n=t.texture.createView();let i,r;void 0!==t.msaaTexture?(i=t.msaaTexture.createView(),r=n):(i=n,r=void 0),u.push({view:i,resolveTarget:r,clearValue:a,loadOp:eQ,storeOp:JY})}if(l||c){o={view:this.get(i.depthTexture).texture.createView()}}}l&&(t?(o.depthLoadOp=eQ,o.depthClearValue=s.getClearDepth(),o.depthStoreOp=JY):(o.depthLoadOp=$Y,o.depthStoreOp=JY)),c&&(n?(o.stencilLoadOp=eQ,o.stencilClearValue=s.getClearStencil(),o.stencilStoreOp=JY):(o.stencilLoadOp=$Y,o.stencilStoreOp=JY));const h=r.createCommandEncoder({});h.beginRenderPass({colorAttachments:u,depthStencilAttachment:o}).end(),r.queue.submit([h.finish()])}beginCompute(e){const t=this.get(e),n={};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder(),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,i){const{passEncoderGPU:r}=this.get(e),s=this.get(i).pipeline;r.setPipeline(s);for(let c=0,u=n.length;c<u;c++){const e=n[c],t=this.get(e);r.setBindGroup(c,t.group)}const o=this.device.limits.maxComputeWorkgroupsPerDimension,a=this.get(t);void 0===a.dispatchSize&&(a.dispatchSize={x:0,y:1,z:1});const{dispatchSize:l}=a;t.dispatchCount>o?(l.x=Math.min(t.dispatchCount,o),l.y=Math.ceil(t.dispatchCount/o)):l.x=t.dispatchCount,r.dispatchWorkgroups(l.x,l.y,l.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.prepareTimestampBuffer(e,t.cmdEncoderGPU),this.device.queue.submit([t.cmdEncoderGPU.finish()])}draw(e,t){const{object:n,geometry:i,context:r,pipeline:s}=e,o=e.getBindings(),a=this.get(r),l=this.get(s).pipeline,c=a.currentSets,u=a.currentPass;c.pipeline!==l&&(u.setPipeline(l),c.pipeline=l);for(let g=0,v=o.length;g<v;g++){const e=o[g],t=this.get(e);u.setBindGroup(e.index,t.group)}const h=e.getIndex(),d=null!==h;if(!0===d&&c.index!==h){const e=this.get(h).buffer,t=h.array instanceof Uint16Array?sQ:oQ;u.setIndexBuffer(e,t),c.index=h}const p=e.getVertexBuffers();for(let g=0,v=p.length;g<v;g++){const e=p[g];if(c.attributes[g]!==e){const t=this.get(e).buffer;u.setVertexBuffer(g,t),c.attributes[g]=e}}if(void 0!==a.occlusionQuerySet){const e=a.lastOcclusionObject;e!==n&&(null!==e&&!0===e.occlusionTest&&(u.endOcclusionQuery(),a.occlusionQueryIndex++),!0===n.occlusionTest&&(u.beginOcclusionQuery(a.occlusionQueryIndex),a.occlusionQueryObjects[a.occlusionQueryIndex]=n),a.lastOcclusionObject=n)}const A=e.drawRange,f=A.start,m=this.getInstanceCount(e);if(0!==m)if(!0===n.isBatchedMesh){const e=n._multiDrawStarts,t=n._multiDrawCounts,i=n._multiDrawCount,r=n._multiDrawInstances,s=d?h.array.BYTES_PER_ELEMENT:1;for(let n=0;n<i;n++){const i=r?r[n]:1,o=i>1?0:n;u.drawIndexed(t[n],i,e[n]/s,0,o)}}else if(!0===d){const e=A.count!==1/0?A.count:h.count;u.drawIndexed(e,m,f,0,0),t.update(n,e,m)}else{const e=i.attributes.position,r=A.count!==1/0?A.count:e.count;u.draw(r,m,f,0),t.update(n,r,m)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:i}=e,r=this.utils,s=r.getSampleCountRenderContext(e.context),o=r.getCurrentColorSpace(e.context),a=r.getCurrentColorFormat(e.context),l=r.getCurrentDepthStencilFormat(e.context),c=r.getPrimitiveTopology(n,i);let u=!1;return t.material===i&&t.materialVersion===i.version&&t.transparent===i.transparent&&t.blending===i.blending&&t.premultipliedAlpha===i.premultipliedAlpha&&t.blendSrc===i.blendSrc&&t.blendDst===i.blendDst&&t.blendEquation===i.blendEquation&&t.blendSrcAlpha===i.blendSrcAlpha&&t.blendDstAlpha===i.blendDstAlpha&&t.blendEquationAlpha===i.blendEquationAlpha&&t.colorWrite===i.colorWrite&&t.depthWrite===i.depthWrite&&t.depthTest===i.depthTest&&t.depthFunc===i.depthFunc&&t.stencilWrite===i.stencilWrite&&t.stencilFunc===i.stencilFunc&&t.stencilFail===i.stencilFail&&t.stencilZFail===i.stencilZFail&&t.stencilZPass===i.stencilZPass&&t.stencilFuncMask===i.stencilFuncMask&&t.stencilWriteMask===i.stencilWriteMask&&t.side===i.side&&t.alphaToCoverage===i.alphaToCoverage&&t.sampleCount===s&&t.colorSpace===o&&t.colorFormat===a&&t.depthStencilFormat===l&&t.primitiveTopology===c&&t.clippingContextCacheKey===e.clippingContext.cacheKey||(t.material=i,t.materialVersion=i.version,t.transparent=i.transparent,t.blending=i.blending,t.premultipliedAlpha=i.premultipliedAlpha,t.blendSrc=i.blendSrc,t.blendDst=i.blendDst,t.blendEquation=i.blendEquation,t.blendSrcAlpha=i.blendSrcAlpha,t.blendDstAlpha=i.blendDstAlpha,t.blendEquationAlpha=i.blendEquationAlpha,t.colorWrite=i.colorWrite,t.depthWrite=i.depthWrite,t.depthTest=i.depthTest,t.depthFunc=i.depthFunc,t.stencilWrite=i.stencilWrite,t.stencilFunc=i.stencilFunc,t.stencilFail=i.stencilFail,t.stencilZFail=i.stencilZFail,t.stencilZPass=i.stencilZPass,t.stencilFuncMask=i.stencilFuncMask,t.stencilWriteMask=i.stencilWriteMask,t.side=i.side,t.alphaToCoverage=i.alphaToCoverage,t.sampleCount=s,t.colorSpace=o,t.colorFormat=a,t.depthStencilFormat=l,t.primitiveTopology=c,t.clippingContextCacheKey=e.clippingContext.cacheKey,u=!0),u}getRenderCacheKey(e){const{object:t,material:n}=e,i=this.utils,r=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,i.getSampleCountRenderContext(r),i.getCurrentColorSpace(r),i.getCurrentColorFormat(r),i.getCurrentDepthStencilFormat(r),i.getPrimitiveTopology(t,n),e.clippingContext.cacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,n,i,r){return this.textureUtils.copyTextureToBuffer(e,t,n,i,r)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=this.get(e);if(!n.timeStampQuerySet){const e=this.device.createQuerySet({type:"timestamp",count:2}),i={querySet:e,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1};Object.assign(t,{timestampWrites:i}),n.timeStampQuerySet=e}}prepareTimestampBuffer(e,t){if(!this.trackTimestamp)return;const n=this.get(e),i=2*BigInt64Array.BYTES_PER_ELEMENT;void 0===n.currentTimestampQueryBuffers&&(n.currentTimestampQueryBuffers={resolveBuffer:this.device.createBuffer({label:"timestamp resolve buffer",size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),resultBuffer:this.device.createBuffer({label:"timestamp result buffer",size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),isMappingPending:!1});const{resolveBuffer:r,resultBuffer:s,isMappingPending:o}=n.currentTimestampQueryBuffers;!0!==o&&(t.resolveQuerySet(n.timeStampQuerySet,0,2,r,0),t.copyBufferToBuffer(r,0,s,0,i))}async resolveTimestampAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"render";if(!this.trackTimestamp)return;const n=this.get(e);if(void 0===n.currentTimestampQueryBuffers)return;const{resultBuffer:i,isMappingPending:r}=n.currentTimestampQueryBuffers;!0!==r&&(n.currentTimestampQueryBuffers.isMappingPending=!0,i.mapAsync(GPUMapMode.READ).then((()=>{const e=new BigUint64Array(i.getMappedRange()),r=Number(e[1]-e[0])/1e6;this.renderer.info.updateTimestamp(t,r),i.unmap(),n.currentTimestampQueryBuffers.isMappingPending=!1})))}createNodeBuilder(e,t){return new D$(e,t)}createProgram(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),i=n.currentPass.finish();this.get(t).bundleGPU=i,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e){this.bindingUtils.createBindings(e)}updateBindings(e){this.bindingUtils.createBindings(e)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=0,o=0,a=0,l=0,c=e.image.width,u=e.image.height;null!==n&&(a=n.x,l=n.y,c=n.width,u=n.height),null!==i&&(s=i.x,o=i.y);const h=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),d=this.get(e).texture,p=this.get(t).texture;h.copyTextureToTexture({texture:d,mipLevel:r,origin:{x:a,y:l,z:0}},{texture:p,mipLevel:r,origin:{x:s,y:o,z:0}},[c,u]),this.device.queue.submit([h.finish()])}copyFramebufferToTexture(e,t){const n=this.get(t),{encoder:i,descriptor:r}=n;let s=null;s=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format===o.format){n.currentPass.end(),i.copyTextureToTexture({texture:s,origin:{x:0,y:0,z:0}},{texture:o},[e.image.width,e.image.height]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e);for(let e=0;e<r.colorAttachments.length;e++)r.colorAttachments[e].loadOp=$Y;t.depth&&(r.depthStencilAttachment.depthLoadOp=$Y),t.stencil&&(r.depthStencilAttachment.stencilLoadOp=$Y),n.currentPass=i.beginRenderPass(r),n.currentSets={attributes:{},pipeline:null,index:null}}else console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,o.format)}}class q$ extends wJ{constructor(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.forceWebGL?e=c$:(e=z$,t.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new c$(t)));super(new e(t),t),this.isWebGPURenderer=!0}}const V$=fW.createMaterialFromType;fW.createMaterialFromType=function(e){const t=function(e){const t=tG.get(e);if(void 0!==t)return new t}(e);return void 0!==t?t:V$.call(this,e)};"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:pP}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=pP);const G$={type:"change"},j$={type:"start"},H$={type:"end"},W$=1e-6,X$=-1,Y$=0,Q$=1,K$=2,Z$=3,J$=4,$$=new Hc,e0=new Hc,t0=new yu,n0=new yu,i0=new yu,r0=new vu,s0=new yu,o0=new yu,a0=new yu,l0=new yu;class c0 extends ev{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,t),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:ba.ROTATE,MIDDLE:ba.DOLLY,RIGHT:ba.PAN},this.state=X$,this.keyState=X$,this.target=new yu,this._lastPosition=new yu,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new yu,this._movePrev=new Hc,this._moveCurr=new Hc,this._lastAxis=new yu,this._zoomStart=new Hc,this._zoomEnd=new Hc,this._panStart=new Hc,this._panEnd=new Hc,this._pointers=[],this._pointerPositions={},this._onPointerMove=h0.bind(this),this._onPointerDown=u0.bind(this),this._onPointerUp=d0.bind(this),this._onPointerCancel=p0.bind(this),this._onContextMenu=b0.bind(this),this._onMouseWheel=y0.bind(this),this._onKeyDown=f0.bind(this),this._onKeyUp=A0.bind(this),this._onTouchStart=x0.bind(this),this._onTouchMove=_0.bind(this),this._onTouchEnd=w0.bind(this),this._onMouseDown=m0.bind(this),this._onMouseMove=g0.bind(this),this._onMouseUp=v0.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,null!==t&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>W$&&(this.dispatchEvent(G$),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>W$||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(G$),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=X$,this.keyState=X$,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(G$),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(e0.copy(this._panEnd).sub(this._panStart),e0.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;e0.x*=e,e0.y*=t}e0.multiplyScalar(this._eye.length()*this.panSpeed),n0.copy(this._eye).cross(this.object.up).setLength(e0.x),n0.add(t0.copy(this.object.up).setLength(e0.y)),this.object.position.add(n0),this.target.add(n0),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(e0.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){l0.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=l0.length();e?(this._eye.copy(this.object.position).sub(this.target),s0.copy(this._eye).normalize(),o0.copy(this.object.up).normalize(),a0.crossVectors(o0,s0).normalize(),o0.setLength(this._moveCurr.y-this._movePrev.y),a0.setLength(this._moveCurr.x-this._movePrev.x),l0.copy(o0.add(a0)),i0.crossVectors(l0,this._eye).normalize(),e*=this.rotateSpeed,r0.setFromAxisAngle(i0,e),this._eye.applyQuaternion(r0),this.object.up.applyQuaternion(r0),this._lastAxis.copy(i0),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),r0.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(r0),this.object.up.applyQuaternion(r0)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===J$?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=jc.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,1!==e&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=jc.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return $$.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),$$}_getMouseOnCircle(e,t){return $$.set((e-.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(this.screen.height+2*(this.screen.top-t))/this.screen.width),$$}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId)return void this._pointers.splice(t,1)}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Hc,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function u0(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e))}function h0(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function d0(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchEnd(e):this._onMouseUp(),this._removePointer(e),0===this._pointers.length&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function p0(e){this._removePointer(e)}function A0(){!1!==this.enabled&&(this.keyState=X$,window.addEventListener("keydown",this._onKeyDown))}function f0(e){!1!==this.enabled&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===X$&&(e.code!==this.keys[Y$]||this.noRotate?e.code!==this.keys[Q$]||this.noZoom?e.code!==this.keys[K$]||this.noPan||(this.keyState=K$):this.keyState=Q$:this.keyState=Y$))}function m0(e){if(this.state===X$)switch(e.button){case this.mouseButtons.LEFT:this.state=Y$;break;case this.mouseButtons.MIDDLE:this.state=Q$;break;case this.mouseButtons.RIGHT:this.state=K$}const t=this.keyState!==X$?this.keyState:this.state;t!==Y$||this.noRotate?t!==Q$||this.noZoom?t!==K$||this.noPan||(this._panStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr)),this.dispatchEvent(j$)}function g0(e){const t=this.keyState!==X$?this.keyState:this.state;t!==Y$||this.noRotate?t!==Q$||this.noZoom?t!==K$||this.noPan||this._panEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):this._zoomEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)))}function v0(){this.state=X$,this.dispatchEvent(H$)}function y0(e){if(!1!==this.enabled&&!0!==this.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:this._zoomStart.y-=.025*e.deltaY;break;case 1:this._zoomStart.y-=.01*e.deltaY;break;default:this._zoomStart.y-=25e-5*e.deltaY}this.dispatchEvent(j$),this.dispatchEvent(H$)}}function b0(e){!1!==this.enabled&&e.preventDefault()}function x0(e){if(this._trackPointer(e),1===this._pointers.length)this.state=Z$,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);else{this.state=J$;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,i=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,i)),this._panEnd.copy(this._panStart)}this.dispatchEvent(j$)}function _0(e){if(this._trackPointer(e),1===this._pointers.length)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY));else{const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,i=e.pageY-t.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+i*i);const r=(e.pageX+t.x)/2,s=(e.pageY+t.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,s))}}function w0(e){switch(this._pointers.length){case 0:this.state=X$;break;case 1:this.state=Z$,this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=J$;for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId!==e.pointerId){const e=this._pointerPositions[this._pointers[t].pointerId];this._moveCurr.copy(this._getMouseOnCircle(e.x,e.y)),this._movePrev.copy(this._moveCurr);break}}this.dispatchEvent(H$)}const S0={type:"change"},T0={type:"start"},M0={type:"end"},E0=new Yu,C0=new zd,R0=Math.cos(70*jc.DEG2RAD),P0=new yu,N0=2*Math.PI,D0=-1,L0=0,I0=1,O0=2,k0=3,B0=4,F0=5,U0=6,z0=1e-6;class q0 extends ev{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.state=D0,this.enabled=!0,this.target=new yu,this.cursor=new yu,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ba.ROTATE,MIDDLE:ba.DOLLY,RIGHT:ba.PAN},this.touches={ONE:xa,TWO:wa},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new yu,this._lastQuaternion=new vu,this._lastTargetPosition=new yu,this._quat=(new vu).setFromUnitVectors(e.up,new yu(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Kg,this._sphericalDelta=new Kg,this._scale=1,this._panOffset=new yu,this._rotateStart=new Hc,this._rotateEnd=new Hc,this._rotateDelta=new Hc,this._panStart=new Hc,this._panEnd=new Hc,this._panDelta=new Hc,this._dollyStart=new Hc,this._dollyEnd=new Hc,this._dollyDelta=new Hc,this._dollyDirection=new yu,this._mouse=new Hc,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=G0.bind(this),this._onPointerDown=V0.bind(this),this._onPointerUp=j0.bind(this),this._onContextMenu=Z0.bind(this),this._onMouseWheel=X0.bind(this),this._onKeyDown=Y0.bind(this),this._onTouchStart=Q0.bind(this),this._onTouchMove=K0.bind(this),this._onMouseDown=H0.bind(this),this._onMouseMove=W0.bind(this),this._interceptControlDown=J0.bind(this),this._interceptControlUp=$0.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1});this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents();this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(S0),this.update(),this.state=D0}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.object.position;P0.copy(t).sub(this.target),P0.applyQuaternion(this._quat),this._spherical.setFromVector3(P0),this.autoRotate&&this.state===D0&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,i=this.maxAzimuthAngle;isFinite(n)&&isFinite(i)&&(n<-Math.PI?n+=N0:n>Math.PI&&(n-=N0),i<-Math.PI?i+=N0:i>Math.PI&&(i-=N0),this._spherical.theta=n<=i?Math.max(n,Math.min(i,this._spherical.theta)):this._spherical.theta>(n+i)/2?Math.max(n,this._spherical.theta):Math.min(i,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=e!=this._spherical.radius}if(P0.setFromSpherical(this._spherical),P0.applyQuaternion(this._quatInverse),t.copy(this.target).add(P0),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){const t=P0.length();e=this._clampDistance(t*this._scale);const n=t-e;this.object.position.addScaledVector(this._dollyDirection,n),this.object.updateMatrixWorld(),r=!!n}else if(this.object.isOrthographicCamera){const t=new yu(this._mouse.x,this._mouse.y,0);t.unproject(this.object);const n=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=n!==this.object.zoom;const i=new yu(this._mouse.x,this._mouse.y,0);i.unproject(this.object),this.object.position.sub(i).add(t),this.object.updateMatrixWorld(),e=P0.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(E0.origin.copy(this.object.position),E0.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(E0.direction))<R0?this.object.lookAt(this.target):(C0.setFromNormalAndCoplanarPoint(this.object.up,this.target),E0.intersectPlane(C0,this.target))))}else if(this.object.isOrthographicCamera){const e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,!!(r||this._lastPosition.distanceToSquared(this.object.position)>z0||8*(1-this._lastQuaternion.dot(this.object.quaternion))>z0||this._lastTargetPosition.distanceToSquared(this.target)>z0)&&(this.dispatchEvent(S0),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?N0/60*this.autoRotateSpeed*e:N0/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){P0.setFromMatrixColumn(t,0),P0.multiplyScalar(-e),this._panOffset.add(P0)}_panUp(e,t){!0===this.screenSpacePanning?P0.setFromMatrixColumn(t,1):(P0.setFromMatrixColumn(t,0),P0.crossVectors(this.object.up,P0)),P0.multiplyScalar(e),this._panOffset.add(P0)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const i=this.object.position;P0.copy(i).sub(this.target);let r=P0.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*r/n.clientHeight,this.object.matrix),this._panUp(2*t*r/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),i=e-n.left,r=t-n.top,s=n.width,o=n.height;this._mouse.x=i/s*2-1,this._mouse.y=-r/o*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(N0*this._rotateDelta.x/t.clientHeight),this._rotateUp(N0*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(N0*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-N0*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(N0*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-N0*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateStart.set(n,i)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panStart.set(n,i)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,i=e.pageY-t.y,r=Math.sqrt(n*n+i*i);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateEnd.set(n,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(N0*this._rotateDelta.x/t.clientHeight),this._rotateUp(N0*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panEnd.set(n,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,i=e.pageY-t.y,r=Math.sqrt(n*n+i*i);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const s=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._updateZoomParameters(s,o)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Hc,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function V0(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function G0(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function j0(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(M0),this.state=D0;break;case 1:const t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y})}}function H0(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case ba.DOLLY:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=I0;break;case ba.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=O0}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=L0}break;case ba.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=L0}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=O0}break;default:this.state=D0}this.state!==D0&&this.dispatchEvent(T0)}function W0(e){switch(this.state){case L0:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case I0:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case O0:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function X0(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===D0&&(e.preventDefault(),this.dispatchEvent(T0),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(M0))}function Y0(e){!1!==this.enabled&&!1!==this.enablePan&&this._handleKeyDown(e)}function Q0(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case xa:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=k0;break;case _a:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=B0;break;default:this.state=D0}break;case 2:switch(this.touches.TWO){case wa:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=F0;break;case Sa:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=U0;break;default:this.state=D0}break;default:this.state=D0}this.state!==D0&&this.dispatchEvent(T0)}function K0(e){switch(this._trackPointer(e),this.state){case k0:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case B0:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case F0:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case U0:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=D0}}function Z0(e){!1!==this.enabled&&e.preventDefault()}function J0(e){if("Control"===e.key){this._controlActive=!0;this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}function $0(e){if("Control"===e.key){this._controlActive=!1;this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}const e1={type:"change"},t1=1e-6,n1=new vu;class i1 extends ev{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new yu(0,0,0),this._rotationVector=new yu(0,0,0),this._lastQuaternion=new vu,this._lastPosition=new yu,this._status=0,this._onKeyDown=r1.bind(this),this._onKeyUp=s1.bind(this),this._onPointerMove=a1.bind(this),this._onPointerDown=o1.bind(this),this._onPointerUp=l1.bind(this),this._onPointerCancel=c1.bind(this),this._onContextMenu=u1.bind(this),null!==t&&this.connect()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(!1===this.enabled)return;const t=this.object,n=e*this.movementSpeed,i=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),n1.set(this._rotationVector.x*i,this._rotationVector.y*i,this._rotationVector.z*i,1).normalize(),t.quaternion.multiply(n1),(this._lastPosition.distanceToSquared(t.position)>t1||8*(1-this._lastQuaternion.dot(t.quaternion))>t1)&&(this.dispatchEvent(e1),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function r1(e){if(!e.altKey&&!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1}this._updateMovementVector(),this._updateRotationVector()}}function s1(e){if(!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0}this._updateMovementVector(),this._updateRotationVector()}}function o1(e){if(!1!==this.enabled)if(this.dragToLook)this._status++;else{switch(e.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1}this._updateMovementVector()}}function a1(e){if(!1!==this.enabled&&(!this.dragToLook||this._status>0)){const t=this._getContainerDimensions(),n=t.size[0]/2,i=t.size[1]/2;this._moveState.yawLeft=-(e.pageX-t.offset[0]-n)/n,this._moveState.pitchDown=(e.pageY-t.offset[1]-i)/i,this._updateRotationVector()}}function l1(e){if(!1!==this.enabled){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(e.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0}this._updateMovementVector()}this._updateRotationVector()}}function c1(){!1!==this.enabled&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function u1(e){!1!==this.enabled&&e.preventDefault()}const h1={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class d1{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const p1=new sp(-1,1,1,-1,0,1);const A1=new class extends nd{constructor(){super(),this.setAttribute("position",new Yh([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Yh([0,2,0,0,2,0],2))}};class f1{constructor(e){this._mesh=new bd(A1,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,p1)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class m1 extends d1{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Ed?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Md.clone(e.uniforms),this.material=new Ed({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new f1(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class g1 extends d1{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const i=e.getContext(),r=e.state;let s,o;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0),this.inverse?(s=0,o=1):(s=1,o=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),r.buffers.stencil.setFunc(i.ALWAYS,s,4294967295),r.buffers.stencil.setClear(o),r.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.color.setMask(!0),r.buffers.depth.setMask(!0),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(i.EQUAL,1,4294967295),r.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),r.buffers.stencil.setLocked(!0)}}class v1 extends d1{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class y1{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const n=e.getSize(new Hc);this._width=n.width,this._height=n.height,(t=new fu(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:pl})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new m1(h1),this.copyPass.material.blending=0,this.clock=new Bg}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let i=0,r=this.passes.length;i<r;i++){const t=this.passes[i];if(!1!==t.enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==g1&&(t instanceof g1?n=!0:t instanceof v1&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Hc);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(n,i),this.renderTarget2.setSize(n,i);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(n,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class b1 extends d1{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=r,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Fh}render(e,t,n){const i=e.autoClear;let r,s;e.autoClear=!1,null!==this.overrideMaterial&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(r=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(r),null!==this.overrideMaterial&&(this.scene.overrideMaterial=s),e.autoClear=i}}function x1(){return x1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},x1.apply(null,arguments)}function _1(e,t){return _1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_1(e,t)}function w1(e){return w1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w1(e)}function S1(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S1=function(){return!!e})()}function T1(e){var t="function"==typeof Map?new Map:void 0;return T1=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(S1())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(e.bind.apply(e,i));return n&&_1(r,n.prototype),r}(e,arguments,w1(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_1(n,e)},T1(e)}var M1=function(e){function t(t){return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this)}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_1(e,t)}(t,e),t}(T1(Error));function E1(e,t){return e.substr(-t.length)===t}var C1=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function R1(e){return"string"!==typeof e?e:e.match(C1)?parseFloat(e):e}var P1=function(e){return function(t,n){void 0===n&&(n="16px");var i=t,r=n;if("string"===typeof t){if(!E1(t,"px"))throw new M1(69,e,t);i=R1(t)}if("string"===typeof n){if(!E1(n,"px"))throw new M1(70,e,n);r=R1(n)}if("string"===typeof i)throw new M1(71,t,e);if("string"===typeof r)throw new M1(72,n,e);return""+i/r+e}};P1("em");P1("rem");function N1(e){return Math.round(255*e)}function D1(e,t,n){return N1(e)+","+N1(t)+","+N1(n)}function L1(e,t,n,i){if(void 0===i&&(i=D1),0===t)return i(n,n,n);var r=(e%360+360)%360/60,s=(1-Math.abs(2*n-1))*t,o=s*(1-Math.abs(r%2-1)),a=0,l=0,c=0;r>=0&&r<1?(a=s,l=o):r>=1&&r<2?(a=o,l=s):r>=2&&r<3?(l=s,c=o):r>=3&&r<4?(l=o,c=s):r>=4&&r<5?(a=o,c=s):r>=5&&r<6&&(a=s,c=o);var u=n-s/2;return i(a+u,l+u,c+u)}var I1={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var O1=/^#[a-fA-F0-9]{6}$/,k1=/^#[a-fA-F0-9]{8}$/,B1=/^#[a-fA-F0-9]{3}$/,F1=/^#[a-fA-F0-9]{4}$/,U1=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,z1=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,q1=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,V1=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function G1(e){if("string"!==typeof e)throw new M1(3);var t=function(e){if("string"!==typeof e)return e;var t=e.toLowerCase();return I1[t]?"#"+I1[t]:e}(e);if(t.match(O1))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(k1)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(B1))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(F1)){var i=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:i}}var r=U1.exec(t);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=z1.exec(t.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=q1.exec(t);if(o){var a="rgb("+L1(parseInt(""+o[1],10),parseInt(""+o[2],10)/100,parseInt(""+o[3],10)/100)+")",l=U1.exec(a);if(!l)throw new M1(4,t,a);return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var c=V1.exec(t.substring(0,50));if(c){var u="rgb("+L1(parseInt(""+c[1],10),parseInt(""+c[2],10)/100,parseInt(""+c[3],10)/100)+")",h=U1.exec(u);if(!h)throw new M1(4,t,u);return{red:parseInt(""+h[1],10),green:parseInt(""+h[2],10),blue:parseInt(""+h[3],10),alpha:parseFloat(""+c[4])>1?parseFloat(""+c[4])/100:parseFloat(""+c[4])}}throw new M1(5)}function j1(e){return function(e){var t,n=e.red/255,i=e.green/255,r=e.blue/255,s=Math.max(n,i,r),o=Math.min(n,i,r),a=(s+o)/2;if(s===o)return void 0!==e.alpha?{hue:0,saturation:0,lightness:a,alpha:e.alpha}:{hue:0,saturation:0,lightness:a};var l=s-o,c=a>.5?l/(2-s-o):l/(s+o);switch(s){case n:t=(i-r)/l+(i<r?6:0);break;case i:t=(r-n)/l+2;break;default:t=(n-i)/l+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:c,lightness:a,alpha:e.alpha}:{hue:t,saturation:c,lightness:a}}(G1(e))}var H1=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function W1(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function X1(e){return W1(Math.round(255*e))}function Y1(e,t,n){return H1("#"+X1(e)+X1(t)+X1(n))}function Q1(e,t,n){return L1(e,t,n,Y1)}function K1(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return Q1(e,t,n);if("object"===typeof e&&void 0===t&&void 0===n)return Q1(e.hue,e.saturation,e.lightness);throw new M1(1)}function Z1(e,t,n,i){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n&&"number"===typeof i)return i>=1?Q1(e,t,n):"rgba("+L1(e,t,n)+","+i+")";if("object"===typeof e&&void 0===t&&void 0===n&&void 0===i)return e.alpha>=1?Q1(e.hue,e.saturation,e.lightness):"rgba("+L1(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new M1(2)}function J1(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return H1("#"+W1(e)+W1(t)+W1(n));if("object"===typeof e&&void 0===t&&void 0===n)return H1("#"+W1(e.red)+W1(e.green)+W1(e.blue));throw new M1(6)}function $1(e,t,n,i){if("string"===typeof e&&"number"===typeof t){var r=G1(e);return"rgba("+r.red+","+r.green+","+r.blue+","+t+")"}if("number"===typeof e&&"number"===typeof t&&"number"===typeof n&&"number"===typeof i)return i>=1?J1(e,t,n):"rgba("+e+","+t+","+n+","+i+")";if("object"===typeof e&&void 0===t&&void 0===n&&void 0===i)return e.alpha>=1?J1(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new M1(7)}function e2(e){if("object"!==typeof e)throw new M1(8);if(function(e){return"number"===typeof e.red&&"number"===typeof e.green&&"number"===typeof e.blue&&"number"===typeof e.alpha}(e))return $1(e);if(function(e){return"number"===typeof e.red&&"number"===typeof e.green&&"number"===typeof e.blue&&("number"!==typeof e.alpha||"undefined"===typeof e.alpha)}(e))return J1(e);if(function(e){return"number"===typeof e.hue&&"number"===typeof e.saturation&&"number"===typeof e.lightness&&"number"===typeof e.alpha}(e))return Z1(e);if(function(e){return"number"===typeof e.hue&&"number"===typeof e.saturation&&"number"===typeof e.lightness&&("number"!==typeof e.alpha||"undefined"===typeof e.alpha)}(e))return K1(e);throw new M1(8)}function t2(e,t,n){return function(){var i=n.concat(Array.prototype.slice.call(arguments));return i.length>=t?e.apply(this,i):t2(e,t,i)}}function n2(e){return t2(e,e.length,[])}n2((function(e,t){if("transparent"===t)return t;var n=j1(t);return e2(x1({},n,{hue:n.hue+parseFloat(e)}))}));function i2(e,t,n){return Math.max(e,Math.min(t,n))}n2((function(e,t){if("transparent"===t)return t;var n=j1(t);return e2(x1({},n,{lightness:i2(0,1,n.lightness-parseFloat(e))}))}));n2((function(e,t){if("transparent"===t)return t;var n=j1(t);return e2(x1({},n,{saturation:i2(0,1,n.saturation-parseFloat(e))}))}));n2((function(e,t){if("transparent"===t)return t;var n=j1(t);return e2(x1({},n,{lightness:i2(0,1,n.lightness+parseFloat(e))}))}));var r2=n2((function(e,t,n){if("transparent"===t)return n;if("transparent"===n)return t;if(0===e)return n;var i=G1(t),r=x1({},i,{alpha:"number"===typeof i.alpha?i.alpha:1}),s=G1(n),o=x1({},s,{alpha:"number"===typeof s.alpha?s.alpha:1}),a=r.alpha-o.alpha,l=2*parseFloat(e)-1,c=((l*a===-1?l:l+a)/(1+l*a)+1)/2,u=1-c;return $1({red:Math.floor(r.red*c+o.red*u),green:Math.floor(r.green*c+o.green*u),blue:Math.floor(r.blue*c+o.blue*u),alpha:r.alpha*parseFloat(e)+o.alpha*(1-parseFloat(e))})})),s2=r2;var o2=n2((function(e,t){if("transparent"===t)return t;var n=G1(t);return $1(x1({},n,{alpha:i2(0,1,(100*("number"===typeof n.alpha?n.alpha:1)+100*parseFloat(e))/100)}))})),a2=o2;n2((function(e,t){if("transparent"===t)return t;var n=j1(t);return e2(x1({},n,{saturation:i2(0,1,n.saturation+parseFloat(e))}))}));n2((function(e,t){return"transparent"===t?t:e2(x1({},j1(t),{hue:parseFloat(e)}))}));n2((function(e,t){return"transparent"===t?t:e2(x1({},j1(t),{lightness:parseFloat(e)}))}));n2((function(e,t){return"transparent"===t?t:e2(x1({},j1(t),{saturation:parseFloat(e)}))}));n2((function(e,t){return"transparent"===t?t:s2(parseFloat(e),"rgb(0, 0, 0)",t)}));n2((function(e,t){return"transparent"===t?t:s2(parseFloat(e),"rgb(255, 255, 255)",t)}));n2((function(e,t){if("transparent"===t)return t;var n=G1(t);return $1(x1({},n,{alpha:i2(0,1,+(100*("number"===typeof n.alpha?n.alpha:1)-100*parseFloat(e)).toFixed(2)/100)}))}));function l2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function c2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u2(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t);else for(;!(l=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||d2(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h2(e){return function(e){if(Array.isArray(e))return l2(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d2(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d2(e,t){if(e){if("string"==typeof e)return l2(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l2(e,t):void 0}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!==typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".scene-nav-info {\n  bottom: 5px;\n  width: 100%;\n  text-align: center;\n  color: slategrey;\n  opacity: 0.7;\n  font-size: 10px;\n}\n\n.scene-tooltip {\n  top: 0;\n  color: lavender;\n  font-size: 15px;\n}\n\n.scene-nav-info, .scene-tooltip {\n  position: absolute;\n  font-family: sans-serif;\n  pointer-events: none;\n  user-select: none;\n}\n\n.scene-container canvas:focus {\n  outline: none;\n}");var p2=window.THREE?window.THREE:{WebGLRenderer:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=Kc(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:o=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1}=e;let h;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=n.getContextAttributes().alpha}else h=s;const d=new Uint32Array(4),p=new Int32Array(4);let A=null,f=null;const m=[],g=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=dc,this.toneMapping=0,this.toneMappingExposure=1;const v=this;let y=!1,b=0,x=0,_=null,w=-1,S=null;const T=new pu,M=new pu;let E=null;const C=new Fh(0);let R=0,P=t.width,N=t.height,D=1,L=null,I=null;const O=new pu(0,0,P,N),k=new pu(0,0,P,N);let B=!1;const F=new Gd;let U=!1,z=!1;const q=new Qu,V=new yu,G=new pu,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let H=!1;function W(){return null===_?D:1}let X,Y,Q,K,Z,J,$,ee,te,ne,ie,re,se,oe,ae,le,ce,ue,he,de,pe,Ae,fe,me,ge=n;function ve(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(ya)),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",_e,!1),t.addEventListener("webglcontextcreationerror",we,!1),null===ge){const t="webgl2";if(ge=ve(t,e),null===ge)throw ve(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Fe){throw console.error("THREE.WebGLRenderer: "+Fe.message),Fe}function ye(){X=new wp(ge),X.init(),Ae=new _f(ge,X),Y=new np(ge,X,e,Ae),Q=new yf(ge),K=new Mp(ge),Z=new sf,J=new xf(ge,X,Q,Z,Y,Ae,K),$=new rp(v),ee=new _p(v),te=new Hd(ge),fe=new ep(ge,te),ne=new Sp(ge,te,K,fe),ie=new Cp(ge,ne,te,K),he=new Ep(ge,Y,J),le=new ip(Z),re=new rf(v,$,ee,X,Y,fe,le),se=new Nf(v,Z),oe=new cf,ae=new ff(X),ue=new $d(v,$,ee,Q,ie,h,a),ce=new vf(v,ie,Y),me=new Df(ge,K,Y,Q),de=new tp(ge,X,K),pe=new Tp(ge,X,K),K.programs=re.programs,v.capabilities=Y,v.extensions=X,v.properties=Z,v.renderLists=oe,v.shadowMap=ce,v.state=Q,v.info=K}ye();const be=new Cf(v,ge);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function _e(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=K.autoReset,t=ce.enabled,n=ce.autoUpdate,i=ce.needsUpdate,r=ce.type;ye(),K.autoReset=e,ce.enabled=t,ce.autoUpdate=n,ce.needsUpdate=i,ce.type=r}function we(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Se(e){const t=e.target;t.removeEventListener("dispose",Se),function(e){(function(e){const t=Z.get(e).programs;void 0!==t&&(t.forEach((function(e){re.releaseProgram(e)})),e.isShaderMaterial&&re.releaseShaderCache(e))})(e),Z.remove(e)}(t)}function Te(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Oe(e,t,n),e.side=0,e.needsUpdate=!0,Oe(e,t,n),e.side=2):Oe(e,t,n)}this.xr=be,this.getContext=function(){return ge},this.getContextAttributes=function(){return ge.getContextAttributes()},this.forceContextLoss=function(){const e=X.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=X.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(e){void 0!==e&&(D=e,this.setSize(P,N,!1))},this.getSize=function(e){return e.set(P,N)},this.setSize=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(P=e,N=n,t.width=Math.floor(e*D),t.height=Math.floor(n*D),!0===i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(P*D,N*D).floor()},this.setDrawingBufferSize=function(e,n,i){P=e,N=n,D=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(T)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,i){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,i),Q.viewport(T.copy(O).multiplyScalar(D).round())},this.getScissor=function(e){return e.copy(k)},this.setScissor=function(e,t,n,i){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,i),Q.scissor(M.copy(k).multiplyScalar(D).round())},this.getScissorTest=function(){return B},this.setScissorTest=function(e){Q.setScissorTest(B=e)},this.setOpaqueSort=function(e){L=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(e){return e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==_){const t=_.texture.format;e=t===Sl||t===wl||t===_l}if(e){const e=_.texture.type,t=e===ol||e===hl||e===cl||e===ml||e===Al||e===fl,n=ue.getClearColor(),i=ue.getClearAlpha(),r=n.r,s=n.g,o=n.b;t?(d[0]=r,d[1]=s,d[2]=o,d[3]=i,ge.clearBufferuiv(ge.COLOR,0,d)):(p[0]=r,p[1]=s,p[2]=o,p[3]=i,ge.clearBufferiv(ge.COLOR,0,p))}else n|=ge.COLOR_BUFFER_BIT}e&&(n|=ge.DEPTH_BUFFER_BIT),t&&(n|=ge.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ge.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",_e,!1),t.removeEventListener("webglcontextcreationerror",we,!1),oe.dispose(),ae.dispose(),Z.dispose(),$.dispose(),ee.dispose(),ie.dispose(),fe.dispose(),me.dispose(),re.dispose(),be.dispose(),be.removeEventListener("sessionstart",Ee),be.removeEventListener("sessionend",Ce),Re.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=j);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=function(e,t,n,i,r){!0!==t.isScene&&(t=j);J.resetTextureUnits();const s=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===_?v.outputColorSpace:!0===_.isXRRenderTarget?_.texture.colorSpace:pc,l=(i.isMeshStandardMaterial?ee:$).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let A=0;i.toneMapped&&(null!==_&&!0!==_.isXRRenderTarget||(A=v.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,y=Z.get(i),b=f.state.lights;if(!0===U&&(!0===z||e!==S)){const t=e===S&&i.id===w;le.setState(i,e,t)}let x=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==a||r.isBatchedMesh&&!1===y.batching?x=!0:r.isBatchedMesh||!0!==y.batching?r.isBatchedMesh&&!0===y.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===y.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===y.instancing?x=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?x=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===y.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===y.instancingMorph&&null!==r.morphTexture||y.envMap!==l||!0===i.fog&&y.fog!==s?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===le.numPlanes&&y.numIntersection===le.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==A||y.morphTargetsCount!==g)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,y.__version=i.version);let T=y.currentProgram;!0===x&&(T=Oe(i,t,r));let M=!1,E=!1,C=!1;const R=T.getUniforms(),P=y.uniforms;Q.useProgram(T.program)&&(M=!0,E=!0,C=!0);i.id!==w&&(w=i.id,E=!0);if(M||S!==e){R.setValue(ge,"projectionMatrix",e.projectionMatrix),R.setValue(ge,"viewMatrix",e.matrixWorldInverse);const t=R.map.cameraPosition;void 0!==t&&t.setValue(ge,V.setFromMatrixPosition(e.matrixWorld)),Y.logarithmicDepthBuffer&&R.setValue(ge,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(ge,"isOrthographic",!0===e.isOrthographicCamera),S!==e&&(S=e,E=!0,C=!0)}if(r.isSkinnedMesh){R.setOptional(ge,r,"bindMatrix"),R.setOptional(ge,r,"bindMatrixInverse");const e=r.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(ge,"boneTexture",e.boneTexture,J))}r.isBatchedMesh&&(R.setOptional(ge,r,"batchingTexture"),R.setValue(ge,"batchingTexture",r._matricesTexture,J),R.setOptional(ge,r,"batchingIdTexture"),R.setValue(ge,"batchingIdTexture",r._indirectTexture,J),R.setOptional(ge,r,"batchingColorTexture"),null!==r._colorsTexture&&R.setValue(ge,"batchingColorTexture",r._colorsTexture,J));const L=n.morphAttributes;void 0===L.position&&void 0===L.normal&&void 0===L.color||he.update(r,n,T);(E||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,R.setValue(ge,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(P.envMap.value=l,P.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==t.environment&&(P.envMapIntensity.value=t.environmentIntensity);E&&(R.setValue(ge,"toneMappingExposure",v.toneMappingExposure),y.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(P,C),s&&!0===i.fog&&se.refreshFogUniforms(P,s),se.refreshMaterialUniforms(P,i,D,N,f.state.transmissionRenderTarget[e.id]),IA.upload(ge,ke(y),P,J));i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(IA.upload(ge,ke(y),P,J),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(ge,"center",r.center);if(R.setValue(ge,"modelViewMatrix",r.modelViewMatrix),R.setValue(ge,"normalMatrix",r.normalMatrix),R.setValue(ge,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];me.update(n,T),me.bind(n,T)}}return T}(e,t,n,i,r);Q.setMaterial(i,o);let l=n.index,c=1;if(!0===i.wireframe){if(l=ne.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):void 0!==h&&null!==h&&(d=Math.max(d,0),p=Math.min(p,h.count));const A=p-d;if(A<0||A===1/0)return;let m;fe.setup(r,i,a,n,l);let g=de;if(null!==l&&(m=te.get(l),g=pe,g.setIndex(m)),r.isMesh)!0===i.wireframe?(Q.setLineWidth(i.wireframeLinewidth*W()),g.setMode(ge.LINES)):g.setMode(ge.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),Q.setLineWidth(e*W()),r.isLineSegments?g.setMode(ge.LINES):r.isLineLoop?g.setMode(ge.LINE_LOOP):g.setMode(ge.LINE_STRIP)}else r.isPoints?g.setMode(ge.POINTS):r.isSprite&&g.setMode(ge.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)g.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(X.get("WEBGL_multi_draw"))g.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const e=r._multiDrawStarts,t=r._multiDrawCounts,n=r._multiDrawCount,s=l?te.get(l).bytesPerElement:1,o=Z.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)o.setValue(ge,"_gl_DrawID",i),g.render(e[i]/s,t[i])}else if(r.isInstancedMesh)g.renderInstances(d,A,r.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);g.renderInstances(d,A,t)}else g.render(d,A)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),f=ae.get(n),f.init(t),g.push(f),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights();const i=new Set;return e.traverse((function(e){const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Te(s,n,e),i.add(s)}else Te(t,n,e),i.add(t)})),g.pop(),f=null,i},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(e,t,n);return new Promise((t=>{function n(){i.forEach((function(e){Z.get(e).currentProgram.isReady()&&i.delete(e)})),0!==i.size?setTimeout(n,10):t(e)}null!==X.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Me=null;function Ee(){Re.stop()}function Ce(){Re.start()}const Re=new jd;function Pe(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||F.intersectsSprite(e)){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(q);const t=ie.update(e),r=e.material;r.visible&&A.push(e,t,r,n,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||F.intersectsObject(e))){const t=ie.update(e),r=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),G.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),G.copy(t.boundingSphere.center)),G.applyMatrix4(e.matrixWorld).applyMatrix4(q)),Array.isArray(r)){const i=t.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&A.push(e,t,a,n,G.z,o)}}else r.visible&&A.push(e,t,r,n,G.z,null)}const r=e.children;for(let s=0,o=r.length;s<o;s++)Pe(r[s],t,n,i)}function Ne(e,t,n,i){const r=e.opaque,s=e.transmissive,o=e.transparent;f.setupLightsView(n),!0===U&&le.setGlobalState(v.clippingPlanes,n),i&&Q.viewport(T.copy(i)),r.length>0&&Le(r,t,n),s.length>0&&Le(s,t,n),o.length>0&&Le(o,t,n),Q.buffers.depth.setTest(!0),Q.buffers.depth.setMask(!0),Q.buffers.color.setMask(!0),Q.setPolygonOffset(!1)}function De(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===f.state.transmissionRenderTarget[i.id]&&(f.state.transmissionRenderTarget[i.id]=new fu(1,1,{generateMipmaps:!0,type:X.has("EXT_color_buffer_half_float")||X.has("EXT_color_buffer_float")?pl:ol,minFilter:sl,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:iu.workingColorSpace}));const s=f.state.transmissionRenderTarget[i.id],o=i.viewport||T;s.setSize(o.z,o.w);const a=v.getRenderTarget();v.setRenderTarget(s),v.getClearColor(C),R=v.getClearAlpha(),R<1&&v.setClearColor(16777215,.5),v.clear(),H&&ue.render(n);const l=v.toneMapping;v.toneMapping=0;const c=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),f.setupLightsView(i),!0===U&&le.setGlobalState(v.clippingPlanes,i),Le(e,n,i),J.updateMultisampleRenderTarget(s),J.updateRenderTargetMipmap(s),!1===X.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.object,a=s.geometry,l=s.material,c=s.group;if(2===l.side&&o.layers.test(i.layers)){const t=l.side;l.side=1,l.needsUpdate=!0,Ie(o,n,i,a,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(J.updateMultisampleRenderTarget(s),J.updateRenderTargetMipmap(s))}v.setRenderTarget(a),v.setClearColor(C,R),void 0!==c&&(i.viewport=c),v.toneMapping=l}function Le(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;o.layers.test(n.layers)&&Ie(o,t,n,a,l,c)}}function Ie(e,t,n,i,r,s){e.onBeforeRender(v,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(v,t,n,i,e,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,v.renderBufferDirect(n,t,i,r,e,s),r.side=0,r.needsUpdate=!0,v.renderBufferDirect(n,t,i,r,e,s),r.side=2):v.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(v,t,n,i,r,s)}function Oe(e,t,n){!0!==t.isScene&&(t=j);const i=Z.get(e),r=f.state.lights,s=f.state.shadowsArray,o=r.state.version,a=re.getParameters(e,r.state,s,t,n),l=re.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ee:$).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Se),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return Be(e,a),u}else a.uniforms=re.getUniforms(e),e.onBeforeCompile(a,v),u=re.acquireProgram(a,l),c.set(l,u),i.uniforms=a.uniforms;const h=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=le.uniform),Be(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotLightMatrix.value=r.state.spotLightMatrix,h.spotLightMap.value=r.state.spotLightMap,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=u,i.uniformsList=null,u}function ke(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=IA.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Be(e,t){const n=Z.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Re.setAnimationLoop((function(e){Me&&Me(e)})),"undefined"!==typeof self&&Re.setContext(self),this.setAnimationLoop=function(e){Me=e,be.setAnimationLoop(e),null===e?Re.stop():Re.start()},be.addEventListener("sessionstart",Ee),be.addEventListener("sessionend",Ce),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(t),t=be.getCamera()),!0===e.isScene&&e.onBeforeRender(v,e,t,_),f=ae.get(e,g.length),f.init(t),g.push(f),q.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),F.setFromProjectionMatrix(q),z=this.localClippingEnabled,U=le.init(this.clippingPlanes,z),A=oe.get(e,m.length),A.init(),m.push(A),!0===be.enabled&&!0===be.isPresenting){const e=v.xr.getDepthSensingMesh();null!==e&&Pe(e,t,-1/0,v.sortObjects)}Pe(e,t,0,v.sortObjects),A.finish(),!0===v.sortObjects&&A.sort(L,I),H=!1===be.enabled||!1===be.isPresenting||!1===be.hasDepthSensing(),H&&ue.addToRenderList(A,e),this.info.render.frame++,!0===U&&le.beginShadows();const n=f.state.shadowsArray;ce.render(n,e,t),!0===U&&le.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=A.opaque,r=A.transmissive;if(f.setupLights(),t.isArrayCamera){const n=t.cameras;if(r.length>0)for(let t=0,s=n.length;t<s;t++){De(i,r,e,n[t])}H&&ue.render(e);for(let t=0,i=n.length;t<i;t++){const i=n[t];Ne(A,e,i,i.viewport)}}else r.length>0&&De(i,r,e,t),H&&ue.render(e),Ne(A,e,t);null!==_&&(J.updateMultisampleRenderTarget(_),J.updateRenderTargetMipmap(_)),!0===e.isScene&&e.onAfterRender(v,e,t),fe.resetDefaultState(),w=-1,S=null,g.pop(),g.length>0?(f=g[g.length-1],!0===U&&le.setGlobalState(v.clippingPlanes,f.state.camera)):f=null,m.pop(),A=m.length>0?m[m.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(e,t,n){Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=n;const i=Z.get(e);i.__hasExternalTextures=!0,i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===X.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){const n=Z.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_=e,b=t,x=n;let i=!0,r=null,s=!1,o=!1;if(e){const a=Z.get(e);if(void 0!==a.__useDefaultFramebuffer)Q.bindFramebuffer(ge.FRAMEBUFFER,null),i=!1;else if(void 0===a.__webglFramebuffer)J.setupRenderTarget(e);else if(a.__hasExternalTextures)J.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(a.__boundDepthTexture!==t){if(null!==t&&Z.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");J.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][n]:c[t],s=!0):r=e.samples>0&&!1===J.useMultisampledRTT(e)?Z.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,T.copy(e.viewport),M.copy(e.scissor),E=e.scissorTest}else T.copy(O).multiplyScalar(D).floor(),M.copy(k).multiplyScalar(D).floor(),E=B;if(Q.bindFramebuffer(ge.FRAMEBUFFER,r)&&i&&Q.drawBuffers(e,r),Q.viewport(T),Q.scissor(M),Q.setScissorTest(E),s){const i=Z.get(e.texture);ge.framebufferTexture2D(ge.FRAMEBUFFER,ge.COLOR_ATTACHMENT0,ge.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(o){const i=Z.get(e.texture),r=t||0;ge.framebufferTextureLayer(ge.FRAMEBUFFER,ge.COLOR_ATTACHMENT0,i.__webglTexture,n||0,r)}w=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){Q.bindFramebuffer(ge.FRAMEBUFFER,a);try{const o=e.texture,a=o.format,l=o.type;if(!Y.textureFormatReadable(a))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Y.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&ge.readPixels(t,n,i,r,Ae.convert(a),Ae.convert(l),s)}finally{const e=null!==_?Z.get(_).__webglFramebuffer:null;Q.bindFramebuffer(ge.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){Q.bindFramebuffer(ge.FRAMEBUFFER,a);try{const o=e.texture,a=o.format,l=o.type;if(!Y.textureFormatReadable(a))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Y.textureTypeReadable(l))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){const e=ge.createBuffer();ge.bindBuffer(ge.PIXEL_PACK_BUFFER,e),ge.bufferData(ge.PIXEL_PACK_BUFFER,s.byteLength,ge.STREAM_READ),ge.readPixels(t,n,i,r,Ae.convert(a),Ae.convert(l),0),ge.flush();const o=ge.fenceSync(ge.SYNC_GPU_COMMANDS_COMPLETE,0);await function(e,t,n){return new Promise((function(i,r){setTimeout((function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}),n)}))}(ge,o,4);try{ge.bindBuffer(ge.PIXEL_PACK_BUFFER,e),ge.getBufferSubData(ge.PIXEL_PACK_BUFFER,0,s)}finally{ge.deleteBuffer(e),ge.deleteSync(o)}return s}}finally{const e=null!==_?Z.get(_).__webglFramebuffer:null;Q.bindFramebuffer(ge.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!0!==e.isTexture&&(Jc("WebGLRenderer: copyFramebufferToTexture function signature has changed."),t=arguments[0]||null,e=arguments[1]);const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i),o=null!==t?t.x:0,a=null!==t?t.y:0;J.setTexture2D(e,0),ge.copyTexSubImage2D(ge.TEXTURE_2D,n,0,0,o,a,r,s),Q.unbindTexture()},this.copyTextureToTexture=function(e,t){let n,i,r,s,o,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==e.isTexture&&(Jc("WebGLRenderer: copyTextureToTexture function signature has changed."),c=arguments[0]||null,e=arguments[1],t=arguments[2],u=arguments[3]||0,l=null),null!==l?(n=l.max.x-l.min.x,i=l.max.y-l.min.y,r=l.min.x,s=l.min.y):(n=e.image.width,i=e.image.height,r=0,s=0),null!==c?(o=c.x,a=c.y):(o=0,a=0);const h=Ae.convert(t.format),d=Ae.convert(t.type);J.setTexture2D(t,0),ge.pixelStorei(ge.UNPACK_FLIP_Y_WEBGL,t.flipY),ge.pixelStorei(ge.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),ge.pixelStorei(ge.UNPACK_ALIGNMENT,t.unpackAlignment);const p=ge.getParameter(ge.UNPACK_ROW_LENGTH),A=ge.getParameter(ge.UNPACK_IMAGE_HEIGHT),f=ge.getParameter(ge.UNPACK_SKIP_PIXELS),m=ge.getParameter(ge.UNPACK_SKIP_ROWS),g=ge.getParameter(ge.UNPACK_SKIP_IMAGES),v=e.isCompressedTexture?e.mipmaps[u]:e.image;ge.pixelStorei(ge.UNPACK_ROW_LENGTH,v.width),ge.pixelStorei(ge.UNPACK_IMAGE_HEIGHT,v.height),ge.pixelStorei(ge.UNPACK_SKIP_PIXELS,r),ge.pixelStorei(ge.UNPACK_SKIP_ROWS,s),e.isDataTexture?ge.texSubImage2D(ge.TEXTURE_2D,u,o,a,n,i,h,d,v.data):e.isCompressedTexture?ge.compressedTexSubImage2D(ge.TEXTURE_2D,u,o,a,v.width,v.height,h,v.data):ge.texSubImage2D(ge.TEXTURE_2D,u,o,a,n,i,h,d,v),ge.pixelStorei(ge.UNPACK_ROW_LENGTH,p),ge.pixelStorei(ge.UNPACK_IMAGE_HEIGHT,A),ge.pixelStorei(ge.UNPACK_SKIP_PIXELS,f),ge.pixelStorei(ge.UNPACK_SKIP_ROWS,m),ge.pixelStorei(ge.UNPACK_SKIP_IMAGES,g),0===u&&t.generateMipmaps&&ge.generateMipmap(ge.TEXTURE_2D),Q.unbindTexture()},this.copyTextureToTexture3D=function(e,t){let n,i,r,s,o,a,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==e.isTexture&&(Jc("WebGLRenderer: copyTextureToTexture3D function signature has changed."),h=arguments[0]||null,d=arguments[1]||null,e=arguments[2],t=arguments[3],p=arguments[4]||0);const A=e.isCompressedTexture?e.mipmaps[p]:e.image;null!==h?(n=h.max.x-h.min.x,i=h.max.y-h.min.y,r=h.max.z-h.min.z,s=h.min.x,o=h.min.y,a=h.min.z):(n=A.width,i=A.height,r=A.depth,s=0,o=0,a=0),null!==d?(l=d.x,c=d.y,u=d.z):(l=0,c=0,u=0);const f=Ae.convert(t.format),m=Ae.convert(t.type);let g;if(t.isData3DTexture)J.setTexture3D(t,0),g=ge.TEXTURE_3D;else{if(!t.isDataArrayTexture&&!t.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(t,0),g=ge.TEXTURE_2D_ARRAY}ge.pixelStorei(ge.UNPACK_FLIP_Y_WEBGL,t.flipY),ge.pixelStorei(ge.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),ge.pixelStorei(ge.UNPACK_ALIGNMENT,t.unpackAlignment);const v=ge.getParameter(ge.UNPACK_ROW_LENGTH),y=ge.getParameter(ge.UNPACK_IMAGE_HEIGHT),b=ge.getParameter(ge.UNPACK_SKIP_PIXELS),x=ge.getParameter(ge.UNPACK_SKIP_ROWS),_=ge.getParameter(ge.UNPACK_SKIP_IMAGES);ge.pixelStorei(ge.UNPACK_ROW_LENGTH,A.width),ge.pixelStorei(ge.UNPACK_IMAGE_HEIGHT,A.height),ge.pixelStorei(ge.UNPACK_SKIP_PIXELS,s),ge.pixelStorei(ge.UNPACK_SKIP_ROWS,o),ge.pixelStorei(ge.UNPACK_SKIP_IMAGES,a),e.isDataTexture||e.isData3DTexture?ge.texSubImage3D(g,p,l,c,u,n,i,r,f,m,A.data):t.isCompressedArrayTexture?ge.compressedTexSubImage3D(g,p,l,c,u,n,i,r,f,A.data):ge.texSubImage3D(g,p,l,c,u,n,i,r,f,m,A),ge.pixelStorei(ge.UNPACK_ROW_LENGTH,v),ge.pixelStorei(ge.UNPACK_IMAGE_HEIGHT,y),ge.pixelStorei(ge.UNPACK_SKIP_PIXELS,b),ge.pixelStorei(ge.UNPACK_SKIP_ROWS,x),ge.pixelStorei(ge.UNPACK_SKIP_IMAGES,_),0===p&&t.generateMipmaps&&ge.generateMipmap(g),Q.unbindTexture()},this.initRenderTarget=function(e){void 0===Z.get(e).__webglFramebuffer&&J.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?J.setTextureCube(e,0):e.isData3DTexture?J.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?J.setTexture2DArray(e,0):J.setTexture2D(e,0),Q.unbindTexture()},this.resetState=function(){b=0,x=0,_=null,Q.reset(),fe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Nc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Ac?"display-p3":"srgb",t.unpackColorSpace=iu.workingColorSpace===fc?"display-p3":"srgb"}},Scene:Lf,PerspectiveCamera:Dd,Raycaster:class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Yu(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new oh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Xg.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Xg),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Qg(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(Yg),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)Qg(e[i],this,n,t);return n.sort(Yg),n}},SRGBColorSpace:dc,TextureLoader:Eg,Vector2:Hc,Vector3:yu,Box3:_u,Color:Fh,Mesh:bd,SphereGeometry:ng,MeshBasicMaterial:Vh,BackSide:1,EventDispatcher:Lc,MOUSE:ba,Quaternion:vu,Spherical:Kg,Clock:Bg},A2=Uv({props:{width:{default:window.innerWidth,onChange:function(e,t,n){isNaN(e)&&(t.width=n)}},height:{default:window.innerHeight,onChange:function(e,t,n){isNaN(e)&&(t.height=n)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.toolTipElem&&(t.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){if(e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach((function(t){return t.render(e.scene,e.camera)})),e.enablePointerInteraction){var t=null;if(e.hoverDuringDrag||!e.isPointerDragging){var n=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y).filter((function(t){return e.hoverFilter(t.object)})).sort((function(t,n){return e.hoverOrderComparator(t.object,n.object)})),i=n.length?n[0]:null;t=i?i.object:null,e.intersectionPoint=i?i.point:null}t!==e.hoverObj&&(e.onHover(t,e.hoverObj),e.toolTipElem.innerHTML=t&&Bb(e.tooltipContent)(t)||"",e.hoverObj=t)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos;return{x:t.x,y:t.y}},cameraPosition:function(e,t,n,i){var r=e.camera;if(t&&e.initialised){var s=t,o=n||{x:0,y:0,z:0};if(i){var a=Object.assign({},r.position),l=h();e.tweenGroup.add(new Wv(a).to(s,i).easing(zv.Quadratic.Out).onUpdate(c).start()),e.tweenGroup.add(new Wv(l).to(o,i/3).easing(zv.Quadratic.Out).onUpdate(u).start())}else c(s),u(o);return this}return Object.assign({},r.position,{lookAt:h()});function c(e){var t=e.x,n=e.y,i=e.z;void 0!==t&&(r.position.x=t),void 0!==n&&(r.position.y=n),void 0!==i&&(r.position.z=i)}function u(t){var n=new p2.Vector3(t.x,t.y,t.z);e.controls.target?e.controls.target=n:r.lookAt(n)}function h(){return Object.assign(new p2.Vector3(0,0,-1e3).applyQuaternion(r.quaternion).add(r.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length,r=new Array(i>3?i-3:0),s=3;s<i;s++)r[s-3]=arguments[s];return this.fitToBbox(this.getBbox.apply(this,r),t,n)},fitToBbox:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=e.camera;if(t){var s=new p2.Vector3(0,0,0),o=2*Math.max.apply(Math,h2(Object.entries(t).map((function(e){var t=u2(e,2),n=t[0],i=t[1];return Math.max.apply(Math,h2(i.map((function(e){return Math.abs(s[n]-e)}))))})))),a=(1-2*i/e.height)*r.fov,l=o/Math.atan(a*Math.PI/180),c=l/r.aspect,u=Math.max(l,c);if(u>0){var h=s.clone().sub(r.position).normalize().multiplyScalar(-u);this.cameraPosition(h,s,n)}}return this},getBbox:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=new p2.Box3(new p2.Vector3(0,0,0),new p2.Vector3(0,0,0)),i=e.objects.filter(t);return i.length?(i.forEach((function(e){return n.expandByObject(e)})),Object.assign.apply(Object,h2(["x","y","z"].map((function(e){return c2({},e,[n.min[e],n.max[e]])}))))):null},getScreenCoords:function(e,t,n,i){var r=new p2.Vector3(t,n,i);return r.project(this.camera()),{x:(r.x+1)*e.width/2,y:-(r.y-1)*e.height/2}},getSceneCoords:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=new p2.Vector2(t/e.width*2-1,-n/e.height*2+1),s=new p2.Raycaster;return s.setFromCamera(r,e.camera),Object.assign({},s.ray.at(i,new p2.Vector3))},intersectingObjects:function(e,t,n){var i=new p2.Vector2(t/e.width*2-1,-n/e.height*2+1),r=new p2.Raycaster;return r.params.Line.threshold=e.lineHoverPrecision,r.setFromCamera(i,e.camera),r.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new p2.Scene,camera:new p2.PerspectiveCamera,clock:new p2.Clock,tweenGroup:new Vv}},init:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.controlType,r=void 0===i?"trackball":i,s=n.useWebGPU,o=void 0!==s&&s,a=n.rendererConfig,l=void 0===a?{}:a,c=n.extraRenderers,u=void 0===c?[]:c,h=n.waitForLoadComplete,d=void 0===h||h;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[r]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.toolTipElem=document.createElement("div"),t.toolTipElem.classList.add("scene-tooltip"),t.container.appendChild(t.toolTipElem),t.pointerPos=new p2.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach((function(e){return t.container.addEventListener(e,(function(n){if("pointerdown"===e&&(t.isPointerPressed=!0),!t.isPointerDragging&&"pointermove"===n.type&&(n.pressure>0||t.isPointerPressed)&&("touch"!==n.pointerType||void 0===n.movementX||[n.movementX,n.movementY].some((function(e){return Math.abs(e)>1})))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var i=function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+i,left:t.left+n}}(t.container);t.pointerPos.x=n.pageX-i.left,t.pointerPos.y=n.pageY-i.top,t.toolTipElem.style.top="".concat(t.pointerPos.y,"px"),t.toolTipElem.style.left="".concat(t.pointerPos.x,"px"),t.toolTipElem.style.transform="translate(-".concat(t.pointerPos.x/t.width*100,"%, ").concat(t.height-t.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}}),{passive:!0})})),t.container.addEventListener("pointerup",(function(e){t.isPointerPressed=!1,t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag)||requestAnimationFrame((function(){0===e.button&&t.onClick(t.hoverObj||null,e,t.intersectionPoint),2===e.button&&t.onRightClick&&t.onRightClick(t.hoverObj||null,e,t.intersectionPoint)}))}),{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",(function(e){t.onRightClick&&e.preventDefault()})),t.renderer=new(o?q$:p2.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},l)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=u,t.extraRenderers.forEach((function(e){e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.pointerEvents="none",t.container.appendChild(e.domElement)})),t.postProcessingComposer=new y1(t.renderer),t.postProcessingComposer.addPass(new b1(t.scene,t.camera)),t.controls=new{trackball:c0,orbit:q0,fly:i1}[r](t.camera,t.renderer.domElement),"fly"===r&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),"trackball"!==r&&"orbit"!==r||(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",(function(){t.controlsEngaged=!0})),t.controls.addEventListener("change",(function(){t.controlsEngaged&&(t.controlsDragging=!0)})),t.controls.addEventListener("end",(function(){t.controlsEngaged=!1,t.controlsDragging=!1}))),[t.renderer,t.postProcessingComposer].concat(h2(t.extraRenderers)).forEach((function(e){return e.setSize(t.width,t.height)})),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new p2.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!d,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))&&(e.container.style.width="".concat(e.width,"px"),e.container.style.height="".concat(e.height,"px"),[e.renderer,e.postProcessingComposer].concat(h2(e.extraRenderers)).forEach((function(t){return t.setSize(e.width,e.height)})),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix()),t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=2.5*e.skyRadius,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new p2.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var n=G1(e.backgroundColor).alpha;void 0===n&&(n=1),e.renderer.setClearColor(new p2.Color(a2(1,e.backgroundColor)),n)}function i(){e.loadComplete=e.scene.visible=!0}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?(new p2.TextureLoader).load(e.backgroundImageUrl,(function(t){t.colorSpace=p2.SRGBColorSpace,e.skysphere.material=new p2.MeshBasicMaterial({map:t,side:p2.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&i()})):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&i())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach((function(t){return e.scene.remove(t)})),e.lights.forEach((function(t){return e.scene.add(t)}))),t.hasOwnProperty("objects")&&((t.objects||[]).forEach((function(t){return e.scene.remove(t)})),e.objects.forEach((function(t){return e.scene.add(t)})))}});function f2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function m2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g2(Object(n),!0).forEach((function(t){m2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y2(e){return function(e){if(Array.isArray(e))return f2(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f2(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f2(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b2(e,t){var n=new t;return n._destructor&&n._destructor(),{linkProp:function(t){return{default:n[t](),onChange:function(n,i){i[e][t](n)},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var i=n[e],r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];var a=i[t].apply(i,s);return a===i?this:a}}}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!==typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".scene-container .clickable {\n  cursor: pointer;\n}");var x2=["rendererConfig","waitForGlobeReady"],_2=v2(v2({},window.THREE?window.THREE:{AmbientLight:Og,DirectionalLight:Ig,Vector2:Hc,REVISION:ya}),{},{CSS2DRenderer:class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this;let n,i,r,s;const o={objects:new WeakMap},a=void 0!==e.element?e.element:document.createElement("div");function l(e){e.isCSS2DObject&&(e.element.style.display="none");for(let t=0,n=e.children.length;t<n;t++)l(e.children[t])}function c(e,n,i){if(!1!==e.visible){if(e.isCSS2DObject){tv.setFromMatrixPosition(e.matrixWorld),tv.applyMatrix4(iv);const l=tv.z>=-1&&tv.z<=1&&!0===e.layers.test(i.layers),c=e.element;c.style.display=!0===l?"":"none",!0===l&&(e.onBeforeRender(t,n,i),c.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(tv.x*r+r)+"px,"+(-tv.y*s+s)+"px)",c.parentNode!==a&&a.appendChild(c),e.onAfterRender(t,n,i));const h={distanceToCameraSquared:u(i,e)};o.objects.set(e,h)}for(let t=0,r=e.children.length;t<r;t++)c(e.children[t],n,i)}else l(e)}function u(e,t){return rv.setFromMatrixPosition(e.matrixWorld),sv.setFromMatrixPosition(t.matrixWorld),rv.distanceToSquared(sv)}a.style.overflow="hidden",this.domElement=a,this.getSize=function(){return{width:n,height:i}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),nv.copy(t.matrixWorldInverse),iv.multiplyMatrices(t.projectionMatrix,nv),c(e,e,t),function(e){const t=function(e){const t=[];return e.traverseVisible((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared})),n=t.length;for(let i=0,r=t.length;i<r;i++)t[i].element.style.zIndex=n-i}(e)},this.setSize=function(e,t){n=e,i=t,r=n/2,s=i/2,a.style.width=e+"px",a.style.height=t+"px"}}}}),w2=b2("globe",dP),S2=Object.assign.apply(Object,y2(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map((function(e){return m2({},e,w2.linkProp(e))})))),T2=Object.assign.apply(Object,y2(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map((function(e){return m2({},e,w2.linkMethod(e))})))),M2=b2("renderObjs",A2),E2=Object.assign.apply(Object,y2(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map((function(e){return m2({},e,M2.linkProp(e))})))),C2=Object.assign.apply(Object,y2(["lights","postProcessingComposer"].map((function(e){return m2({},e,M2.linkMethod(e))})))),R2=Uv({props:v2(v2({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1,onChange:function(e,t){return t.renderObjs.hoverFilter((function(t){return e(t,t.__data)}))}},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){return t.renderObjs.lineHoverPrecision(e)}}},S2),E2),methods:v2(v2({pauseAnimation:function(e){var t;return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),null===(t=e.globe)||void 0===t||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return null===e.animationFrameRequestId&&this._animationCycle(),null===(t=e.globe)||void 0===t||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.globe.toGeoCoords(e.renderObjs.cameraPosition());if(void 0===t.lat&&void 0===t.lng&&void 0===t.altitude)return i;var r=Object.assign({},i,t);if(["lat","lng","altitude"].forEach((function(e){return r[e]=+r[e]})),n){for(;i.lng-r.lng>180;)i.lng-=360;for(;i.lng-r.lng<-180;)i.lng+=360;e.tweenGroup.add(new Wv(i).to(r,n).easing(zv.Cubic.InOut).onUpdate(s).start())}else s(r);return this;function s(t){var n=t.lat,i=t.lng,r=t.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(n,i,r))}},getScreenCoords:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var s=(t=e.globe).getCoords.apply(t,i);return e.renderObjs.getScreenCoords(s.x,s.y,s.z)},toGlobeCoords:function(e,t,n){var i=e.renderObjs.intersectingObjects(t,n).find((function(e){return"globe"===e.object.__globeObjType}));if(!i)return null;var r=e.globe.toGeoCoords(i.point);return{lat:r.lat,lng:r.lng}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},T2),C2),stateInit:function(e){var t=e.rendererConfig,n=e.waitForGlobeReady,i=void 0===n||n,r=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,x2),s=new dP(v2({waitForGlobeReady:i},r));return{globe:s,renderObjs:A2({controlType:"orbit",rendererConfig:t,waitForLoadComplete:i,extraRenderers:[new _2.CSS2DRenderer]}).skyRadius(500*s.getGlobeRadius()).showNavInfo(!1).objects([s]).lights([new _2.AmbientLight(13421772,Math.PI),new _2.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new Vv}},init:function(e,t){var n=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var i=document.createElement("div");t.container.appendChild(i),t.renderObjs(i),t.globe.rendererSize(t.renderObjs.renderer().getSize(new _2.Vector2)),this.pointOfView({altitude:2.5});var r=t.globe.getGlobeRadius(),s=t.renderObjs.controls();s.minDistance=1.01*r,s.maxDistance=100*r,s.enablePan=!1,s.enableDamping=!0,s.dampingFactor=.1,s.rotateSpeed=.3,s.zoomSpeed=.3,s.addEventListener("change",(function(){var e=n.pointOfView();s.rotateSpeed=.2*e.altitude,s.zoomSpeed=.1*(e.altitude+1),t.globe.setPointOfView(t.renderObjs.camera().position),t.onZoom&&t.onZoom(e)}));var o=function(e){for(var t=e;t&&!t.hasOwnProperty("__globeObjType");)t=t.parent;return t},a={point:function(e){return e},arc:function(e){return e},polygon:function(e){return e.data},path:function(e){return e},heatmap:function(e){return e},hexbin:function(e){return e},hexPolygon:function(e){return e},tile:function(e){return e},label:function(e){return e},object:function(e){return e},custom:function(e){return e}};_2.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverOrderComparator((function(e,t){var n=o(e),i=o(t),r=function(e){return!e};return r(n)-r(i)})).tooltipContent((function(e){var n={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},i=o(e),r=i&&i.__globeObjType;return i&&r&&n.hasOwnProperty(r)&&a.hasOwnProperty(r)&&Bb(n[r])(a[r](i.__data))||""})).onHover((function(e){var n={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},i={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},r=o(e);if(r&&!n.hasOwnProperty(r.__globeObjType)&&(r=null),r!==t.hoverObj){var s=t.hoverObj?t.hoverObj.__globeObjType:null,l=t.hoverObj?a[s](t.hoverObj.__data):null,c=r?r.__globeObjType:null,u=r?a[c](r.__data):null;s&&s!==c&&n[s]&&n[s](null,l),c&&n[c]&&n[c](u,s===c?l:null),t.renderObjs.renderer().domElement.classList[c&&i[c]?"add":"remove"]("clickable"),t.hoverObj=r}})).onClick((function(e,i,r){if(e){var s={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},l=o(e),c=l.__globeObjType;if(l&&s.hasOwnProperty(c)&&s[c]){var u=[i];if("globe"===c){var h=n.toGeoCoords(r),d=h.lat,p=h.lng;u.unshift({lat:d,lng:p})}else u.push(n.toGeoCoords(r));a.hasOwnProperty(c)&&u.unshift(a[c](l.__data)),s[c].apply(s,u)}}})).onRightClick((function(e,i,r){if(e){var s={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},l=o(e),c=l.__globeObjType;if(l&&s.hasOwnProperty(c)&&s[c]){var u=[i];if("globe"===c){var h=n.toGeoCoords(r),d=h.lat,p=h.lng;u.unshift({lat:d,lng:p})}else u.push(n.toGeoCoords(r));a.hasOwnProperty(c)&&u.unshift(a[c](l.__data)),s[c].apply(s,u)}}})),this._animationCycle()}}),P2=n(173),N2={width:P2.number,height:P2.number,backgroundColor:P2.string,backgroundImageUrl:P2.string,globeImageUrl:P2.string,bumpImageUrl:P2.string,showGlobe:P2.bool,showGraticules:P2.bool,showAtmosphere:P2.bool,atmosphereColor:P2.string,atmosphereAltitude:P2.number,globeMaterial:P2.object,onGlobeReady:P2.func,onGlobeClick:P2.func,onGlobeRightClick:P2.func,pointsData:P2.arrayOf(P2.object),pointLat:P2.oneOfType([P2.number,P2.string,P2.func]),pointLng:P2.oneOfType([P2.number,P2.string,P2.func]),pointColor:P2.oneOfType([P2.string,P2.func]),pointAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),pointRadius:P2.oneOfType([P2.number,P2.string,P2.func]),pointResolution:P2.number,pointsMerge:P2.bool,pointsTransitionDuration:P2.number,pointLabel:P2.oneOfType([P2.string,P2.func]),onPointClick:P2.func,onPointRightClick:P2.func,onPointHover:P2.func,arcsData:P2.arrayOf(P2.object),arcStartLat:P2.oneOfType([P2.number,P2.string,P2.func]),arcStartLng:P2.oneOfType([P2.number,P2.string,P2.func]),arcEndLat:P2.oneOfType([P2.number,P2.string,P2.func]),arcEndLng:P2.oneOfType([P2.number,P2.string,P2.func]),arcColor:P2.oneOfType([P2.string,P2.arrayOf(P2.string),P2.func]),arcAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),arcAltitudeAutoScale:P2.oneOfType([P2.number,P2.string,P2.func]),arcStroke:P2.oneOfType([P2.number,P2.string,P2.func]),arcCurveResolution:P2.number,arcCircularResolution:P2.number,arcDashLength:P2.oneOfType([P2.number,P2.string,P2.func]),arcDashGap:P2.oneOfType([P2.number,P2.string,P2.func]),arcDashInitialGap:P2.oneOfType([P2.number,P2.string,P2.func]),arcDashAnimateTime:P2.oneOfType([P2.number,P2.string,P2.func]),arcsTransitionDuration:P2.number,arcLabel:P2.oneOfType([P2.string,P2.func]),onArcClick:P2.func,onArcRightClick:P2.func,onArcHover:P2.func,polygonsData:P2.arrayOf(P2.object),polygonGeoJsonGeometry:P2.oneOfType([P2.string,P2.func]),polygonCapColor:P2.oneOfType([P2.string,P2.func]),polygonCapMaterial:P2.oneOfType([P2.object,P2.string,P2.func]),polygonSideColor:P2.oneOfType([P2.string,P2.func]),polygonSideMaterial:P2.oneOfType([P2.object,P2.string,P2.func]),polygonStrokeColor:P2.oneOfType([P2.string,P2.func]),polygonAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),polygonCapCurvatureResolution:P2.oneOfType([P2.number,P2.string,P2.func]),polygonsTransitionDuration:P2.number,polygonLabel:P2.oneOfType([P2.string,P2.func]),onPolygonClick:P2.func,onPolygonRightClick:P2.func,onPolygonHover:P2.func,pathsData:P2.array,pathPoints:P2.oneOfType([P2.array,P2.string,P2.func]),pathPointLat:P2.oneOfType([P2.number,P2.string,P2.func]),pathPointLng:P2.oneOfType([P2.number,P2.string,P2.func]),pathPointAlt:P2.oneOfType([P2.number,P2.string,P2.func]),pathResolution:P2.number,pathColor:P2.oneOfType([P2.string,P2.arrayOf(P2.string),P2.func]),pathStroke:P2.oneOfType([P2.number,P2.string,P2.func]),pathDashLength:P2.oneOfType([P2.number,P2.string,P2.func]),pathDashGap:P2.oneOfType([P2.number,P2.string,P2.func]),pathDashInitialGap:P2.oneOfType([P2.number,P2.string,P2.func]),pathDashAnimateTime:P2.oneOfType([P2.number,P2.string,P2.func]),pathTransitionDuration:P2.number,pathLabel:P2.oneOfType([P2.string,P2.func]),onPathClick:P2.func,onPathRightClick:P2.func,onPathHover:P2.func,heatmapsData:P2.array,heatmapPoints:P2.oneOfType([P2.array,P2.string,P2.func]),heatmapPointLat:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapPointLng:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapPointWeight:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapBandwidth:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapColorFn:P2.oneOfType([P2.string,P2.func]),heatmapColorSaturation:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapBaseAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapTopAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),heatmapsTransitionDuration:P2.number,onHeatmapClick:P2.func,onHeatmapRightClick:P2.func,onHeatmapHover:P2.func,hexBinPointsData:P2.arrayOf(P2.object),hexBinPointLat:P2.oneOfType([P2.number,P2.string,P2.func]),hexBinPointLng:P2.oneOfType([P2.number,P2.string,P2.func]),hexBinPointWeight:P2.oneOfType([P2.number,P2.string,P2.func]),hexBinResolution:P2.number,hexMargin:P2.oneOfType([P2.number,P2.func]),hexTopColor:P2.func,hexSideColor:P2.func,hexAltitude:P2.oneOfType([P2.number,P2.func]),hexTopCurvatureResolution:P2.number,hexBinMerge:P2.bool,hexTransitionDuration:P2.number,hexLabel:P2.oneOfType([P2.string,P2.func]),onHexClick:P2.func,onHexRightClick:P2.func,onHexHover:P2.func,hexPolygonsData:P2.arrayOf(P2.object),hexPolygonGeoJsonGeometry:P2.oneOfType([P2.string,P2.func]),hexPolygonColor:P2.oneOfType([P2.string,P2.func]),hexPolygonAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),hexPolygonResolution:P2.oneOfType([P2.number,P2.string,P2.func]),hexPolygonMargin:P2.oneOfType([P2.number,P2.string,P2.func]),hexPolygonUseDots:P2.oneOfType([P2.bool,P2.string,P2.func]),hexPolygonCurvatureResolution:P2.oneOfType([P2.number,P2.string,P2.func]),hexPolygonDotResolution:P2.oneOfType([P2.number,P2.string,P2.func]),hexPolygonsTransitionDuration:P2.number,hexPolygonLabel:P2.oneOfType([P2.string,P2.func]),onHexPolygonClick:P2.func,onHexPolygonRightClick:P2.func,onHexPolygonHover:P2.func,tilesData:P2.arrayOf(P2.object),tileLat:P2.oneOfType([P2.number,P2.string,P2.func]),tileLng:P2.oneOfType([P2.number,P2.string,P2.func]),tileAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),tileWidth:P2.oneOfType([P2.number,P2.string,P2.func]),tileHeight:P2.oneOfType([P2.number,P2.string,P2.func]),tileUseGlobeProjection:P2.oneOfType([P2.bool,P2.string,P2.func]),tileMaterial:P2.oneOfType([P2.object,P2.string,P2.func]),tileCurvatureResolution:P2.oneOfType([P2.number,P2.string,P2.func]),tilesTransitionDuration:P2.number,tileLabel:P2.oneOfType([P2.string,P2.func]),onTileClick:P2.func,onTileRightClick:P2.func,onTileHover:P2.func,ringsData:P2.arrayOf(P2.object),ringLat:P2.oneOfType([P2.number,P2.string,P2.func]),ringLng:P2.oneOfType([P2.number,P2.string,P2.func]),ringAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),ringColor:P2.oneOfType([P2.string,P2.arrayOf(P2.string),P2.func]),ringResolution:P2.number,ringMaxRadius:P2.oneOfType([P2.number,P2.string,P2.func]),ringPropagationSpeed:P2.oneOfType([P2.number,P2.string,P2.func]),ringRepeatPeriod:P2.oneOfType([P2.number,P2.string,P2.func]),labelsData:P2.arrayOf(P2.object),labelLat:P2.oneOfType([P2.number,P2.string,P2.func]),labelLng:P2.oneOfType([P2.number,P2.string,P2.func]),labelAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),labelRotation:P2.oneOfType([P2.number,P2.string,P2.func]),labelText:P2.oneOfType([P2.string,P2.func]),labelSize:P2.oneOfType([P2.number,P2.string,P2.func]),labelTypeFace:P2.object,labelColor:P2.oneOfType([P2.string,P2.func]),labelResolution:P2.number,labelIncludeDot:P2.oneOfType([P2.bool,P2.string,P2.func]),labelDotRadius:P2.oneOfType([P2.number,P2.string,P2.func]),labelDotOrientation:P2.oneOfType([P2.string,P2.func]),labelsTransitionDuration:P2.number,labelLabel:P2.oneOfType([P2.string,P2.func]),onLabelClick:P2.func,onLabelRightClick:P2.func,onLabelHover:P2.func,htmlElementsData:P2.arrayOf(P2.object),htmlLat:P2.oneOfType([P2.number,P2.string,P2.func]),htmlLng:P2.oneOfType([P2.number,P2.string,P2.func]),htmlAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),htmlElement:P2.oneOfType([P2.string,P2.func]),htmlTransitionDuration:P2.number,objectsData:P2.arrayOf(P2.object),objectLat:P2.oneOfType([P2.number,P2.string,P2.func]),objectLng:P2.oneOfType([P2.number,P2.string,P2.func]),objectAltitude:P2.oneOfType([P2.number,P2.string,P2.func]),objectRotation:P2.oneOfType([P2.shape({x:P2.number,y:P2.number,z:P2.number}),P2.string,P2.func]),objectFacesSurface:P2.oneOfType([P2.bool,P2.string,P2.func]),objectThreeObject:P2.oneOfType([P2.object,P2.string,P2.func]),objectLabel:P2.oneOfType([P2.string,P2.func]),onObjectClick:P2.func,onObjectRightClick:P2.func,onObjectHover:P2.func,customLayerData:P2.arrayOf(P2.object),customThreeObject:P2.oneOfType([P2.object,P2.string,P2.func]),customThreeObjectUpdate:P2.oneOfType([P2.string,P2.func]),customLayerLabel:P2.oneOfType([P2.string,P2.func]),onCustomLayerClick:P2.func,onCustomLayerRightClick:P2.func,onCustomLayerHover:P2.func,enablePointerInteraction:P2.bool,pointerEventsFilter:P2.func,lineHoverPrecision:P2.number,onZoom:P2.func},D2=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.wrapperElementType,r=void 0===i?"div":i,s=n.nodeMapper,o=void 0===s?function(e){return e}:s,a=n.methodNames,l=void 0===a?[]:a,c=n.initPropNames,u=void 0===c?[]:c;return(0,t.forwardRef)((function(n,i){var s=(0,t.useRef)(),a=(0,t.useMemo)((function(){var t=Object.fromEntries(u.filter((function(e){return n.hasOwnProperty(e)})).map((function(e){return[e,n[e]]})));return e(t)}),[]);va((function(){a(o(s.current))}),t.useLayoutEffect),va((function(){return a._destructor instanceof Function?a._destructor:void 0}));var c=(0,t.useCallback)((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a[e]instanceof Function?a[e].apply(a,n):void 0}),[a]),h=(0,t.useRef)({});return Object.keys(function(e,t){var n=new Set(t);return Object.assign.apply(Object,[{}].concat(ha(Object.entries(e).filter((function(e){var t=ua(e,1)[0];return!n.has(t)})).map((function(e){var t=ua(e,2);return ca({},t[0],t[1])})))))}(n,[].concat(ma(l),ma(u)))).filter((function(e){return h.current[e]!==n[e]})).forEach((function(e){return c(e,n[e])})),h.current=n,(0,t.useImperativeHandle)(i,(function(){return Object.fromEntries(l.map((function(e){return[e,function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return c.apply(void 0,[e].concat(n))}]})))}),[c]),t.createElement(r,{ref:s})}))}(R2,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});D2.displayName="Globe",D2.propTypes=N2;const L2=()=>{const e=(0,t.useRef)();return(0,t.useEffect)((()=>{const t=e.current;t.controls().enableZoom=!1,t.controls().autoRotate=!0,t.controls().autoRotateSpeed=.5;const n=t.scene(),i=new nd,r=new Float32Array(3e3);for(let e=0;e<1e3;e++)r[3*e]=2e3*Math.random()-1e3,r[3*e+1]=2e3*Math.random()-1e3,r[3*e+2]=2e3*Math.random()-1e3;i.setAttribute("position",new Hh(r,3));const s=new Zf({color:8947848,size:.5,blending:2,transparent:!0}),o=new nm(i,s);n.add(o);const a=()=>{requestAnimationFrame(a),o.rotation.y+=.001};a()}),[]),(0,r.jsx)("div",{style:{width:"100%",height:"100vh",position:"relative"},children:(0,r.jsx)(D2,{ref:e,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-night.jpg",backgroundColor:"rgba(0,0,0,0)",showGlobe:!0,showGraticules:!0,showAtmosphere:!0})})},I2="generated",O2="pointerleave",k2="pointermove",B2="touchend",F2="tsParticles - Error",U2=100,z2=1e3;var q2;function V2(e){return"boolean"===typeof e}function G2(e){return"string"===typeof e}function j2(e){return"number"===typeof e}function H2(e){return"object"===typeof e&&null!==e}function W2(e){return Array.isArray(e)}function X2(e){return null===e||void 0===e}!function(e){e.bottom="bottom",e.bottomLeft="bottom-left",e.bottomRight="bottom-right",e.left="left",e.none="none",e.right="right",e.top="top",e.topLeft="top-left",e.topRight="top-right",e.outside="outside",e.inside="inside"}(q2||(q2={}));const Y2=0,Q2=0,K2=0;class Z2{constructor(e,t,n){if(this._updateFromAngle=(e,t)=>{this.x=Math.cos(e)*t,this.y=Math.sin(e)*t},!j2(e)&&e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:K2}else{if(void 0===e||void 0===t)throw new Error("".concat(F2," Vector3d not initialized correctly"));this.x=e,this.y=t,this.z=null!==n&&void 0!==n?n:K2}}static get origin(){return Z2.create(Y2,Q2,K2)}get angle(){return Math.atan2(this.y,this.x)}set angle(e){this._updateFromAngle(e,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(e){this._updateFromAngle(this.angle,e)}static clone(e){return Z2.create(e.x,e.y,e.z)}static create(e,t,n){return new Z2(e,t,n)}add(e){return Z2.create(this.x+e.x,this.y+e.y,this.z+e.z)}addTo(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}copy(){return Z2.clone(this)}distanceTo(e){return this.sub(e).length}distanceToSq(e){return this.sub(e).getLengthSq()}div(e){return Z2.create(this.x/e,this.y/e,this.z/e)}divTo(e){this.x/=e,this.y/=e,this.z/=e}getLengthSq(){return this.x**2+this.y**2}mult(e){return Z2.create(this.x*e,this.y*e,this.z*e)}multTo(e){this.x*=e,this.y*=e,this.z*=e}normalize(){const e=this.length;0!=e&&this.multTo(1/e)}rotate(e){return Z2.create(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e),K2)}setTo(e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:K2}sub(e){return Z2.create(this.x-e.x,this.y-e.y,this.z-e.z)}subFrom(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}class J2 extends Z2{constructor(e,t){super(e,t,K2)}static get origin(){return J2.create(Y2,Q2)}static clone(e){return J2.create(e.x,e.y)}static create(e,t){return new J2(e,t)}}let $2=Math.random;const e3={nextFrame:e=>requestAnimationFrame(e),cancel:e=>cancelAnimationFrame(e)},t3=2*Math.PI;function n3(){return i3($2(),0,1-Number.EPSILON)}function i3(e,t,n){return Math.min(Math.max(e,t),n)}function r3(e,t,n,i){return Math.floor((e*n+t*i)/(n+i))}function s3(e){const t=l3(e);let n=a3(e);return t===n&&(n=0),n3()*(t-n)+n}function o3(e){return j2(e)?e:s3(e)}function a3(e){return j2(e)?e:e.min}function l3(e){return j2(e)?e:e.max}function c3(e,t){if(e===t||void 0===t&&j2(e))return e;const n=a3(e),i=l3(e);return void 0!==t?{min:Math.min(n,t),max:Math.max(i,t)}:c3(n,i)}function u3(e,t){const n=e.x-t.x,i=e.y-t.y;return{dx:n,dy:i,distance:Math.sqrt(n**2+i**2)}}function h3(e,t){return u3(e,t).distance}function d3(e){return e*Math.PI/180}function p3(e,t,n,i){return J2.create(e.x*(n-i)/(n+i)+2*t.x*i/(n+i),e.y)}function A3(e){var t,n,i,r;return{x:null!==(t=null===(n=e.position)||void 0===n?void 0:n.x)&&void 0!==t?t:n3()*e.size.width,y:null!==(i=null===(r=e.position)||void 0===r?void 0:r.y)&&void 0!==i?i:n3()*e.size.height}}function f3(e){return e?e.endsWith("%")?parseFloat(e)/U2:parseFloat(e):1}var m3,g3,v3,y3,b3,x3;!function(e){e.auto="auto",e.increase="increase",e.decrease="decrease",e.random="random"}(m3||(m3={})),function(e){e.increasing="increasing",e.decreasing="decreasing"}(g3||(g3={})),function(e){e.none="none",e.max="max",e.min="min"}(v3||(v3={})),function(e){e.bottom="bottom",e.left="left",e.right="right",e.top="top"}(y3||(y3={})),function(e){e.precise="precise",e.percent="percent"}(b3||(b3={})),function(e){e.max="max",e.min="min",e.random="random"}(x3||(x3={}));const _3=["mode"],w3={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function S3(){return w3}function T3(e){const t={bounced:!1},{pSide:n,pOtherSide:i,rectSide:r,rectOtherSide:s,velocity:o,factor:a}=e;return i.min<s.min||i.min>s.max||i.max<s.min||i.max>s.max||(n.max>=r.min&&n.max<=.5*(r.max+r.min)&&o>0||n.min<=r.max&&n.min>.5*(r.max+r.min)&&o<0)&&(t.velocity=o*-a,t.bounced=!0),t}function M3(){return"undefined"===typeof window||!window||"undefined"===typeof window.document||!window.document}function E3(e){if(!M3()&&"undefined"!==typeof matchMedia)return matchMedia(e)}function C3(e,t){return e===t||W2(t)&&t.indexOf(e)>-1}async function R3(e,t){try{await document.fonts.load("".concat(null!==t&&void 0!==t?t:"400"," 36px '").concat(null!==e&&void 0!==e?e:"Verdana","'"))}catch(n){}}function P3(e,t){return e[void 0!==t&&(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])?t%e.length:function(e){return Math.floor(n3()*e.length)}(e)]}function N3(e,t,n,i,r){return function(e,t,n,i){let r=!0;i&&i!==y3.bottom||(r=e.top<t.height+n.x);!r||i&&i!==y3.left||(r=e.right>n.x);!r||i&&i!==y3.right||(r=e.left<t.width+n.y);!r||i&&i!==y3.top||(r=e.bottom>n.y);return r}(D3(e,null!==i&&void 0!==i?i:0),t,n,r)}function D3(e,t){return{bottom:e.y+t,left:e.x-t,right:e.x+t,top:e.y-t}}function L3(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n){if(void 0===r||null===r)continue;if(!H2(r)){e=r;continue}const t=Array.isArray(r);!t||!H2(e)&&e&&Array.isArray(e)?t||!H2(e)&&e&&!Array.isArray(e)||(e={}):e=[];for(const n in r){if("__proto__"===n)continue;const t=r[n],i=e;i[n]=H2(t)&&Array.isArray(t)?t.map((e=>L3(i[n],e))):L3(i[n],t)}}return e}function I3(e,t){return!!V3(t,(t=>t.enable&&C3(e,t.mode)))}function O3(e,t,n){z3(t,(t=>{const i=t.mode;t.enable&&C3(e,i)&&function(e,t){const n=e.selectors;z3(n,(n=>{t(n,e)}))}(t,n)}))}function k3(e,t){if(t&&e)return V3(e,(e=>function(e,t){const n=z3(t,(t=>e.matches(t)));return W2(n)?n.some((e=>e)):n}(t,e.selectors)))}function B3(e){return{position:e.getPosition(),radius:e.getRadius(),mass:e.getMass(),velocity:e.velocity,factor:J2.create(o3(e.options.bounce.horizontal.value),o3(e.options.bounce.vertical.value))}}function F3(e,t){const{x:n,y:i}=e.velocity.sub(t.velocity),[r,s]=[e.position,t.position],{dx:o,dy:a}=u3(s,r);if(n*o+i*a<0)return;const l=-Math.atan2(a,o),c=e.mass,u=t.mass,h=e.velocity.rotate(l),d=t.velocity.rotate(l),p=p3(h,d,c,u),A=p3(d,h,c,u),f=p.rotate(-l),m=A.rotate(-l);e.velocity.x=f.x*e.factor.x,e.velocity.y=f.y*e.factor.y,t.velocity.x=m.x*t.factor.x,t.velocity.y=m.y*t.factor.y}function U3(e,t){const n=D3(e.getPosition(),e.getRadius()),i=e.options.bounce,r=T3({pSide:{min:n.left,max:n.right},pOtherSide:{min:n.top,max:n.bottom},rectSide:{min:t.left,max:t.right},rectOtherSide:{min:t.top,max:t.bottom},velocity:e.velocity.x,factor:o3(i.horizontal.value)});r.bounced&&(void 0!==r.velocity&&(e.velocity.x=r.velocity),void 0!==r.position&&(e.position.x=r.position));const s=T3({pSide:{min:n.top,max:n.bottom},pOtherSide:{min:n.left,max:n.right},rectSide:{min:t.top,max:t.bottom},rectOtherSide:{min:t.left,max:t.right},velocity:e.velocity.y,factor:o3(i.vertical.value)});s.bounced&&(void 0!==s.velocity&&(e.velocity.y=s.velocity),void 0!==s.position&&(e.position.y=s.position))}function z3(e,t){return W2(e)?e.map(((e,n)=>t(e,n))):t(e,0)}function q3(e,t,n){return W2(e)?P3(e,t,n):e}function V3(e,t){if(W2(e))return e.find(((e,n)=>t(e,n)));return t(e,0)?e:void 0}function G3(e,t){const n=e.value,i=e.animation,r={delayTime:o3(i.delay)*z2,enable:i.enable,value:o3(e.value)*t,max:l3(n)*t,min:a3(n)*t,loops:0,maxLoops:o3(i.count),time:0};if(i.enable){switch(r.decay=1-o3(i.decay),i.mode){case m3.increase:r.status=g3.increasing;break;case m3.decrease:r.status=g3.decreasing;break;case m3.random:r.status=n3()>=.5?g3.increasing:g3.decreasing}const e=i.mode===m3.auto;switch(i.startValue){case x3.min:r.value=r.min,e&&(r.status=g3.increasing);break;case x3.max:r.value=r.max,e&&(r.status=g3.decreasing);break;case x3.random:default:r.value=s3(r),e&&(r.status=n3()>=.5?g3.increasing:g3.decreasing)}}return r.initialValue=r.value,r}function j3(e,t){if(!(e.mode===b3.percent)){const{mode:t}=e;return C(e,_3)}return"x"in e?{x:e.x/U2*t.width,y:e.y/U2*t.height}:{width:e.width/U2*t.width,height:e.height/U2*t.height}}function H3(e,t){return j3(e,t)}function W3(e,t,n,i,r){var s,o,a,l,c,u,h,d,p;if(e.destroyed||!t||!t.enable||(null!==(s=t.maxLoops)&&void 0!==s?s:0)>0&&(null!==(o=t.loops)&&void 0!==o?o:0)>(null!==(a=t.maxLoops)&&void 0!==a?a:0))return;const A=(null!==(l=t.velocity)&&void 0!==l?l:0)*r.factor,f=t.min,m=t.max,g=null!==(c=t.decay)&&void 0!==c?c:1;if(t.time||(t.time=0),(null!==(u=t.delayTime)&&void 0!==u?u:0)>0&&t.time<(null!==(h=t.delayTime)&&void 0!==h?h:0)&&(t.time+=r.value),!((null!==(d=t.delayTime)&&void 0!==d?d:0)>0&&t.time<(null!==(p=t.delayTime)&&void 0!==p?p:0))){switch(t.status){case g3.increasing:t.value>=m?(n?t.status=g3.decreasing:t.value-=m,t.loops||(t.loops=0),t.loops++):t.value+=A;break;case g3.decreasing:t.value<=f?(n?t.status=g3.increasing:t.value+=m,t.loops||(t.loops=0),t.loops++):t.value-=A}t.velocity&&1!==g&&(t.velocity*=g),function(e,t,n,i,r){switch(t){case v3.max:n>=r&&e.destroy();break;case v3.min:n<=i&&e.destroy()}}(e,i,t.value,f,m),e.destroyed||(t.value=i3(t.value,f,m))}}function X3(e,t){if(e.version!==t)throw new Error("The tsParticles version is different from the loaded plugins version. Engine version: ".concat(e.version,". Plugins version: ").concat(t))}var Y3;!function(e){e.darken="darken",e.enlighten="enlighten"}(Y3||(Y3={}));const Q3="random",K3="mid";function Z3(e,t){if(t)for(const n of e.colorManagers.values())if(t.startsWith(n.stringPrefix))return n.parseString(t)}function J3(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t)return;const r=G2(t)?{value:t}:t;if(G2(r.value))return $3(e,r.value,n,i);if(W2(r.value))return J3(e,{value:P3(r.value,n,i)});for(const s of e.colorManagers.values()){const e=s.handleRangeColor(r);if(e)return e}}function $3(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t)return;const r=G2(t)?{value:t}:t;if(G2(r.value))return r.value===Q3?i4():function(e,t){return Z3(e,t)}(e,r.value);if(W2(r.value))return $3(e,{value:P3(r.value,n,i)});for(const s of e.colorManagers.values()){const e=s.handleColor(r);if(e)return e}}function e4(e,t,n){const i=J3(e,t,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]);return i?t4(i):void 0}function t4(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),o={h:0,l:.5*(r+s),s:0};return r!==s&&(o.s=o.l<.5?(r-s)/(r+s):(r-s)/(2-r-s),o.h=t===r?(n-i)/(r-s):o.h=n===r?2+(i-t)/(r-s):4+(t-n)/(r-s)),o.l*=100,o.s*=100,o.h*=60,o.h<0&&(o.h+=360),o.h>=360&&(o.h-=360),o}function n4(e){const t=360,n=(e.h%t+t)%t,i=Math.max(0,Math.min(100,e.s)),r=n/t,s=i/100,o=Math.max(0,Math.min(100,e.l))/100,a=255;if(0===i){const e=Math.round(o*a);return{r:e,g:e,b:e}}const l=(e,t,n)=>{if(n<0&&n++,n>1&&n--,6*n<1)return e+6*(t-e)*n;if(2*n<1)return t;if(3*n<2){return e+(t-e)*(2/3-n)*6}return e},c=o<.5?o*(1+s):o+s-o*s,u=2*o-c,h=1/3,d=Math.min(a,a*l(u,c,r+h)),p=Math.min(a,a*l(u,c,r)),A=Math.min(a,a*l(u,c,r-h));return{r:Math.round(d),g:Math.round(p),b:Math.round(A)}}function i4(e){const t=null!==e&&void 0!==e?e:0;return{b:Math.floor(s3(c3(t,256))),g:Math.floor(s3(c3(t,256))),r:Math.floor(s3(c3(t,256)))}}function r4(e,t){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(null!==t&&void 0!==t?t:1,")")}function s4(e,t){return"hsla(".concat(e.h,", ").concat(e.s,"%, ").concat(e.l,"%, ").concat(null!==t&&void 0!==t?t:1,")")}function o4(e,t,n,i){let r=e,s=t;return void 0===r.r&&(r=n4(e)),void 0===s.r&&(s=n4(t)),{b:r3(r.b,s.b,n,i),g:r3(r.g,s.g,n,i),r:r3(r.r,s.r,n,i)}}function a4(e,t,n){if(n===Q3)return i4();if(n!==K3)return n;{var i,r;const n=null!==(i=e.getFillColor())&&void 0!==i?i:e.getStrokeColor(),s=null!==(r=null===t||void 0===t?void 0:t.getFillColor())&&void 0!==r?r:null===t||void 0===t?void 0:t.getStrokeColor();if(n&&s&&t)return o4(n,s,e.getRadius(),t.getRadius());{const e=null!==n&&void 0!==n?n:s;if(e)return n4(e)}}}function l4(e,t,n,i){const r=G2(t)?t:t.value;return r===Q3?i?J3(e,{value:r}):n?Q3:K3:r===K3?K3:J3(e,{value:r})}function c4(e){return void 0!==e?{h:e.h.value,s:e.s.value,l:e.l.value}:void 0}function u4(e,t,n){const i={h:{enable:!1,value:e.h},s:{enable:!1,value:e.s},l:{enable:!1,value:e.l}};return t&&(h4(i.h,t.h,n),h4(i.s,t.s,n),h4(i.l,t.l,n)),i}function h4(e,t,n){e.enable=t.enable;e.enable?(e.velocity=o3(t.speed)/U2*n,e.decay=1-o3(t.decay),e.status=g3.increasing,e.loops=0,e.maxLoops=o3(t.count),e.time=0,e.delayTime=o3(t.delay)*z2,t.sync||(e.velocity*=n3(),e.value*=n3()),e.initialValue=e.value,e.offset=c3(t.offset)):e.velocity=0}function d4(e,t,n,i){var r,s,o,a,l,c,u,h,d;if(!e||!e.enable||(null!==(r=e.maxLoops)&&void 0!==r?r:0)>0&&(null!==(s=e.loops)&&void 0!==s?s:0)>(null!==(o=e.maxLoops)&&void 0!==o?o:0))return;if(e.time||(e.time=0),(null!==(a=e.delayTime)&&void 0!==a?a:0)>0&&e.time<(null!==(l=e.delayTime)&&void 0!==l?l:0)&&(e.time+=i.value),(null!==(c=e.delayTime)&&void 0!==c?c:0)>0&&e.time<(null!==(u=e.delayTime)&&void 0!==u?u:0))return;const p=e.offset?s3(e.offset):0,A=(null!==(h=e.velocity)&&void 0!==h?h:0)*i.factor+3.6*p,f=null!==(d=e.decay)&&void 0!==d?d:1,m=l3(t),g=a3(t);if(n&&e.status!==g3.increasing){e.value-=A;const t=0;e.value<t&&(e.loops||(e.loops=0),e.loops++,e.status=g3.increasing)}else e.value+=A,e.value>m&&(e.loops||(e.loops=0),e.loops++,n?e.status=g3.decreasing:e.value-=m);e.velocity&&1!==f&&(e.velocity*=f),e.value=i3(e.value,g,m)}function p4(e,t){if(!e)return;const{h:n,s:i,l:r}=e,s={min:0,max:100},o={min:0,max:100};n&&d4(n,{min:0,max:360},!1,t),i&&d4(i,s,!0,t),r&&d4(r,o,!0,t)}const A4=0,f4=0,m4=1,g4=0,v4=0,y4=1;function b4(e,t,n){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.closePath()}function x4(e,t){e.clearRect(A4,f4,t.width,t.height)}function _4(e){var t,n,i,r,s,o,a;const{container:l,context:c,particle:u,delta:h,colorStyles:d,backgroundMask:p,composite:A,radius:f,opacity:m,shadow:g,transform:v}=e,y=u.getPosition(),b=u.rotation+(u.pathRotation?u.velocity.angle:0),x=Math.sin(b),_=Math.cos(b),w=!!b,S={a:_*(null!==(t=v.a)&&void 0!==t?t:m4),b:w?x*(null!==(n=v.b)&&void 0!==n?n:1):null!==(i=v.b)&&void 0!==i?i:g4,c:w?-x*(null!==(r=v.c)&&void 0!==r?r:1):null!==(s=v.c)&&void 0!==s?s:v4,d:_*(null!==(o=v.d)&&void 0!==o?o:y4)};c.setTransform(S.a,S.b,S.c,S.d,y.x,y.y),p&&(c.globalCompositeOperation=A);const T=u.shadowColor;g.enable&&T&&(c.shadowBlur=g.blur,c.shadowColor=r4(T),c.shadowOffsetX=g.offset.x,c.shadowOffsetY=g.offset.y),d.fill&&(c.fillStyle=d.fill);const E=null!==(a=u.strokeWidth)&&void 0!==a?a:0;c.lineWidth=E,d.stroke&&(c.strokeStyle=d.stroke);const C={container:l,context:c,particle:u,radius:f,opacity:m,delta:h,transformData:S,strokeWidth:E};!function(e){const{container:t,context:n,particle:i,radius:r,opacity:s,delta:o,strokeWidth:a,transformData:l}=e,c=0;if(!i.shape)return;const u=t.shapeDrawers.get(i.shape);if(!u)return;n.beginPath(),u.draw({context:n,particle:i,radius:r,opacity:s,delta:o,pixelRatio:t.retina.pixelRatio,transformData:M({},l)}),i.shapeClose&&n.closePath();a>c&&n.stroke();i.shapeFill&&n.fill()}(C),function(e){const{container:t,context:n,particle:i,radius:r,opacity:s,delta:o,transformData:a}=e;if(!i.shape)return;const l=t.shapeDrawers.get(i.shape);if(null===l||void 0===l||!l.afterDraw)return;l.afterDraw({context:n,particle:i,radius:r,opacity:s,delta:o,pixelRatio:t.retina.pixelRatio,transformData:M({},a)})}(C),function(e){const{container:t,context:n,particle:i,radius:r,opacity:s,delta:o,transformData:a}=e;if(!i.effect)return;const l=t.effectDrawers.get(i.effect);if(!l)return;l.draw({context:n,particle:i,radius:r,opacity:s,delta:o,pixelRatio:t.retina.pixelRatio,transformData:M({},a)})}(C),c.globalCompositeOperation="source-over",c.resetTransform()}function w4(e,t,n){const i=t[n];var r;void 0!==i&&(e[n]=(null!==(r=e[n])&&void 0!==r?r:1)*i)}function S4(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return;if(!e)return;const i=e.style;if(i)for(const r in t){const e=t[r];i.setProperty(r,e,n?"important":"")}}class T4{constructor(e,t){this.container=e,this._applyPostDrawUpdaters=e=>{for(const n of this._postDrawUpdaters){var t;null===(t=n.afterDraw)||void 0===t||t.call(n,e)}},this._applyPreDrawUpdaters=(e,t,n,i,r,s)=>{for(const a of this._preDrawUpdaters){var o;if(a.getColorStyles){const{fill:s,stroke:o}=a.getColorStyles(t,e,n,i);s&&(r.fill=s),o&&(r.stroke=o)}if(a.getTransformValues){const e=a.getTransformValues(t);for(const t in e)w4(s,e,t)}null===(o=a.beforeDraw)||void 0===o||o.call(a,t)}},this._applyResizePlugins=()=>{for(const t of this._resizePlugins){var e;null===(e=t.resize)||void 0===e||e.call(t)}},this._getPluginParticleColors=e=>{let t,n;for(const i of this._colorPlugins)if(!t&&i.particleFillColor&&(t=e4(this._engine,i.particleFillColor(e))),!n&&i.particleStrokeColor&&(n=e4(this._engine,i.particleStrokeColor(e))),t&&n)break;return[t,n]},this._initCover=async()=>{const e=this.container.actualOptions.backgroundMask.cover,t=e.color;if(t){const n=J3(this._engine,t);if(n){const t=M(M({},n),{},{a:e.opacity});this._coverColorStyle=r4(t,t.a)}}else await new Promise(((t,n)=>{if(!e.image)return;const i=document.createElement("img");i.addEventListener("load",(()=>{this._coverImage={image:i,opacity:e.opacity},t()})),i.addEventListener("error",(e=>{n(e.error)})),i.src=e.image}))},this._initStyle=()=>{const e=this.element,t=this.container.actualOptions;if(e){this._fullScreen?(this._originalStyle=L3({},e.style),this._setFullScreenStyle()):this._resetOriginalStyle();for(const n in t.style){if(!n||!t.style)continue;const i=t.style[n];i&&e.style.setProperty(n,i,"important")}}},this._initTrail=async()=>{const e=this.container.actualOptions.particles.move.trail,t=e.fill;if(!e.enable)return;const n=1/e.length;if(t.color){const e=J3(this._engine,t.color);if(!e)return;this._trailFill={color:M({},e),opacity:n}}else await new Promise(((e,i)=>{if(!t.image)return;const r=document.createElement("img");r.addEventListener("load",(()=>{this._trailFill={image:r,opacity:n},e()})),r.addEventListener("error",(e=>{i(e.error)})),r.src=t.image}))},this._paintBase=e=>{this.draw((t=>function(e,t,n){e.fillStyle=null!==n&&void 0!==n?n:"rgba(0,0,0,0)",e.fillRect(A4,f4,t.width,t.height)}(t,this.size,e)))},this._paintImage=(e,t)=>{this.draw((n=>function(e,t,n,i){n&&(e.globalAlpha=i,e.drawImage(n,A4,f4,t.width,t.height),e.globalAlpha=1)}(n,this.size,e,t)))},this._repairStyle=()=>{const e=this.element;e&&(this._safeMutationObserver((e=>e.disconnect())),this._initStyle(),this.initBackground(),this._safeMutationObserver((t=>{e&&e instanceof Node&&t.observe(e,{attributes:!0})})))},this._resetOriginalStyle=()=>{const e=this.element,t=this._originalStyle;e&&t&&S4(e,t)},this._safeMutationObserver=e=>{this._mutationObserver&&e(this._mutationObserver)},this._setFullScreenStyle=()=>{const e=this.element;if(!e)return;const t=this.container.actualOptions.fullScreen.zIndex.toString(10);S4(e,{position:"fixed","z-index":t,zIndex:t,top:"0",left:"0",width:"100%",height:"100%"},!0)},this._engine=t,this._standardSize={height:0,width:0};const n=e.retina.pixelRatio,i=this._standardSize;this.size={height:i.height*n,width:i.width*n},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){const e=this.container.actualOptions,t=e.particles.move.trail,n=this._trailFill;e.backgroundMask.enable?this.paint():t.enable&&t.length>0&&n?n.color?this._paintBase(r4(n.color,n.opacity)):n.image&&this._paintImage(n.image,n.opacity):e.clear&&this.draw((e=>{x4(e,this.size)}))}destroy(){if(this.stop(),this._generated){const e=this.element;null===e||void 0===e||e.remove()}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(e){const t=this._context;if(t)return e(t)}drawAsync(e){const t=this._context;if(t)return e(t)}drawParticle(e,t){var n;if(e.spawning||e.destroyed)return;const i=e.getRadius();if(i<=0)return;const r=e.getFillColor(),s=null!==(n=e.getStrokeColor())&&void 0!==n?n:r;let[o,a]=this._getPluginParticleColors(e);o||(o=r),a||(a=s),(o||a)&&this.draw((n=>{var r,s,l,c;const u=this.container,h=u.actualOptions,d=e.options.zIndex,p=1-e.zIndexFactor,A=p**d.opacityRate,f=null!==(r=null!==(s=e.bubble.opacity)&&void 0!==s?s:null===(l=e.opacity)||void 0===l?void 0:l.value)&&void 0!==r?r:1,m=f*A,g=(null!==(c=e.strokeOpacity)&&void 0!==c?c:f)*A,v={},y={fill:o?s4(o,m):void 0};y.stroke=a?s4(a,g):y.fill,this._applyPreDrawUpdaters(n,e,i,m,y,v),_4({container:u,context:n,particle:e,delta:t,colorStyles:y,backgroundMask:h.backgroundMask.enable,composite:h.backgroundMask.composite,radius:i*p**d.sizeRate,opacity:m,shadow:e.options.shadow,transform:v}),this._applyPostDrawUpdaters(e)}))}drawParticlePlugin(e,t,n){this.draw((i=>function(e,t,n,i){t.drawParticle&&t.drawParticle(e,n,i)}(i,e,t,n)))}drawPlugin(e,t){this.draw((n=>function(e,t,n){t.draw&&t.draw(e,n)}(n,e,t)))}async init(){this._safeMutationObserver((e=>e.disconnect())),this._mutationObserver=function(e){if(!M3()&&"undefined"!==typeof MutationObserver)return new MutationObserver(e)}((e=>{for(const t of e)"attributes"===t.type&&"style"===t.attributeName&&this._repairStyle()})),this.resize(),this._initStyle(),await this._initCover();try{await this._initTrail()}catch(e){S3().error(e)}this.initBackground(),this._safeMutationObserver((e=>{this.element&&this.element instanceof Node&&e.observe(this.element,{attributes:!0})})),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){const e=this.container.actualOptions.background,t=this.element;if(!t)return;const n=t.style;if(n){if(e.color){const t=J3(this._engine,e.color);n.backgroundColor=t?r4(t,e.opacity):""}else n.backgroundColor="";n.backgroundImage=e.image||"",n.backgroundPosition=e.position||"",n.backgroundRepeat=e.repeat||"",n.backgroundSize=e.size||""}}initPlugins(){this._resizePlugins=[];for(const t of this.container.plugins.values()){var e;t.resize&&this._resizePlugins.push(t),(null!==(e=t.particleFillColor)&&void 0!==e?e:t.particleStrokeColor)&&this._colorPlugins.push(t)}}initUpdaters(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];for(const n of this.container.particles.updaters){var e,t;n.afterDraw&&this._postDrawUpdaters.push(n),(null!==(e=null!==(t=n.getColorStyles)&&void 0!==t?t:n.getTransformValues)&&void 0!==e?e:n.beforeDraw)&&this._preDrawUpdaters.push(n)}}loadCanvas(e){this._generated&&this.element&&this.element.remove(),this._generated=e.dataset&&I2 in e.dataset?"true"===e.dataset[I2]:this._generated,this.element=e,this.element.ariaHidden="true",this._originalStyle=L3({},this.element.style);const t=this._standardSize;t.height=e.offsetHeight,t.width=e.offsetWidth;const n=this.container.retina.pixelRatio,i=this.size;e.height=i.height=t.height*n,e.width=i.width=t.width*n,this._context=this.element.getContext("2d"),this._safeMutationObserver((e=>{this.element&&this.element instanceof Node&&e.observe(this.element,{attributes:!0})})),this.container.retina.init(),this.initBackground()}paint(){const e=this.container.actualOptions;this.draw((t=>{e.backgroundMask.enable&&e.backgroundMask.cover?(x4(t,this.size),this._coverImage?this._paintImage(this._coverImage.image,this._coverImage.opacity):this._coverColorStyle?this._paintBase(this._coverColorStyle):this._paintBase()):this._paintBase()}))}resize(){if(!this.element)return!1;const e=this.container,t=e.canvas._standardSize,n={width:this.element.offsetWidth,height:this.element.offsetHeight},i=e.retina.pixelRatio,r={width:n.width*i,height:n.height*i};if(n.height===t.height&&n.width===t.width&&r.height===this.element.height&&r.width===this.element.width)return!1;const s=M({},t);t.height=n.height,t.width=n.width;const o=this.size;return this.element.width=o.width=r.width,this.element.height=o.height=r.height,this.container.started&&e.particles.setResizeFactor({width:t.width/s.width,height:t.height/s.height}),!0}stop(){this._safeMutationObserver((e=>e.disconnect())),this._mutationObserver=void 0,this.draw((e=>x4(e,this.size)))}async windowResize(){if(!this.element||!this.resize())return;const e=this.container,t=e.updateActualOptions();e.particles.setDensity(),this._applyResizePlugins(),t&&await e.refresh()}}var M4;!function(e){e.canvas="canvas",e.parent="parent",e.window="window"}(M4||(M4={}));function E4(e,t,n,i,r){if(i){let i={passive:!0};V2(r)?i.capture=r:void 0!==r&&(i=r),e.addEventListener(t,n,i)}else{const i=r;e.removeEventListener(t,n,i)}}class C4{constructor(e){this.container=e,this._doMouseTouchClick=e=>{const t=this.container,n=t.actualOptions;if(this._canPush){const e=t.interactivity.mouse,i=e.position;if(!i)return;e.clickPosition=M({},i),e.clickTime=(new Date).getTime();z3(n.interactivity.events.onClick.mode,(e=>this.container.handleClickMode(e)))}if("touchend"===e.type){setTimeout((()=>this._mouseTouchFinish()),500)}},this._handleThemeChange=e=>{const t=e,n=this.container,i=n.options,r=i.defaultThemes,s=t.matches?r.dark:r.light,o=i.themes.find((e=>e.name===s));null!==o&&void 0!==o&&o.default.auto&&n.loadTheme(s)},this._handleVisibilityChange=()=>{var e;const t=this.container,n=t.actualOptions;this._mouseTouchFinish(),n.pauseOnBlur&&(null!==(e=document)&&void 0!==e&&e.hidden?(t.pageHidden=!0,t.pause()):(t.pageHidden=!1,t.animationStatus?t.play(!0):t.draw(!0)))},this._handleWindowResize=()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout);const e=async()=>{const e=this.container.canvas;await(null===e||void 0===e?void 0:e.windowResize())};this._resizeTimeout=setTimeout((()=>{e()}),this.container.actualOptions.interactivity.events.resize.delay*z2)},this._manageInteractivityListeners=(e,t)=>{const n=this._handlers,i=this.container,r=i.actualOptions,s=i.interactivity.element;if(!s)return;const o=s,a=i.canvas.element;a&&(a.style.pointerEvents=o===a?"initial":"none"),(r.interactivity.events.onHover.enable||r.interactivity.events.onClick.enable)&&(E4(s,k2,n.mouseMove,t),E4(s,"touchstart",n.touchStart,t),E4(s,"touchmove",n.touchMove,t),r.interactivity.events.onClick.enable?(E4(s,B2,n.touchEndClick,t),E4(s,"pointerup",n.mouseUp,t),E4(s,"pointerdown",n.mouseDown,t)):E4(s,B2,n.touchEnd,t),E4(s,e,n.mouseLeave,t),E4(s,"touchcancel",n.touchCancel,t))},this._manageListeners=e=>{const t=this._handlers,n=this.container,i=n.actualOptions.interactivity.detectsOn,r=n.canvas.element;let s=O2;if(i===M4.window)n.interactivity.element=window,s="pointerout";else if(i===M4.parent&&r){var o;n.interactivity.element=null!==(o=r.parentElement)&&void 0!==o?o:r.parentNode}else n.interactivity.element=r;this._manageMediaMatch(e),this._manageResize(e),this._manageInteractivityListeners(s,e),document&&E4(document,"visibilitychange",t.visibilityChange,e,!1)},this._manageMediaMatch=e=>{const t=this._handlers,n=E3("(prefers-color-scheme: dark)");n&&(void 0===n.addEventListener?void 0!==n.addListener&&(e?n.addListener(t.oldThemeChange):n.removeListener(t.oldThemeChange)):E4(n,"change",t.themeChange,e))},this._manageResize=e=>{const t=this._handlers,n=this.container;if(!n.actualOptions.interactivity.events.resize)return;if("undefined"===typeof ResizeObserver)return void E4(window,"resize",t.resize,e);const i=n.canvas.element;this._resizeObserver&&!e?(i&&this._resizeObserver.unobserve(i),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&e&&i&&(this._resizeObserver=new ResizeObserver((e=>{e.find((e=>e.target===i))&&this._handleWindowResize()})),this._resizeObserver.observe(i))},this._mouseDown=()=>{const{interactivity:e}=this.container;if(!e)return;const{mouse:t}=e;t.clicking=!0,t.downPosition=t.position},this._mouseTouchClick=e=>{const t=this.container,n=t.actualOptions,{mouse:i}=t.interactivity;i.inside=!0;let r=!1;const s=i.position;if(s&&n.interactivity.events.onClick.enable){for(const e of t.plugins.values())if(e.clickPositionValid&&(r=e.clickPositionValid(s),r))break;r||this._doMouseTouchClick(e),i.clicking=!1}},this._mouseTouchFinish=()=>{const e=this.container.interactivity;if(!e)return;const t=e.mouse;delete t.position,delete t.clickPosition,delete t.downPosition,e.status=O2,t.inside=!1,t.clicking=!1},this._mouseTouchMove=e=>{const t=this.container,n=t.actualOptions,i=t.interactivity,r=t.canvas.element;if(null===i||void 0===i||!i.element)return;let s;if(i.mouse.inside=!0,e.type.startsWith("pointer")){this._canPush=!0;const t=e;if(i.element===window){if(r){const e=r.getBoundingClientRect();s={x:t.clientX-e.left,y:t.clientY-e.top}}}else if(n.interactivity.detectsOn===M4.parent){const e=t.target,n=t.currentTarget;if(e&&n&&r){const i=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=r.getBoundingClientRect();s={x:t.offsetX+2*i.left-(o.left+a.left),y:t.offsetY+2*i.top-(o.top+a.top)}}else{var o,a;s={x:null!==(o=t.offsetX)&&void 0!==o?o:t.clientX,y:null!==(a=t.offsetY)&&void 0!==a?a:t.clientY}}}else if(t.target===r){var l,c;s={x:null!==(l=t.offsetX)&&void 0!==l?l:t.clientX,y:null!==(c=t.offsetY)&&void 0!==c?c:t.clientY}}}else if(this._canPush="touchmove"!==e.type,r){var u,h;const t=e,n=1,i=t.touches[t.touches.length-n],o=r.getBoundingClientRect(),a=0;s={x:i.clientX-(null!==(u=o.left)&&void 0!==u?u:a),y:i.clientY-(null!==(h=o.top)&&void 0!==h?h:a)}}const d=t.retina.pixelRatio;s&&(s.x*=d,s.y*=d),i.mouse.position=s,i.status=k2},this._touchEnd=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.delete(i.identifier);this._mouseTouchFinish()},this._touchEndClick=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.delete(i.identifier);this._mouseTouchClick(e)},this._touchStart=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.set(i.identifier,performance.now());this._mouseTouchMove(e)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:e=>this._mouseTouchMove(e),mouseUp:e=>this._mouseTouchClick(e),touchStart:e=>this._touchStart(e),touchMove:e=>this._mouseTouchMove(e),touchEnd:e=>this._touchEnd(e),touchCancel:e=>this._touchEnd(e),touchEndClick:e=>this._touchEndClick(e),visibilityChange:()=>this._handleVisibilityChange(),themeChange:e=>this._handleThemeChange(e),oldThemeChange:e=>this._handleThemeChange(e),resize:()=>{this._handleWindowResize()}}}addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}}var R4,P4;!function(e){e.configAdded="configAdded",e.containerInit="containerInit",e.particlesSetup="particlesSetup",e.containerStarted="containerStarted",e.containerStopped="containerStopped",e.containerDestroyed="containerDestroyed",e.containerPaused="containerPaused",e.containerPlay="containerPlay",e.containerBuilt="containerBuilt",e.particleAdded="particleAdded",e.particleDestroyed="particleDestroyed",e.particleRemoved="particleRemoved"}(R4||(R4={}));class N4{constructor(){this.value=""}static create(e,t){const n=new N4;return n.load(e),void 0!==t&&(G2(t)||W2(t)?n.load({value:t}):n.load(t)),n}load(e){X2(e)||X2(e.value)||(this.value=e.value)}}class D4{constructor(){this.color=new N4,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}load(e){X2(e)||(void 0!==e.color&&(this.color=N4.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.position&&(this.position=e.position),void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.size&&(this.size=e.size),void 0!==e.opacity&&(this.opacity=e.opacity))}}class L4{constructor(){this.opacity=1}load(e){X2(e)||(void 0!==e.color&&(this.color=N4.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.opacity&&(this.opacity=e.opacity))}}class I4{constructor(){this.composite="destination-out",this.cover=new L4,this.enable=!1}load(e){if(!X2(e)){if(void 0!==e.composite&&(this.composite=e.composite),void 0!==e.cover){const t=e.cover,n=G2(e.cover)?{color:e.cover}:e.cover;this.cover.load(void 0!==t.color||void 0!==t.image?t:{color:n})}void 0!==e.enable&&(this.enable=e.enable)}}}class O4{constructor(){this.enable=!0,this.zIndex=0}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.zIndex&&(this.zIndex=e.zIndex))}}class k4{constructor(){this.enable=!1,this.mode=[]}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode))}}!function(e){e.circle="circle",e.rectangle="rectangle"}(P4||(P4={}));class B4{constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type=P4.circle}load(e){X2(e)||(void 0!==e.selectors&&(this.selectors=e.selectors),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.type&&(this.type=e.type))}}class F4{constructor(){this.enable=!1,this.force=2,this.smooth=10}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.force&&(this.force=e.force),void 0!==e.smooth&&(this.smooth=e.smooth))}}class U4{constructor(){this.enable=!1,this.mode=[],this.parallax=new F4}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),this.parallax.load(e.parallax))}}class z4{constructor(){this.delay=.5,this.enable=!0}load(e){X2(e)||(void 0!==e.delay&&(this.delay=e.delay),void 0!==e.enable&&(this.enable=e.enable))}}class q4{constructor(){this.onClick=new k4,this.onDiv=new B4,this.onHover=new U4,this.resize=new z4}load(e){if(X2(e))return;this.onClick.load(e.onClick);const t=e.onDiv;void 0!==t&&(this.onDiv=z3(t,(e=>{const t=new B4;return t.load(e),t}))),this.onHover.load(e.onHover),this.resize.load(e.resize)}}class V4{constructor(e,t){this._engine=e,this._container=t}load(e){if(X2(e))return;if(!this._container)return;const t=this._engine.interactors.get(this._container);if(t)for(const n of t)n.loadModeOptions&&n.loadModeOptions(this,e)}}class G4{constructor(e,t){this.detectsOn=M4.window,this.events=new q4,this.modes=new V4(e,t)}load(e){if(X2(e))return;const t=e.detectsOn;void 0!==t&&(this.detectsOn=t),this.events.load(e.events),this.modes.load(e.modes)}}class j4{load(e){if(!X2(e)){var t,n,i;if(e.position)this.position={x:null!==(t=e.position.x)&&void 0!==t?t:50,y:null!==(n=e.position.y)&&void 0!==n?n:50,mode:null!==(i=e.position.mode)&&void 0!==i?i:b3.percent};e.options&&(this.options=L3({},e.options))}}}var H4,W4,X4,Y4,Q4,K4,Z4;!function(e){e.screen="screen",e.canvas="canvas"}(H4||(H4={}));class J4{constructor(){this.maxWidth=1/0,this.options={},this.mode=H4.canvas}load(e){X2(e)||(X2(e.maxWidth)||(this.maxWidth=e.maxWidth),X2(e.mode)||(e.mode===H4.screen?this.mode=H4.screen:this.mode=H4.canvas),X2(e.options)||(this.options=L3({},e.options)))}}!function(e){e.any="any",e.dark="dark",e.light="light"}(W4||(W4={}));class $4{constructor(){this.auto=!1,this.mode=W4.any,this.value=!1}load(e){X2(e)||(void 0!==e.auto&&(this.auto=e.auto),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}class e5{constructor(){this.name="",this.default=new $4}load(e){X2(e)||(void 0!==e.name&&(this.name=e.name),this.default.load(e.default),void 0!==e.options&&(this.options=L3({},e.options)))}}class t5{constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}load(e){X2(e)||(void 0!==e.count&&(this.count=c3(e.count)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=c3(e.speed)),void 0!==e.decay&&(this.decay=c3(e.decay)),void 0!==e.delay&&(this.delay=c3(e.delay)),void 0!==e.sync&&(this.sync=e.sync))}}class n5 extends t5{constructor(){super(),this.mode=m3.auto,this.startValue=x3.random}load(e){super.load(e),X2(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.startValue&&(this.startValue=e.startValue))}}class i5 extends t5{constructor(){super(),this.offset=0,this.sync=!0}load(e){super.load(e),X2(e)||void 0!==e.offset&&(this.offset=c3(e.offset))}}class r5{constructor(){this.h=new i5,this.s=new i5,this.l=new i5}load(e){X2(e)||(this.h.load(e.h),this.s.load(e.s),this.l.load(e.l))}}class s5 extends N4{constructor(){super(),this.animation=new r5}static create(e,t){const n=new s5;return n.load(e),void 0!==t&&(G2(t)||W2(t)?n.load({value:t}):n.load(t)),n}load(e){if(super.load(e),X2(e))return;const t=e.animation;void 0!==t&&(void 0!==t.enable?this.animation.h.load(t):this.animation.load(e.animation))}}!function(e){e.absorb="absorb",e.bounce="bounce",e.destroy="destroy"}(X4||(X4={}));class o5{constructor(){this.speed=2}load(e){X2(e)||void 0!==e.speed&&(this.speed=e.speed)}}class a5{constructor(){this.enable=!0,this.retries=0}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.retries&&(this.retries=e.retries))}}class l5{constructor(){this.value=0}load(e){X2(e)||X2(e.value)||(this.value=c3(e.value))}}class c5 extends l5{constructor(){super(),this.animation=new t5}load(e){if(super.load(e),X2(e))return;const t=e.animation;void 0!==t&&this.animation.load(t)}}class u5 extends c5{constructor(){super(),this.animation=new n5}load(e){super.load(e)}}class h5 extends l5{constructor(){super(),this.value=1}}class d5{constructor(){this.horizontal=new h5,this.vertical=new h5}load(e){X2(e)||(this.horizontal.load(e.horizontal),this.vertical.load(e.vertical))}}class p5{constructor(){this.absorb=new o5,this.bounce=new d5,this.enable=!1,this.maxSpeed=50,this.mode=X4.bounce,this.overlap=new a5}load(e){X2(e)||(this.absorb.load(e.absorb),this.bounce.load(e.bounce),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.maxSpeed&&(this.maxSpeed=c3(e.maxSpeed)),void 0!==e.mode&&(this.mode=e.mode),this.overlap.load(e.overlap))}}class A5{constructor(){this.close=!0,this.fill=!0,this.options={},this.type=[]}load(e){if(X2(e))return;const t=e.options;if(void 0!==t)for(const i in t){const e=t[i];var n;if(e)this.options[i]=L3(null!==(n=this.options[i])&&void 0!==n?n:{},e)}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}class f5{constructor(){this.offset=0,this.value=90}load(e){X2(e)||(void 0!==e.offset&&(this.offset=c3(e.offset)),void 0!==e.value&&(this.value=c3(e.value)))}}class m5{constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}load(e){if(!X2(e)&&(void 0!==e.distance&&(this.distance=c3(e.distance)),void 0!==e.enable&&(this.enable=e.enable),e.rotate)){const t=e.rotate.x;void 0!==t&&(this.rotate.x=t);const n=e.rotate.y;void 0!==n&&(this.rotate.y=n)}}}class g5{constructor(){this.x=50,this.y=50,this.mode=b3.percent,this.radius=0}load(e){X2(e)||(void 0!==e.x&&(this.x=e.x),void 0!==e.y&&(this.y=e.y),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.radius&&(this.radius=e.radius))}}class v5{constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}load(e){X2(e)||(void 0!==e.acceleration&&(this.acceleration=c3(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.inverse&&(this.inverse=e.inverse),void 0!==e.maxSpeed&&(this.maxSpeed=c3(e.maxSpeed)))}}class y5{constructor(){this.clamp=!0,this.delay=new l5,this.enable=!1,this.options={}}load(e){X2(e)||(void 0!==e.clamp&&(this.clamp=e.clamp),this.delay.load(e.delay),void 0!==e.enable&&(this.enable=e.enable),this.generator=e.generator,e.options&&(this.options=L3(this.options,e.options)))}}class b5{load(e){X2(e)||(void 0!==e.color&&(this.color=N4.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image))}}class x5{constructor(){this.enable=!1,this.length=10,this.fill=new b5}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.fill&&this.fill.load(e.fill),void 0!==e.length&&(this.length=e.length))}}!function(e){e.bounce="bounce",e.none="none",e.out="out",e.destroy="destroy",e.split="split"}(Y4||(Y4={}));class _5{constructor(){this.default=Y4.out}load(e){var t,n,i,r;X2(e)||(void 0!==e.default&&(this.default=e.default),this.bottom=null!==(t=e.bottom)&&void 0!==t?t:e.default,this.left=null!==(n=e.left)&&void 0!==n?n:e.default,this.right=null!==(i=e.right)&&void 0!==i?i:e.default,this.top=null!==(r=e.top)&&void 0!==r?r:e.default)}}class w5{constructor(){this.acceleration=0,this.enable=!1}load(e){X2(e)||(void 0!==e.acceleration&&(this.acceleration=c3(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),e.position&&(this.position=L3({},e.position)))}}class S5{constructor(){this.angle=new f5,this.attract=new m5,this.center=new g5,this.decay=0,this.distance={},this.direction=q2.none,this.drift=0,this.enable=!1,this.gravity=new v5,this.path=new y5,this.outModes=new _5,this.random=!1,this.size=!1,this.speed=2,this.spin=new w5,this.straight=!1,this.trail=new x5,this.vibrate=!1,this.warp=!1}load(e){if(X2(e))return;this.angle.load(j2(e.angle)?{value:e.angle}:e.angle),this.attract.load(e.attract),this.center.load(e.center),void 0!==e.decay&&(this.decay=c3(e.decay)),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.distance&&(this.distance=j2(e.distance)?{horizontal:e.distance,vertical:e.distance}:M({},e.distance)),void 0!==e.drift&&(this.drift=c3(e.drift)),void 0!==e.enable&&(this.enable=e.enable),this.gravity.load(e.gravity);const t=e.outModes;void 0!==t&&(H2(t)?this.outModes.load(t):this.outModes.load({default:t})),this.path.load(e.path),void 0!==e.random&&(this.random=e.random),void 0!==e.size&&(this.size=e.size),void 0!==e.speed&&(this.speed=c3(e.speed)),this.spin.load(e.spin),void 0!==e.straight&&(this.straight=e.straight),this.trail.load(e.trail),void 0!==e.vibrate&&(this.vibrate=e.vibrate),void 0!==e.warp&&(this.warp=e.warp)}}class T5 extends n5{constructor(){super(),this.destroy=v3.none,this.speed=2}load(e){super.load(e),X2(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}class M5 extends u5{constructor(){super(),this.animation=new T5,this.value=1}load(e){if(X2(e))return;super.load(e);const t=e.animation;void 0!==t&&this.animation.load(t)}}class E5{constructor(){this.enable=!1,this.width=1920,this.height=1080}load(e){if(X2(e))return;void 0!==e.enable&&(this.enable=e.enable);const t=e.width;void 0!==t&&(this.width=t);const n=e.height;void 0!==n&&(this.height=n)}}!function(e){e.delete="delete",e.wait="wait"}(Q4||(Q4={}));class C5{constructor(){this.mode=Q4.delete,this.value=0}load(e){X2(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}class R5{constructor(){this.density=new E5,this.limit=new C5,this.value=0}load(e){X2(e)||(this.density.load(e.density),this.limit.load(e.limit),void 0!==e.value&&(this.value=e.value))}}class P5{constructor(){this.blur=0,this.color=new N4,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}load(e){X2(e)||(void 0!==e.blur&&(this.blur=e.blur),this.color=N4.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.offset&&(void 0!==e.offset.x&&(this.offset.x=e.offset.x),void 0!==e.offset.y&&(this.offset.y=e.offset.y)))}}class N5{constructor(){this.close=!0,this.fill=!0,this.options={},this.type="circle"}load(e){if(X2(e))return;const t=e.options;if(void 0!==t)for(const i in t){const e=t[i];var n;if(e)this.options[i]=L3(null!==(n=this.options[i])&&void 0!==n?n:{},e)}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}class D5 extends n5{constructor(){super(),this.destroy=v3.none,this.speed=5}load(e){super.load(e),X2(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}class L5 extends u5{constructor(){super(),this.animation=new D5,this.value=3}load(e){if(super.load(e),X2(e))return;const t=e.animation;void 0!==t&&this.animation.load(t)}}class I5{constructor(){this.width=0}load(e){X2(e)||(void 0!==e.color&&(this.color=s5.create(this.color,e.color)),void 0!==e.width&&(this.width=c3(e.width)),void 0!==e.opacity&&(this.opacity=c3(e.opacity)))}}class O5 extends l5{constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}load(e){super.load(e),X2(e)||(void 0!==e.opacityRate&&(this.opacityRate=e.opacityRate),void 0!==e.sizeRate&&(this.sizeRate=e.sizeRate),void 0!==e.velocityRate&&(this.velocityRate=e.velocityRate))}}class k5{constructor(e,t){this._engine=e,this._container=t,this.bounce=new d5,this.collisions=new p5,this.color=new s5,this.color.value="#fff",this.effect=new A5,this.groups={},this.move=new S5,this.number=new R5,this.opacity=new M5,this.reduceDuplicates=!1,this.shadow=new P5,this.shape=new N5,this.size=new L5,this.stroke=new I5,this.zIndex=new O5}load(e){if(X2(e))return;if(void 0!==e.groups)for(const i of Object.keys(e.groups)){if(!Object.hasOwn(e.groups,i))continue;const n=e.groups[i];var t;if(void 0!==n)this.groups[i]=L3(null!==(t=this.groups[i])&&void 0!==t?t:{},n)}void 0!==e.reduceDuplicates&&(this.reduceDuplicates=e.reduceDuplicates),this.bounce.load(e.bounce),this.color.load(s5.create(this.color,e.color)),this.effect.load(e.effect),this.move.load(e.move),this.number.load(e.number),this.opacity.load(e.opacity),this.shape.load(e.shape),this.size.load(e.size),this.shadow.load(e.shadow),this.zIndex.load(e.zIndex),this.collisions.load(e.collisions),void 0!==e.interactivity&&(this.interactivity=L3({},e.interactivity));const n=e.stroke;if(n&&(this.stroke=z3(n,(e=>{const t=new I5;return t.load(e),t}))),this._container){const t=this._engine.updaters.get(this._container);if(t)for(const i of t)i.loadOptions&&i.loadOptions(this,e);const n=this._engine.interactors.get(this._container);if(n)for(const i of n)i.loadParticlesOptions&&i.loadParticlesOptions(this,e)}}}function B5(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.load(r)}function F5(e,t){const n=new k5(e,t);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return B5(n,...r),n}class U5{constructor(e,t){this._findDefaultTheme=e=>{var t;return null!==(t=this.themes.find((t=>t.default.value&&t.default.mode===e)))&&void 0!==t?t:this.themes.find((e=>e.default.value&&e.default.mode===W4.any))},this._importPreset=e=>{this.load(this._engine.getPreset(e))},this._engine=e,this._container=t,this.autoPlay=!0,this.background=new D4,this.backgroundMask=new I4,this.clear=!0,this.defaultThemes={},this.delay=0,this.fullScreen=new O4,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new G4(e,t),this.manualParticles=[],this.particles=F5(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}load(e){var t,n;if(X2(e))return;void 0!==e.preset&&z3(e.preset,(e=>this._importPreset(e))),void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.clear&&(this.clear=e.clear),void 0!==e.key&&(this.key=e.key),void 0!==e.name&&(this.name=e.name),void 0!==e.delay&&(this.delay=c3(e.delay));const i=e.detectRetina;void 0!==i&&(this.detectRetina=i),void 0!==e.duration&&(this.duration=c3(e.duration));const r=e.fpsLimit;void 0!==r&&(this.fpsLimit=r),void 0!==e.pauseOnBlur&&(this.pauseOnBlur=e.pauseOnBlur),void 0!==e.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=e.pauseOnOutsideViewport),void 0!==e.zLayers&&(this.zLayers=e.zLayers),this.background.load(e.background);const s=e.fullScreen;V2(s)?this.fullScreen.enable=s:this.fullScreen.load(s),this.backgroundMask.load(e.backgroundMask),this.interactivity.load(e.interactivity),e.manualParticles&&(this.manualParticles=e.manualParticles.map((e=>{const t=new j4;return t.load(e),t}))),this.particles.load(e.particles),this.style=L3(this.style,e.style),this._engine.loadOptions(this,e),void 0!==e.smooth&&(this.smooth=e.smooth);const o=this._engine.interactors.get(this._container);if(o)for(const a of o)a.loadOptions&&a.loadOptions(this,e);if(void 0!==e.responsive)for(const a of e.responsive){const e=new J4;e.load(a),this.responsive.push(e)}if(this.responsive.sort(((e,t)=>e.maxWidth-t.maxWidth)),void 0!==e.themes)for(const a of e.themes){const e=this.themes.find((e=>e.name===a.name));if(e)e.load(a);else{const e=new e5;e.load(a),this.themes.push(e)}}this.defaultThemes.dark=null===(t=this._findDefaultTheme(W4.dark))||void 0===t?void 0:t.name,this.defaultThemes.light=null===(n=this._findDefaultTheme(W4.light))||void 0===n?void 0:n.name}setResponsive(e,t,n){this.load(n);const i=this.responsive.find((n=>n.mode===H4.screen&&screen?n.maxWidth>screen.availWidth:n.maxWidth*t>e));return this.load(null===i||void 0===i?void 0:i.options),null===i||void 0===i?void 0:i.maxWidth}setTheme(e){if(e){const t=this.themes.find((t=>t.name===e));t&&this.load(t.options)}else{const e=E3("(prefers-color-scheme: dark)"),t=null===e||void 0===e?void 0:e.matches,n=this._findDefaultTheme(t?W4.dark:W4.light);n&&this.load(n.options)}}}!function(e){e.external="external",e.particles="particles"}(K4||(K4={}));class z5{constructor(e,t){this.container=t,this._engine=e,this._interactors=[],this._externalInteractors=[],this._particleInteractors=[]}externalInteract(e){for(const t of this._externalInteractors)t.isEnabled()&&t.interact(e)}handleClickMode(e){for(const n of this._externalInteractors){var t;null===(t=n.handleClickMode)||void 0===t||t.call(n,e)}}async init(){this._interactors=await this._engine.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[];for(const e of this._interactors){switch(e.type){case K4.external:this._externalInteractors.push(e);break;case K4.particles:this._particleInteractors.push(e)}e.init()}}particlesInteract(e,t){for(const n of this._externalInteractors)n.clear(e,t);for(const n of this._particleInteractors)n.isEnabled(e)&&n.interact(e,t)}reset(e){for(const t of this._externalInteractors)t.isEnabled()&&t.reset(e);for(const t of this._particleInteractors)t.isEnabled(e)&&t.reset(e)}}!function(e){e.normal="normal",e.inside="inside",e.outside="outside"}(Z4||(Z4={}));const q5=.5,V5="random";function G5(e){if(!C3(e.outMode,e.checkModes))return;const t=2*e.radius;e.coord>e.maxCoord-t?e.setCb(-e.radius):e.coord<t&&e.setCb(e.radius)}class j5{constructor(e,t){var n=this;this.container=t,this._calcPosition=function(e,t,i){var r,s,o,a;let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(const f of e.plugins.values()){const e=void 0!==f.particlePosition?f.particlePosition(t,n):void 0;if(e)return Z2.create(e.x,e.y,i)}const c=A3({size:e.canvas.size,position:t}),u=Z2.create(c.x,c.y,i),h=n.getRadius(),d=n.options.move.outModes,p=t=>{G5({outMode:t,checkModes:[Y4.bounce],coord:u.x,maxCoord:e.canvas.size.width,setCb:e=>u.x+=e,radius:h})},A=t=>{G5({outMode:t,checkModes:[Y4.bounce],coord:u.y,maxCoord:e.canvas.size.height,setCb:e=>u.y+=e,radius:h})};if(p(null!==(r=d.left)&&void 0!==r?r:d.default),p(null!==(s=d.right)&&void 0!==s?s:d.default),A(null!==(o=d.top)&&void 0!==o?o:d.default),A(null!==(a=d.bottom)&&void 0!==a?a:d.default),n._checkOverlap(u,l)){const t=1;return n._calcPosition(e,void 0,i,l+t)}return u},this._calculateVelocity=()=>{const e=function(e){const t=J2.origin;return t.length=1,t.angle=e,t}(this.direction),t=e.copy(),n=this.options.move;if(n.direction===q2.inside||n.direction===q2.outside)return t;const i=d3(o3(n.angle.value)),r=d3(o3(n.angle.offset)),s={left:r-i*q5,right:r+i*q5};return n.straight||(t.angle+=s3(c3(s.left,s.right))),n.random&&"number"===typeof n.speed&&(t.length*=n3()),t},this._checkOverlap=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=n.options.collisions,r=n.getRadius();if(!i.enable)return!1;const s=i.overlap;if(s.enable)return!1;const o=s.retries;if(o>=0&&t>o)throw new Error("".concat(F2," particle is overlapping and can't be placed"));return!!n.container.particles.find((t=>h3(e,t.position)<r+t.getRadius()))},this._getRollColor=e=>{var t;if(!e||!this.roll||!this.backColor&&!this.roll.alter)return e;const n=this.roll.horizontal&&this.roll.vertical?2:1,i=this.roll.horizontal?Math.PI*q5:0;return Math.floor(((null!==(t=this.roll.angle)&&void 0!==t?t:0)+i)/(Math.PI/n))%2?this.backColor?this.backColor:this.roll.alter?function(e,t,n){return{h:e.h,s:e.s,l:e.l+(t===Y3.darken?-1:1)*n}}(e,this.roll.alter.type,this.roll.alter.value):e:e},this._initPosition=e=>{var t,n;const i=this.container,r=o3(this.options.zIndex.value);this.position=this._calcPosition(i,e,i3(r,0,i.zLayers)),this.initialPosition=this.position.copy();const s=i.canvas.size;switch(this.moveCenter=M(M({},H3(this.options.move.center,s)),{},{radius:null!==(t=this.options.move.center.radius)&&void 0!==t?t:0,mode:null!==(n=this.options.move.center.mode)&&void 0!==n?n:b3.percent}),this.direction=function(e,t,n){if(j2(e))return d3(e);const i=.25;switch(e){case q2.top:return.5*-Math.PI;case q2.topRight:return-Math.PI*i;case q2.right:return 0;case q2.bottomRight:return Math.PI*i;case q2.bottom:return.5*Math.PI;case q2.bottomLeft:return.75*Math.PI;case q2.left:return Math.PI;case q2.topLeft:return.75*-Math.PI;case q2.inside:return Math.atan2(n.y-t.y,n.x-t.x);case q2.outside:return Math.atan2(t.y-n.y,t.x-n.x);default:return n3()*t3}}(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case q2.inside:this.outType=Z4.inside;break;case q2.outside:this.outType=Z4.outside}this.offset=J2.origin},this._engine=e}destroy(e){var t;if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;const n=this.container,i=this.pathGenerator,r=n.shapeDrawers.get(this.shape);null===r||void 0===r||null===(t=r.particleDestroy)||void 0===t||t.call(r,this);for(const a of n.plugins.values()){var s;null===(s=a.particleDestroyed)||void 0===s||s.call(a,this,e)}for(const a of n.particles.updaters){var o;null===(o=a.particleDestroyed)||void 0===o||o.call(a,this,e)}null===i||void 0===i||i.reset(this),this._engine.dispatchEvent(R4.particleDestroyed,{container:this.container,data:{particle:this}})}draw(e){const t=this.container,n=t.canvas;for(const i of t.plugins.values())n.drawParticlePlugin(i,this,e);n.drawParticle(this,e)}getFillColor(){var e;return this._getRollColor(null!==(e=this.bubble.color)&&void 0!==e?e:c4(this.color))}getMass(){return this.getRadius()**2*Math.PI*q5}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){var e;return null!==(e=this.bubble.radius)&&void 0!==e?e:this.size.value}getStrokeColor(){var e;return this._getRollColor(null!==(e=this.bubble.color)&&void 0!==e?e:c4(this.strokeColor))}init(e,t,n,i){var r,s,o,a,l,c,u,h,d,p,A;const f=this.container,m=this._engine;this.id=e,this.group=i,this.effectClose=!0,this.effectFill=!0,this.shapeClose=!0,this.shapeFill=!0,this.pathRotation=!1,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.isRotating=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType=Z4.normal,this.ignoresResizeRatio=!0;const g=f.retina.pixelRatio,v=f.actualOptions,y=F5(this._engine,f,v.particles),{reduceDuplicates:b}=y,x=y.effect.type,_=y.shape.type;this.effect=q3(x,this.id,b),this.shape=q3(_,this.id,b);const w=y.effect,S=y.shape;if(n){var T,M;if(null!==(T=n.effect)&&void 0!==T&&T.type){const e=q3(n.effect.type,this.id,b);e&&(this.effect=e,w.load(n.effect))}if(null!==(M=n.shape)&&void 0!==M&&M.type){const e=q3(n.shape.type,this.id,b);e&&(this.shape=e,S.load(n.shape))}}if(this.effect===V5){const e=[...this.container.effectDrawers.keys()];this.effect=e[Math.floor(Math.random()*e.length)]}if(this.shape===V5){const e=[...this.container.shapeDrawers.keys()];this.shape=e[Math.floor(Math.random()*e.length)]}this.effectData=function(e,t,n,i){const r=t.options[e];if(r)return L3({close:t.close,fill:t.fill},q3(r,n,i))}(this.effect,w,this.id,b),this.shapeData=function(e,t,n,i){const r=t.options[e];if(r)return L3({close:t.close,fill:t.fill},q3(r,n,i))}(this.shape,S,this.id,b),y.load(n);const E=this.effectData;E&&y.load(E.particles);const C=this.shapeData;C&&y.load(C.particles);const R=new G4(m,f);R.load(f.actualOptions.interactivity),R.load(y.interactivity),this.interactivity=R,this.effectFill=null!==(r=null===E||void 0===E?void 0:E.fill)&&void 0!==r?r:y.effect.fill,this.effectClose=null!==(s=null===E||void 0===E?void 0:E.close)&&void 0!==s?s:y.effect.close,this.shapeFill=null!==(o=null===C||void 0===C?void 0:C.fill)&&void 0!==o?o:y.shape.fill,this.shapeClose=null!==(a=null===C||void 0===C?void 0:C.close)&&void 0!==a?a:y.shape.close,this.options=y;const P=this.options.move.path;this.pathDelay=o3(P.delay.value)*z2,P.generator&&(this.pathGenerator=this._engine.getPathGenerator(P.generator),this.pathGenerator&&f.addPath(P.generator,this.pathGenerator)&&this.pathGenerator.init(f)),f.retina.initParticle(this),this.size=G3(this.options.size,g),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(t),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy();this.moveDecay=1-o3(this.options.move.decay);const N=f.particles;N.setLastZIndex(this.position.z),this.zIndexFactor=this.position.z/f.zLayers,this.sides=24;let D=f.effectDrawers.get(this.effect);D||(D=this._engine.getEffectDrawer(this.effect),D&&f.effectDrawers.set(this.effect,D)),null!==(l=D)&&void 0!==l&&l.loadEffect&&D.loadEffect(this);let L=f.shapeDrawers.get(this.shape);L||(L=this._engine.getShapeDrawer(this.shape),L&&f.shapeDrawers.set(this.shape,L)),null!==(c=L)&&void 0!==c&&c.loadShape&&L.loadShape(this);const I=null===(u=L)||void 0===u?void 0:u.getSidesCount;I&&(this.sides=I(this)),this.spawning=!1,this.shadowColor=J3(this._engine,this.options.shadow.color);for(const B of N.updaters)B.init(this);for(const B of N.movers){var O;null===(O=B.init)||void 0===O||O.call(B,this)}null===(h=D)||void 0===h||null===(d=h.particleInit)||void 0===d||d.call(h,f,this),null===(p=L)||void 0===p||null===(A=p.particleInit)||void 0===A||A.call(p,f,this);for(const B of f.plugins.values()){var k;null===(k=B.particleCreated)||void 0===k||k.call(B,this)}}isInsideCanvas(){const e=this.getRadius(),t=this.container.canvas.size,n=this.position;return n.x>=-e&&n.y>=-e&&n.y<=t.height+e&&n.x<=t.width+e}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){for(const t of this.container.particles.updaters){var e;null===(e=t.reset)||void 0===e||e.call(t,this)}}}class H5{constructor(e,t){this.position=e,this.particle=t}}var W5;!function(e){e.circle="circle",e.rectangle="rectangle"}(W5||(W5={}));class X5{constructor(e,t,n){this.position={x:e,y:t},this.type=n}}class Y5 extends X5{constructor(e,t,n){super(e,t,W5.circle),this.radius=n}contains(e){return h3(e,this.position)<=this.radius}intersects(e){const t=this.position,n=e.position,i=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y),s=this.radius;if(e instanceof Y5||e.type===W5.circle){return s+e.radius>Math.sqrt(i**2+r**2)}if(e instanceof Q5||e.type===W5.rectangle){const t=e,{width:n,height:o}=t.size;return Math.pow(i-n,2)+Math.pow(r-o,2)<=s**2||i<=s+n&&r<=s+o||i<=n||r<=o}return!1}}class Q5 extends X5{constructor(e,t,n,i){super(e,t,W5.rectangle),this.size={height:i,width:n}}contains(e){const t=this.size.width,n=this.size.height,i=this.position;return e.x>=i.x&&e.x<=i.x+t&&e.y>=i.y&&e.y<=i.y+n}intersects(e){if(e instanceof Y5)return e.intersects(this);const t=this.size.width,n=this.size.height,i=this.position,r=e.position,s=e instanceof Q5?e.size:{width:0,height:0},o=s.width,a=s.height;return r.x<i.x+t&&r.x+o>i.x&&r.y<i.y+n&&r.y+a>i.y}}const K5=.5;class Z5{constructor(e,t){this.rectangle=e,this.capacity=t,this._subdivide=()=>{const{x:e,y:t}=this.rectangle.position,{width:n,height:i}=this.rectangle.size,{capacity:r}=this;for(let s=0;s<4;s++){const o=s%2;this._subs.push(new Z5(new Q5(e+n*K5*o,t+i*K5*(Math.round(s*K5)-o),n*K5,i*K5),r))}this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}insert(e){return!!this.rectangle.contains(e.position)&&(this._points.length<this.capacity?(this._points.push(e),!0):(this._divided||this._subdivide(),this._subs.some((t=>t.insert(e)))))}query(e,t){const n=[];if(!e.intersects(this.rectangle))return[];for(const i of this._points)!e.contains(i.position)&&h3(e.position,i.position)>i.particle.getRadius()&&(!t||t(i.particle))||n.push(i.particle);if(this._divided)for(const i of this._subs)n.push(...i.query(e,t));return n}queryCircle(e,t,n){return this.query(new Y5(e.x,e.y,t),n)}queryRectangle(e,t,n){return this.query(new Q5(e.x,e.y,t.width,t.height),n)}}const J5=e=>{const{height:t,width:n}=e;return new Q5(-.25*n,-.25*t,1.5*n,1.5*t)};class $5{constructor(e,t){var n=this;this._addToPool=function(){n._pool.push(...arguments)},this._applyDensity=(e,t,n)=>{var i;const r=e.number;if(null===(i=e.number.density)||void 0===i||!i.enable)return void(void 0===n?this._limit=r.limit.value:r.limit&&this._groupLimits.set(n,r.limit.value));const s=this._initDensityFactor(r.density),o=r.value,a=r.limit.value>0?r.limit.value:o,l=Math.min(o,a)*s+t,c=Math.min(this.count,this.filter((e=>e.group===n)).length);void 0===n?this._limit=r.limit.value*s:this._groupLimits.set(n,r.limit.value*s),c<l?this.push(Math.abs(l-c),void 0,e,n):c>l&&this.removeQuantity(c-l,n)},this._initDensityFactor=e=>{const t=this._container;if(!t.canvas.element||!e.enable)return 1;const n=t.canvas.element,i=t.retina.pixelRatio;return n.width*n.height/(e.height*e.width*i**2)},this._pushParticle=(e,t,n,i)=>{try{let r=this._pool.pop();r||(r=new j5(this._engine,this._container)),r.init(this._nextId,e,t,n);let s=!0;if(i&&(s=i(r)),!s)return;return this._array.push(r),this._zArray.push(r),this._nextId++,this._engine.dispatchEvent(R4.particleAdded,{container:this._container,data:{particle:r}}),r}catch(r){S3().warning("".concat(F2," adding particle: ").concat(r))}},this._removeParticle=(e,t,n)=>{const i=this._array[e];if(!i||i.group!==t)return!1;const r=this._zArray.indexOf(i);return this._array.splice(e,1),this._zArray.splice(r,1),i.destroy(n),this._engine.dispatchEvent(R4.particleRemoved,{container:this._container,data:{particle:i}}),this._addToPool(i),!0},this._engine=e,this._container=t,this._nextId=0,this._array=[],this._zArray=[],this._pool=[],this._limit=0,this._groupLimits=new Map,this._needsSort=!1,this._lastZIndex=0,this._interactionManager=new z5(e,t),this._pluginsInitialized=!1;const i=t.canvas.size;this.quadTree=new Z5(J5(i),4),this.movers=[],this.updaters=[]}get count(){return this._array.length}addManualParticles(){const e=this._container;e.actualOptions.manualParticles.forEach((t=>this.addParticle(t.position?H3(t.position,e.canvas.size):void 0,t.options)))}addParticle(e,t,n,i){var r;const s=this._container.actualOptions.particles.number.limit.mode,o=void 0===n?this._limit:null!==(r=this._groupLimits.get(n))&&void 0!==r?r:this._limit,a=this.count;if(o>0)switch(s){case Q4.delete:{const e=a+1-o;e>0&&this.removeQuantity(e);break}case Q4.wait:if(a>=o)return}return this._pushParticle(e,t,n,i)}clear(){this._array=[],this._zArray=[],this._pluginsInitialized=!1}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}draw(e){const t=this._container,n=t.canvas;n.clear(),this.update(e);for(const i of t.plugins.values())n.drawPlugin(i,e);for(const i of this._zArray)i.draw(e)}filter(e){return this._array.filter(e)}find(e){return this._array.find(e)}get(e){return this._array[e]}handleClickMode(e){this._interactionManager.handleClickMode(e)}async init(){const e=this._container,t=e.actualOptions;this._lastZIndex=0,this._needsSort=!1,await this.initPlugins();let n=!1;for(const o of e.plugins.values()){var i,r;if(n=null!==(i=null===(r=o.particlesInitialization)||void 0===r?void 0:r.call(o))&&void 0!==i?i:n,n)break}if(this.addManualParticles(),!n){const e=t.particles,n=e.groups;for(const t in n){const i=n[t];for(let n=this.count,r=0;r<(null===(s=i.number)||void 0===s?void 0:s.value)&&n<e.number.value;n++,r++){var s;this.addParticle(void 0,i,t)}}for(let t=this.count;t<e.number.value;t++)this.addParticle()}}async initPlugins(){if(this._pluginsInitialized)return;const e=this._container;this.movers=await this._engine.getMovers(e,!0),this.updaters=await this._engine.getUpdaters(e,!0),await this._interactionManager.init();for(const t of e.pathGenerators.values())t.init(e)}push(e,t,n,i){for(let r=0;r<e;r++)this.addParticle(null===t||void 0===t?void 0:t.position,n,i)}async redraw(){this.clear(),await this.init(),this.draw({value:0,factor:0})}remove(e,t,n){this.removeAt(this._array.indexOf(e),void 0,t,n)}removeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(e<0||e>this.count)return;let r=0;for(let s=e;r<t&&s<this.count;s++)this._removeParticle(s,n,i)&&(s--,r++)}removeQuantity(e,t){this.removeAt(0,e,t)}setDensity(){const e=this._container.actualOptions,t=e.particles.groups;for(const n in t)this._applyDensity(t[n],0,n);this._applyDensity(e.particles,e.manualParticles.length)}setLastZIndex(e){this._lastZIndex=e,this._needsSort=this._needsSort||this._lastZIndex<e}setResizeFactor(e){this._resizeFactor=e}update(e){const t=this._container,n=new Set;this.quadTree=new Z5(J5(t.canvas.size),4);for(const o of t.pathGenerators.values())o.update();for(const o of t.plugins.values()){var i;null===(i=o.update)||void 0===i||i.call(o,e)}const r=this._resizeFactor;for(const o of this._array){r&&!o.ignoresResizeRatio&&(o.position.x*=r.width,o.position.y*=r.height,o.initialPosition.x*=r.width,o.initialPosition.y*=r.height),o.ignoresResizeRatio=!1,this._interactionManager.reset(o);for(const t of this._container.plugins.values()){var s;if(o.destroyed)break;null===(s=t.particleUpdate)||void 0===s||s.call(t,o,e)}for(const t of this.movers)t.isEnabled(o)&&t.move(o,e);o.destroyed?n.add(o):this.quadTree.insert(new H5(o.getPosition(),o))}if(n.size){const e=e=>!n.has(e);this._array=this.filter(e),this._zArray=this._zArray.filter(e);for(const t of n)this._engine.dispatchEvent(R4.particleRemoved,{container:this._container,data:{particle:t}});this._addToPool(...n)}this._interactionManager.externalInteract(e);for(const o of this._array){for(const t of this.updaters)t.update(o,e);o.destroyed||o.spawning||this._interactionManager.particlesInteract(o,e)}if(delete this._resizeFactor,this._needsSort){const e=this._zArray;e.sort(((e,t)=>t.position.z-e.position.z||e.id-t.id));const t=1;this._lastZIndex=e[e.length-t].position.z,this._needsSort=!1}}}class e6{constructor(e){this.container=e,this.pixelRatio=1,this.reduceFactor=1}init(){const e=this.container,t=e.actualOptions;this.pixelRatio=!t.detectRetina||M3()?1:window.devicePixelRatio,this.reduceFactor=1;const n=this.pixelRatio,i=e.canvas;if(i.element){const e=i.element;i.size.width=e.offsetWidth*n,i.size.height=e.offsetHeight*n}const r=t.particles,s=r.move;this.maxSpeed=o3(s.gravity.maxSpeed)*n,this.sizeAnimationSpeed=o3(r.size.animation.speed)*n}initParticle(e){const t=e.options,n=this.pixelRatio,i=t.move,r=i.distance,s=e.retina;s.moveDrift=o3(i.drift)*n,s.moveSpeed=o3(i.speed)*n,s.sizeAnimationSpeed=o3(t.size.animation.speed)*n;const o=s.maxDistance;o.horizontal=void 0!==r.horizontal?r.horizontal*n:void 0,o.vertical=void 0!==r.vertical?r.vertical*n:void 0,s.maxSpeed=o3(i.gravity.maxSpeed)*n}}function t6(e){return e&&!e.destroyed}function n6(e,t){const n=new U5(e,t);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return B5(n,...r),n}class i6{constructor(e,t,n){this._intersectionManager=e=>{if(t6(this)&&this.actualOptions.pauseOnOutsideViewport)for(const t of e)t.target===this.interactivity.element&&(t.isIntersecting?this.play():this.pause())},this._nextFrame=e=>{try{var t;if(!this._smooth&&void 0!==this._lastFrameTime&&e<this._lastFrameTime+z2/this.fpsLimit)return void this.draw(!1);null!==(t=this._lastFrameTime)&&void 0!==t||(this._lastFrameTime=e);const n=function(e){return{value:e,factor:arguments.length>2&&void 0!==arguments[2]&&arguments[2]?60/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:60):60*e/z2}}(e-this._lastFrameTime,this.fpsLimit,this._smooth);if(this.addLifeTime(n.value),this._lastFrameTime=e,n.value>z2)return void this.draw(!1);if(this.particles.draw(n),!this.alive())return void this.destroy();this.animationStatus&&this.draw(!1)}catch(n){S3().error("".concat(F2," in animation loop"),n)}},this._engine=e,this.id=Symbol(t),this.fpsLimit=120,this._smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this._lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._clickHandlers=new Map,this._sourceOptions=n,this._initialSourceOptions=n,this.retina=new e6(this),this.canvas=new T4(this,this._engine),this.particles=new $5(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this._options=n6(this._engine,this),this.actualOptions=n6(this._engine,this),this._eventListeners=new C4(this),this._intersectionObserver=function(e){if(!M3()&&"undefined"!==typeof IntersectionObserver)return new IntersectionObserver(e)}((e=>this._intersectionManager(e))),this._engine.dispatchEvent(R4.containerBuilt,{container:this})}get animationStatus(){return!this._paused&&!this.pageHidden&&t6(this)}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(e){if(!t6(this))return;const t=this.interactivity.element;if(!t)return;const n=(t,n,i)=>{if(!t6(this))return;const r=this.retina.pixelRatio,s={x:n.x*r,y:n.y*r},o=this.particles.quadTree.queryCircle(s,i*r);e(t,o)};let i=!1,r=!1;this._clickHandlers.set("click",(e=>{if(!t6(this))return;const t=e,i={x:t.offsetX||t.clientX,y:t.offsetY||t.clientY};n(e,i,1)})),this._clickHandlers.set("touchstart",(()=>{t6(this)&&(i=!0,r=!1)})),this._clickHandlers.set("touchmove",(()=>{t6(this)&&(r=!0)})),this._clickHandlers.set("touchend",(e=>{if(t6(this)){if(i&&!r){const t=e,i=1;let r=t.touches[t.touches.length-i];if(!r&&(r=t.changedTouches[t.changedTouches.length-i],!r))return;const s=this.canvas.element,o=s?s.getBoundingClientRect():void 0,a=0,l={x:r.clientX-(o?o.left:a),y:r.clientY-(o?o.top:a)};n(e,l,Math.max(r.radiusX,r.radiusY))}i=!1,r=!1}})),this._clickHandlers.set("touchcancel",(()=>{t6(this)&&(i=!1,r=!1)}));for(const[s,o]of this._clickHandlers)t.addEventListener(s,o)}addLifeTime(e){this._lifeTime+=e}addPath(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!t6(this)||!n&&this.pathGenerators.has(e))&&(this.pathGenerators.set(e,t),!0)}alive(){return!this._duration||this._lifeTime<=this._duration}clearClickHandlers(){if(t6(this)){for(const[t,n]of this._clickHandlers){var e;null===(e=this.interactivity.element)||void 0===e||e.removeEventListener(t,n)}this._clickHandlers.clear()}}destroy(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t6(this)){this.stop(),this.clearClickHandlers(),this.particles.destroy(),this.canvas.destroy();for(const e of this.effectDrawers.values()){var t;null===(t=e.destroy)||void 0===t||t.call(e,this)}for(const e of this.shapeDrawers.values()){var n;null===(n=e.destroy)||void 0===n||n.call(e,this)}for(const e of this.effectDrawers.keys())this.effectDrawers.delete(e);for(const e of this.shapeDrawers.keys())this.shapeDrawers.delete(e);if(this._engine.clearPlugins(this),this.destroyed=!0,e){const e=this._engine.items,t=e.findIndex((e=>e===this));if(t>=0){const n=1;e.splice(t,n)}}this._engine.dispatchEvent(R4.containerDestroyed,{container:this})}}draw(e){if(!t6(this))return;let t=e;const n=e=>{t&&(this._lastFrameTime=void 0,t=!1),this._nextFrame(e)};var i;this._drawAnimationFrame=(i=e=>n(e),e3.nextFrame(i))}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const n of this.plugins.values()){if(!n.export)continue;const i=await n.export(e,t);if(i.supported)return i.blob}S3().error("".concat(F2," - Export plugin with type ").concat(e," not found"))}handleClickMode(e){if(t6(this)){this.particles.handleClickMode(e);for(const n of this.plugins.values()){var t;null===(t=n.handleClickMode)||void 0===t||t.call(n,e)}}}async init(){if(!t6(this))return;const e=this._engine.getSupportedEffects();for(const d of e){const e=this._engine.getEffectDrawer(d);e&&this.effectDrawers.set(d,e)}const t=this._engine.getSupportedShapes();for(const d of t){const e=this._engine.getShapeDrawer(d);e&&this.shapeDrawers.set(d,e)}await this.particles.initPlugins(),this._options=n6(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=n6(this._engine,this,this._options);const n=await this._engine.getAvailablePlugins(this);for(const[d,p]of n)this.plugins.set(d,p);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize();const{zLayers:i,duration:r,delay:s,fpsLimit:o,smooth:a}=this.actualOptions;this.zLayers=i,this._duration=o3(r)*z2,this._delay=o3(s)*z2,this._lifeTime=0;this.fpsLimit=o>0?o:120,this._smooth=a;for(const d of this.effectDrawers.values()){var l;await(null===(l=d.init)||void 0===l?void 0:l.call(d,this))}for(const d of this.shapeDrawers.values()){var c;await(null===(c=d.init)||void 0===c?void 0:c.call(d,this))}for(const d of this.plugins.values()){var u;await(null===(u=d.init)||void 0===u?void 0:u.call(d))}this._engine.dispatchEvent(R4.containerInit,{container:this}),await this.particles.init(),this.particles.setDensity();for(const d of this.plugins.values()){var h;null===(h=d.particlesSetup)||void 0===h||h.call(d)}this._engine.dispatchEvent(R4.particlesSetup,{container:this})}async loadTheme(e){t6(this)&&(this._currentTheme=e,await this.refresh())}pause(){var e;if(t6(this)&&(void 0!==this._drawAnimationFrame&&(e=this._drawAnimationFrame,e3.cancel(e),delete this._drawAnimationFrame),!this._paused)){for(const e of this.plugins.values()){var t;null===(t=e.pause)||void 0===t||t.call(e)}this.pageHidden||(this._paused=!0),this._engine.dispatchEvent(R4.containerPaused,{container:this})}}play(e){if(!t6(this))return;const t=this._paused||e;if(!this._firstStart||this.actualOptions.autoPlay){if(this._paused&&(this._paused=!1),t)for(const e of this.plugins.values())e.play&&e.play();this._engine.dispatchEvent(R4.containerPlay,{container:this}),this.draw(null!==t&&void 0!==t&&t)}else this._firstStart=!1}async refresh(){if(t6(this))return this.stop(),this.start()}async reset(e){if(t6(this))return this._initialSourceOptions=e,this._sourceOptions=e,this._options=n6(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=n6(this._engine,this,this._options),this.refresh()}async start(){t6(this)&&!this.started&&(await this.init(),this.started=!0,await new Promise((e=>{const t=async()=>{this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element);for(const e of this.plugins.values()){var t;await(null===(t=e.start)||void 0===t?void 0:t.call(e))}this._engine.dispatchEvent(R4.containerStarted,{container:this}),this.play(),e()};this._delayTimeout=setTimeout((()=>{t()}),this._delay)})))}stop(){if(t6(this)&&this.started){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);for(const t of this.plugins.values()){var e;null===(e=t.stop)||void 0===e||e.call(t)}for(const e of this.plugins.keys())this.plugins.delete(e);this._sourceOptions=this._options,this._engine.dispatchEvent(R4.containerStopped,{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];const e=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this._responsiveMaxWidth!==e&&(this._responsiveMaxWidth=e,!0)}}class r6{constructor(){this._listeners=new Map}addEventListener(e,t){this.removeEventListener(e,t);let n=this._listeners.get(e);n||(n=[],this._listeners.set(e,n)),n.push(t)}dispatchEvent(e,t){const n=this._listeners.get(e);null===n||void 0===n||n.forEach((e=>e(t)))}hasEventListener(e){return!!this._listeners.get(e)}removeAllEventListeners(e){e?this._listeners.delete(e):this._listeners=new Map}removeEventListener(e,t){const n=this._listeners.get(e);if(!n)return;const i=n.length,r=n.indexOf(t);if(r<0)return;1===i?this._listeners.delete(e):n.splice(r,1)}}async function s6(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.get(e);return r&&!i||(r=await Promise.all([...n.values()].map((t=>t(e)))),t.set(e,r)),r}const o6="true",a6="false",l6="canvas";class c6{constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new r6,this._initialized=!1,this.plugins=[],this.colorManagers=new Map,this.easingFunctions=new Map,this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this.pathGenerators=new Map}get configs(){const e={};for(const[t,n]of this._configs)e[t]=n;return e}get items(){return this._domArray}get version(){return"3.7.1"}async addColorManager(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.colorManagers.set(e.key,e),await this.refresh(t)}addConfig(e){var t,n;const i=null!==(t=null!==(n=e.key)&&void 0!==n?n:e.name)&&void 0!==t?t:"default";this._configs.set(i,e),this._eventDispatcher.dispatchEvent(R4.configAdded,{data:{name:i,config:e}})}async addEasing(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.getEasing(e)||(this.easingFunctions.set(e,t),await this.refresh(n))}async addEffect(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];z3(e,(e=>{this.getEffectDrawer(e)||this.effectDrawers.set(e,t)})),await this.refresh(n)}addEventListener(e,t){this._eventDispatcher.addEventListener(e,t)}async addInteractor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.interactors.set(e,t),await this.refresh(n)}async addMover(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.movers.set(e,t),await this.refresh(n)}async addParticleUpdater(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.updaters.set(e,t),await this.refresh(n)}async addPathGenerator(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.getPathGenerator(e)||this.pathGenerators.set(e,t),await this.refresh(n)}async addPlugin(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.getPlugin(e.id)||this.plugins.push(e),await this.refresh(t)}async addPreset(e,t){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&this.getPreset(e)||this.presets.set(e,t),await this.refresh(n)}async addShape(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(const n of e.validTypes)this.getShapeDrawer(n)||this.shapeDrawers.set(n,e);await this.refresh(t)}clearPlugins(e){this.updaters.delete(e),this.movers.delete(e),this.interactors.delete(e)}dispatchEvent(e,t){this._eventDispatcher.dispatchEvent(e,t)}dom(){return this.items}domItem(e){return this.item(e)}async getAvailablePlugins(e){const t=new Map;for(const n of this.plugins)n.needsPlugin(e.actualOptions)&&t.set(n.id,await n.getPlugin(e));return t}getEasing(e){var t;return null!==(t=this.easingFunctions.get(e))&&void 0!==t?t:e=>e}getEffectDrawer(e){return this.effectDrawers.get(e)}async getInteractors(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s6(e,this.interactors,this._initializers.interactors,t)}async getMovers(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s6(e,this.movers,this._initializers.movers,t)}getPathGenerator(e){return this.pathGenerators.get(e)}getPlugin(e){return this.plugins.find((t=>t.id===e))}getPreset(e){return this.presets.get(e)}getShapeDrawer(e){return this.shapeDrawers.get(e)}getSupportedEffects(){return this.effectDrawers.keys()}getSupportedShapes(){return this.shapeDrawers.keys()}async getUpdaters(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s6(e,this.updaters,this._initializers.updaters,t)}init(){this._initialized||(this._initialized=!0)}item(e){const{items:t}=this,n=t[e];if(n&&!n.destroyed)return n;{const n=1;t.splice(e,n)}}async load(e){var t,n,i;const r=null!==(t=null!==(n=e.id)&&void 0!==n?n:null===(i=e.element)||void 0===i?void 0:i.id)&&void 0!==t?t:"tsparticles".concat(Math.floor(1e4*n3())),{index:s,url:o}=e,a=o?await async function(e){const t=q3(e.url,e.index);if(!t)return e.fallback;const n=await fetch(t);return n.ok?await n.json():(S3().error("".concat(F2," ").concat(n.status," while retrieving config file")),e.fallback)}({fallback:e.options,url:o,index:s}):e.options,l=q3(a,s),{items:c}=this,u=c.findIndex((e=>e.id.description===r)),h=new i6(this,r,l);if(u>=0){const e=this.item(u),t=e?1:0;e&&!e.destroyed&&e.destroy(!1),c.splice(u,t,h)}else c.push(h);const d=((e,t)=>{let n=null!==t&&void 0!==t?t:document.getElementById(e);return n||(n=document.createElement("div"),n.id=e,n.dataset[I2]=o6,document.body.append(n),n)})(r,e.element),p=(e=>{let t;if(e instanceof HTMLCanvasElement||e.tagName.toLowerCase()===l6)t=e,t.dataset[I2]||(t.dataset[I2]=a6);else{const n=e.getElementsByTagName(l6);n.length?(t=n[0],t.dataset[I2]=a6):(t=document.createElement(l6),t.dataset[I2]=o6,e.appendChild(t))}const n="100%";return t.style.width||(t.style.width=n),t.style.height||(t.style.height=n),t})(d);return h.canvas.loadCanvas(p),await h.start(),h}loadOptions(e,t){this.plugins.forEach((n=>{var i;return null===(i=n.loadOptions)||void 0===i?void 0:i.call(n,e,t)}))}loadParticlesOptions(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=this.updaters.get(e);s&&s.forEach((e=>{var n;return null===(n=e.loadOptions)||void 0===n?void 0:n.call(e,t,...i)}))}async refresh(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&await Promise.all(this.items.map((e=>e.refresh())))}removeEventListener(e,t){this._eventDispatcher.removeEventListener(e,t)}setOnClickHandler(e){const{items:t}=this;if(!t.length)throw new Error("".concat(F2," can only set click handlers after calling tsParticles.load()"));t.forEach((t=>t.addClickHandler(e)))}}class u6{constructor(e){this.type=K4.external,this.container=e}}class h6{constructor(e){this.type=K4.particles,this.container=e}}var d6,p6,A6;!function(e){e.clockwise="clockwise",e.counterClockwise="counter-clockwise",e.random="random"}(d6||(d6={})),function(e){e.linear="linear",e.radial="radial",e.random="random"}(p6||(p6={})),function(e){e.easeInBack="ease-in-back",e.easeInCirc="ease-in-circ",e.easeInCubic="ease-in-cubic",e.easeInLinear="ease-in-linear",e.easeInQuad="ease-in-quad",e.easeInQuart="ease-in-quart",e.easeInQuint="ease-in-quint",e.easeInExpo="ease-in-expo",e.easeInSine="ease-in-sine",e.easeOutBack="ease-out-back",e.easeOutCirc="ease-out-circ",e.easeOutCubic="ease-out-cubic",e.easeOutLinear="ease-out-linear",e.easeOutQuad="ease-out-quad",e.easeOutQuart="ease-out-quart",e.easeOutQuint="ease-out-quint",e.easeOutExpo="ease-out-expo",e.easeOutSine="ease-out-sine",e.easeInOutBack="ease-in-out-back",e.easeInOutCirc="ease-in-out-circ",e.easeInOutCubic="ease-in-out-cubic",e.easeInOutLinear="ease-in-out-linear",e.easeInOutQuad="ease-in-out-quad",e.easeInOutQuart="ease-in-out-quart",e.easeInOutQuint="ease-in-out-quint",e.easeInOutExpo="ease-in-out-expo",e.easeInOutSine="ease-in-out-sine"}(A6||(A6={}));const f6=function(){const e=new c6;return e.init(),e}();M3()||(window.tsParticles=f6);const m6=e=>{var n;const i=null!==(n=e.id)&&void 0!==n?n:"tsparticles";return(0,t.useEffect)((()=>{let t;return f6.load({id:i,url:e.url,options:e.options}).then((n=>{var i;t=n,null==(i=e.particlesLoaded)||i.call(e,n)})),()=>{null==t||t.destroy()}}),[i,e,e.url,e.options]),(0,r.jsx)("div",{id:i,className:e.className})};function g6(e,t,n,i,r,s){!function(e,t){var n;const i=e.options,r=i.move.path;if(!r.enable)return;if(e.lastPathTime<=e.pathDelay)return void(e.lastPathTime+=t.value);const s=null===(n=e.pathGenerator)||void 0===n?void 0:n.generate(e,t);s&&e.velocity.addTo(s);r.clamp&&(e.velocity.x=i3(e.velocity.x,-1,1),e.velocity.y=i3(e.velocity.y,-1,1));e.lastPathTime-=e.pathDelay}(e,s);const o=e.gravity,a=null!==o&&void 0!==o&&o.enable&&o.inverse?-1:1;r&&n&&(e.velocity.x+=r*s.factor/(60*n)),null!==o&&void 0!==o&&o.enable&&n&&(e.velocity.y+=a*(o.acceleration*s.factor)/(60*n));const l=e.moveDecay;e.velocity.multTo(l);const c=e.velocity.mult(n);null!==o&&void 0!==o&&o.enable&&i>0&&(!o.inverse&&c.y>=0&&c.y>=i||o.inverse&&c.y<=0&&c.y<=-i)&&(c.y=a*i,n&&(e.velocity.y=c.y/n));const u=e.options.zIndex,h=(1-e.zIndexFactor)**u.velocityRate;c.multTo(h);const{position:d}=e;d.addTo(c),t.vibrate&&(d.x+=Math.sin(d.x*Math.cos(d.y)),d.y+=Math.cos(d.y*Math.sin(d.x)))}class v6{init(e){const t=e.options.move.gravity;e.gravity={enable:t.enable,acceleration:o3(t.acceleration),inverse:t.inverse},function(e){var t;const n=e.container,i=e.options.move.spin;if(!i.enable)return;const r=null!==(t=i.position)&&void 0!==t?t:{x:50,y:50},s={x:.01*r.x*n.canvas.size.width,y:.01*r.y*n.canvas.size.height},o=h3(e.getPosition(),s),a=o3(i.acceleration);e.retina.spinAcceleration=a*n.retina.pixelRatio,e.spin={center:s,direction:e.velocity.x>=0?d6.clockwise:d6.counterClockwise,angle:e.velocity.angle,radius:o,acceleration:e.retina.spinAcceleration}}(e)}isEnabled(e){return!e.destroyed&&e.options.move.enable}move(e,t){var n,i,r,s,o;const a=e.options,l=a.move;if(!l.enable)return;const c=e.container,u=c.retina.pixelRatio;null!==(i=(n=e.retina).moveSpeed)&&void 0!==i||(n.moveSpeed=o3(l.speed)*u),null!==(s=(r=e.retina).moveDrift)&&void 0!==s||(r.moveDrift=o3(e.options.move.drift)*u);const h=function(e){return e.slow.inRange?e.slow.factor:1}(e),d=e.retina.moveSpeed*c.retina.reduceFactor,p=e.retina.moveDrift,A=l3(a.size.value)*u,f=d*(l.size?e.getRadius()/A:1)*h*(t.factor||1)/2,m=null!==(o=e.retina.maxSpeed)&&void 0!==o?o:c.retina.maxSpeed;l.spin.enable?function(e,t){const n=e.container;if(!e.spin)return;const i={x:e.spin.direction===d6.clockwise?Math.cos:Math.sin,y:e.spin.direction===d6.clockwise?Math.sin:Math.cos};e.position.x=e.spin.center.x+e.spin.radius*i.x(e.spin.angle),e.position.y=e.spin.center.y+e.spin.radius*i.y(e.spin.angle),e.spin.radius+=e.spin.acceleration;const r=Math.max(n.canvas.size.width,n.canvas.size.height),s=.5*r;e.spin.radius>s?(e.spin.radius=s,e.spin.acceleration*=-1):e.spin.radius<0&&(e.spin.radius=0,e.spin.acceleration*=-1),e.spin.angle+=.01*t*(1-e.spin.radius/r)}(e,f):g6(e,l,f,m,p,t),function(e){var t,n;const i=e.initialPosition,{dx:r,dy:s}=u3(i,e.position),o=Math.abs(r),a=Math.abs(s),{maxDistance:l}=e.retina,c=l.horizontal,u=l.vertical;if(!c&&!u)return;const h=null!==(n=u&&a>=u)&&void 0!==n&&n;if((null!==(t=c&&o>=c)&&void 0!==t&&t||h)&&!e.misplaced)e.misplaced=!!c&&o>c||!!u&&a>u,c&&(e.velocity.x=.5*e.velocity.y-e.velocity.x),u&&(e.velocity.y=.5*e.velocity.x-e.velocity.y);else if((!c||o<c)&&(!u||a<u)&&e.misplaced)e.misplaced=!1;else if(e.misplaced){const t=e.position,n=e.velocity;c&&(t.x<i.x&&n.x<0||t.x>i.x&&n.x>0)&&(n.x*=-n3()),u&&(t.y<i.y&&n.y<0||t.y>i.y&&n.y>0)&&(n.y*=-n3())}}(e)}}const y6=2*Math.PI,b6=0,x6=0;class _6{constructor(){this.validTypes=["circle"]}draw(e){!function(e){const{context:t,particle:n,radius:i}=e;n.circleRange||(n.circleRange={min:0,max:y6});const r=n.circleRange;t.arc(b6,x6,i,r.min,r.max,!1)}(e)}getSidesCount(){return 12}particleInit(e,t){var n;const i=t.shapeData,r=null!==(n=null===i||void 0===i?void 0:i.angle)&&void 0!==n?n:{max:360,min:0};t.circleRange=H2(r)?{min:d3(r.min),max:d3(r.max)}:{min:0,max:d3(r)}}}class w6{constructor(e,t){this._container=e,this._engine=t}init(e){const t=e4(this._engine,e.options.color,e.id,e.options.reduceDuplicates);t&&(e.color=u4(t,e.options.color.animation,this._container.retina.reduceFactor))}isEnabled(e){const{h:t,s:n,l:i}=e.options.color.animation,{color:r}=e;return!e.destroyed&&!e.spawning&&(void 0!==(null===r||void 0===r?void 0:r.h.value)&&t.enable||void 0!==(null===r||void 0===r?void 0:r.s.value)&&n.enable||void 0!==(null===r||void 0===r?void 0:r.l.value)&&i.enable)}update(e,t){p4(e.color,t)}}var S6;!function(e){e[e.r=1]="r",e[e.g=2]="g",e[e.b=3]="b",e[e.a=4]="a"}(S6||(S6={}));const T6=/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,M6=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i;class E6{constructor(){this.key="hex",this.stringPrefix="#"}handleColor(e){return this._parseString(e.value)}handleRangeColor(e){return this._parseString(e.value)}parseString(e){return this._parseString(e)}_parseString(e){if("string"!==typeof e)return;if(null===e||void 0===e||!e.startsWith(this.stringPrefix))return;const t=e.replace(T6,((e,t,n,i,r)=>t+t+n+n+i+i+(void 0!==r?r+r:""))),n=M6.exec(t);return n?{a:void 0!==n[S6.a]?parseInt(n[S6.a],16)/255:1,b:parseInt(n[S6.b],16),g:parseInt(n[S6.g],16),r:parseInt(n[S6.r],16)}:void 0}}var C6;!function(e){e[e.h=1]="h",e[e.s=2]="s",e[e.l=3]="l",e[e.a=5]="a"}(C6||(C6={}));class R6{constructor(){this.key="hsl",this.stringPrefix="hsl"}handleColor(e){var t;const n=null!==(t=e.value.hsl)&&void 0!==t?t:e.value;if(void 0!==n.h&&void 0!==n.s&&void 0!==n.l)return n4(n)}handleRangeColor(e){var t;const n=null!==(t=e.value.hsl)&&void 0!==t?t:e.value;if(void 0!==n.h&&void 0!==n.l)return n4({h:o3(n.h),l:o3(n.l),s:o3(n.s)})}parseString(e){if(!e.startsWith("hsl"))return;const t=/hsla?\(\s*(\d+)\s*[\s,]\s*(\d+)%\s*[\s,]\s*(\d+)%\s*([\s,]\s*(0|1|0?\.\d+|(\d{1,3})%)\s*)?\)/i.exec(e);return t?function(e){const t=n4(e);return{a:e.a,b:t.b,g:t.g,r:t.r}}({a:t.length>4?f3(t[C6.a]):1,h:parseInt(t[C6.h],10),l:parseInt(t[C6.l],10),s:parseInt(t[C6.s],10)}):void 0}}class P6{constructor(e){this.container=e}init(e){const t=e.options.opacity;e.opacity=G3(t,1);const n=t.animation;n.enable&&(e.opacity.velocity=o3(n.speed)/U2*this.container.retina.reduceFactor,n.sync||(e.opacity.velocity*=n3()))}isEnabled(e){var t,n,i,r;return!e.destroyed&&!e.spawning&&!!e.opacity&&e.opacity.enable&&((null!==(t=e.opacity.maxLoops)&&void 0!==t?t:0)<=0||(null!==(n=e.opacity.maxLoops)&&void 0!==n?n:0)>0&&(null!==(i=e.opacity.loops)&&void 0!==i?i:0)<(null!==(r=e.opacity.maxLoops)&&void 0!==r?r:0))}reset(e){e.opacity&&(e.opacity.time=0,e.opacity.loops=0)}update(e,t){this.isEnabled(e)&&e.opacity&&W3(e,e.opacity,!0,e.options.opacity.animation.destroy,t)}}class N6{constructor(e){this.container=e,this.modes=[Y4.bounce,Y4.split]}update(e,t,n,i){if(!this.modes.includes(i))return;const r=this.container;let s=!1;for(const h of r.plugins.values())if(void 0!==h.particleBounce&&(s=h.particleBounce(e,n,t)),s)break;if(s)return;const o=e.getPosition(),a=e.offset,l=e.getRadius(),c=D3(o,l),u=r.canvas.size;!function(e){if(e.outMode!==Y4.bounce&&e.outMode!==Y4.split||e.direction!==y3.left&&e.direction!==y3.right)return;e.bounds.right<0&&e.direction===y3.left?e.particle.position.x=e.size+e.offset.x:e.bounds.left>e.canvasSize.width&&e.direction===y3.right&&(e.particle.position.x=e.canvasSize.width-e.size-e.offset.x);const t=e.particle.velocity.x;let n=!1;if(e.direction===y3.right&&e.bounds.right>=e.canvasSize.width&&t>0||e.direction===y3.left&&e.bounds.left<=0&&t<0){const t=o3(e.particle.options.bounce.horizontal.value);e.particle.velocity.x*=-t,n=!0}if(!n)return;const i=e.offset.x+e.size;e.bounds.right>=e.canvasSize.width&&e.direction===y3.right?e.particle.position.x=e.canvasSize.width-i:e.bounds.left<=0&&e.direction===y3.left&&(e.particle.position.x=i),e.outMode===Y4.split&&e.particle.destroy()}({particle:e,outMode:i,direction:t,bounds:c,canvasSize:u,offset:a,size:l}),function(e){if(e.outMode!==Y4.bounce&&e.outMode!==Y4.split||e.direction!==y3.bottom&&e.direction!==y3.top)return;e.bounds.bottom<0&&e.direction===y3.top?e.particle.position.y=e.size+e.offset.y:e.bounds.top>e.canvasSize.height&&e.direction===y3.bottom&&(e.particle.position.y=e.canvasSize.height-e.size-e.offset.y);const t=e.particle.velocity.y;let n=!1;if(e.direction===y3.bottom&&e.bounds.bottom>=e.canvasSize.height&&t>0||e.direction===y3.top&&e.bounds.top<=0&&t<0){const t=o3(e.particle.options.bounce.vertical.value);e.particle.velocity.y*=-t,n=!0}if(!n)return;const i=e.offset.y+e.size;e.bounds.bottom>=e.canvasSize.height&&e.direction===y3.bottom?e.particle.position.y=e.canvasSize.height-i:e.bounds.top<=0&&e.direction===y3.top&&(e.particle.position.y=i),e.outMode===Y4.split&&e.particle.destroy()}({particle:e,outMode:i,direction:t,bounds:c,canvasSize:u,offset:a,size:l})}}class D6{constructor(e){this.container=e,this.modes=[Y4.destroy]}update(e,t,n,i){if(!this.modes.includes(i))return;const r=this.container;switch(e.outType){case Z4.normal:case Z4.outside:if(N3(e.position,r.canvas.size,J2.origin,e.getRadius(),t))return;break;case Z4.inside:{const{dx:t,dy:n}=u3(e.position,e.moveCenter),{x:i,y:r}=e.velocity;if(i<0&&t>e.moveCenter.radius||r<0&&n>e.moveCenter.radius||i>=0&&t<-e.moveCenter.radius||r>=0&&n<-e.moveCenter.radius)return;break}}r.particles.remove(e,e.group,!0)}}class L6{constructor(e){this.container=e,this.modes=[Y4.none]}update(e,t,n,i){var r;if(!this.modes.includes(i))return;if(null!==(r=e.options.move.distance.horizontal&&(t===y3.left||t===y3.right))&&void 0!==r?r:e.options.move.distance.vertical&&(t===y3.top||t===y3.bottom))return;const s=e.options.move.gravity,o=this.container,a=o.canvas.size,l=e.getRadius();if(s.enable){const n=e.position;(!s.inverse&&n.y>a.height+l&&t===y3.bottom||s.inverse&&n.y<-l&&t===y3.top)&&o.particles.remove(e)}else{if(e.velocity.y>0&&e.position.y<=a.height+l||e.velocity.y<0&&e.position.y>=-l||e.velocity.x>0&&e.position.x<=a.width+l||e.velocity.x<0&&e.position.x>=-l)return;N3(e.position,o.canvas.size,J2.origin,l,t)||o.particles.remove(e)}}}class I6{constructor(e){this.container=e,this.modes=[Y4.out]}update(e,t,n,i){if(!this.modes.includes(i))return;const r=this.container;switch(e.outType){case Z4.inside:{const{x:t,y:n}=e.velocity,i=J2.origin;i.length=e.moveCenter.radius,i.angle=e.velocity.angle+Math.PI,i.addTo(J2.create(e.moveCenter));const{dx:s,dy:o}=u3(e.position,i);if(t<=0&&s>=0||n<=0&&o>=0||t>=0&&s<=0||n>=0&&o<=0)return;e.position.x=Math.floor(s3({min:0,max:r.canvas.size.width})),e.position.y=Math.floor(s3({min:0,max:r.canvas.size.height}));const{dx:a,dy:l}=u3(e.position,e.moveCenter);e.direction=Math.atan2(-l,-a),e.velocity.angle=e.direction;break}default:if(N3(e.position,r.canvas.size,J2.origin,e.getRadius(),t))return;switch(e.outType){case Z4.outside:{e.position.x=Math.floor(s3({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.x,e.position.y=Math.floor(s3({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.y;const{dx:t,dy:n}=u3(e.position,e.moveCenter);e.moveCenter.radius&&(e.direction=Math.atan2(n,t),e.velocity.angle=e.direction);break}case Z4.normal:{const n=e.options.move.warp,i=r.canvas.size,s={bottom:i.height+e.getRadius()+e.offset.y,left:-e.getRadius()-e.offset.x,right:i.width+e.getRadius()+e.offset.x,top:-e.getRadius()-e.offset.y},o=e.getRadius(),a=D3(e.position,o);t===y3.right&&a.left>i.width+e.offset.x?(e.position.x=s.left,e.initialPosition.x=e.position.x,n||(e.position.y=n3()*i.height,e.initialPosition.y=e.position.y)):t===y3.left&&a.right<-e.offset.x&&(e.position.x=s.right,e.initialPosition.x=e.position.x,n||(e.position.y=n3()*i.height,e.initialPosition.y=e.position.y)),t===y3.bottom&&a.top>i.height+e.offset.y?(n||(e.position.x=n3()*i.width,e.initialPosition.x=e.position.x),e.position.y=s.top,e.initialPosition.y=e.position.y):t===y3.top&&a.bottom<-e.offset.y&&(n||(e.position.x=n3()*i.width,e.initialPosition.x=e.position.x),e.position.y=s.bottom,e.initialPosition.y=e.position.y);break}}}}}class O6{constructor(e){this._addUpdaterIfMissing=(e,t,n)=>{const i=e.options.move.outModes;!this.updaters.has(t)&&((e,t)=>e.default===t||e.bottom===t||e.left===t||e.right===t||e.top===t)(i,t)&&this.updaters.set(t,n(this.container))},this._updateOutMode=(e,t,n,i)=>{for(const r of this.updaters.values())r.update(e,i,t,n)},this.container=e,this.updaters=new Map}init(e){this._addUpdaterIfMissing(e,Y4.bounce,(e=>new N6(e))),this._addUpdaterIfMissing(e,Y4.out,(e=>new I6(e))),this._addUpdaterIfMissing(e,Y4.destroy,(e=>new D6(e))),this._addUpdaterIfMissing(e,Y4.none,(e=>new L6(e)))}isEnabled(e){return!e.destroyed&&!e.spawning}update(e,t){var n,i,r,s;const o=e.options.move.outModes;this._updateOutMode(e,t,null!==(n=o.bottom)&&void 0!==n?n:o.default,y3.bottom),this._updateOutMode(e,t,null!==(i=o.left)&&void 0!==i?i:o.default,y3.left),this._updateOutMode(e,t,null!==(r=o.right)&&void 0!==r?r:o.default,y3.right),this._updateOutMode(e,t,null!==(s=o.top)&&void 0!==s?s:o.default,y3.top)}}var k6;!function(e){e[e.r=1]="r",e[e.g=2]="g",e[e.b=3]="b",e[e.a=5]="a"}(k6||(k6={}));class B6{constructor(){this.key="rgb",this.stringPrefix="rgb"}handleColor(e){var t;const n=null!==(t=e.value.rgb)&&void 0!==t?t:e.value;if(void 0!==n.r)return n}handleRangeColor(e){var t;const n=null!==(t=e.value.rgb)&&void 0!==t?t:e.value;if(void 0!==n.r)return{r:o3(n.r),g:o3(n.g),b:o3(n.b)}}parseString(e){if(!e.startsWith(this.stringPrefix))return;const t=/rgba?\(\s*(\d{1,3})\s*[\s,]\s*(\d{1,3})\s*[\s,]\s*(\d{1,3})\s*([\s,]\s*(0|1|0?\.\d+|(\d{1,3})%)\s*)?\)/i.exec(e);return t?{a:t.length>4?f3(t[k6.a]):1,b:parseInt(t[k6.b],10),g:parseInt(t[k6.g],10),r:parseInt(t[k6.r],10)}:void 0}}class F6{init(e){const t=e.container,n=e.options.size.animation;var i;n.enable&&(e.size.velocity=(null!==(i=e.retina.sizeAnimationSpeed)&&void 0!==i?i:t.retina.sizeAnimationSpeed)/U2*t.retina.reduceFactor,n.sync||(e.size.velocity*=n3()))}isEnabled(e){var t,n,i,r;return!e.destroyed&&!e.spawning&&e.size.enable&&((null!==(t=e.size.maxLoops)&&void 0!==t?t:0)<=0||(null!==(n=e.size.maxLoops)&&void 0!==n?n:0)>0&&(null!==(i=e.size.loops)&&void 0!==i?i:0)<(null!==(r=e.size.maxLoops)&&void 0!==r?r:0))}reset(e){e.size.loops=0}update(e,t){this.isEnabled(e)&&W3(e,e.size,!0,e.options.size.animation.destroy,t)}}async function U6(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addColorManager(new E6,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addColorManager(new R6,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addColorManager(new B6,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addMover("base",(()=>Promise.resolve(new v6)),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new _6,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("color",(t=>Promise.resolve(new w6(t,e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("opacity",(e=>Promise.resolve(new P6(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("outModes",(e=>Promise.resolve(new O6(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("size",(()=>Promise.resolve(new F6)),t)}(e,!1),await e.refresh(t)}const z6='"Twemoji Mozilla", Apple Color Emoji, "Segoe UI Emoji", "Noto Color Emoji", "EmojiOne Color"';class q6{constructor(){this.validTypes=["emoji"],this._emojiShapeDict=new Map}destroy(){for(const[e,t]of this._emojiShapeDict)t instanceof ImageBitmap&&(null===t||void 0===t||t.close()),this._emojiShapeDict.delete(e)}draw(e){const t=e.particle.emojiDataKey;if(!t)return;const n=this._emojiShapeDict.get(t);n&&function(e,t){const{context:n,opacity:i}=e,r=n.globalAlpha;if(!t)return;const s=t.width,o=.5*s;n.globalAlpha=i,n.drawImage(t,-o,-o,s,s),n.globalAlpha=r}(e,n)}async init(e){const t=e.actualOptions,{validTypes:n}=this;if(!n.find((e=>C3(e,t.particles.shape.type))))return;const i=[R3(z6)],r=n.map((e=>t.particles.shape.options[e])).find((e=>!!e));r&&z3(r,(e=>{e.font&&i.push(R3(e.font))})),await Promise.all(i)}particleDestroy(e){e.emojiDataKey=void 0}particleInit(e,t){var n,i;const r=t.shapeData;if(null===r||void 0===r||!r.value)return;const s=q3(r.value,t.randomIndexData);if(!s)return;const o="string"===typeof s?{font:null!==(n=r.font)&&void 0!==n?n:z6,padding:null!==(i=r.padding)&&void 0!==i?i:0,value:s}:M(M({font:z6,padding:0},r),s),a=o.font,l=o.value,c="".concat(l,"_").concat(a);if(this._emojiShapeDict.has(c))return void(t.emojiDataKey=c);const u=2*o.padding,h=l3(t.size.value),d=h+u,p=2*d;let A;if("undefined"!==typeof OffscreenCanvas){const e=new OffscreenCanvas(p,p),t=e.getContext("2d");if(!t)return;t.font="400 ".concat(2*h,"px ").concat(a),t.textBaseline="middle",t.textAlign="center",t.fillText(l,d,d),A=e.transferToImageBitmap()}else{const e=document.createElement("canvas");e.width=p,e.height=p;const t=e.getContext("2d");if(!t)return;t.font="400 ".concat(2*h,"px ").concat(a),t.textBaseline="middle",t.textAlign="center",t.fillText(l,d,d),A=e}this._emojiShapeDict.set(c,A),t.emojiDataKey=c}}function V6(e,t,n,i,r,s){const o=t.actualOptions.interactivity.modes.attract;if(!o)return;const a=t.particles.quadTree.query(r,s);for(const l of a){const{dx:t,dy:r,distance:s}=u3(l.position,n),a=o.speed*o.factor,c=i3(e.getEasing(o.easing)(1-s/i)*a,1,o.maxSpeed),u=J2.create(s?t/s*c:a,s?r/s*c:a);l.position.subFrom(u)}}class G6{constructor(){this.distance=200,this.duration=.4,this.easing=A6.easeOutQuad,this.factor=1,this.maxSpeed=50,this.speed=1}load(e){X2(e)||(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.easing&&(this.easing=e.easing),void 0!==e.factor&&(this.factor=e.factor),void 0!==e.maxSpeed&&(this.maxSpeed=e.maxSpeed),void 0!==e.speed&&(this.speed=e.speed))}}const j6="attract";class H6 extends u6{constructor(e,t){super(t),this._engine=e,t.attract||(t.attract={particles:[]}),this.handleClickMode=e=>{const n=this.container.actualOptions.interactivity.modes.attract;if(n&&e===j6){t.attract||(t.attract={particles:[]}),t.attract.clicking=!0,t.attract.count=0;for(const e of t.attract.particles)this.isEnabled(e)&&e.velocity.setTo(e.initialVelocity);t.attract.particles=[],t.attract.finish=!1,setTimeout((()=>{t.destroyed||(t.attract||(t.attract={particles:[]}),t.attract.clicking=!1)}),n.duration*z2)}}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.attract;t&&(e.retina.attractModeDistance=t.distance*e.retina.pixelRatio)}interact(){const e=this.container,t=e.actualOptions,n=e.interactivity.status===k2,i=t.interactivity.events,{enable:r,mode:s}=i.onHover,{enable:o,mode:a}=i.onClick;n&&r&&C3(j6,s)?function(e,t,n){const i=t.interactivity.mouse.position,r=t.retina.attractModeDistance;!r||r<0||!i||V6(e,t,i,r,new Y5(i.x,i.y,r),(e=>n(e)))}(this._engine,this.container,(e=>this.isEnabled(e))):o&&C3(j6,a)&&function(e,t,n){t.attract||(t.attract={particles:[]});const{attract:i}=t;if(i.finish||(i.count||(i.count=0),i.count++,i.count===t.particles.count&&(i.finish=!0)),i.clicking){const i=t.interactivity.mouse.clickPosition,r=t.retina.attractModeDistance;if(!r||r<0||!i)return;V6(e,t,i,r,new Y5(i.x,i.y,r),(e=>n(e)))}else!1===i.clicking&&(i.particles=[])}(this._engine,this.container,(e=>this.isEnabled(e)))}isEnabled(e){var t;const n=this.container,i=n.actualOptions,r=n.interactivity.mouse,s=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:i.interactivity).events;if((!r.position||!s.onHover.enable)&&(!r.clickPosition||!s.onClick.enable))return!1;const o=s.onHover.mode,a=s.onClick.mode;return C3(j6,o)||C3(j6,a)}loadModeOptions(e){e.attract||(e.attract=new G6);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.attract.load(null===r||void 0===r?void 0:r.attract)}reset(){}}const W6=.5,X6=Math.PI*W6;function Y6(e,t,n,i,r){const s=e.particles.quadTree.query(i,r);for(const o of s)i instanceof Y5?F3(B3(o),{position:t,radius:n,mass:n**2*X6,velocity:J2.origin,factor:J2.origin}):i instanceof Q5&&U3(o,D3(t,n))}function Q6(e,t,n,i){O3(n,t,((t,n)=>function(e,t,n,i){const r=document.querySelectorAll(t);r.length&&r.forEach((t=>{const r=t,s=e.retina.pixelRatio,o={x:(r.offsetLeft+r.offsetWidth*W6)*s,y:(r.offsetTop+r.offsetHeight*W6)*s},a=r.offsetWidth*W6*s,l=10*s,c=n.type===P4.circle?new Y5(o.x,o.y,a+l):new Q5(r.offsetLeft*s-l,r.offsetTop*s-l,r.offsetWidth*s+2*l,r.offsetHeight*s+2*l);i(o,a,c)}))}(e,t,n,((t,n,r)=>Y6(e,t,n,r,i)))))}class K6{constructor(){this.distance=200}load(e){X2(e)||void 0!==e.distance&&(this.distance=e.distance)}}const Z6="bounce";class J6 extends u6{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bounce;t&&(e.retina.bounceModeDistance=t.distance*e.retina.pixelRatio)}interact(){const e=this.container,t=e.actualOptions.interactivity.events,n=e.interactivity.status===k2,i=t.onHover.enable,r=t.onHover.mode,s=t.onDiv;n&&i&&C3(Z6,r)?function(e,t){const n=10*e.retina.pixelRatio,i=e.interactivity.mouse.position,r=e.retina.bounceModeDistance;!r||r<0||!i||Y6(e,i,r,new Y5(i.x,i.y,r+n),t)}(this.container,(e=>this.isEnabled(e))):Q6(this.container,s,Z6,(e=>this.isEnabled(e)))}isEnabled(e){var t;const n=this.container,i=n.actualOptions,r=n.interactivity.mouse,s=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:i.interactivity).events,o=s.onDiv;return!!r.position&&s.onHover.enable&&C3(Z6,s.onHover.mode)||I3(Z6,o)}loadModeOptions(e){e.bounce||(e.bounce=new K6);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.bounce.load(null===r||void 0===r?void 0:r.bounce)}reset(){}}class $6{constructor(){this.distance=200,this.duration=.4,this.mix=!1}load(e){if(!X2(e)){if(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.mix&&(this.mix=e.mix),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.color){const t=W2(this.color)?void 0:this.color;this.color=z3(e.color,(e=>N4.create(t,e)))}void 0!==e.size&&(this.size=e.size)}}}class e8 extends $6{constructor(){super(),this.selectors=[]}load(e){super.load(e),X2(e)||void 0!==e.selectors&&(this.selectors=e.selectors)}}class t8 extends $6{load(e){super.load(e),X2(e)||(this.divs=z3(e.divs,(e=>{const t=new e8;return t.load(e),t})))}}var n8;function i8(e,t,n,i){if(t>=n){return i3(e+(t-n)*i,e,t)}if(t<n){return i3(e-(n-t)*i,t,e)}}!function(e){e.color="color",e.opacity="opacity",e.size="size"}(n8||(n8={}));const r8="bubble";class s8 extends u6{constructor(e,t){super(e),this._clickBubble=()=>{const e=this.container,t=e.actualOptions,n=e.interactivity.mouse.clickPosition,i=t.interactivity.modes.bubble;if(!i||!n)return;e.bubble||(e.bubble={});const r=e.retina.bubbleModeDistance;if(!r||r<0)return;const s=e.particles.quadTree.queryCircle(n,r,(e=>this.isEnabled(e))),{bubble:o}=e;for(const u of s){var a,l,c;if(!o.clicking)continue;u.bubble.inRange=!o.durationEnd;const t=h3(u.getPosition(),n),s=((new Date).getTime()-(null!==(a=e.interactivity.mouse.clickTime)&&void 0!==a?a:0))/z2;s>i.duration&&(o.durationEnd=!0),s>2*i.duration&&(o.clicking=!1,o.durationEnd=!1);const h={bubbleObj:{optValue:e.retina.bubbleModeSize,value:u.bubble.radius},particlesObj:{optValue:l3(u.options.size.value)*e.retina.pixelRatio,value:u.size.value},type:n8.size};this._process(u,t,s,h);const d={bubbleObj:{optValue:i.opacity,value:u.bubble.opacity},particlesObj:{optValue:l3(u.options.opacity.value),value:null!==(l=null===(c=u.opacity)||void 0===c?void 0:c.value)&&void 0!==l?l:1},type:n8.opacity};this._process(u,t,s,d),!o.durationEnd&&t<=r?this._hoverBubbleColor(u,t):delete u.bubble.color}},this._hoverBubble=()=>{const e=this.container,t=e.interactivity.mouse.position,n=e.retina.bubbleModeDistance;if(!n||n<0||!t)return;const i=e.particles.quadTree.queryCircle(t,n,(e=>this.isEnabled(e)));for(const r of i){r.bubble.inRange=!0;const i=h3(r.getPosition(),t),s=1-i/n;i<=n?s>=0&&e.interactivity.status===k2&&(this._hoverBubbleSize(r,s),this._hoverBubbleOpacity(r,s),this._hoverBubbleColor(r,s)):this.reset(r),e.interactivity.status===O2&&this.reset(r)}},this._hoverBubbleColor=(e,t,n)=>{const i=this.container.actualOptions,r=null!==n&&void 0!==n?n:i.interactivity.modes.bubble;if(r){if(!e.bubble.finalColor){const t=r.color;if(!t)return;const n=q3(t);e.bubble.finalColor=e4(this._engine,n)}if(e.bubble.finalColor)if(r.mix){e.bubble.color=void 0;const n=e.getFillColor();e.bubble.color=n?t4(o4(n,e.bubble.finalColor,1-t,t)):e.bubble.finalColor}else e.bubble.color=e.bubble.finalColor}},this._hoverBubbleOpacity=(e,t,n)=>{var i,r,s,o;const a=this.container.actualOptions,l=null!==(i=null===n||void 0===n?void 0:n.opacity)&&void 0!==i?i:null===(r=a.interactivity.modes.bubble)||void 0===r?void 0:r.opacity;if(!l)return;const c=e.options.opacity.value,u=i8(null!==(s=null===(o=e.opacity)||void 0===o?void 0:o.value)&&void 0!==s?s:1,l,l3(c),t);void 0!==u&&(e.bubble.opacity=u)},this._hoverBubbleSize=(e,t,n)=>{const i=this.container,r=null!==n&&void 0!==n&&n.size?n.size*i.retina.pixelRatio:i.retina.bubbleModeSize;if(void 0===r)return;const s=l3(e.options.size.value)*i.retina.pixelRatio,o=i8(e.size.value,r,s,t);void 0!==o&&(e.bubble.radius=o)},this._process=(e,t,n,i)=>{var r;const s=this.container,o=i.bubbleObj.optValue,a=s.actualOptions.interactivity.modes.bubble;if(!a||void 0===o)return;const l=a.duration,c=s.retina.bubbleModeDistance,u=i.particlesObj.optValue,h=i.bubbleObj.value,d=null!==(r=i.particlesObj.value)&&void 0!==r?r:0,p=i.type;if(c&&!(c<0)&&o!==u)if(s.bubble||(s.bubble={}),s.bubble.durationEnd)h&&(p===n8.size&&delete e.bubble.radius,p===n8.opacity&&delete e.bubble.opacity);else if(t<=c){if((null!==h&&void 0!==h?h:d)!==o){const t=d-n*(d-o)/l;p===n8.size&&(e.bubble.radius=t),p===n8.opacity&&(e.bubble.opacity=t)}}else p===n8.size&&delete e.bubble.radius,p===n8.opacity&&delete e.bubble.opacity},this._singleSelectorHover=(e,t,n)=>{const i=this.container,r=document.querySelectorAll(t),s=i.actualOptions.interactivity.modes.bubble;s&&r.length&&r.forEach((t=>{const r=t,o=i.retina.pixelRatio,a={x:(r.offsetLeft+.5*r.offsetWidth)*o,y:(r.offsetTop+.5*r.offsetHeight)*o},l=.5*r.offsetWidth*o,c=n.type===P4.circle?new Y5(a.x,a.y,l):new Q5(r.offsetLeft*o,r.offsetTop*o,r.offsetWidth*o,r.offsetHeight*o),u=i.particles.quadTree.query(c,(e=>this.isEnabled(e)));for(const n of u){if(!c.contains(n.getPosition()))continue;n.bubble.inRange=!0;const t=k3(s.divs,r);n.bubble.div&&n.bubble.div===r||(this.clear(n,e,!0),n.bubble.div=r),this._hoverBubbleSize(n,1,t),this._hoverBubbleOpacity(n,1,t),this._hoverBubbleColor(n,1,t)}}))},this._engine=t,e.bubble||(e.bubble={}),this.handleClickMode=t=>{t===r8&&(e.bubble||(e.bubble={}),e.bubble.clicking=!0)}}clear(e,t,n){e.bubble.inRange&&!n||(delete e.bubble.div,delete e.bubble.opacity,delete e.bubble.radius,delete e.bubble.color)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bubble;t&&(e.retina.bubbleModeDistance=t.distance*e.retina.pixelRatio,void 0!==t.size&&(e.retina.bubbleModeSize=t.size*e.retina.pixelRatio))}interact(e){const t=this.container.actualOptions.interactivity.events,n=t.onHover,i=t.onClick,r=n.enable,s=n.mode,o=i.enable,a=i.mode,l=t.onDiv;r&&C3(r8,s)?this._hoverBubble():o&&C3(r8,a)?this._clickBubble():O3(r8,l,((t,n)=>this._singleSelectorHover(e,t,n)))}isEnabled(e){var t;const n=this.container,i=n.actualOptions,r=n.interactivity.mouse,s=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:i.interactivity).events,{onClick:o,onDiv:a,onHover:l}=s,c=I3(r8,a);return!!(c||l.enable&&r.position||o.enable&&r.clickPosition)&&(C3(r8,l.mode)||C3(r8,o.mode)||c)}loadModeOptions(e){e.bubble||(e.bubble=new t8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.bubble.load(null===r||void 0===r?void 0:r.bubble)}reset(e){e.bubble.inRange=!1}}class o8{constructor(){this.opacity=.5}load(e){X2(e)||void 0!==e.opacity&&(this.opacity=e.opacity)}}class a8{constructor(){this.distance=80,this.links=new o8,this.radius=60}load(e){X2(e)||(void 0!==e.distance&&(this.distance=e.distance),this.links.load(e.links),void 0!==e.radius&&(this.radius=e.radius))}}function l8(e,t,n,i){const r=e.actualOptions.interactivity.modes.connect;if(r)return function(e,t,n,i){const r=Math.floor(n.getRadius()/t.getRadius()),s=t.getFillColor(),o=n.getFillColor();if(!s||!o)return;const a=t.getPosition(),l=n.getPosition(),c=o4(s,o,t.getRadius(),n.getRadius()),u=e.createLinearGradient(a.x,a.y,l.x,l.y);return u.addColorStop(0,s4(s,i)),u.addColorStop(i3(r,0,1),r4(c,i)),u.addColorStop(1,s4(o,i)),u}(t,n,i,r.links.opacity)}function c8(e,t,n){e.canvas.draw((i=>{var r;const s=l8(e,i,t,n);if(!s)return;const o=t.getPosition(),a=n.getPosition();!function(e,t,n,i,r){b4(e,i,r),e.lineWidth=t,e.strokeStyle=n,e.stroke()}(i,null!==(r=t.retina.linksWidth)&&void 0!==r?r:0,s,o,a)}))}class u8 extends u6{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.connect;t&&(e.retina.connectModeDistance=t.distance*e.retina.pixelRatio,e.retina.connectModeRadius=t.radius*e.retina.pixelRatio)}interact(){const e=this.container;if(e.actualOptions.interactivity.events.onHover.enable&&"pointermove"===e.interactivity.status){const t=e.interactivity.mouse.position,{connectModeDistance:n,connectModeRadius:i}=e.retina;if(!n||n<0||!i||i<0||!t)return;const r=Math.abs(i),s=e.particles.quadTree.queryCircle(t,r,(e=>this.isEnabled(e)));s.forEach(((t,i)=>{const r=t.getPosition();for(const o of s.slice(i+1)){const i=o.getPosition(),s=Math.abs(n),a=Math.abs(r.x-i.x),l=Math.abs(r.y-i.y);a<s&&l<s&&c8(e,t,o)}}))}}isEnabled(e){var t;const n=this.container,i=n.interactivity.mouse,r=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:n.actualOptions.interactivity).events;return!(!r.onHover.enable||!i.position)&&C3("connect",r.onHover.mode)}loadModeOptions(e){e.connect||(e.connect=new a8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.connect.load(null===r||void 0===r?void 0:r.connect)}reset(){}}class h8{constructor(){this.blink=!1,this.consent=!1,this.opacity=1}load(e){X2(e)||(void 0!==e.blink&&(this.blink=e.blink),void 0!==e.color&&(this.color=N4.create(this.color,e.color)),void 0!==e.consent&&(this.consent=e.consent),void 0!==e.opacity&&(this.opacity=e.opacity))}}class d8{constructor(){this.distance=100,this.links=new h8}load(e){X2(e)||(void 0!==e.distance&&(this.distance=e.distance),this.links.load(e.links))}}function p8(e,t,n,i,r){e.canvas.draw((e=>{var s;const o=t.getPosition();!function(e,t,n,i,r,s){b4(e,n,i),e.strokeStyle=r4(r,s),e.lineWidth=t,e.stroke()}(e,null!==(s=t.retina.linksWidth)&&void 0!==s?s:0,o,r,n,i)}))}class A8 extends u6{constructor(e,t){super(e),this._engine=t}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.grab;t&&(e.retina.grabModeDistance=t.distance*e.retina.pixelRatio)}interact(){const e=this.container,t=e.actualOptions.interactivity;if(!t.modes.grab||!t.events.onHover.enable||e.interactivity.status!==k2)return;const n=e.interactivity.mouse.position;if(!n)return;const i=e.retina.grabModeDistance;if(!i||i<0)return;const r=e.particles.quadTree.queryCircle(n,i,(e=>this.isEnabled(e)));for(const a of r){var s,o;const r=h3(a.getPosition(),n);if(r>i)continue;const l=t.modes.grab.links,c=l.opacity,u=c-r*c/i;if(u<=0)continue;const h=null!==(s=l.color)&&void 0!==s?s:null===(o=a.options.links)||void 0===o?void 0:o.color;if(!e.particles.grabLineColor&&h){const n=t.modes.grab.links;e.particles.grabLineColor=l4(this._engine,h,n.blink,n.consent)}const d=a4(a,void 0,e.particles.grabLineColor);d&&p8(e,a,d,u,n)}}isEnabled(e){var t;const n=this.container,i=n.interactivity.mouse,r=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:n.actualOptions.interactivity).events;return r.onHover.enable&&!!i.position&&C3("grab",r.onHover.mode)}loadModeOptions(e){e.grab||(e.grab=new d8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.grab.load(null===r||void 0===r?void 0:r.grab)}reset(){}}class f8 extends u6{constructor(e){super(e),this.handleClickMode=e=>{if("pause"!==e)return;const t=this.container;t.animationStatus?t.pause():t.play()}}clear(){}init(){}interact(){}isEnabled(){return!0}reset(){}}class m8{constructor(){this.default=!0,this.groups=[],this.quantity=4}load(e){if(X2(e))return;void 0!==e.default&&(this.default=e.default),void 0!==e.groups&&(this.groups=e.groups.map((e=>e))),this.groups.length||(this.default=!0);const t=e.quantity;void 0!==t&&(this.quantity=c3(t))}}class g8 extends u6{constructor(e){super(e),this.handleClickMode=e=>{if("push"!==e)return;const t=this.container,n=t.actualOptions.interactivity.modes.push;if(!n)return;const i=o3(n.quantity);if(i<=0)return;const r=P3([void 0,...n.groups]),s=void 0!==r?t.actualOptions.particles.groups[r]:void 0;t.particles.push(i,t.interactivity.mouse,s,r)}}clear(){}init(){}interact(){}isEnabled(){return!0}loadModeOptions(e){e.push||(e.push=new m8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.push.load(null===r||void 0===r?void 0:r.push)}reset(){}}class v8{constructor(){this.quantity=2}load(e){if(X2(e))return;const t=e.quantity;void 0!==t&&(this.quantity=c3(t))}}class y8 extends u6{constructor(e){super(e),this.handleClickMode=e=>{const t=this.container,n=t.actualOptions;if(!n.interactivity.modes.remove||"remove"!==e)return;const i=o3(n.interactivity.modes.remove.quantity);t.particles.removeQuantity(i)}}clear(){}init(){}interact(){}isEnabled(){return!0}loadModeOptions(e){e.remove||(e.remove=new v8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.remove.load(null===r||void 0===r?void 0:r.remove)}reset(){}}class b8{constructor(){this.distance=200,this.duration=.4,this.factor=100,this.speed=1,this.maxSpeed=50,this.easing=A6.easeOutQuad}load(e){X2(e)||(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.easing&&(this.easing=e.easing),void 0!==e.factor&&(this.factor=e.factor),void 0!==e.speed&&(this.speed=e.speed),void 0!==e.maxSpeed&&(this.maxSpeed=e.maxSpeed))}}class x8 extends b8{constructor(){super(),this.selectors=[]}load(e){super.load(e),X2(e)||void 0!==e.selectors&&(this.selectors=e.selectors)}}class _8 extends b8{load(e){super.load(e),X2(e)||(this.divs=z3(e.divs,(e=>{const t=new x8;return t.load(e),t})))}}const w8="repulse";class S8 extends u6{constructor(e,t){super(t),this._clickRepulse=()=>{var e;const t=this.container,n=t.actualOptions.interactivity.modes.repulse;if(!n)return;const i=null!==(e=t.repulse)&&void 0!==e?e:{particles:[]};if(i.finish||(i.count||(i.count=0),i.count++,i.count===t.particles.count&&(i.finish=!0)),i.clicking){const e=t.retina.repulseModeDistance;if(!e||e<0)return;const r=Math.pow(e/6,3),s=t.interactivity.mouse.clickPosition;if(void 0===s)return;const o=new Y5(s.x,s.y,r),a=t.particles.quadTree.query(o,(e=>this.isEnabled(e)));for(const t of a){const{dx:e,dy:o,distance:a}=u3(s,t.position),l=a**2,c=-r*n.speed/l;if(l<=r){i.particles.push(t);const n=J2.create(e,o);n.length=c,t.velocity.setTo(n)}}}else if(!1===i.clicking){for(const e of i.particles)e.velocity.setTo(e.initialVelocity);i.particles=[]}},this._hoverRepulse=()=>{const e=this.container,t=e.interactivity.mouse.position,n=e.retina.repulseModeDistance;!n||n<0||!t||this._processRepulse(t,n,new Y5(t.x,t.y,n))},this._processRepulse=(e,t,n,i)=>{var r;const s=this.container,o=s.particles.quadTree.query(n,(e=>this.isEnabled(e))),a=s.actualOptions.interactivity.modes.repulse;if(!a)return;const{easing:l,speed:c,factor:u,maxSpeed:h}=a,d=this._engine.getEasing(l),p=(null!==(r=null===i||void 0===i?void 0:i.speed)&&void 0!==r?r:c)*u;for(const A of o){const{dx:n,dy:i,distance:r}=u3(A.position,e),s=i3(d(1-r/t)*p,0,h),o=J2.create(r?n/r*s:p,r?i/r*s:p);A.position.addTo(o)}},this._singleSelectorRepulse=(e,t)=>{const n=this.container,i=n.actualOptions.interactivity.modes.repulse;if(!i)return;const r=document.querySelectorAll(e);r.length&&r.forEach((e=>{const r=e,s=n.retina.pixelRatio,o={x:(r.offsetLeft+.5*r.offsetWidth)*s,y:(r.offsetTop+.5*r.offsetHeight)*s},a=.5*r.offsetWidth*s,l=t.type===P4.circle?new Y5(o.x,o.y,a):new Q5(r.offsetLeft*s,r.offsetTop*s,r.offsetWidth*s,r.offsetHeight*s),c=k3(i.divs,r);this._processRepulse(o,a,l,c)}))},this._engine=e,t.repulse||(t.repulse={particles:[]}),this.handleClickMode=e=>{const n=this.container.actualOptions.interactivity.modes.repulse;if(!n||e!==w8)return;t.repulse||(t.repulse={particles:[]});const i=t.repulse;i.clicking=!0,i.count=0;for(const r of t.repulse.particles)this.isEnabled(r)&&r.velocity.setTo(r.initialVelocity);i.particles=[],i.finish=!1,setTimeout((()=>{t.destroyed||(i.clicking=!1)}),n.duration*z2)}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.repulse;t&&(e.retina.repulseModeDistance=t.distance*e.retina.pixelRatio)}interact(){const e=this.container,t=e.actualOptions,n=e.interactivity.status===k2,i=t.interactivity.events,r=i.onHover,s=r.enable,o=r.mode,a=i.onClick,l=a.enable,c=a.mode,u=i.onDiv;n&&s&&C3(w8,o)?this._hoverRepulse():l&&C3(w8,c)?this._clickRepulse():O3(w8,u,((e,t)=>this._singleSelectorRepulse(e,t)))}isEnabled(e){var t;const n=this.container,i=n.actualOptions,r=n.interactivity.mouse,s=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:i.interactivity).events,o=s.onDiv,a=s.onHover,l=s.onClick,c=I3(w8,o);if(!(c||a.enable&&r.position||l.enable&&r.clickPosition))return!1;const u=a.mode,h=l.mode;return C3(w8,u)||C3(w8,h)||c}loadModeOptions(e){e.repulse||(e.repulse=new _8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.repulse.load(null===r||void 0===r?void 0:r.repulse)}reset(){}}class T8{constructor(){this.factor=3,this.radius=200}load(e){X2(e)||(void 0!==e.factor&&(this.factor=e.factor),void 0!==e.radius&&(this.radius=e.radius))}}class M8 extends u6{constructor(e){super(e)}clear(e,t,n){e.slow.inRange&&!n||(e.slow.factor=1)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.slow;t&&(e.retina.slowModeRadius=t.radius*e.retina.pixelRatio)}interact(){}isEnabled(e){var t;const n=this.container,i=n.interactivity.mouse,r=(null!==(t=null===e||void 0===e?void 0:e.interactivity)&&void 0!==t?t:n.actualOptions.interactivity).events;return r.onHover.enable&&!!i.position&&C3("slow",r.onHover.mode)}loadModeOptions(e){e.slow||(e.slow=new T8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.slow.load(null===r||void 0===r?void 0:r.slow)}reset(e){e.slow.inRange=!1;const t=this.container,n=t.actualOptions,i=t.interactivity.mouse.position,r=t.retina.slowModeRadius,s=n.interactivity.modes.slow;if(!s||!r||r<0||!i)return;const o=h3(i,e.getPosition()),a=o/r,l=s.factor,{slow:c}=e;o>r||(c.inRange=!0,c.factor=a/l)}}const E8=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?\))|currentcolor/gi;async function C8(e){return new Promise((t=>{e.loading=!0;const n=new Image;e.element=n,n.addEventListener("load",(()=>{e.loading=!1,t()})),n.addEventListener("error",(()=>{e.element=void 0,e.error=!0,e.loading=!1,S3().error("".concat(F2," loading image: ").concat(e.source)),t()})),n.src=e.source}))}async function R8(e){if("svg"!==e.type)return void await C8(e);e.loading=!0;const t=await fetch(e.source);t.ok?e.svgData=await t.text():(S3().error("".concat(F2," Image not found")),e.error=!0),e.loading=!1}function P8(e,t,n,i){var r,s;const o=function(e,t,n){const{svgData:i}=e;if(!i)return"";const r=s4(t,n);if(i.includes("fill"))return i.replace(E8,(()=>r));const s=i.indexOf(">");return"".concat(i.substring(0,s),' fill="').concat(r,'"').concat(i.substring(s))}(e,n,null!==(r=null===(s=i.opacity)||void 0===s?void 0:s.value)&&void 0!==r?r:1),a={color:n,gif:t.gif,data:M(M({},e),{},{svgData:o}),loaded:!1,ratio:t.width/t.height,replaceColor:t.replaceColor,source:t.src};return new Promise((t=>{const n=new Blob([o],{type:"image/svg+xml"}),i=URL||window.URL||window.webkitURL||window,r=i.createObjectURL(n),s=new Image;s.addEventListener("load",(()=>{a.loaded=!0,a.element=s,t(a),i.revokeObjectURL(r)}));s.addEventListener("error",(()=>{(async()=>{i.revokeObjectURL(r);const n=M(M({},e),{},{error:!1,loading:!0});await C8(n),a.loaded=!0,a.element=n.element,t(a)})()})),s.src=r}))}const N8=[0,4,2,1],D8=[8,8,4,2];class L8{constructor(e){this.pos=0,this.data=new Uint8ClampedArray(e)}getString(e){const t=this.data.slice(this.pos,this.pos+e);return this.pos+=t.length,t.reduce(((e,t)=>e+String.fromCharCode(t)),"")}nextByte(){return this.data[this.pos++]}nextTwoBytes(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}readSubBlocks(){let e="",t=0;do{t=this.data[this.pos++];for(let n=t;--n>=0;e+=String.fromCharCode(this.data[this.pos++]));}while(0!==t);return e}readSubBlocksBin(){let e=this.data[this.pos],t=0;for(let i=0;0!==e;i+=e+1,e=this.data[this.pos+i])t+=e;const n=new Uint8Array(t);e=this.data[this.pos++];for(let i=0;0!==e;e=this.data[this.pos++])for(let t=e;--t>=0;n[i++]=this.data[this.pos++]);return n}skipSubBlocks(){for(const e=1,t=0;this.data[this.pos]!==t;this.pos+=this.data[this.pos]+e);this.pos++}}var I8,O8;!function(e){e[e.Replace=0]="Replace",e[e.Combine=1]="Combine",e[e.RestoreBackground=2]="RestoreBackground",e[e.RestorePrevious=3]="RestorePrevious",e[e.UndefinedA=4]="UndefinedA",e[e.UndefinedB=5]="UndefinedB",e[e.UndefinedC=6]="UndefinedC",e[e.UndefinedD=7]="UndefinedD"}(I8||(I8={})),function(e){e[e.Extension=33]="Extension",e[e.ApplicationExtension=255]="ApplicationExtension",e[e.GraphicsControlExtension=249]="GraphicsControlExtension",e[e.PlainTextExtension=1]="PlainTextExtension",e[e.CommentExtension=254]="CommentExtension",e[e.Image=44]="Image",e[e.EndOfFile=59]="EndOfFile"}(O8||(O8={}));const k8=0,B8=0;function F8(e,t){const n=[];for(let i=0;i<t;i++)n.push({r:e.data[e.pos],g:e.data[e.pos+1],b:e.data[e.pos+2]}),e.pos+=3;return n}async function U8(e,t,n,i,r,s){switch(e.nextByte()){case O8.EndOfFile:return!0;case O8.Image:await async function(e,t,n,i,r,s){const o=t.frames[i(!0)];o.left=e.nextTwoBytes(),o.top=e.nextTwoBytes(),o.width=e.nextTwoBytes(),o.height=e.nextTwoBytes();const a=e.nextByte(),l=128===(128&a),c=64===(64&a);o.sortFlag=32===(32&a),o.reserved=(24&a)>>>3;const u=1<<1+(7&a);l&&(o.localColorTable=F8(e,u));const h=e=>{const{r:i,g:s,b:a}=(l?o.localColorTable:t.globalColorTable)[e];return e!==r(null)?{r:i,g:s,b:a,a:255}:{r:i,g:s,b:a,a:n?~~((i+s+a)/3):0}},d=(()=>{try{return new ImageData(o.width,o.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==d)throw new EvalError("GIF frame size is to large");const p=e.nextByte(),A=e.readSubBlocksBin(),f=1<<p,m=(e,t)=>{const n=e>>>3,i=7&e;return(A[n]+(A[n+1]<<8)+(A[n+2]<<16)&(1<<t)-1<<i)>>>i};if(c){for(let n=0,r=p+1,a=0,l=[[0]],c=0;c<4;c++){if(N8[c]<o.height){let e=0,t=0,i=!1;for(;!i;){const s=n;if(n=m(a,r),a+=r+1,n===f){r=p+1,l.length=f+2;for(let e=0;e<l.length;e++)l[e]=e<f?[e]:[]}else{n>=l.length?l.push(l[s].concat(l[s][0])):s!==f&&l.push(l[s].concat(l[n][0]));for(const i of l[n]){const{r:n,g:r,b:s,a:a}=h(i);d.data.set([n,r,s,a],N8[c]*o.width+D8[c]*t+e%(4*o.width)),e+=4}l.length===1<<r&&r<12&&r++}e===4*o.width*(t+1)&&(t++,N8[c]+D8[c]*t>=o.height&&(i=!0))}}null===s||void 0===s||s(e.pos/(e.data.length-1),i(!1)+1,d,{x:o.left,y:o.top},{width:t.width,height:t.height})}o.image=d,o.bitmap=await createImageBitmap(d)}else{let n=0,r=p+1,a=0,l=-4,c=!1;const u=[[0]];for(;!c;){const e=n;if(n=m(a,r),a+=r,n===f){r=p+1,u.length=f+2;for(let e=0;e<u.length;e++)u[e]=e<f?[e]:[]}else{if(n===f+1){c=!0;break}n>=u.length?u.push(u[e].concat(u[e][0])):e!==f&&u.push(u[e].concat(u[n][0]));for(const e of u[n]){const{r:t,g:n,b:i,a:r}=h(e);d.data.set([t,n,i,r],l+=4)}u.length>=1<<r&&r<12&&r++}}o.image=d,o.bitmap=await createImageBitmap(d),null===s||void 0===s||s((e.pos+1)/e.data.length,i(!1)+1,o.image,{x:o.left,y:o.top},{width:t.width,height:t.height})}}(e,t,n,i,r,s);break;case O8.Extension:!function(e,t,n,i){switch(e.nextByte()){case O8.GraphicsControlExtension:{const r=t.frames[n(!1)];e.pos++;const s=e.nextByte();r.GCreserved=(224&s)>>>5,r.disposalMethod=(28&s)>>>2,r.userInputDelayFlag=2===(2&s);const o=1===(1&s);r.delayTime=10*e.nextTwoBytes();const a=e.nextByte();o&&i(a),e.pos++;break}case O8.ApplicationExtension:{e.pos++;const n={identifier:e.getString(8),authenticationCode:e.getString(3),data:e.readSubBlocksBin()};t.applicationExtensions.push(n);break}case O8.CommentExtension:t.comments.push([n(!1),e.readSubBlocks()]);break;case O8.PlainTextExtension:if(0===t.globalColorTable.length)throw new EvalError("plain text extension without global color table");e.pos++,t.frames[n(!1)].plainTextData={left:e.nextTwoBytes(),top:e.nextTwoBytes(),width:e.nextTwoBytes(),height:e.nextTwoBytes(),charSize:{width:e.nextTwoBytes(),height:e.nextTwoBytes()},foregroundColor:e.nextByte(),backgroundColor:e.nextByte(),text:e.readSubBlocks()};break;default:e.skipSubBlocks()}}(e,t,i,r);break;default:throw new EvalError("undefined block found")}return!1}async function z8(e){if("gif"===e.type){e.loading=!0;try{var t;e.gifData=await async function(e,t,n){n||(n=!1);const i=await fetch(e);if(!i.ok&&404===i.status)throw new EvalError("file not found");const r=await i.arrayBuffer(),s={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},o=new L8(new Uint8ClampedArray(r));if("GIF89a"!==o.getString(6))throw new Error("not a supported GIF file");s.width=o.nextTwoBytes(),s.height=o.nextTwoBytes();const a=o.nextByte(),l=128===(128&a);s.colorRes=(112&a)>>>4,s.sortFlag=8===(8&a);const c=1<<1+(7&a),u=o.nextByte();s.pixelAspectRatio=o.nextByte(),0!==s.pixelAspectRatio&&(s.pixelAspectRatio=(s.pixelAspectRatio+15)/64),l&&(s.globalColorTable=F8(o,c));const h=(()=>{try{return new ImageData(s.width,s.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==h)throw new Error("GIF frame size is to large");const{r:d,g:p,b:A}=s.globalColorTable[u];h.data.set(l?[d,p,A,255]:[0,0,0,0]);for(let x=4;x<h.data.length;x*=2)h.data.copyWithin(x,0,x);s.backgroundImage=h;let f=-1,m=!0,g=-1;const v=e=>(e&&(m=!0),f),y=e=>(null!=e&&(g=e),g);try{do{m&&(s.frames.push({left:0,top:0,width:0,height:0,disposalMethod:I8.Replace,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),f++,g=-1,m=!1)}while(!await U8(o,s,n,v,y,t));s.frames.length--;for(const e of s.frames){if(e.userInputDelayFlag&&0===e.delayTime){s.totalTime=1/0;break}s.totalTime+=e.delayTime}return s}catch(b){if(b instanceof EvalError)throw new Error("error while parsing frame ".concat(f,' "').concat(b.message,'"'));throw b}}(e.source),e.gifLoopCount=null!==(t=function(e){for(const t of e.applicationExtensions)if(t.identifier+t.authenticationCode==="NETSCAPE2.0")return t.data[1]+(t.data[2]<<8);return NaN}(e.gifData))&&void 0!==t?t:0,e.gifLoopCount||(e.gifLoopCount=1/0)}catch(n){e.error=!0}e.loading=!1}else await C8(e)}class q8{constructor(e){this.validTypes=["image","images"],this.loadImageShape=async e=>{var t;if(!this._engine.loadImage)throw new Error("".concat(F2," image shape not initialized"));await this._engine.loadImage({gif:e.gif,name:e.name,replaceColor:null!==(t=e.replaceColor)&&void 0!==t&&t,src:e.src})},this._engine=e}addImage(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}draw(e){const{context:t,radius:n,particle:i,opacity:r}=e,s=i.image,o=null===s||void 0===s?void 0:s.element;if(s){if(t.globalAlpha=r,s.gif&&s.gifData)!function(e){var t;const{context:n,radius:i,particle:r,delta:s}=e,o=r.image;if(null===o||void 0===o||!o.gifData||!o.gif)return;const a=new OffscreenCanvas(o.gifData.width,o.gifData.height),l=a.getContext("2d");if(!l)throw new Error("could not create offscreen canvas context");var c;l.imageSmoothingQuality="low",l.imageSmoothingEnabled=!1,l.clearRect(k8,B8,a.width,a.height),void 0===r.gifLoopCount&&(r.gifLoopCount=null!==(c=o.gifLoopCount)&&void 0!==c?c:0);let u=null!==(t=r.gifFrame)&&void 0!==t?t:0;const h={x:.5*-o.gifData.width,y:.5*-o.gifData.height},d=o.gifData.frames[u];if(void 0===r.gifTime&&(r.gifTime=0),d.bitmap){switch(n.scale(i/o.gifData.width,i/o.gifData.height),d.disposalMethod){case I8.UndefinedA:case I8.UndefinedB:case I8.UndefinedC:case I8.UndefinedD:case I8.Replace:l.drawImage(d.bitmap,d.left,d.top),n.drawImage(a,h.x,h.y),l.clearRect(k8,B8,a.width,a.height);break;case I8.Combine:l.drawImage(d.bitmap,d.left,d.top),n.drawImage(a,h.x,h.y);break;case I8.RestoreBackground:l.drawImage(d.bitmap,d.left,d.top),n.drawImage(a,h.x,h.y),l.clearRect(k8,B8,a.width,a.height),o.gifData.globalColorTable.length?l.putImageData(o.gifData.backgroundImage,h.x,h.y):l.putImageData(o.gifData.frames[0].image,h.x+d.left,h.y+d.top);break;case I8.RestorePrevious:{const e=l.getImageData(k8,B8,a.width,a.height);l.drawImage(d.bitmap,d.left,d.top),n.drawImage(a,h.x,h.y),l.clearRect(k8,B8,a.width,a.height),l.putImageData(e,k8,B8)}}if(r.gifTime+=s.value,r.gifTime>d.delayTime){if(r.gifTime-=d.delayTime,++u>=o.gifData.frames.length){if(--r.gifLoopCount<=0)return;u=0,l.clearRect(k8,B8,a.width,a.height)}r.gifFrame=u}n.scale(o.gifData.width/i,o.gifData.height/i)}}(e);else if(o){const e=s.ratio,i={x:-n,y:-n},r=2*n;t.drawImage(o,i.x,i.y,r,r/e)}t.globalAlpha=1}}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(t.preload&&this._engine.loadImage)for(const n of t.preload)await this._engine.loadImage(n)}loadShape(e){if("image"!==e.shape&&"images"!==e.shape)return;this._engine.images||(this._engine.images=[]);const t=e.shapeData;if(!t)return;this._engine.images.find((e=>e.name===t.name||e.source===t.src))||this.loadImageShape(t).then((()=>{this.loadShape(e)}))}particleInit(e,t){var n;if("image"!==t.shape&&"images"!==t.shape)return;this._engine.images||(this._engine.images=[]);const i=this._engine.images,r=t.shapeData;if(!r)return;const s=t.getFillColor(),o=i.find((e=>e.name===r.name||e.source===r.src));if(!o)return;const a=null!==(n=r.replaceColor)&&void 0!==n?n:o.replaceColor;o.loading?setTimeout((()=>{this.particleInit(e,t)})):(async(e,n)=>{let i;var l;o.svgData&&s?i=await P8(o,r,s,t):i={color:s,data:o,element:o.element,gif:o.gif,gifData:o.gifData,gifLoopCount:o.gifLoopCount,loaded:!0,ratio:r.width&&r.height?r.width/r.height:null!==(l=o.ratio)&&void 0!==l?l:1,replaceColor:a,source:r.src};i.ratio||(i.ratio=1);const c={image:i,fill:null!==(e=r.fill)&&void 0!==e?e:t.shapeFill,close:null!==(n=r.close)&&void 0!==n?n:t.shapeClose};t.image=c.image,t.shapeFill=c.fill,t.shapeClose=c.close})()}}class V8{constructor(){this.src="",this.gif=!1}load(e){X2(e)||(void 0!==e.gif&&(this.gif=e.gif),void 0!==e.height&&(this.height=e.height),void 0!==e.name&&(this.name=e.name),void 0!==e.replaceColor&&(this.replaceColor=e.replaceColor),void 0!==e.src&&(this.src=e.src),void 0!==e.width&&(this.width=e.width))}}class G8{constructor(e){this.id="imagePreloader",this._engine=e}async getPlugin(){return await Promise.resolve(),{}}loadOptions(e,t){if(null===t||void 0===t||!t.preload)return;e.preload||(e.preload=[]);const n=e.preload;for(const i of t.preload){const e=n.find((e=>e.name===i.name||e.src===i.src));if(e)e.load(i);else{const e=new V8;e.load(i),n.push(e)}}}needsPlugin(){return!0}}async function j8(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),function(e){e.loadImage||(e.loadImage=async t=>{if(!t.name&&!t.src)throw new Error("".concat(F2," no image source provided"));if(e.images||(e.images=[]),!e.images.find((e=>e.name===t.name||e.source===t.src)))try{var n,i;const r={gif:null!==(n=t.gif)&&void 0!==n&&n,name:null!==(i=t.name)&&void 0!==i?i:t.src,source:t.src,type:t.src.substring(t.src.length-3),error:!1,loading:!0,replaceColor:t.replaceColor,ratio:t.width&&t.height?t.width/t.height:void 0};let s;e.images.push(r),s=t.gif?z8:t.replaceColor?R8:C8,await s(r)}catch(s){var r;throw new Error("".concat(F2," ").concat(null!==(r=t.name)&&void 0!==r?r:t.src," not found"))}})}(e);const n=new G8(e);await e.addPlugin(n,t),await e.addShape(new q8(e),t)}class H8 extends l5{constructor(){super(),this.sync=!1}load(e){X2(e)||(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class W8 extends l5{constructor(){super(),this.sync=!1}load(e){X2(e)||(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class X8{constructor(){this.count=0,this.delay=new H8,this.duration=new W8}load(e){X2(e)||(void 0!==e.count&&(this.count=e.count),this.delay.load(e.delay),this.duration.load(e.duration))}}class Y8{constructor(e){this.container=e}init(e){const t=this.container,n=e.options.life;n&&(e.life={delay:t.retina.reduceFactor?o3(n.delay.value)*(n.delay.sync?1:n3())/t.retina.reduceFactor*z2:0,delayTime:0,duration:t.retina.reduceFactor?o3(n.duration.value)*(n.duration.sync?1:n3())/t.retina.reduceFactor*z2:0,time:0,count:n.count},e.life.duration<=0&&(e.life.duration=-1),e.life.count<=0&&(e.life.count=-1),e.life&&(e.spawning=e.life.delay>0))}isEnabled(e){return!e.destroyed}loadOptions(e){e.life||(e.life=new X8);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.life.load(null===r||void 0===r?void 0:r.life)}update(e,t){this.isEnabled(e)&&e.life&&function(e,t,n){if(!e.life)return;const i=e.life;let r=!1;if(e.spawning){if(i.delayTime+=t.value,!(i.delayTime>=e.life.delay))return;r=!0,e.spawning=!1,i.delayTime=0,i.time=0}if(-1===i.duration)return;if(e.spawning)return;if(r?i.time=0:i.time+=t.value,i.time<i.duration)return;if(i.time=0,e.life.count>0&&e.life.count--,0===e.life.count)return void e.destroy();const s=c3(0,n.width),o=c3(0,n.width);e.position.x=s3(s),e.position.y=s3(o),e.spawning=!0,i.delayTime=0,i.time=0,e.reset();const a=e.options.life;a&&(i.delay=o3(a.delay.value)*z2,i.duration=o3(a.duration.value)*z2)}(e,t,this.container.canvas.size)}}class Q8{constructor(){this.validTypes=["line"]}draw(e){!function(e){var t;const{context:n,particle:i,radius:r}=e,s=i.shapeData;n.moveTo(-r,0),n.lineTo(r,0),n.lineCap=null!==(t=null===s||void 0===s?void 0:s.cap)&&void 0!==t?t:"butt"}(e)}getSidesCount(){return 1}}class K8{init(){}isEnabled(e){return!M3()&&!e.destroyed&&e.container.actualOptions.interactivity.events.onHover.parallax.enable}move(e){const t=e.container,n=t.actualOptions.interactivity.events.onHover.parallax;if(M3()||!n.enable)return;const i=n.force,r=t.interactivity.mouse.position;if(!r)return;const s=t.canvas.size,o=.5*s.width,a=.5*s.height,l=n.smooth,c=e.getRadius()/i,u=(r.x-o)*c,h=(r.y-a)*c,{offset:d}=e;d.x+=(u-d.x)/l,d.y+=(h-d.y)/l}}class Z8 extends h6{constructor(e){super(e)}clear(){}init(){}interact(e){const t=this.container;void 0===e.attractDistance&&(e.attractDistance=o3(e.options.move.attract.distance)*t.retina.pixelRatio);const n=e.attractDistance,i=e.getPosition(),r=t.particles.quadTree.queryCircle(i,n);for(const s of r){if(e===s||!s.options.move.attract.enable||s.destroyed||s.spawning)continue;const t=s.getPosition(),{dx:n,dy:r}=u3(i,t),o=e.options.move.attract.rotate,a=n/(1e3*o.x),l=r/(1e3*o.y),c=s.size.value/e.size.value,u=1/c;e.velocity.x-=a*c,e.velocity.y-=l*c,s.velocity.x+=a*u,s.velocity.y+=l*u}}isEnabled(e){return e.options.move.attract.enable}reset(){}}function J8(e,t,n,i,r,s){const o=i3(e.options.collisions.absorb.speed*r.factor/10,0,i);e.size.value+=.5*o,n.size.value-=o,i<=s&&(n.size.value=0,n.destroy())}const $8=e=>{void 0===e.collisionMaxSpeed&&(e.collisionMaxSpeed=o3(e.options.collisions.maxSpeed)),e.velocity.length>e.collisionMaxSpeed&&(e.velocity.length=e.collisionMaxSpeed)};function e7(e,t){F3(B3(e),B3(t)),$8(e),$8(t)}function t7(e,t,n,i){switch(e.options.collisions.mode){case X4.absorb:!function(e,t,n,i){const r=e.getRadius(),s=t.getRadius();void 0===r&&void 0!==s?e.destroy():void 0!==r&&void 0===s?t.destroy():void 0!==r&&void 0!==s&&(r>=s?J8(e,0,t,s,n,i):J8(t,0,e,r,n,i))}(e,t,n,i);break;case X4.bounce:e7(e,t);break;case X4.destroy:!function(e,t){e.unbreakable||t.unbreakable||e7(e,t),void 0===e.getRadius()&&void 0!==t.getRadius()?e.destroy():void 0!==e.getRadius()&&void 0===t.getRadius()?t.destroy():void 0!==e.getRadius()&&void 0!==t.getRadius()&&(e.getRadius()>=t.getRadius()?t:e).destroy()}(e,t)}}class n7 extends h6{constructor(e){super(e)}clear(){}init(){}interact(e,t){if(e.destroyed||e.spawning)return;const n=this.container,i=e.getPosition(),r=e.getRadius(),s=n.particles.quadTree.queryCircle(i,2*r);for(const o of s){if(e===o||!o.options.collisions.enable||e.options.collisions.mode!==o.options.collisions.mode||o.destroyed||o.spawning)continue;const s=o.getPosition(),a=o.getRadius();if(Math.abs(Math.round(i.z)-Math.round(s.z))>r+a)continue;h3(i,s)>r+a||t7(e,o,t,n.retina.pixelRatio)}}isEnabled(e){return e.options.collisions.enable}reset(){}}class i7 extends Y5{constructor(e,t,n,i){super(e,t,n),this.canvasSize=i,this.canvasSize=M({},i)}contains(e){const{width:t,height:n}=this.canvasSize,{x:i,y:r}=e;return super.contains(e)||super.contains({x:i-t,y:r})||super.contains({x:i-t,y:r-n})||super.contains({x:i,y:r-n})}intersects(e){if(super.intersects(e))return!0;const t=e,n=e,i={x:e.position.x-this.canvasSize.width,y:e.position.y-this.canvasSize.height};if(void 0!==n.radius){const e=new Y5(i.x,i.y,2*n.radius);return super.intersects(e)}if(void 0!==t.size){const e=new Q5(i.x,i.y,2*t.size.width,2*t.size.height);return super.intersects(e)}return!1}}class r7{constructor(){this.blur=5,this.color=new N4,this.color.value="#000",this.enable=!1}load(e){X2(e)||(void 0!==e.blur&&(this.blur=e.blur),this.color=N4.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable))}}class s7{constructor(){this.enable=!1,this.frequency=1}load(e){X2(e)||(void 0!==e.color&&(this.color=N4.create(this.color,e.color)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.frequency&&(this.frequency=e.frequency),void 0!==e.opacity&&(this.opacity=e.opacity))}}class o7{constructor(){this.blink=!1,this.color=new N4,this.color.value="#fff",this.consent=!1,this.distance=100,this.enable=!1,this.frequency=1,this.opacity=1,this.shadow=new r7,this.triangles=new s7,this.width=1,this.warp=!1}load(e){X2(e)||(void 0!==e.id&&(this.id=e.id),void 0!==e.blink&&(this.blink=e.blink),this.color=N4.create(this.color,e.color),void 0!==e.consent&&(this.consent=e.consent),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.frequency&&(this.frequency=e.frequency),void 0!==e.opacity&&(this.opacity=e.opacity),this.shadow.load(e.shadow),this.triangles.load(e.triangles),void 0!==e.width&&(this.width=e.width),void 0!==e.warp&&(this.warp=e.warp))}}const a7=0,l7=0;function c7(e,t,n,i,r){const{dx:s,dy:o,distance:a}=u3(e,t);if(!r||a<=n)return a;const l={x:Math.abs(s),y:Math.abs(o)},c=Math.min(l.x,i.width-l.x),u=Math.min(l.y,i.height-l.y);return Math.sqrt(c**2+u**2)}class u7 extends h6{constructor(e,t){super(e),this._setColor=e=>{if(!e.options.links)return;const t=this._linkContainer,n=e.options.links;let i=void 0===n.id?t.particles.linksColor:t.particles.linksColors.get(n.id);if(i)return;const r=n.color;i=l4(this._engine,r,n.blink,n.consent),void 0===n.id?t.particles.linksColor=i:t.particles.linksColors.set(n.id,i)},this._linkContainer=e,this._engine=t}clear(){}init(){this._linkContainer.particles.linksColor=void 0,this._linkContainer.particles.linksColors=new Map}interact(e){var t;if(!e.options.links)return;e.links=[];const n=e.getPosition(),i=this.container,r=i.canvas.size;if(n.x<a7||n.y<l7||n.x>r.width||n.y>r.height)return;const s=e.options.links,o=s.opacity,a=null!==(t=e.retina.linksDistance)&&void 0!==t?t:0,l=s.warp;let c;c=l?new i7(n.x,n.y,a,r):new Y5(n.x,n.y,a);const u=i.particles.quadTree.query(c);for(const h of u){const t=h.options.links;if(e===h||null===t||void 0===t||!t.enable||s.id!==t.id||h.spawning||h.destroyed||!h.links||e.links.some((e=>e.destination===h))||h.links.some((t=>t.destination===e)))continue;const i=h.getPosition();if(i.x<a7||i.y<l7||i.x>r.width||i.y>r.height)continue;const c=c7(n,i,a,r,l&&t.warp);if(c>a)continue;const u=(1-c/a)*o;this._setColor(e),e.links.push({destination:h,opacity:u})}}isEnabled(e){var t;return!(null===(t=e.options.links)||void 0===t||!t.enable)}loadParticlesOptions(e){e.links||(e.links=new o7);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.links.load(null===r||void 0===r?void 0:r.links)}reset(){}}function h7(e,t){const n=((i=e.map((e=>e.id))).sort(((e,t)=>e-t)),i.join("_"));var i;let r=t.get(n);return void 0===r&&(r=n3(),t.set(n,r)),r}class d7{constructor(e,t){this._drawLinkLine=(e,t)=>{const n=e.options.links;if(null===n||void 0===n||!n.enable)return;const i=this._container,r=i.actualOptions,s=t.destination,o=e.getPosition(),a=s.getPosition();let l=t.opacity;i.canvas.draw((t=>{var c,u,h;let d;const p=null===(c=e.options.twinkle)||void 0===c?void 0:c.lines;if(null!==p&&void 0!==p&&p.enable){const e=p.frequency,t=J3(this._engine,p.color);n3()<e&&t&&(d=t,l=o3(p.opacity))}if(!d){const t=void 0!==n.id?i.particles.linksColors.get(n.id):i.particles.linksColor;d=a4(e,s,t)}if(!d)return;const A=null!==(u=e.retina.linksWidth)&&void 0!==u?u:0,f=null!==(h=e.retina.linksDistance)&&void 0!==h?h:0,{backgroundMask:m}=r;!function(e){let t=!1;const{begin:n,end:i,engine:r,maxDistance:s,context:o,canvasSize:a,width:l,backgroundMask:c,colorLine:u,opacity:h,links:d}=e;if(h3(n,i)<=s)b4(o,n,i),t=!0;else if(d.warp){let e,r;const l=u3(n,{x:i.x-a.width,y:i.y});if(l.distance<=s){const t=n.y-l.dy/l.dx*n.x;e={x:0,y:t},r={x:a.width,y:t}}else{const t=u3(n,{x:i.x,y:i.y-a.height});if(t.distance<=s){const i=-(n.y-t.dy/t.dx*n.x)/(t.dy/t.dx);e={x:i,y:0},r={x:i,y:a.height}}else{const t=u3(n,{x:i.x-a.width,y:i.y-a.height});if(t.distance<=s){const i=n.y-t.dy/t.dx*n.x;e={x:-i/(t.dy/t.dx),y:i},r={x:e.x+a.width,y:e.y+a.height}}}}e&&r&&(b4(o,n,e),b4(o,i,r),t=!0)}if(!t)return;o.lineWidth=l,c.enable&&(o.globalCompositeOperation=c.composite),o.strokeStyle=r4(u,h);const{shadow:p}=d;if(p.enable){const e=J3(r,p.color);e&&(o.shadowBlur=p.blur,o.shadowColor=r4(e))}o.stroke()}({context:t,width:A,begin:o,end:a,engine:this._engine,maxDistance:f,canvasSize:i.canvas.size,links:n,backgroundMask:m,colorLine:d,opacity:l})}))},this._drawLinkTriangle=(e,t,n)=>{var i;const r=e.options.links;if(null===r||void 0===r||!r.enable)return;const s=r.triangles;if(!s.enable)return;const o=this._container,a=o.actualOptions,l=t.destination,c=n.destination,u=null!==(i=s.opacity)&&void 0!==i?i:.5*(t.opacity+n.opacity);u<=0||o.canvas.draw((t=>{var n;const i=e.getPosition(),h=l.getPosition(),d=c.getPosition(),p=null!==(n=e.retina.linksDistance)&&void 0!==n?n:0;if(h3(i,h)>p||h3(d,h)>p||h3(d,i)>p)return;let A=J3(this._engine,s.color);if(!A){const t=void 0!==r.id?o.particles.linksColors.get(r.id):o.particles.linksColor;A=a4(e,l,t)}A&&function(e){const{context:t,pos1:n,pos2:i,pos3:r,backgroundMask:s,colorTriangle:o,opacityTriangle:a}=e;!function(e,t,n,i){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.lineTo(i.x,i.y),e.closePath()}(t,n,i,r),s.enable&&(t.globalCompositeOperation=s.composite),t.fillStyle=r4(o,a),t.fill()}({context:t,pos1:i,pos2:h,pos3:d,backgroundMask:a.backgroundMask,colorTriangle:A,opacityTriangle:u})}))},this._drawTriangles=(e,t,n,i)=>{var r,s,o;const a=n.destination;if(null===(r=e.links)||void 0===r||!r.triangles.enable||null===(s=a.options.links)||void 0===s||!s.triangles.enable)return;const l=null===(o=a.links)||void 0===o?void 0:o.filter((e=>{const t=this._getLinkFrequency(a,e.destination);return a.options.links&&t<=a.options.links.frequency&&i.findIndex((t=>t.destination===e.destination))>=0}));if(null!==l&&void 0!==l&&l.length)for(const c of l){const i=c.destination;this._getTriangleFrequency(t,a,i)>e.links.triangles.frequency||this._drawLinkTriangle(t,n,c)}},this._getLinkFrequency=(e,t)=>h7([e,t],this._freqs.links),this._getTriangleFrequency=(e,t,n)=>h7([e,t,n],this._freqs.triangles),this._container=e,this._engine=t,this._freqs={links:new Map,triangles:new Map}}drawParticle(e,t){const{links:n,options:i}=t;if(null===n||void 0===n||!n.length)return;const r=n.filter((e=>i.links&&(i.links.frequency>=1||this._getLinkFrequency(t,e.destination)<=i.links.frequency)));for(const o of r){var s;this._drawTriangles(i,t,o,r),o.opacity>0&&(null!==(s=t.retina.linksWidth)&&void 0!==s?s:0)>0&&this._drawLinkLine(t,o)}}async init(){this._freqs.links=new Map,this._freqs.triangles=new Map,await Promise.resolve()}particleCreated(e){if(e.links=[],!e.options.links)return;const t=this._container.retina.pixelRatio,{retina:n}=e,{distance:i,width:r}=e.options.links;n.linksDistance=i*t,n.linksWidth=r*t}particleDestroyed(e){e.links=[]}}class p7{constructor(e){this.id="links",this._engine=e}getPlugin(e){return Promise.resolve(new d7(e,this._engine))}loadOptions(){}needsPlugin(){return!0}}async function A7(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];await e.addInteractor("particlesLinks",(async t=>Promise.resolve(new u7(t,e))),t)}(e,t),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=new p7(e);await e.addPlugin(n,t)}(e,t)}const f7=0,m7=0;class g7{draw(e){const{particle:t,radius:n}=e;!function(e,t,n){const{context:i}=e,r=n.count.numerator*n.count.denominator,s=n.count.numerator/n.count.denominator,o=180*(s-2)/s,a=Math.PI-d3(o);if(i){i.beginPath(),i.translate(t.x,t.y),i.moveTo(f7,m7);for(let e=0;e<r;e++)i.lineTo(n.length,m7),i.translate(n.length,m7),i.rotate(a)}}(e,this.getCenter(t,n),this.getSidesData(t,n))}getSidesCount(e){var t;const n=e.shapeData;return Math.round(o3(null!==(t=null===n||void 0===n?void 0:n.sides)&&void 0!==t?t:5))}}class v7 extends g7{constructor(){super(...arguments),this.validTypes=["polygon"]}getCenter(e,t){return{x:-t/(e.sides/3.5),y:-t/.76}}getSidesData(e,t){const n=e.sides;return{count:{denominator:1,numerator:n},length:2.66*t/(n/3)}}}class y7 extends g7{constructor(){super(...arguments),this.validTypes=["triangle"]}getCenter(e,t){return{x:-t,y:t/1.66}}getSidesCount(){return 3}getSidesData(e,t){return{count:{denominator:2,numerator:3},length:2*t}}}async function b7(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new v7,t)}(e,t),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new y7,t)}(e,t)}class x7{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){X2(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=c3(e.speed)),void 0!==e.decay&&(this.decay=c3(e.decay)),void 0!==e.sync&&(this.sync=e.sync))}}class _7 extends l5{constructor(){super(),this.animation=new x7,this.direction=d6.clockwise,this.path=!1,this.value=0}load(e){X2(e)||(super.load(e),void 0!==e.direction&&(this.direction=e.direction),this.animation.load(e.animation),void 0!==e.path&&(this.path=e.path))}}const w7=2*Math.PI;class S7{constructor(e){this.container=e}init(e){const t=e.options.rotate;if(!t)return;e.rotate={enable:t.animation.enable,value:d3(o3(t.value)),min:0,max:w7},e.pathRotation=t.path;let n=t.direction;if(n===d6.random){n=Math.floor(2*n3())>0?d6.counterClockwise:d6.clockwise}switch(n){case d6.counterClockwise:case"counterClockwise":e.rotate.status=g3.decreasing;break;case d6.clockwise:e.rotate.status=g3.increasing}const i=t.animation;i.enable&&(e.rotate.decay=1-o3(i.decay),e.rotate.velocity=o3(i.speed)/360*this.container.retina.reduceFactor,i.sync||(e.rotate.velocity*=n3())),e.rotation=e.rotate.value}isEnabled(e){const t=e.options.rotate;return!!t&&(!e.destroyed&&!e.spawning&&(!!t.value||t.animation.enable||t.path))}loadOptions(e){e.rotate||(e.rotate=new _7);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)e.rotate.load(null===r||void 0===r?void 0:r.rotate)}update(e,t){this.isEnabled(e)&&(e.isRotating=!!e.rotate,e.rotate&&(W3(e,e.rotate,!1,v3.none,t),e.rotation=e.rotate.value))}}const T7=Math.sqrt(2);class M7{constructor(){this.validTypes=["edge","square"]}draw(e){!function(e){const{context:t,radius:n}=e,i=n/T7,r=2*i;t.rect(-i,-i,r,r)}(e)}getSidesCount(){return 4}}const E7=0,C7=0;class R7{constructor(){this.validTypes=["star"]}draw(e){!function(e){var t;const{context:n,particle:i,radius:r}=e,s=i.sides,o=null!==(t=i.starInset)&&void 0!==t?t:2;n.moveTo(E7,C7-r);for(let a=0;a<s;a++)n.rotate(Math.PI/s),n.lineTo(E7,C7-r*o),n.rotate(Math.PI/s),n.lineTo(E7,C7-r)}(e)}getSidesCount(e){var t;const n=e.shapeData;return Math.round(o3(null!==(t=null===n||void 0===n?void 0:n.sides)&&void 0!==t?t:5))}particleInit(e,t){var n;const i=t.shapeData;t.starInset=o3(null!==(n=null===i||void 0===i?void 0:i.inset)&&void 0!==n?n:2)}}class P7{constructor(e,t){this._container=e,this._engine=t}init(e){var t,n,i;const r=this._container,s=e.options,o=q3(s.stroke,e.id,s.reduceDuplicates);e.strokeWidth=o3(o.width)*r.retina.pixelRatio,e.strokeOpacity=o3(null!==(t=o.opacity)&&void 0!==t?t:1),e.strokeAnimation=null===(n=o.color)||void 0===n?void 0:n.animation;const a=null!==(i=e4(this._engine,o.color))&&void 0!==i?i:e.getFillColor();a&&(e.strokeColor=u4(a,e.strokeAnimation,r.retina.reduceFactor))}isEnabled(e){const t=e.strokeAnimation,{strokeColor:n}=e;return!e.destroyed&&!e.spawning&&!!t&&(void 0!==(null===n||void 0===n?void 0:n.h.value)&&n.h.enable||void 0!==(null===n||void 0===n?void 0:n.s.value)&&n.s.enable||void 0!==(null===n||void 0===n?void 0:n.l.value)&&n.l.enable)}update(e,t){this.isEnabled(e)&&p4(e.strokeColor,t)}}async function N7(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addMover("parallax",(()=>Promise.resolve(new K8)),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalAttract",(t=>Promise.resolve(new H6(e,t))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalBounce",(e=>Promise.resolve(new J6(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalBubble",(t=>Promise.resolve(new s8(t,e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalConnect",(e=>Promise.resolve(new u8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalGrab",(t=>Promise.resolve(new A8(t,e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalPause",(e=>Promise.resolve(new f8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalPush",(e=>Promise.resolve(new g8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalRemove",(e=>Promise.resolve(new y8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalRepulse",(t=>Promise.resolve(new S8(e,t))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("externalSlow",(e=>Promise.resolve(new M8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("particlesAttract",(e=>Promise.resolve(new Z8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addInteractor("particlesCollisions",(e=>Promise.resolve(new n7(e))),t)}(e,!1),await A7(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addEasing(A6.easeInQuad,(e=>e**2),!1),await e.addEasing(A6.easeOutQuad,(e=>1-(1-e)**2),!1),await e.addEasing(A6.easeInOutQuad,(e=>e<.5?2*e**2:1-(-2*e+2)**2/2),!1),await e.refresh(t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new q6,t)}(e,!1),await j8(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new Q8,t)}(e,!1),await b7(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new M7,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addShape(new R7,t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("life",(async e=>Promise.resolve(new Y8(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("rotate",(e=>Promise.resolve(new S7(e))),t)}(e,!1),await async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X3(e,"3.7.1"),await e.addParticleUpdater("strokeColor",(t=>Promise.resolve(new P7(t,e))),t)}(e,!1),await U6(e,t)}const D7=()=>{const[e,n]=(0,t.useState)(!1);(0,t.useEffect)((()=>{(async function(e){await e(f6)})((async e=>{await N7(e)})).then((()=>{n(!0)}))}),[]);const i=e=>{console.log(e)},s=(0,t.useMemo)((()=>({background:{image:"url('/path-to-your-globe-image.jpg')",size:"cover",repeat:"no-repeat",position:"center"},fpsLimit:120,interactivity:{events:{onClick:{enable:!1,mode:"push"},onHover:{enable:!0,mode:"repulse"}},modes:{push:{quantity:60},repulse:{distance:200,duration:.4}}},particles:{color:{value:"#ffffff"},links:{color:"#ffffff",distance:150,enable:!0,opacity:.5,width:1},move:{direction:"none",enable:!0,outModes:{default:"bounce"},random:!1,speed:6,straight:!1},number:{density:{enable:!0},value:90},opacity:{value:.5},shape:{type:"circle"},size:{value:{min:1,max:5}}},detectRetina:!0})),[]);return e?(0,r.jsx)(m6,{id:"tsparticles",particlesLoaded:i,options:s}):null},L7=e=>{let{domain:n,setDomain:i,zone:s,setZone:o,checkDomain:a}=e;const[l,c]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{const e=setTimeout((()=>c(!0)),500);return()=>clearTimeout(e)}),[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-xl border-b border-white border-opacity-10 flex items-center justify-center absolute w-full left-0 top-0 bg-opacity-75 z-50",children:(0,r.jsx)("div",{className:"container mx-auto",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-gray-300 border-r border-white border-opacity-10 p-5 font-bold",children:"INEED "}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-300 border-x border-white border-opacity-10 p-5",children:"\u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442"}),(0,r.jsx)("span",{className:"text-gray-300 border-x border-white border-opacity-10 p-5",children:"\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 "}),(0,r.jsx)("span",{className:"text-gray-300 border-x border-white border-opacity-10 p-5",children:"\u0414\u043b\u044f \u043a\u043e\u0433\u043e \u044d\u0442\u043e\u0442 \u043f\u043e\u0440\u0442\u0430\u043b "})]})]})})}),(0,r.jsxs)("div",{className:"hero min-h-screen overflow-hidden relative after:bg-black after:absolute after:z-40 after:block after:w-full after:h-screen after:bg-opacity-35 bg-gray-950 flex items-center flex-col justify-center",children:[(0,r.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full z-10 overflow-hidden",children:[(0,r.jsx)(L2,{}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-20",children:(0,r.jsx)(D7,{})})]}),(0,r.jsx)(b,{children:l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(la.div,{className:"bg-white w-full absolute left-0 bg-opacity-25",initial:{opacity:0,scaleX:0},animate:{opacity:1,scaleX:1},exit:{opacity:0,scaleX:0},transition:{duration:.8,ease:"easeOut"},style:{height:"1px",top:"50%",transformOrigin:"left center"}}),(0,r.jsx)(la.div,{className:"relative w-full z-50",initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:{duration:.8,ease:"easeOut"},children:(0,r.jsx)("div",{className:"container mx-auto",children:(0,r.jsxs)("div",{className:"border border-white bg-black/8 backdrop-blur-xl w-full p-10 flex flex-col items-center rounded-lg border-opacity-10",children:[(0,r.jsx)(la.h1,{className:"font-bold text-white text-[28px] py-5 uppercase typing-effect",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.8},children:"\u041f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 B2B \u0434\u043b\u044f \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u043a\u0443\u043f\u043e\u043a"}),(0,r.jsx)(la.p,{className:"text-white",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.8},children:"\u041f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0437\u0430\u044f\u0432\u043e\u043a, \u043e\u0442\u043a\u043b\u0438\u043a\u0438 \u043e\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u0432."}),(0,r.jsx)(la.a,{className:"text-white/70 uppercase px-5 border-opacity-15 tracking-wide py-2 border-white font-bold border mt-10 rounded-sm text-sm",href:"",initial:{opacity:0},animate:{opacity:1},transition:{delay:.9,duration:.8},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})]})})})]})})]})]})},I7=()=>(0,r.jsx)("div",{className:"bg-black relative z-50 py-10",children:(0,r.jsx)("div",{className:"container mx-auto ",children:(0,r.jsx)("div",{className:"px-5 uppercase text-white font-bold text-center",children:"INEED company all rights reserved"})})});var O7={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},k7=t.createContext&&t.createContext(O7),B7=["attr","size","title"];function F7(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function U7(){return U7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},U7.apply(this,arguments)}function z7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function q7(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z7(Object(n),!0).forEach((function(t){V7(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z7(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V7(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G7(e){return e&&e.map(((e,n)=>t.createElement(e.tag,q7({key:n},e.attr),G7(e.child))))}function j7(e){return n=>t.createElement(H7,U7({attr:q7({},e.attr)},n),G7(e.child))}function H7(e){var n=n=>{var i,{attr:r,size:s,title:o}=e,a=F7(e,B7),l=s||n.size||"1em";return n.className&&(i=n.className),e.className&&(i=(i?i+" ":"")+e.className),t.createElement("svg",U7({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:i,style:q7(q7({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&t.createElement("title",null,o),e.children)};return void 0!==k7?t.createElement(k7.Consumer,null,(e=>n(e))):n(O7)}function W7(e){return j7({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 508c-6.7 0-13.5-1.8-19.4-5.2l-61.7-36.5c-9.2-5.2-4.7-7-1.7-8 12.3-4.3 14.8-5.2 27.9-12.7 1.4-.8 3.2-.5 4.6.4l47.4 28.1c1.7 1 4.1 1 5.7 0l184.7-106.6c1.7-1 2.8-3 2.8-5V149.3c0-2.1-1.1-4-2.9-5.1L226.8 37.7c-1.7-1-4-1-5.7 0L36.6 144.3c-1.8 1-2.9 3-2.9 5.1v213.1c0 2 1.1 4 2.9 4.9l50.6 29.2c27.5 13.7 44.3-2.4 44.3-18.7V167.5c0-3 2.4-5.3 5.4-5.3h23.4c2.9 0 5.4 2.3 5.4 5.3V378c0 36.6-20 57.6-54.7 57.6-10.7 0-19.1 0-42.5-11.6l-48.4-27.9C8.1 389.2.7 376.3.7 362.4V149.3c0-13.8 7.4-26.8 19.4-33.7L204.6 9c11.7-6.6 27.2-6.6 38.8 0l184.7 106.7c12 6.9 19.4 19.8 19.4 33.7v213.1c0 13.8-7.4 26.7-19.4 33.7L243.4 502.8c-5.9 3.4-12.6 5.2-19.4 5.2zm149.1-210.1c0-39.9-27-50.5-83.7-58-57.4-7.6-63.2-11.5-63.2-24.9 0-11.1 4.9-25.9 47.4-25.9 37.9 0 51.9 8.2 57.7 33.8.5 2.4 2.7 4.2 5.2 4.2h24c1.5 0 2.9-.6 3.9-1.7s1.5-2.6 1.4-4.1c-3.7-44.1-33-64.6-92.2-64.6-52.7 0-84.1 22.2-84.1 59.5 0 40.4 31.3 51.6 81.8 56.6 60.5 5.9 65.2 14.8 65.2 26.7 0 20.6-16.6 29.4-55.5 29.4-48.9 0-59.6-12.3-63.2-36.6-.4-2.6-2.6-4.5-5.3-4.5h-23.9c-3 0-5.3 2.4-5.3 5.3 0 31.1 16.9 68.2 97.8 68.2 58.4-.1 92-23.2 92-63.4z"},child:[]}]})(e)}function X7(e){return j7({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"},child:[]}]})(e)}function Y7(e){return j7({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(e)}function Q7(e){return j7({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function K7(e){return j7({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M616 192H480V24c0-13.26-10.74-24-24-24H312c-13.26 0-24 10.74-24 24v72h-64V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v80h-64V16c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v80H24c-13.26 0-24 10.74-24 24v360c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V216c0-13.26-10.75-24-24-24zM128 404c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm128 192c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12V76c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 288c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40z"},child:[]}]})(e)}function Z7(e){return j7({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"},child:[]}]})(e)}function J7(e){return j7({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M275.3 250.5c7 7.4 18.4 7.4 25.5 0l108.9-114.2c31.6-33.2 29.8-88.2-5.6-118.8-30.8-26.7-76.7-21.9-104.9 7.7L288 36.9l-11.1-11.6C248.7-4.4 202.8-9.2 172 17.5c-35.3 30.6-37.2 85.6-5.6 118.8l108.9 114.2zm290 77.6c-11.8-10.7-30.2-10-42.6 0L430.3 402c-11.3 9.1-25.4 14-40 14H272c-8.8 0-16-7.2-16-16s7.2-16 16-16h78.3c15.9 0 30.7-10.9 33.3-26.6 3.3-20-12.1-37.4-31.6-37.4H192c-27 0-53.1 9.3-74.1 26.3L71.4 384H16c-8.8 0-16 7.2-16 16v96c0 8.8 7.2 16 16 16h356.8c14.5 0 28.6-4.9 40-14L564 377c15.2-12.1 16.4-35.3 1.3-48.9z"},child:[]}]})(e)}function $7(e){return j7({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M255.03 261.65c6.25 6.25 16.38 6.25 22.63 0l11.31-11.31c6.25-6.25 6.25-16.38 0-22.63L253.25 192l35.71-35.72c6.25-6.25 6.25-16.38 0-22.63l-11.31-11.31c-6.25-6.25-16.38-6.25-22.63 0l-58.34 58.34c-6.25 6.25-6.25 16.38 0 22.63l58.35 58.34zm96.01-11.3l11.31 11.31c6.25 6.25 16.38 6.25 22.63 0l58.34-58.34c6.25-6.25 6.25-16.38 0-22.63l-58.34-58.34c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63L386.75 192l-35.71 35.72c-6.25 6.25-6.25 16.38 0 22.63zM624 416H381.54c-.74 19.81-14.71 32-32.74 32H288c-18.69 0-33.02-17.47-32.77-32H16c-8.8 0-16 7.2-16 16v16c0 35.2 28.8 64 64 64h512c35.2 0 64-28.8 64-64v-16c0-8.8-7.2-16-16-16zM576 48c0-26.4-21.6-48-48-48H112C85.6 0 64 21.6 64 48v336h512V48zm-64 272H128V64h384v256z"},child:[]}]})(e)}function e9(e){return j7({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(e)}function t9(e){return j7({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M519.2 127.9l-47.6-47.6A56.252 56.252 0 0 0 432 64H205.2c-14.8 0-29.1 5.9-39.6 16.3L118 127.9H0v255.7h64c17.6 0 31.8-14.2 31.9-31.7h9.1l84.6 76.4c30.9 25.1 73.8 25.7 105.6 3.8 12.5 10.8 26 15.9 41.1 15.9 18.2 0 35.3-7.4 48.8-24 22.1 8.7 48.2 2.6 64-16.8l26.2-32.3c5.6-6.9 9.1-14.8 10.9-23h57.9c.1 17.5 14.4 31.7 31.9 31.7h64V127.9H519.2zM48 351.6c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16c0 8.9-7.2 16-16 16zm390-6.9l-26.1 32.2c-2.8 3.4-7.8 4-11.3 1.2l-23.9-19.4-30 36.5c-6 7.3-15 4.8-18 2.4l-36.8-31.5-15.6 19.2c-13.9 17.1-39.2 19.7-55.3 6.6l-97.3-88H96V175.8h41.9l61.7-61.6c2-.8 3.7-1.5 5.7-2.3H262l-38.7 35.5c-29.4 26.9-31.1 72.3-4.4 101.3 14.8 16.2 61.2 41.2 101.5 4.4l8.2-7.5 108.2 87.8c3.4 2.8 3.9 7.9 1.2 11.3zm106-40.8h-69.2c-2.3-2.8-4.9-5.4-7.7-7.7l-102.7-83.4 12.5-11.4c6.5-6 7-16.1 1-22.6L367 167.1c-6-6.5-16.1-6.9-22.6-1l-55.2 50.6c-9.5 8.7-25.7 9.4-34.6 0-9.3-9.9-8.5-25.1 1.2-33.9l65.6-60.1c7.4-6.8 17-10.5 27-10.5l83.7-.2c2.1 0 4.1.8 5.5 2.3l61.7 61.6H544v128zm48 47.7c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16c0 8.9-7.2 16-16 16z"},child:[]}]})(e)}const n9=()=>(0,r.jsxs)("div",{className:" relative z-50",id:"triangle",children:[(0,r.jsx)("div",{id:"dot"}),(0,r.jsxs)("div",{id:"spin-me",children:[(0,r.jsx)("div",{id:"one",className:"circle bg-white text-blue-500 flex items-center justify-center text-[24px]",children:(0,r.jsx)(X7,{})}),(0,r.jsx)("div",{id:"two",className:"circle bg-white text-blue-500 flex items-center justify-center text-[24px]",children:(0,r.jsx)(W7,{})}),(0,r.jsx)("div",{id:"three",className:"circle bg-white text-blue-500 flex items-center justify-center text-[24px]",children:(0,r.jsx)(Z7,{})})]}),(0,r.jsx)("div",{className:"border-white bg-white/10 border-2  backdrop-blur-sm   border-opacity-80",id:"triangle-two"})]}),i9=()=>(0,r.jsx)("div",{className:"bg-gradient-to-l from-blue-800 text-white  border to-blue-400 h-[400px] flex items-center",children:(0,r.jsx)("div",{className:"container mx-auto",children:(0,r.jsxs)("div",{className:"items-center flex justify-between w-full",children:[(0,r.jsx)("div",{className:"flex w-full items-start justify-start",children:(0,r.jsx)(n9,{})}),(0,r.jsxs)("div",{className:"text-white",children:[(0,r.jsx)("h1",{className:"text-[28px] mb-5 uppercase font-bold",children:"\u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442"}),(0,r.jsx)("p",{className:"text-lg",children:"\u041d\u0430\u0448 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043e\u0441\u043d\u043e\u0432\u0430\u043d \u043d\u0430 3 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u0445: \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438, \u0432\u044b\u0441\u043e\u043a\u043e\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u044b, \u043d\u0430\u0434\u0451\u0436\u043d\u0430\u044f \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u0434. \u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c."})]})]})})});function r9(e,t,n,i){return new Promise((r=>{const s=e.animate(t,n),o=()=>{s.cancel()},a=()=>{i.removeEventListener("abort",o),s.removeEventListener("finish",a),r()};i.addEventListener("abort",o),s.addEventListener("finish",a)}))}var s9=t["undefined"!=typeof document&&void 0!==document.createElement?"useLayoutEffect":"useEffect"];function o9(){}let a9;function l9(e){const[n,i]=(0,t.useState)({width:void 0,height:void 0});return(0,t.useLayoutEffect)((()=>{if(e.current){const{width:t,height:n}=e.current.getBoundingClientRect();i({width:t,height:n})}}),[e]),function(e,n){const i=(e=>a9||(a9=function(e){let t=!1,n=[];const i=new Map,r=new(e||window.ResizeObserver)(((e,r)=>{n=n.concat(e),t||window.requestAnimationFrame((function(){const e=new Set;for(let t=0;t<n.length;t++){if(e.has(n[t].target))continue;e.add(n[t].target);const s=i.get(n[t].target);null==s||s.forEach((e=>e(n[t],r)))}n=[],t=!1})),t=!0}));return{observer:r,subscribe(e,t){var n;r.observe(e);const s=null!==(n=i.get(e))&&void 0!==n?n:[];s.push(t),i.set(e,s)},unsubscribe(e,t){var n;const s=null!==(n=i.get(e))&&void 0!==n?n:[];if(1===s.length)return r.unobserve(e),void i.delete(e);const o=s.indexOf(t);-1!==o&&s.splice(o,1),i.set(e,s)}}}(e)))((arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).polyfill),r=(e=>{const n=t.useRef(e);return t.useEffect((()=>{n.current=e})),n})(n);s9((()=>{let t=!1;const n=e&&"current"in e?e.current:e;if(!n)return o9;function s(e,n){t||r.current(e,n)}return i.subscribe(n,s),()=>{t=!0,i.unsubscribe(n,s)}}),[e,i,r]),i.observer}(e,(e=>{const{width:t,height:n}=e.contentRect;i({width:t,height:n})})),n}const c9=e=>{let{children:n,duration:i,easing:r,delay:s,reverse:o=!1}=e;const a=(0,t.useRef)(null),l=(0,t.useRef)(null),c=(0,t.useMemo)((()=>({duration:i,easing:r,delay:s,iterations:1,fill:"forwards",direction:o?"reverse":"normal"})),[i,r,s,o]),{width:u}=l9(a);return(0,t.useEffect)((()=>{if(!u||!a.current||!l.current)return;const e=u,t=a.current,n=l.current,i=new AbortController;return async function r(){const s=[{transform:"translateX(0px)"},{transform:"translateX(".concat(-1*e,"px)")}],o=[{transform:"translateX(".concat(e,"px)")},{transform:"translateX(0px)"}],a=[{transform:"translateX(".concat(-1*e,"px)")},{transform:"translateX(".concat(-2*e,"px)")}],l=r9(t,s,c,i.signal).then((()=>r9(t,o,c,i.signal))),u=r9(n,s,c,i.signal).then((()=>r9(n,a,c,i.signal)));return Promise.all([l,u]).then((()=>r()))}(),()=>{i.abort()}}),[u,c]),t.createElement("div",{style:{overflow:"hidden",display:"flex",flexWrap:"nowrap",width:"100%"}},t.createElement("div",{ref:a,style:{display:"flex"}},n),t.createElement("div",{ref:l,style:{display:"flex"}},n))},u9=()=>{const e=[{id:1,text:"\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442",icon:(0,r.jsx)(e9,{})},{id:2,text:"\u0421\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f",icon:(0,r.jsx)($7,{})},{id:3,text:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442\u0430",icon:(0,r.jsx)(Q7,{})},{id:4,text:"\u0413\u0438\u0431\u043a\u0430\u044f \u0446\u0435\u043d\u043e\u0432\u0430\u044f \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430",icon:(0,r.jsx)(t9,{})}];return(0,r.jsxs)("div",{className:"bg-black relative h-[400px] py-20 z-50",children:[(0,r.jsx)("div",{className:"absolute -top-8 left-0 w-full h-full flex justify-center items-center",children:(0,r.jsx)("h1",{className:"text-[500px] font-bold text-white opacity-5",children:(0,r.jsxs)(c9,{duration:25e3,children:[(0,r.jsx)("h1",{children:"INEED"}),(0,r.jsx)("h1",{children:"\u2022"})]})})}),(0,r.jsxs)("div",{className:"container mx-auto py-6",children:[(0,r.jsx)("h2",{className:"text-3xl text-center mb-8 text-white font-bold",children:"\u041d\u0430\u0448\u0438 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8",children:e.map((e=>(0,r.jsxs)("div",{className:" text-white rounded-lg flex items-center justify-center text-left",children:[(0,r.jsx)("div",{className:"text-2xl text-white border-opacity-10 p-5 rounded-full border border-white",children:e.icon}),(0,r.jsx)("p",{className:"text-lg text-white ml-2",children:e.text})]},e.id)))})]})]})},h9=()=>{const e=[{id:1,title:"\u041c\u0430\u043b\u044b\u0439 \u0438 \u0441\u0440\u0435\u0434\u043d\u0438\u0439 \u0431\u0438\u0437\u043d\u0435\u0441",description:"\u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0449\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u0432 \u0438 \u0445\u043e\u0442\u044f\u0442 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0437\u0430\u043a\u0443\u043f\u043e\u043a.",icon:(0,r.jsx)(Y7,{})},{id:2,title:"\u041a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u044b",description:"\u041d\u0430\u0448 \u043f\u043e\u0440\u0442\u0430\u043b \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0432\u0430\u0436\u043d\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0438 \u0432\u044b\u0431\u043e\u0440\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u0432.",icon:(0,r.jsx)(K7,{})},{id:3,title:"\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u0438 \u0443\u0441\u043b\u0443\u0433",description:"\u0414\u043b\u044f \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u0432, \u0436\u0435\u043b\u0430\u044e\u0449\u0438\u0445 \u0440\u0430\u0441\u0448\u0438\u0440\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0443\u044e \u0431\u0430\u0437\u0443 \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043d\u043e\u0432\u044b\u043c \u0437\u0430\u044f\u0432\u043a\u0430\u043c.",icon:(0,r.jsx)(J7,{})}];return(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-800 to-blue-600 py-20 text-white",children:(0,r.jsxs)("div",{className:"container mx-auto py-6",children:[(0,r.jsx)("h2",{className:"text-4xl font-semibold text-center mb-8",children:"\u0414\u043b\u044f \u043a\u043e\u0433\u043e \u044d\u0442\u043e\u0442 \u043f\u043e\u0440\u0442\u0430\u043b?"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:e.map((e=>(0,r.jsxs)("div",{className:"transition relative z-50 transform hover:scale-105 hover:shadow-lg rounded-lg p-6 text-center bg-black bg-opacity-60 backdrop-blur-sm shadow-xl",children:[(0,r.jsx)("div",{className:"text-5xl text-blue-400 mb-4 flex items-center justify-center",children:e.icon}),(0,r.jsx)("h3",{className:"text-2xl font-medium mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-lg",children:e.description})]},e.id)))})]})})};function d9(e){return null!==e&&"object"===typeof e&&"constructor"in e&&e.constructor===Object}function p9(e,t){void 0===e&&(e={}),void 0===t&&(t={}),Object.keys(t).forEach((n=>{"undefined"===typeof e[n]?e[n]=t[n]:d9(t[n])&&d9(e[n])&&Object.keys(t[n]).length>0&&p9(e[n],t[n])}))}const A9={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function f9(){const e="undefined"!==typeof document?document:{};return p9(e,A9),e}const m9={document:A9,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"===typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!==typeof setTimeout&&clearTimeout(e)}};function g9(){const e="undefined"!==typeof window?window:{};return p9(e,m9),e}function v9(e,t){return void 0===t&&(t=0),setTimeout(e,t)}function y9(){return Date.now()}function b9(e,t){void 0===t&&(t="x");const n=g9();let i,r,s;const o=function(e){const t=g9();let n;return t.getComputedStyle&&(n=t.getComputedStyle(e,null)),!n&&e.currentStyle&&(n=e.currentStyle),n||(n=e.style),n}(e);return n.WebKitCSSMatrix?(r=o.transform||o.webkitTransform,r.split(",").length>6&&(r=r.split(", ").map((e=>e.replace(",","."))).join(", ")),s=new n.WebKitCSSMatrix("none"===r?"":r)):(s=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=s.toString().split(",")),"x"===t&&(r=n.WebKitCSSMatrix?s.m41:16===i.length?parseFloat(i[12]):parseFloat(i[4])),"y"===t&&(r=n.WebKitCSSMatrix?s.m42:16===i.length?parseFloat(i[13]):parseFloat(i[5])),r||0}function x9(e){return"object"===typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function _9(){const e=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let i=1;i<arguments.length;i+=1){const r=i<0||arguments.length<=i?void 0:arguments[i];if(void 0!==r&&null!==r&&(n=r,!("undefined"!==typeof window&&"undefined"!==typeof window.HTMLElement?n instanceof HTMLElement:n&&(1===n.nodeType||11===n.nodeType)))){const n=Object.keys(Object(r)).filter((e=>t.indexOf(e)<0));for(let t=0,i=n.length;t<i;t+=1){const i=n[t],s=Object.getOwnPropertyDescriptor(r,i);void 0!==s&&s.enumerable&&(x9(e[i])&&x9(r[i])?r[i].__swiper__?e[i]=r[i]:_9(e[i],r[i]):!x9(e[i])&&x9(r[i])?(e[i]={},r[i].__swiper__?e[i]=r[i]:_9(e[i],r[i])):e[i]=r[i])}}}var n;return e}function w9(e,t,n){e.style.setProperty(t,n)}function S9(e){let{swiper:t,targetPosition:n,side:i}=e;const r=g9(),s=-t.translate;let o,a=null;const l=t.params.speed;t.wrapperEl.style.scrollSnapType="none",r.cancelAnimationFrame(t.cssModeFrameID);const c=n>s?"next":"prev",u=(e,t)=>"next"===c&&e>=t||"prev"===c&&e<=t,h=()=>{o=(new Date).getTime(),null===a&&(a=o);const e=Math.max(Math.min((o-a)/l,1),0),c=.5-Math.cos(e*Math.PI)/2;let d=s+c*(n-s);if(u(d,n)&&(d=n),t.wrapperEl.scrollTo({[i]:d}),u(d,n))return t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout((()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[i]:d})})),void r.cancelAnimationFrame(t.cssModeFrameID);t.cssModeFrameID=r.requestAnimationFrame(h)};h()}function T9(e,t){void 0===t&&(t="");const n=[...e.children];return e instanceof HTMLSlotElement&&n.push(...e.assignedElements()),t?n.filter((e=>e.matches(t))):n}function M9(e){try{return void console.warn(e)}catch(t){}}function E9(e,t){void 0===t&&(t=[]);const n=document.createElement(e);return n.classList.add(...Array.isArray(t)?t:function(e){return void 0===e&&(e=""),e.trim().split(" ").filter((e=>!!e.trim()))}(t)),n}function C9(e,t){return g9().getComputedStyle(e,null).getPropertyValue(t)}function R9(e){let t,n=e;if(n){for(t=0;null!==(n=n.previousSibling);)1===n.nodeType&&(t+=1);return t}}function P9(e,t){const n=[];let i=e.parentElement;for(;i;)t?i.matches(t)&&n.push(i):n.push(i),i=i.parentElement;return n}function N9(e,t,n){const i=g9();return n?e["width"===t?"offsetWidth":"offsetHeight"]+parseFloat(i.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-right":"margin-top"))+parseFloat(i.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-left":"margin-bottom")):e.offsetWidth}function D9(e){return(Array.isArray(e)?e:[e]).filter((e=>!!e))}let L9,I9,O9;function k9(){return L9||(L9=function(){const e=g9(),t=f9();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}()),L9}function B9(e){return void 0===e&&(e={}),I9||(I9=function(e){let{userAgent:t}=void 0===e?{}:e;const n=k9(),i=g9(),r=i.navigator.platform,s=t||i.navigator.userAgent,o={ios:!1,android:!1},a=i.screen.width,l=i.screen.height,c=s.match(/(Android);?[\s\/]+([\d.]+)?/);let u=s.match(/(iPad).*OS\s([\d_]+)/);const h=s.match(/(iPod)(.*OS\s([\d_]+))?/),d=!u&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p="Win32"===r;let A="MacIntel"===r;return!u&&A&&n.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf("".concat(a,"x").concat(l))>=0&&(u=s.match(/(Version)\/([\d.]+)/),u||(u=[0,1,"13_0_0"]),A=!1),c&&!p&&(o.os="android",o.android=!0),(u||d||h)&&(o.os="ios",o.ios=!0),o}(e)),I9}function F9(){return O9||(O9=function(){const e=g9(),t=B9();let n=!1;function i(){const t=e.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}if(i()){const t=String(e.navigator.userAgent);if(t.includes("Version/")){const[e,i]=t.split("Version/")[1].split(" ")[0].split(".").map((e=>Number(e)));n=e<16||16===e&&i<2}}const r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),s=i();return{isSafari:n||s,needPerspectiveFix:n,need3dFix:s||r&&t.ios,isWebView:r}}()),O9}var U9={on(e,t,n){const i=this;if(!i.eventsListeners||i.destroyed)return i;if("function"!==typeof t)return i;const r=n?"unshift":"push";return e.split(" ").forEach((e=>{i.eventsListeners[e]||(i.eventsListeners[e]=[]),i.eventsListeners[e][r](t)})),i},once(e,t,n){const i=this;if(!i.eventsListeners||i.destroyed)return i;if("function"!==typeof t)return i;function r(){i.off(e,r),r.__emitterProxy&&delete r.__emitterProxy;for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];t.apply(i,s)}return r.__emitterProxy=t,i.on(e,r,n)},onAny(e,t){const n=this;if(!n.eventsListeners||n.destroyed)return n;if("function"!==typeof e)return n;const i=t?"unshift":"push";return n.eventsAnyListeners.indexOf(e)<0&&n.eventsAnyListeners[i](e),n},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsAnyListeners)return t;const n=t.eventsAnyListeners.indexOf(e);return n>=0&&t.eventsAnyListeners.splice(n,1),t},off(e,t){const n=this;return!n.eventsListeners||n.destroyed?n:n.eventsListeners?(e.split(" ").forEach((e=>{"undefined"===typeof t?n.eventsListeners[e]=[]:n.eventsListeners[e]&&n.eventsListeners[e].forEach(((i,r)=>{(i===t||i.__emitterProxy&&i.__emitterProxy===t)&&n.eventsListeners[e].splice(r,1)}))})),n):n},emit(){const e=this;if(!e.eventsListeners||e.destroyed)return e;if(!e.eventsListeners)return e;let t,n,i;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];"string"===typeof s[0]||Array.isArray(s[0])?(t=s[0],n=s.slice(1,s.length),i=e):(t=s[0].events,n=s[0].data,i=s[0].context||e),n.unshift(i);return(Array.isArray(t)?t:t.split(" ")).forEach((t=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach((e=>{e.apply(i,[t,...n])})),e.eventsListeners&&e.eventsListeners[t]&&e.eventsListeners[t].forEach((e=>{e.apply(i,n)}))})),e}};const z9=(e,t,n)=>{t&&!e.classList.contains(n)?e.classList.add(n):!t&&e.classList.contains(n)&&e.classList.remove(n)};const q9=(e,t,n)=>{t&&!e.classList.contains(n)?e.classList.add(n):!t&&e.classList.contains(n)&&e.classList.remove(n)};const V9=(e,t)=>{if(!e||e.destroyed||!e.params)return;const n=t.closest(e.isElement?"swiper-slide":".".concat(e.params.slideClass));if(n){let t=n.querySelector(".".concat(e.params.lazyPreloaderClass));!t&&e.isElement&&(n.shadowRoot?t=n.shadowRoot.querySelector(".".concat(e.params.lazyPreloaderClass)):requestAnimationFrame((()=>{n.shadowRoot&&(t=n.shadowRoot.querySelector(".".concat(e.params.lazyPreloaderClass)),t&&t.remove())}))),t&&t.remove()}},G9=(e,t)=>{if(!e.slides[t])return;const n=e.slides[t].querySelector('[loading="lazy"]');n&&n.removeAttribute("loading")},j9=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const n=e.slides.length;if(!n||!t||t<0)return;t=Math.min(t,n);const i="auto"===e.params.slidesPerView?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),r=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const n=r,s=[n-t];return s.push(...Array.from({length:t}).map(((e,t)=>n+i+t))),void e.slides.forEach(((t,n)=>{s.includes(t.column)&&G9(e,n)}))}const s=r+i-1;if(e.params.rewind||e.params.loop)for(let o=r-t;o<=s+t;o+=1){const t=(o%n+n)%n;(t<r||t>s)&&G9(e,t)}else for(let o=Math.max(r-t,0);o<=Math.min(s+t,n-1);o+=1)o!==r&&(o>s||o<r)&&G9(e,o)};var H9={updateSize:function(){const e=this;let t,n;const i=e.el;t="undefined"!==typeof e.params.width&&null!==e.params.width?e.params.width:i.clientWidth,n="undefined"!==typeof e.params.height&&null!==e.params.height?e.params.height:i.clientHeight,0===t&&e.isHorizontal()||0===n&&e.isVertical()||(t=t-parseInt(C9(i,"padding-left")||0,10)-parseInt(C9(i,"padding-right")||0,10),n=n-parseInt(C9(i,"padding-top")||0,10)-parseInt(C9(i,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(n)&&(n=0),Object.assign(e,{width:t,height:n,size:e.isHorizontal()?t:n}))},updateSlides:function(){const e=this;function t(t,n){return parseFloat(t.getPropertyValue(e.getDirectionLabel(n))||0)}const n=e.params,{wrapperEl:i,slidesEl:r,size:s,rtlTranslate:o,wrongRTL:a}=e,l=e.virtual&&n.virtual.enabled,c=l?e.virtual.slides.length:e.slides.length,u=T9(r,".".concat(e.params.slideClass,", swiper-slide")),h=l?e.virtual.slides.length:u.length;let d=[];const p=[],A=[];let f=n.slidesOffsetBefore;"function"===typeof f&&(f=n.slidesOffsetBefore.call(e));let m=n.slidesOffsetAfter;"function"===typeof m&&(m=n.slidesOffsetAfter.call(e));const g=e.snapGrid.length,v=e.slidesGrid.length;let y=n.spaceBetween,b=-f,x=0,_=0;if("undefined"===typeof s)return;"string"===typeof y&&y.indexOf("%")>=0?y=parseFloat(y.replace("%",""))/100*s:"string"===typeof y&&(y=parseFloat(y)),e.virtualSize=-y,u.forEach((e=>{o?e.style.marginLeft="":e.style.marginRight="",e.style.marginBottom="",e.style.marginTop=""})),n.centeredSlides&&n.cssMode&&(w9(i,"--swiper-centered-offset-before",""),w9(i,"--swiper-centered-offset-after",""));const w=n.grid&&n.grid.rows>1&&e.grid;let S;w?e.grid.initSlides(u):e.grid&&e.grid.unsetSlides();const T="auto"===n.slidesPerView&&n.breakpoints&&Object.keys(n.breakpoints).filter((e=>"undefined"!==typeof n.breakpoints[e].slidesPerView)).length>0;for(let M=0;M<h;M+=1){let i;if(S=0,u[M]&&(i=u[M]),w&&e.grid.updateSlide(M,i,u),!u[M]||"none"!==C9(i,"display")){if("auto"===n.slidesPerView){T&&(u[M].style[e.getDirectionLabel("width")]="");const r=getComputedStyle(i),s=i.style.transform,o=i.style.webkitTransform;if(s&&(i.style.transform="none"),o&&(i.style.webkitTransform="none"),n.roundLengths)S=e.isHorizontal()?N9(i,"width",!0):N9(i,"height",!0);else{const e=t(r,"width"),n=t(r,"padding-left"),s=t(r,"padding-right"),o=t(r,"margin-left"),a=t(r,"margin-right"),l=r.getPropertyValue("box-sizing");if(l&&"border-box"===l)S=e+o+a;else{const{clientWidth:t,offsetWidth:r}=i;S=e+n+s+o+a+(r-t)}}s&&(i.style.transform=s),o&&(i.style.webkitTransform=o),n.roundLengths&&(S=Math.floor(S))}else S=(s-(n.slidesPerView-1)*y)/n.slidesPerView,n.roundLengths&&(S=Math.floor(S)),u[M]&&(u[M].style[e.getDirectionLabel("width")]="".concat(S,"px"));u[M]&&(u[M].swiperSlideSize=S),A.push(S),n.centeredSlides?(b=b+S/2+x/2+y,0===x&&0!==M&&(b=b-s/2-y),0===M&&(b=b-s/2-y),Math.abs(b)<.001&&(b=0),n.roundLengths&&(b=Math.floor(b)),_%n.slidesPerGroup===0&&d.push(b),p.push(b)):(n.roundLengths&&(b=Math.floor(b)),(_-Math.min(e.params.slidesPerGroupSkip,_))%e.params.slidesPerGroup===0&&d.push(b),p.push(b),b=b+S+y),e.virtualSize+=S+y,x=S,_+=1}}if(e.virtualSize=Math.max(e.virtualSize,s)+m,o&&a&&("slide"===n.effect||"coverflow"===n.effect)&&(i.style.width="".concat(e.virtualSize+y,"px")),n.setWrapperSize&&(i.style[e.getDirectionLabel("width")]="".concat(e.virtualSize+y,"px")),w&&e.grid.updateWrapperSize(S,d),!n.centeredSlides){const t=[];for(let i=0;i<d.length;i+=1){let r=d[i];n.roundLengths&&(r=Math.floor(r)),d[i]<=e.virtualSize-s&&t.push(r)}d=t,Math.floor(e.virtualSize-s)-Math.floor(d[d.length-1])>1&&d.push(e.virtualSize-s)}if(l&&n.loop){const t=A[0]+y;if(n.slidesPerGroup>1){const i=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/n.slidesPerGroup),r=t*n.slidesPerGroup;for(let e=0;e<i;e+=1)d.push(d[d.length-1]+r)}for(let i=0;i<e.virtual.slidesBefore+e.virtual.slidesAfter;i+=1)1===n.slidesPerGroup&&d.push(d[d.length-1]+t),p.push(p[p.length-1]+t),e.virtualSize+=t}if(0===d.length&&(d=[0]),0!==y){const t=e.isHorizontal()&&o?"marginLeft":e.getDirectionLabel("marginRight");u.filter(((e,t)=>!(n.cssMode&&!n.loop)||t!==u.length-1)).forEach((e=>{e.style[t]="".concat(y,"px")}))}if(n.centeredSlides&&n.centeredSlidesBounds){let e=0;A.forEach((t=>{e+=t+(y||0)})),e-=y;const t=e>s?e-s:0;d=d.map((e=>e<=0?-f:e>t?t+m:e))}if(n.centerInsufficientSlides){let e=0;A.forEach((t=>{e+=t+(y||0)})),e-=y;const t=(n.slidesOffsetBefore||0)+(n.slidesOffsetAfter||0);if(e+t<s){const n=(s-e-t)/2;d.forEach(((e,t)=>{d[t]=e-n})),p.forEach(((e,t)=>{p[t]=e+n}))}}if(Object.assign(e,{slides:u,snapGrid:d,slidesGrid:p,slidesSizesGrid:A}),n.centeredSlides&&n.cssMode&&!n.centeredSlidesBounds){w9(i,"--swiper-centered-offset-before","".concat(-d[0],"px")),w9(i,"--swiper-centered-offset-after","".concat(e.size/2-A[A.length-1]/2,"px"));const t=-e.snapGrid[0],n=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map((e=>e+t)),e.slidesGrid=e.slidesGrid.map((e=>e+n))}if(h!==c&&e.emit("slidesLengthChange"),d.length!==g&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),p.length!==v&&e.emit("slidesGridLengthChange"),n.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!l&&!n.cssMode&&("slide"===n.effect||"fade"===n.effect)){const t="".concat(n.containerModifierClass,"backface-hidden"),i=e.el.classList.contains(t);h<=n.maxBackfaceHiddenSlides?i||e.el.classList.add(t):i&&e.el.classList.remove(t)}},updateAutoHeight:function(e){const t=this,n=[],i=t.virtual&&t.params.virtual.enabled;let r,s=0;"number"===typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const o=e=>i?t.slides[t.getSlideIndexByData(e)]:t.slides[e];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach((e=>{n.push(e)}));else for(r=0;r<Math.ceil(t.params.slidesPerView);r+=1){const e=t.activeIndex+r;if(e>t.slides.length&&!i)break;n.push(o(e))}else n.push(o(t.activeIndex));for(r=0;r<n.length;r+=1)if("undefined"!==typeof n[r]){const e=n[r].offsetHeight;s=e>s?e:s}(s||0===s)&&(t.wrapperEl.style.height="".concat(s,"px"))},updateSlidesOffset:function(){const e=this,t=e.slides,n=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let i=0;i<t.length;i+=1)t[i].swiperSlideOffset=(e.isHorizontal()?t[i].offsetLeft:t[i].offsetTop)-n-e.cssOverflowAdjustment()},updateSlidesProgress:function(e){void 0===e&&(e=this&&this.translate||0);const t=this,n=t.params,{slides:i,rtlTranslate:r,snapGrid:s}=t;if(0===i.length)return;"undefined"===typeof i[0].swiperSlideOffset&&t.updateSlidesOffset();let o=-e;r&&(o=e),t.visibleSlidesIndexes=[],t.visibleSlides=[];let a=n.spaceBetween;"string"===typeof a&&a.indexOf("%")>=0?a=parseFloat(a.replace("%",""))/100*t.size:"string"===typeof a&&(a=parseFloat(a));for(let l=0;l<i.length;l+=1){const e=i[l];let c=e.swiperSlideOffset;n.cssMode&&n.centeredSlides&&(c-=i[0].swiperSlideOffset);const u=(o+(n.centeredSlides?t.minTranslate():0)-c)/(e.swiperSlideSize+a),h=(o-s[0]+(n.centeredSlides?t.minTranslate():0)-c)/(e.swiperSlideSize+a),d=-(o-c),p=d+t.slidesSizesGrid[l],A=d>=0&&d<=t.size-t.slidesSizesGrid[l],f=d>=0&&d<t.size-1||p>1&&p<=t.size||d<=0&&p>=t.size;f&&(t.visibleSlides.push(e),t.visibleSlidesIndexes.push(l)),z9(e,f,n.slideVisibleClass),z9(e,A,n.slideFullyVisibleClass),e.progress=r?-u:u,e.originalProgress=r?-h:h}},updateProgress:function(e){const t=this;if("undefined"===typeof e){const n=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*n||0}const n=t.params,i=t.maxTranslate()-t.minTranslate();let{progress:r,isBeginning:s,isEnd:o,progressLoop:a}=t;const l=s,c=o;if(0===i)r=0,s=!0,o=!0;else{r=(e-t.minTranslate())/i;const n=Math.abs(e-t.minTranslate())<1,a=Math.abs(e-t.maxTranslate())<1;s=n||r<=0,o=a||r>=1,n&&(r=0),a&&(r=1)}if(n.loop){const n=t.getSlideIndexByData(0),i=t.getSlideIndexByData(t.slides.length-1),r=t.slidesGrid[n],s=t.slidesGrid[i],o=t.slidesGrid[t.slidesGrid.length-1],l=Math.abs(e);a=l>=r?(l-r)/o:(l+o-s)/o,a>1&&(a-=1)}Object.assign(t,{progress:r,progressLoop:a,isBeginning:s,isEnd:o}),(n.watchSlidesProgress||n.centeredSlides&&n.autoHeight)&&t.updateSlidesProgress(e),s&&!l&&t.emit("reachBeginning toEdge"),o&&!c&&t.emit("reachEnd toEdge"),(l&&!s||c&&!o)&&t.emit("fromEdge"),t.emit("progress",r)},updateSlidesClasses:function(){const e=this,{slides:t,params:n,slidesEl:i,activeIndex:r}=e,s=e.virtual&&n.virtual.enabled,o=e.grid&&n.grid&&n.grid.rows>1,a=e=>T9(i,".".concat(n.slideClass).concat(e,", swiper-slide").concat(e))[0];let l,c,u;if(s)if(n.loop){let t=r-e.virtual.slidesBefore;t<0&&(t=e.virtual.slides.length+t),t>=e.virtual.slides.length&&(t-=e.virtual.slides.length),l=a('[data-swiper-slide-index="'.concat(t,'"]'))}else l=a('[data-swiper-slide-index="'.concat(r,'"]'));else o?(l=t.filter((e=>e.column===r))[0],u=t.filter((e=>e.column===r+1))[0],c=t.filter((e=>e.column===r-1))[0]):l=t[r];l&&(o||(u=function(e,t){const n=[];for(;e.nextElementSibling;){const i=e.nextElementSibling;t?i.matches(t)&&n.push(i):n.push(i),e=i}return n}(l,".".concat(n.slideClass,", swiper-slide"))[0],n.loop&&!u&&(u=t[0]),c=function(e,t){const n=[];for(;e.previousElementSibling;){const i=e.previousElementSibling;t?i.matches(t)&&n.push(i):n.push(i),e=i}return n}(l,".".concat(n.slideClass,", swiper-slide"))[0],n.loop&&0===!c&&(c=t[t.length-1]))),t.forEach((e=>{q9(e,e===l,n.slideActiveClass),q9(e,e===u,n.slideNextClass),q9(e,e===c,n.slidePrevClass)})),e.emitSlidesClasses()},updateActiveIndex:function(e){const t=this,n=t.rtlTranslate?t.translate:-t.translate,{snapGrid:i,params:r,activeIndex:s,realIndex:o,snapIndex:a}=t;let l,c=e;const u=e=>{let n=e-t.virtual.slidesBefore;return n<0&&(n=t.virtual.slides.length+n),n>=t.virtual.slides.length&&(n-=t.virtual.slides.length),n};if("undefined"===typeof c&&(c=function(e){const{slidesGrid:t,params:n}=e,i=e.rtlTranslate?e.translate:-e.translate;let r;for(let s=0;s<t.length;s+=1)"undefined"!==typeof t[s+1]?i>=t[s]&&i<t[s+1]-(t[s+1]-t[s])/2?r=s:i>=t[s]&&i<t[s+1]&&(r=s+1):i>=t[s]&&(r=s);return n.normalizeSlideIndex&&(r<0||"undefined"===typeof r)&&(r=0),r}(t)),i.indexOf(n)>=0)l=i.indexOf(n);else{const e=Math.min(r.slidesPerGroupSkip,c);l=e+Math.floor((c-e)/r.slidesPerGroup)}if(l>=i.length&&(l=i.length-1),c===s&&!t.params.loop)return void(l!==a&&(t.snapIndex=l,t.emit("snapIndexChange")));if(c===s&&t.params.loop&&t.virtual&&t.params.virtual.enabled)return void(t.realIndex=u(c));const h=t.grid&&r.grid&&r.grid.rows>1;let d;if(t.virtual&&r.virtual.enabled&&r.loop)d=u(c);else if(h){const e=t.slides.filter((e=>e.column===c))[0];let n=parseInt(e.getAttribute("data-swiper-slide-index"),10);Number.isNaN(n)&&(n=Math.max(t.slides.indexOf(e),0)),d=Math.floor(n/r.grid.rows)}else if(t.slides[c]){const e=t.slides[c].getAttribute("data-swiper-slide-index");d=e?parseInt(e,10):c}else d=c;Object.assign(t,{previousSnapIndex:a,snapIndex:l,previousRealIndex:o,realIndex:d,previousIndex:s,activeIndex:c}),t.initialized&&j9(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(o!==d&&t.emit("realIndexChange"),t.emit("slideChange"))},updateClickedSlide:function(e,t){const n=this,i=n.params;let r=e.closest(".".concat(i.slideClass,", swiper-slide"));!r&&n.isElement&&t&&t.length>1&&t.includes(e)&&[...t.slice(t.indexOf(e)+1,t.length)].forEach((e=>{!r&&e.matches&&e.matches(".".concat(i.slideClass,", swiper-slide"))&&(r=e)}));let s,o=!1;if(r)for(let a=0;a<n.slides.length;a+=1)if(n.slides[a]===r){o=!0,s=a;break}if(!r||!o)return n.clickedSlide=void 0,void(n.clickedIndex=void 0);n.clickedSlide=r,n.virtual&&n.params.virtual.enabled?n.clickedIndex=parseInt(r.getAttribute("data-swiper-slide-index"),10):n.clickedIndex=s,i.slideToClickedSlide&&void 0!==n.clickedIndex&&n.clickedIndex!==n.activeIndex&&n.slideToClickedSlide()}};var W9={getTranslate:function(e){void 0===e&&(e=this.isHorizontal()?"x":"y");const{params:t,rtlTranslate:n,translate:i,wrapperEl:r}=this;if(t.virtualTranslate)return n?-i:i;if(t.cssMode)return i;let s=b9(r,e);return s+=this.cssOverflowAdjustment(),n&&(s=-s),s||0},setTranslate:function(e,t){const n=this,{rtlTranslate:i,params:r,wrapperEl:s,progress:o}=n;let a,l=0,c=0;n.isHorizontal()?l=i?-e:e:c=e,r.roundLengths&&(l=Math.floor(l),c=Math.floor(c)),n.previousTranslate=n.translate,n.translate=n.isHorizontal()?l:c,r.cssMode?s[n.isHorizontal()?"scrollLeft":"scrollTop"]=n.isHorizontal()?-l:-c:r.virtualTranslate||(n.isHorizontal()?l-=n.cssOverflowAdjustment():c-=n.cssOverflowAdjustment(),s.style.transform="translate3d(".concat(l,"px, ").concat(c,"px, ").concat(0,"px)"));const u=n.maxTranslate()-n.minTranslate();a=0===u?0:(e-n.minTranslate())/u,a!==o&&n.updateProgress(e),n.emit("setTranslate",n.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e,t,n,i,r){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===n&&(n=!0),void 0===i&&(i=!0);const s=this,{params:o,wrapperEl:a}=s;if(s.animating&&o.preventInteractionOnTransition)return!1;const l=s.minTranslate(),c=s.maxTranslate();let u;if(u=i&&e>l?l:i&&e<c?c:e,s.updateProgress(u),o.cssMode){const e=s.isHorizontal();if(0===t)a[e?"scrollLeft":"scrollTop"]=-u;else{if(!s.support.smoothScroll)return S9({swiper:s,targetPosition:-u,side:e?"left":"top"}),!0;a.scrollTo({[e?"left":"top"]:-u,behavior:"smooth"})}return!0}return 0===t?(s.setTransition(0),s.setTranslate(u),n&&(s.emit("beforeTransitionStart",t,r),s.emit("transitionEnd"))):(s.setTransition(t),s.setTranslate(u),n&&(s.emit("beforeTransitionStart",t,r),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(e){s&&!s.destroyed&&e.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,n&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}};function X9(e){let{swiper:t,runCallbacks:n,direction:i,step:r}=e;const{activeIndex:s,previousIndex:o}=t;let a=i;if(a||(a=s>o?"next":s<o?"prev":"reset"),t.emit("transition".concat(r)),n&&s!==o){if("reset"===a)return void t.emit("slideResetTransition".concat(r));t.emit("slideChangeTransition".concat(r)),"next"===a?t.emit("slideNextTransition".concat(r)):t.emit("slidePrevTransition".concat(r))}}var Y9={setTransition:function(e,t){const n=this;n.params.cssMode||(n.wrapperEl.style.transitionDuration="".concat(e,"ms"),n.wrapperEl.style.transitionDelay=0===e?"0ms":""),n.emit("setTransition",e,t)},transitionStart:function(e,t){void 0===e&&(e=!0);const n=this,{params:i}=n;i.cssMode||(i.autoHeight&&n.updateAutoHeight(),X9({swiper:n,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function(e,t){void 0===e&&(e=!0);const n=this,{params:i}=n;n.animating=!1,i.cssMode||(n.setTransition(0),X9({swiper:n,runCallbacks:e,direction:t,step:"End"}))}};var Q9={slideTo:function(e,t,n,i,r){void 0===e&&(e=0),void 0===n&&(n=!0),"string"===typeof e&&(e=parseInt(e,10));const s=this;let o=e;o<0&&(o=0);const{params:a,snapGrid:l,slidesGrid:c,previousIndex:u,activeIndex:h,rtlTranslate:d,wrapperEl:p,enabled:A}=s;if(!A&&!i&&!r||s.destroyed||s.animating&&a.preventInteractionOnTransition)return!1;"undefined"===typeof t&&(t=s.params.speed);const f=Math.min(s.params.slidesPerGroupSkip,o);let m=f+Math.floor((o-f)/s.params.slidesPerGroup);m>=l.length&&(m=l.length-1);const g=-l[m];if(a.normalizeSlideIndex)for(let b=0;b<c.length;b+=1){const e=-Math.floor(100*g),t=Math.floor(100*c[b]),n=Math.floor(100*c[b+1]);"undefined"!==typeof c[b+1]?e>=t&&e<n-(n-t)/2?o=b:e>=t&&e<n&&(o=b+1):e>=t&&(o=b)}if(s.initialized&&o!==h){if(!s.allowSlideNext&&(d?g>s.translate&&g>s.minTranslate():g<s.translate&&g<s.minTranslate()))return!1;if(!s.allowSlidePrev&&g>s.translate&&g>s.maxTranslate()&&(h||0)!==o)return!1}let v;o!==(u||0)&&n&&s.emit("beforeSlideChangeStart"),s.updateProgress(g),v=o>h?"next":o<h?"prev":"reset";const y=s.virtual&&s.params.virtual.enabled;if(!(y&&r)&&(d&&-g===s.translate||!d&&g===s.translate))return s.updateActiveIndex(o),a.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),"slide"!==a.effect&&s.setTranslate(g),"reset"!==v&&(s.transitionStart(n,v),s.transitionEnd(n,v)),!1;if(a.cssMode){const e=s.isHorizontal(),n=d?g:-g;if(0===t)y&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),y&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame((()=>{p[e?"scrollLeft":"scrollTop"]=n}))):p[e?"scrollLeft":"scrollTop"]=n,y&&requestAnimationFrame((()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1}));else{if(!s.support.smoothScroll)return S9({swiper:s,targetPosition:n,side:e?"left":"top"}),!0;p.scrollTo({[e?"left":"top"]:n,behavior:"smooth"})}return!0}return s.setTransition(t),s.setTranslate(g),s.updateActiveIndex(o),s.updateSlidesClasses(),s.emit("beforeTransitionStart",t,i),s.transitionStart(n,v),0===t?s.transitionEnd(n,v):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(e){s&&!s.destroyed&&e.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(n,v))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(e,t,n,i){if(void 0===e&&(e=0),void 0===n&&(n=!0),"string"===typeof e){e=parseInt(e,10)}const r=this;if(r.destroyed)return;"undefined"===typeof t&&(t=r.params.speed);const s=r.grid&&r.params.grid&&r.params.grid.rows>1;let o=e;if(r.params.loop)if(r.virtual&&r.params.virtual.enabled)o+=r.virtual.slidesBefore;else{let e;if(s){const t=o*r.params.grid.rows;e=r.slides.filter((e=>1*e.getAttribute("data-swiper-slide-index")===t))[0].column}else e=r.getSlideIndexByData(o);const t=s?Math.ceil(r.slides.length/r.params.grid.rows):r.slides.length,{centeredSlides:n}=r.params;let a=r.params.slidesPerView;"auto"===a?a=r.slidesPerViewDynamic():(a=Math.ceil(parseFloat(r.params.slidesPerView,10)),n&&a%2===0&&(a+=1));let l=t-e<a;if(n&&(l=l||e<Math.ceil(a/2)),i&&n&&"auto"!==r.params.slidesPerView&&!s&&(l=!1),l){const i=n?e<r.activeIndex?"prev":"next":e-r.activeIndex-1<r.params.slidesPerView?"next":"prev";r.loopFix({direction:i,slideTo:!0,activeSlideIndex:"next"===i?e+1:e-t+1,slideRealIndex:"next"===i?r.realIndex:void 0})}if(s){const e=o*r.params.grid.rows;o=r.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0].column}else o=r.getSlideIndexByData(o)}return requestAnimationFrame((()=>{r.slideTo(o,t,n,i)})),r},slideNext:function(e,t,n){void 0===t&&(t=!0);const i=this,{enabled:r,params:s,animating:o}=i;if(!r||i.destroyed)return i;"undefined"===typeof e&&(e=i.params.speed);let a=s.slidesPerGroup;"auto"===s.slidesPerView&&1===s.slidesPerGroup&&s.slidesPerGroupAuto&&(a=Math.max(i.slidesPerViewDynamic("current",!0),1));const l=i.activeIndex<s.slidesPerGroupSkip?1:a,c=i.virtual&&s.virtual.enabled;if(s.loop){if(o&&!c&&s.loopPreventsSliding)return!1;if(i.loopFix({direction:"next"}),i._clientLeft=i.wrapperEl.clientLeft,i.activeIndex===i.slides.length-1&&s.cssMode)return requestAnimationFrame((()=>{i.slideTo(i.activeIndex+l,e,t,n)})),!0}return s.rewind&&i.isEnd?i.slideTo(0,e,t,n):i.slideTo(i.activeIndex+l,e,t,n)},slidePrev:function(e,t,n){void 0===t&&(t=!0);const i=this,{params:r,snapGrid:s,slidesGrid:o,rtlTranslate:a,enabled:l,animating:c}=i;if(!l||i.destroyed)return i;"undefined"===typeof e&&(e=i.params.speed);const u=i.virtual&&r.virtual.enabled;if(r.loop){if(c&&!u&&r.loopPreventsSliding)return!1;i.loopFix({direction:"prev"}),i._clientLeft=i.wrapperEl.clientLeft}function h(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const d=h(a?i.translate:-i.translate),p=s.map((e=>h(e)));let A=s[p.indexOf(d)-1];if("undefined"===typeof A&&r.cssMode){let e;s.forEach(((t,n)=>{d>=t&&(e=n)})),"undefined"!==typeof e&&(A=s[e>0?e-1:e])}let f=0;if("undefined"!==typeof A&&(f=o.indexOf(A),f<0&&(f=i.activeIndex-1),"auto"===r.slidesPerView&&1===r.slidesPerGroup&&r.slidesPerGroupAuto&&(f=f-i.slidesPerViewDynamic("previous",!0)+1,f=Math.max(f,0))),r.rewind&&i.isBeginning){const r=i.params.virtual&&i.params.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1;return i.slideTo(r,e,t,n)}return r.loop&&0===i.activeIndex&&r.cssMode?(requestAnimationFrame((()=>{i.slideTo(f,e,t,n)})),!0):i.slideTo(f,e,t,n)},slideReset:function(e,t,n){void 0===t&&(t=!0);const i=this;if(!i.destroyed)return"undefined"===typeof e&&(e=i.params.speed),i.slideTo(i.activeIndex,e,t,n)},slideToClosest:function(e,t,n,i){void 0===t&&(t=!0),void 0===i&&(i=.5);const r=this;if(r.destroyed)return;"undefined"===typeof e&&(e=r.params.speed);let s=r.activeIndex;const o=Math.min(r.params.slidesPerGroupSkip,s),a=o+Math.floor((s-o)/r.params.slidesPerGroup),l=r.rtlTranslate?r.translate:-r.translate;if(l>=r.snapGrid[a]){const e=r.snapGrid[a];l-e>(r.snapGrid[a+1]-e)*i&&(s+=r.params.slidesPerGroup)}else{const e=r.snapGrid[a-1];l-e<=(r.snapGrid[a]-e)*i&&(s-=r.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,r.slidesGrid.length-1),r.slideTo(s,e,t,n)},slideToClickedSlide:function(){const e=this;if(e.destroyed)return;const{params:t,slidesEl:n}=e,i="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let r,s=e.clickedIndex;const o=e.isElement?"swiper-slide":".".concat(t.slideClass);if(t.loop){if(e.animating)return;r=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?s<e.loopedSlides-i/2||s>e.slides.length-e.loopedSlides+i/2?(e.loopFix(),s=e.getSlideIndex(T9(n,"".concat(o,'[data-swiper-slide-index="').concat(r,'"]'))[0]),v9((()=>{e.slideTo(s)}))):e.slideTo(s):s>e.slides.length-i?(e.loopFix(),s=e.getSlideIndex(T9(n,"".concat(o,'[data-swiper-slide-index="').concat(r,'"]'))[0]),v9((()=>{e.slideTo(s)}))):e.slideTo(s)}else e.slideTo(s)}};var K9={loopCreate:function(e){const t=this,{params:n,slidesEl:i}=t;if(!n.loop||t.virtual&&t.params.virtual.enabled)return;const r=()=>{T9(i,".".concat(n.slideClass,", swiper-slide")).forEach(((e,t)=>{e.setAttribute("data-swiper-slide-index",t)}))},s=t.grid&&n.grid&&n.grid.rows>1,o=n.slidesPerGroup*(s?n.grid.rows:1),a=t.slides.length%o!==0,l=s&&t.slides.length%n.grid.rows!==0,c=e=>{for(let i=0;i<e;i+=1){const e=t.isElement?E9("swiper-slide",[n.slideBlankClass]):E9("div",[n.slideClass,n.slideBlankClass]);t.slidesEl.append(e)}};if(a){if(n.loopAddBlankSlides){c(o-t.slides.length%o),t.recalcSlides(),t.updateSlides()}else M9("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else if(l){if(n.loopAddBlankSlides){c(n.grid.rows-t.slides.length%n.grid.rows),t.recalcSlides(),t.updateSlides()}else M9("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");r()}else r();t.loopFix({slideRealIndex:e,direction:n.centeredSlides?void 0:"next"})},loopFix:function(e){let{slideRealIndex:t,slideTo:n=!0,direction:i,setTranslate:r,activeSlideIndex:s,byController:o,byMousewheel:a}=void 0===e?{}:e;const l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");const{slides:c,allowSlidePrev:u,allowSlideNext:h,slidesEl:d,params:p}=l,{centeredSlides:A}=p;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&p.virtual.enabled)return n&&(p.centeredSlides||0!==l.snapIndex?p.centeredSlides&&l.snapIndex<p.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0):l.slideTo(l.virtual.slides.length,0,!1,!0)),l.allowSlidePrev=u,l.allowSlideNext=h,void l.emit("loopFix");let f=p.slidesPerView;"auto"===f?f=l.slidesPerViewDynamic():(f=Math.ceil(parseFloat(p.slidesPerView,10)),A&&f%2===0&&(f+=1));const m=p.slidesPerGroupAuto?f:p.slidesPerGroup;let g=m;g%m!==0&&(g+=m-g%m),g+=p.loopAdditionalSlides,l.loopedSlides=g;const v=l.grid&&p.grid&&p.grid.rows>1;c.length<f+g?M9("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):v&&"row"===p.grid.fill&&M9("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const y=[],b=[];let x=l.activeIndex;"undefined"===typeof s?s=l.getSlideIndex(c.filter((e=>e.classList.contains(p.slideActiveClass)))[0]):x=s;const _="next"===i||!i,w="prev"===i||!i;let S=0,T=0;const E=v?Math.ceil(c.length/p.grid.rows):c.length,C=(v?c[s].column:s)+(A&&"undefined"===typeof r?-f/2+.5:0);if(C<g){S=Math.max(g-C,m);for(let e=0;e<g-C;e+=1){const t=e-Math.floor(e/E)*E;if(v){const e=E-t-1;for(let t=c.length-1;t>=0;t-=1)c[t].column===e&&y.push(t)}else y.push(E-t-1)}}else if(C+f>E-g){T=Math.max(C-(E-2*g),m);for(let e=0;e<T;e+=1){const t=e-Math.floor(e/E)*E;v?c.forEach(((e,n)=>{e.column===t&&b.push(n)})):b.push(t)}}if(l.__preventObserver__=!0,requestAnimationFrame((()=>{l.__preventObserver__=!1})),w&&y.forEach((e=>{c[e].swiperLoopMoveDOM=!0,d.prepend(c[e]),c[e].swiperLoopMoveDOM=!1})),_&&b.forEach((e=>{c[e].swiperLoopMoveDOM=!0,d.append(c[e]),c[e].swiperLoopMoveDOM=!1})),l.recalcSlides(),"auto"===p.slidesPerView?l.updateSlides():v&&(y.length>0&&w||b.length>0&&_)&&l.slides.forEach(((e,t)=>{l.grid.updateSlide(t,e,l.slides)})),p.watchSlidesProgress&&l.updateSlidesOffset(),n)if(y.length>0&&w){if("undefined"===typeof t){const e=l.slidesGrid[x],t=l.slidesGrid[x+S]-e;a?l.setTranslate(l.translate-t):(l.slideTo(x+Math.ceil(S),0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-t,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-t))}else if(r){const e=v?y.length/p.grid.rows:y.length;l.slideTo(l.activeIndex+e,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(b.length>0&&_)if("undefined"===typeof t){const e=l.slidesGrid[x],t=l.slidesGrid[x-T]-e;a?l.setTranslate(l.translate-t):(l.slideTo(x-T,0,!1,!0),r&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-t,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-t))}else{const e=v?b.length/p.grid.rows:b.length;l.slideTo(l.activeIndex-e,0,!1,!0)}if(l.allowSlidePrev=u,l.allowSlideNext=h,l.controller&&l.controller.control&&!o){const e={slideRealIndex:t,direction:i,setTranslate:r,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach((t=>{!t.destroyed&&t.params.loop&&t.loopFix(M(M({},e),{},{slideTo:t.params.slidesPerView===p.slidesPerView&&n}))})):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix(M(M({},e),{},{slideTo:l.controller.control.params.slidesPerView===p.slidesPerView&&n}))}l.emit("loopFix")},loopDestroy:function(){const e=this,{params:t,slidesEl:n}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const i=[];e.slides.forEach((e=>{const t="undefined"===typeof e.swiperSlideIndex?1*e.getAttribute("data-swiper-slide-index"):e.swiperSlideIndex;i[t]=e})),e.slides.forEach((e=>{e.removeAttribute("data-swiper-slide-index")})),i.forEach((e=>{n.append(e)})),e.recalcSlides(),e.slideTo(e.realIndex,0)}};var Z9={setGrabCursor:function(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const n="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),n.style.cursor="move",n.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame((()=>{t.__preventObserver__=!1}))},unsetGrabCursor:function(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame((()=>{e.__preventObserver__=!1})))}};function J9(e,t,n){const i=g9(),{params:r}=e,s=r.edgeSwipeDetection,o=r.edgeSwipeThreshold;return!s||!(n<=o||n>=i.innerWidth-o)||"prevent"===s&&(t.preventDefault(),!0)}function $9(e){const t=this,n=f9();let i=e;i.originalEvent&&(i=i.originalEvent);const r=t.touchEventsData;if("pointerdown"===i.type){if(null!==r.pointerId&&r.pointerId!==i.pointerId)return;r.pointerId=i.pointerId}else"touchstart"===i.type&&1===i.targetTouches.length&&(r.touchId=i.targetTouches[0].identifier);if("touchstart"===i.type)return void J9(t,i,i.targetTouches[0].pageX);const{params:s,touches:o,enabled:a}=t;if(!a)return;if(!s.simulateTouch&&"mouse"===i.pointerType)return;if(t.animating&&s.preventInteractionOnTransition)return;!t.animating&&s.cssMode&&s.loop&&t.loopFix();let l=i.target;if("wrapper"===s.touchEventsTarget&&!function(e,t){const n=t.contains(e);if(!n&&t instanceof HTMLSlotElement)return[...t.assignedElements()].includes(e);return n}(l,t.wrapperEl))return;if("which"in i&&3===i.which)return;if("button"in i&&i.button>0)return;if(r.isTouched&&r.isMoved)return;const c=!!s.noSwipingClass&&""!==s.noSwipingClass,u=i.composedPath?i.composedPath():i.path;c&&i.target&&i.target.shadowRoot&&u&&(l=u[0]);const h=s.noSwipingSelector?s.noSwipingSelector:".".concat(s.noSwipingClass),d=!(!i.target||!i.target.shadowRoot);if(s.noSwiping&&(d?function(e,t){return void 0===t&&(t=this),function t(n){if(!n||n===f9()||n===g9())return null;n.assignedSlot&&(n=n.assignedSlot);const i=n.closest(e);return i||n.getRootNode?i||t(n.getRootNode().host):null}(t)}(h,l):l.closest(h)))return void(t.allowClick=!0);if(s.swipeHandler&&!l.closest(s.swipeHandler))return;o.currentX=i.pageX,o.currentY=i.pageY;const p=o.currentX,A=o.currentY;if(!J9(t,i,p))return;Object.assign(r,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),o.startX=p,o.startY=A,r.touchStartTime=y9(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,s.threshold>0&&(r.allowThresholdMove=!1);let f=!0;l.matches(r.focusableElements)&&(f=!1,"SELECT"===l.nodeName&&(r.isTouched=!1)),n.activeElement&&n.activeElement.matches(r.focusableElements)&&n.activeElement!==l&&("mouse"===i.pointerType||"mouse"!==i.pointerType&&!l.matches(r.focusableElements))&&n.activeElement.blur();const m=f&&t.allowTouchMove&&s.touchStartPreventDefault;!s.touchStartForcePreventDefault&&!m||l.isContentEditable||i.preventDefault(),s.freeMode&&s.freeMode.enabled&&t.freeMode&&t.animating&&!s.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",i)}function eee(e){const t=f9(),n=this,i=n.touchEventsData,{params:r,touches:s,rtlTranslate:o,enabled:a}=n;if(!a)return;if(!r.simulateTouch&&"mouse"===e.pointerType)return;let l,c=e;if(c.originalEvent&&(c=c.originalEvent),"pointermove"===c.type){if(null!==i.touchId)return;if(c.pointerId!==i.pointerId)return}if("touchmove"===c.type){if(l=[...c.changedTouches].filter((e=>e.identifier===i.touchId))[0],!l||l.identifier!==i.touchId)return}else l=c;if(!i.isTouched)return void(i.startMoving&&i.isScrolling&&n.emit("touchMoveOpposite",c));const u=l.pageX,h=l.pageY;if(c.preventedByNestedSwiper)return s.startX=u,void(s.startY=h);if(!n.allowTouchMove)return c.target.matches(i.focusableElements)||(n.allowClick=!1),void(i.isTouched&&(Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h}),i.touchStartTime=y9()));if(r.touchReleaseOnEdges&&!r.loop)if(n.isVertical()){if(h<s.startY&&n.translate<=n.maxTranslate()||h>s.startY&&n.translate>=n.minTranslate())return i.isTouched=!1,void(i.isMoved=!1)}else if(u<s.startX&&n.translate<=n.maxTranslate()||u>s.startX&&n.translate>=n.minTranslate())return;if(t.activeElement&&t.activeElement.matches(i.focusableElements)&&t.activeElement!==c.target&&"mouse"!==c.pointerType&&t.activeElement.blur(),t.activeElement&&c.target===t.activeElement&&c.target.matches(i.focusableElements))return i.isMoved=!0,void(n.allowClick=!1);i.allowTouchCallbacks&&n.emit("touchMove",c),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=u,s.currentY=h;const d=s.currentX-s.startX,p=s.currentY-s.startY;if(n.params.threshold&&Math.sqrt(d**2+p**2)<n.params.threshold)return;if("undefined"===typeof i.isScrolling){let e;n.isHorizontal()&&s.currentY===s.startY||n.isVertical()&&s.currentX===s.startX?i.isScrolling=!1:d*d+p*p>=25&&(e=180*Math.atan2(Math.abs(p),Math.abs(d))/Math.PI,i.isScrolling=n.isHorizontal()?e>r.touchAngle:90-e>r.touchAngle)}if(i.isScrolling&&n.emit("touchMoveOpposite",c),"undefined"===typeof i.startMoving&&(s.currentX===s.startX&&s.currentY===s.startY||(i.startMoving=!0)),i.isScrolling||"touchmove"===c.type&&i.preventTouchMoveFromPointerMove)return void(i.isTouched=!1);if(!i.startMoving)return;n.allowClick=!1,!r.cssMode&&c.cancelable&&c.preventDefault(),r.touchMoveStopPropagation&&!r.nested&&c.stopPropagation();let A=n.isHorizontal()?d:p,f=n.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;r.oneWayMovement&&(A=Math.abs(A)*(o?1:-1),f=Math.abs(f)*(o?1:-1)),s.diff=A,A*=r.touchRatio,o&&(A=-A,f=-f);const m=n.touchesDirection;n.swipeDirection=A>0?"prev":"next",n.touchesDirection=f>0?"prev":"next";const g=n.params.loop&&!r.cssMode,v="next"===n.touchesDirection&&n.allowSlideNext||"prev"===n.touchesDirection&&n.allowSlidePrev;if(!i.isMoved){if(g&&v&&n.loopFix({direction:n.swipeDirection}),i.startTranslate=n.getTranslate(),n.setTransition(0),n.animating){const e=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});n.wrapperEl.dispatchEvent(e)}i.allowMomentumBounce=!1,!r.grabCursor||!0!==n.allowSlideNext&&!0!==n.allowSlidePrev||n.setGrabCursor(!0),n.emit("sliderFirstMove",c)}if((new Date).getTime(),i.isMoved&&i.allowThresholdMove&&m!==n.touchesDirection&&g&&v&&Math.abs(A)>=1)return Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h,startTranslate:i.currentTranslate}),i.loopSwapReset=!0,void(i.startTranslate=i.currentTranslate);n.emit("sliderMove",c),i.isMoved=!0,i.currentTranslate=A+i.startTranslate;let y=!0,b=r.resistanceRatio;if(r.touchReleaseOnEdges&&(b=0),A>0?(g&&v&&i.allowThresholdMove&&i.currentTranslate>(r.centeredSlides?n.minTranslate()-n.slidesSizesGrid[n.activeIndex+1]-("auto"!==r.slidesPerView&&n.slides.length-r.slidesPerView>=2?n.slidesSizesGrid[n.activeIndex+1]+n.params.spaceBetween:0)-n.params.spaceBetween:n.minTranslate())&&n.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),i.currentTranslate>n.minTranslate()&&(y=!1,r.resistance&&(i.currentTranslate=n.minTranslate()-1+(-n.minTranslate()+i.startTranslate+A)**b))):A<0&&(g&&v&&i.allowThresholdMove&&i.currentTranslate<(r.centeredSlides?n.maxTranslate()+n.slidesSizesGrid[n.slidesSizesGrid.length-1]+n.params.spaceBetween+("auto"!==r.slidesPerView&&n.slides.length-r.slidesPerView>=2?n.slidesSizesGrid[n.slidesSizesGrid.length-1]+n.params.spaceBetween:0):n.maxTranslate())&&n.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:n.slides.length-("auto"===r.slidesPerView?n.slidesPerViewDynamic():Math.ceil(parseFloat(r.slidesPerView,10)))}),i.currentTranslate<n.maxTranslate()&&(y=!1,r.resistance&&(i.currentTranslate=n.maxTranslate()+1-(n.maxTranslate()-i.startTranslate-A)**b))),y&&(c.preventedByNestedSwiper=!0),!n.allowSlideNext&&"next"===n.swipeDirection&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!n.allowSlidePrev&&"prev"===n.swipeDirection&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),n.allowSlidePrev||n.allowSlideNext||(i.currentTranslate=i.startTranslate),r.threshold>0){if(!(Math.abs(A)>r.threshold||i.allowThresholdMove))return void(i.currentTranslate=i.startTranslate);if(!i.allowThresholdMove)return i.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,i.currentTranslate=i.startTranslate,void(s.diff=n.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY)}r.followFinger&&!r.cssMode&&((r.freeMode&&r.freeMode.enabled&&n.freeMode||r.watchSlidesProgress)&&(n.updateActiveIndex(),n.updateSlidesClasses()),r.freeMode&&r.freeMode.enabled&&n.freeMode&&n.freeMode.onTouchMove(),n.updateProgress(i.currentTranslate),n.setTranslate(i.currentTranslate))}function tee(e){const t=this,n=t.touchEventsData;let i,r=e;r.originalEvent&&(r=r.originalEvent);if("touchend"===r.type||"touchcancel"===r.type){if(i=[...r.changedTouches].filter((e=>e.identifier===n.touchId))[0],!i||i.identifier!==n.touchId)return}else{if(null!==n.touchId)return;if(r.pointerId!==n.pointerId)return;i=r}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(r.type)){if(!(["pointercancel","contextmenu"].includes(r.type)&&(t.browser.isSafari||t.browser.isWebView)))return}n.pointerId=null,n.touchId=null;const{params:s,touches:o,rtlTranslate:a,slidesGrid:l,enabled:c}=t;if(!c)return;if(!s.simulateTouch&&"mouse"===r.pointerType)return;if(n.allowTouchCallbacks&&t.emit("touchEnd",r),n.allowTouchCallbacks=!1,!n.isTouched)return n.isMoved&&s.grabCursor&&t.setGrabCursor(!1),n.isMoved=!1,void(n.startMoving=!1);s.grabCursor&&n.isMoved&&n.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const u=y9(),h=u-n.touchStartTime;if(t.allowClick){const e=r.path||r.composedPath&&r.composedPath();t.updateClickedSlide(e&&e[0]||r.target,e),t.emit("tap click",r),h<300&&u-n.lastClickTime<300&&t.emit("doubleTap doubleClick",r)}if(n.lastClickTime=y9(),v9((()=>{t.destroyed||(t.allowClick=!0)})),!n.isTouched||!n.isMoved||!t.swipeDirection||0===o.diff&&!n.loopSwapReset||n.currentTranslate===n.startTranslate&&!n.loopSwapReset)return n.isTouched=!1,n.isMoved=!1,void(n.startMoving=!1);let d;if(n.isTouched=!1,n.isMoved=!1,n.startMoving=!1,d=s.followFinger?a?t.translate:-t.translate:-n.currentTranslate,s.cssMode)return;if(s.freeMode&&s.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:d});const p=d>=-t.maxTranslate()&&!t.params.loop;let A=0,f=t.slidesSizesGrid[0];for(let b=0;b<l.length;b+=b<s.slidesPerGroupSkip?1:s.slidesPerGroup){const e=b<s.slidesPerGroupSkip-1?1:s.slidesPerGroup;"undefined"!==typeof l[b+e]?(p||d>=l[b]&&d<l[b+e])&&(A=b,f=l[b+e]-l[b]):(p||d>=l[b])&&(A=b,f=l[l.length-1]-l[l.length-2])}let m=null,g=null;s.rewind&&(t.isBeginning?g=s.virtual&&s.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(m=0));const v=(d-l[A])/f,y=A<s.slidesPerGroupSkip-1?1:s.slidesPerGroup;if(h>s.longSwipesMs){if(!s.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(v>=s.longSwipesRatio?t.slideTo(s.rewind&&t.isEnd?m:A+y):t.slideTo(A)),"prev"===t.swipeDirection&&(v>1-s.longSwipesRatio?t.slideTo(A+y):null!==g&&v<0&&Math.abs(v)>s.longSwipesRatio?t.slideTo(g):t.slideTo(A))}else{if(!s.shortSwipes)return void t.slideTo(t.activeIndex);t.navigation&&(r.target===t.navigation.nextEl||r.target===t.navigation.prevEl)?r.target===t.navigation.nextEl?t.slideTo(A+y):t.slideTo(A):("next"===t.swipeDirection&&t.slideTo(null!==m?m:A+y),"prev"===t.swipeDirection&&t.slideTo(null!==g?g:A))}}function nee(){const e=this,{params:t,el:n}=e;if(n&&0===n.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:i,allowSlidePrev:r,snapGrid:s}=e,o=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const a=o&&t.loop;!("auto"===t.slidesPerView||t.slidesPerView>1)||!e.isEnd||e.isBeginning||e.params.centeredSlides||a?e.params.loop&&!o?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0):e.slideTo(e.slides.length-1,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout((()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()}),500)),e.allowSlidePrev=r,e.allowSlideNext=i,e.params.watchOverflow&&s!==e.snapGrid&&e.checkOverflow()}function iee(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function ree(){const e=this,{wrapperEl:t,rtlTranslate:n,enabled:i}=e;if(!i)return;let r;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const s=e.maxTranslate()-e.minTranslate();r=0===s?0:(e.translate-e.minTranslate())/s,r!==e.progress&&e.updateProgress(n?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function see(e){const t=this;V9(t,e.target),t.params.cssMode||"auto"!==t.params.slidesPerView&&!t.params.autoHeight||t.update()}function oee(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const aee=(e,t)=>{const n=f9(),{params:i,el:r,wrapperEl:s,device:o}=e,a=!!i.nested,l="on"===t?"addEventListener":"removeEventListener",c=t;r&&"string"!==typeof r&&(n[l]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:a}),r[l]("touchstart",e.onTouchStart,{passive:!1}),r[l]("pointerdown",e.onTouchStart,{passive:!1}),n[l]("touchmove",e.onTouchMove,{passive:!1,capture:a}),n[l]("pointermove",e.onTouchMove,{passive:!1,capture:a}),n[l]("touchend",e.onTouchEnd,{passive:!0}),n[l]("pointerup",e.onTouchEnd,{passive:!0}),n[l]("pointercancel",e.onTouchEnd,{passive:!0}),n[l]("touchcancel",e.onTouchEnd,{passive:!0}),n[l]("pointerout",e.onTouchEnd,{passive:!0}),n[l]("pointerleave",e.onTouchEnd,{passive:!0}),n[l]("contextmenu",e.onTouchEnd,{passive:!0}),(i.preventClicks||i.preventClicksPropagation)&&r[l]("click",e.onClick,!0),i.cssMode&&s[l]("scroll",e.onScroll),i.updateOnWindowResize?e[c](o.ios||o.android?"resize orientationchange observerUpdate":"resize observerUpdate",nee,!0):e[c]("observerUpdate",nee,!0),r[l]("load",e.onLoad,{capture:!0}))};var lee={attachEvents:function(){const e=this,{params:t}=e;e.onTouchStart=$9.bind(e),e.onTouchMove=eee.bind(e),e.onTouchEnd=tee.bind(e),e.onDocumentTouchStart=oee.bind(e),t.cssMode&&(e.onScroll=ree.bind(e)),e.onClick=iee.bind(e),e.onLoad=see.bind(e),aee(e,"on")},detachEvents:function(){aee(this,"off")}};const cee=(e,t)=>e.grid&&t.grid&&t.grid.rows>1;var uee={setBreakpoint:function(){const e=this,{realIndex:t,initialized:n,params:i,el:r}=e,s=i.breakpoints;if(!s||s&&0===Object.keys(s).length)return;const o=e.getBreakpoint(s,e.params.breakpointsBase,e.el);if(!o||e.currentBreakpoint===o)return;const a=(o in s?s[o]:void 0)||e.originalParams,l=cee(e,i),c=cee(e,a),u=e.params.grabCursor,h=a.grabCursor,d=i.enabled;l&&!c?(r.classList.remove("".concat(i.containerModifierClass,"grid"),"".concat(i.containerModifierClass,"grid-column")),e.emitContainerClasses()):!l&&c&&(r.classList.add("".concat(i.containerModifierClass,"grid")),(a.grid.fill&&"column"===a.grid.fill||!a.grid.fill&&"column"===i.grid.fill)&&r.classList.add("".concat(i.containerModifierClass,"grid-column")),e.emitContainerClasses()),u&&!h?e.unsetGrabCursor():!u&&h&&e.setGrabCursor(),["navigation","pagination","scrollbar"].forEach((t=>{if("undefined"===typeof a[t])return;const n=i[t]&&i[t].enabled,r=a[t]&&a[t].enabled;n&&!r&&e[t].disable(),!n&&r&&e[t].enable()}));const p=a.direction&&a.direction!==i.direction,A=i.loop&&(a.slidesPerView!==i.slidesPerView||p),f=i.loop;p&&n&&e.changeDirection(),_9(e.params,a);const m=e.params.enabled,g=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),d&&!m?e.disable():!d&&m&&e.enable(),e.currentBreakpoint=o,e.emit("_beforeBreakpoint",a),n&&(A?(e.loopDestroy(),e.loopCreate(t),e.updateSlides()):!f&&g?(e.loopCreate(t),e.updateSlides()):f&&!g&&e.loopDestroy()),e.emit("breakpoint",a)},getBreakpoint:function(e,t,n){if(void 0===t&&(t="window"),!e||"container"===t&&!n)return;let i=!1;const r=g9(),s="window"===t?r.innerHeight:n.clientHeight,o=Object.keys(e).map((e=>{if("string"===typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:s*t,point:e}}return{value:e,point:e}}));o.sort(((e,t)=>parseInt(e.value,10)-parseInt(t.value,10)));for(let a=0;a<o.length;a+=1){const{point:e,value:s}=o[a];"window"===t?r.matchMedia("(min-width: ".concat(s,"px)")).matches&&(i=e):s<=n.clientWidth&&(i=e)}return i||"max"}};var hee={addClasses:function(){const e=this,{classNames:t,params:n,rtl:i,el:r,device:s}=e,o=function(e,t){const n=[];return e.forEach((e=>{"object"===typeof e?Object.keys(e).forEach((i=>{e[i]&&n.push(t+i)})):"string"===typeof e&&n.push(t+e)})),n}(["initialized",n.direction,{"free-mode":e.params.freeMode&&n.freeMode.enabled},{autoheight:n.autoHeight},{rtl:i},{grid:n.grid&&n.grid.rows>1},{"grid-column":n.grid&&n.grid.rows>1&&"column"===n.grid.fill},{android:s.android},{ios:s.ios},{"css-mode":n.cssMode},{centered:n.cssMode&&n.centeredSlides},{"watch-progress":n.watchSlidesProgress}],n.containerModifierClass);t.push(...o),r.classList.add(...t),e.emitContainerClasses()},removeClasses:function(){const{el:e,classNames:t}=this;e&&"string"!==typeof e&&(e.classList.remove(...t),this.emitContainerClasses())}};var dee={checkOverflow:function(){const e=this,{isLocked:t,params:n}=e,{slidesOffsetBefore:i}=n;if(i){const t=e.slides.length-1,n=e.slidesGrid[t]+e.slidesSizesGrid[t]+2*i;e.isLocked=e.size>n}else e.isLocked=1===e.snapGrid.length;!0===n.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===n.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},pee={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function Aee(e,t){return function(n){void 0===n&&(n={});const i=Object.keys(n)[0],r=n[i];"object"===typeof r&&null!==r?(!0===e[i]&&(e[i]={enabled:!0}),"navigation"===i&&e[i]&&e[i].enabled&&!e[i].prevEl&&!e[i].nextEl&&(e[i].auto=!0),["pagination","scrollbar"].indexOf(i)>=0&&e[i]&&e[i].enabled&&!e[i].el&&(e[i].auto=!0),i in e&&"enabled"in r?("object"!==typeof e[i]||"enabled"in e[i]||(e[i].enabled=!0),e[i]||(e[i]={enabled:!1}),_9(t,n)):_9(t,n)):_9(t,n)}}const fee={eventsEmitter:U9,update:H9,translate:W9,transition:Y9,slide:Q9,loop:K9,grabCursor:Z9,events:lee,breakpoints:uee,checkOverflow:dee,classes:hee},mee={};class gee{constructor(){let e,t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];1===i.length&&i[0].constructor&&"Object"===Object.prototype.toString.call(i[0]).slice(8,-1)?t=i[0]:[e,t]=i,t||(t={}),t=_9({},t),e&&!t.el&&(t.el=e);const s=f9();if(t.el&&"string"===typeof t.el&&s.querySelectorAll(t.el).length>1){const e=[];return s.querySelectorAll(t.el).forEach((n=>{const i=_9({},t,{el:n});e.push(new gee(i))})),e}const o=this;o.__swiper__=!0,o.support=k9(),o.device=B9({userAgent:t.userAgent}),o.browser=F9(),o.eventsListeners={},o.eventsAnyListeners=[],o.modules=[...o.__modules__],t.modules&&Array.isArray(t.modules)&&o.modules.push(...t.modules);const a={};o.modules.forEach((e=>{e({params:t,swiper:o,extendParams:Aee(t,a),on:o.on.bind(o),once:o.once.bind(o),off:o.off.bind(o),emit:o.emit.bind(o)})}));const l=_9({},pee,a);return o.params=_9({},l,mee,t),o.originalParams=_9({},o.params),o.passedParams=_9({},t),o.params&&o.params.on&&Object.keys(o.params.on).forEach((e=>{o.on(e,o.params.on[e])})),o.params&&o.params.onAny&&o.onAny(o.params.onAny),Object.assign(o,{enabled:o.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===o.params.direction,isVertical:()=>"vertical"===o.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:o.params.allowSlideNext,allowSlidePrev:o.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:o.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:o.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),o.emit("_swiper"),o.params.init&&o.init(),o}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:t,params:n}=this,i=R9(T9(t,".".concat(n.slideClass,", swiper-slide"))[0]);return R9(e)-i}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0])}recalcSlides(){const{slidesEl:e,params:t}=this;this.slides=T9(e,".".concat(t.slideClass,", swiper-slide"))}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const n=this;e=Math.min(Math.max(e,0),1);const i=n.minTranslate(),r=(n.maxTranslate()-i)*e+i;n.translateTo(r,"undefined"===typeof t?0:t),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter((t=>0===t.indexOf("swiper")||0===t.indexOf(e.params.containerModifierClass)));e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter((e=>0===e.indexOf("swiper-slide")||0===e.indexOf(t.params.slideClass))).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach((n=>{const i=e.getSlideClasses(n);t.push({slideEl:n,classNames:i}),e.emit("_slideClass",n,i)})),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){void 0===e&&(e="current"),void 0===t&&(t=!1);const{params:n,slides:i,slidesGrid:r,slidesSizesGrid:s,size:o,activeIndex:a}=this;let l=1;if("number"===typeof n.slidesPerView)return n.slidesPerView;if(n.centeredSlides){let e,t=i[a]?Math.ceil(i[a].swiperSlideSize):0;for(let n=a+1;n<i.length;n+=1)i[n]&&!e&&(t+=Math.ceil(i[n].swiperSlideSize),l+=1,t>o&&(e=!0));for(let n=a-1;n>=0;n-=1)i[n]&&!e&&(t+=i[n].swiperSlideSize,l+=1,t>o&&(e=!0))}else if("current"===e)for(let c=a+1;c<i.length;c+=1){(t?r[c]+s[c]-r[a]<o:r[c]-r[a]<o)&&(l+=1)}else for(let c=a-1;c>=0;c-=1){r[a]-r[c]<o&&(l+=1)}return l}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:n}=e;function i(){const t=e.rtlTranslate?-1*e.translate:e.translate,n=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(n),e.updateActiveIndex(),e.updateSlidesClasses()}let r;if(n.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach((t=>{t.complete&&V9(e,t)})),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),n.freeMode&&n.freeMode.enabled&&!n.cssMode)i(),n.autoHeight&&e.updateAutoHeight();else{if(("auto"===n.slidesPerView||n.slidesPerView>1)&&e.isEnd&&!n.centeredSlides){const t=e.virtual&&n.virtual.enabled?e.virtual.slides:e.slides;r=e.slideTo(t.length-1,0,!1,!0)}else r=e.slideTo(e.activeIndex,0,!1,!0);r||i()}n.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){void 0===t&&(t=!0);const n=this,i=n.params.direction;return e||(e="horizontal"===i?"vertical":"horizontal"),e===i||"horizontal"!==e&&"vertical"!==e||(n.el.classList.remove("".concat(n.params.containerModifierClass).concat(i)),n.el.classList.add("".concat(n.params.containerModifierClass).concat(e)),n.emitContainerClasses(),n.params.direction=e,n.slides.forEach((t=>{"vertical"===e?t.style.width="":t.style.height=""})),n.emit("changeDirection"),t&&n.update()),n}changeLanguageDirection(e){const t=this;t.rtl&&"rtl"===e||!t.rtl&&"ltr"===e||(t.rtl="rtl"===e,t.rtlTranslate="horizontal"===t.params.direction&&t.rtl,t.rtl?(t.el.classList.add("".concat(t.params.containerModifierClass,"rtl")),t.el.dir="rtl"):(t.el.classList.remove("".concat(t.params.containerModifierClass,"rtl")),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let n=e||t.params.el;if("string"===typeof n&&(n=document.querySelector(n)),!n)return!1;n.swiper=t,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);const i=()=>".".concat((t.params.wrapperClass||"").trim().split(" ").join("."));let r=(()=>{if(n&&n.shadowRoot&&n.shadowRoot.querySelector){return n.shadowRoot.querySelector(i())}return T9(n,i())[0]})();return!r&&t.params.createElements&&(r=E9("div",t.params.wrapperClass),n.append(r),T9(n,".".concat(t.params.slideClass)).forEach((e=>{r.append(e)}))),Object.assign(t,{el:n,wrapperEl:r,slidesEl:t.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:r,hostEl:t.isElement?n.parentNode.host:n,mounted:!0,rtl:"rtl"===n.dir.toLowerCase()||"rtl"===C9(n,"direction"),rtlTranslate:"horizontal"===t.params.direction&&("rtl"===n.dir.toLowerCase()||"rtl"===C9(n,"direction")),wrongRTL:"-webkit-box"===C9(r,"display")}),!0}init(e){const t=this;if(t.initialized)return t;if(!1===t.mount(e))return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();const n=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&n.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),n.forEach((e=>{e.complete?V9(t,e):e.addEventListener("load",(e=>{V9(t,e.target)}))})),j9(t),t.initialized=!0,j9(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);const n=this,{params:i,el:r,wrapperEl:s,slides:o}=n;return"undefined"===typeof n.params||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),i.loop&&n.loopDestroy(),t&&(n.removeClasses(),r&&"string"!==typeof r&&r.removeAttribute("style"),s&&s.removeAttribute("style"),o&&o.length&&o.forEach((e=>{e.classList.remove(i.slideVisibleClass,i.slideFullyVisibleClass,i.slideActiveClass,i.slideNextClass,i.slidePrevClass),e.removeAttribute("style"),e.removeAttribute("data-swiper-slide-index")}))),n.emit("destroy"),Object.keys(n.eventsListeners).forEach((e=>{n.off(e)})),!1!==e&&(n.el&&"string"!==typeof n.el&&(n.el.swiper=null),function(e){const t=e;Object.keys(t).forEach((e=>{try{t[e]=null}catch(n){}try{delete t[e]}catch(n){}}))}(n)),n.destroyed=!0),null}static extendDefaults(e){_9(mee,e)}static get extendedDefaults(){return mee}static get defaults(){return pee}static installModule(e){gee.prototype.__modules__||(gee.prototype.__modules__=[]);const t=gee.prototype.__modules__;"function"===typeof e&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach((e=>gee.installModule(e))),gee):(gee.installModule(e),gee)}}Object.keys(fee).forEach((e=>{Object.keys(fee[e]).forEach((t=>{gee.prototype[t]=fee[e][t]}))})),gee.use([function(e){let{swiper:t,on:n,emit:i}=e;const r=g9();let s=null,o=null;const a=()=>{t&&!t.destroyed&&t.initialized&&(i("beforeResize"),i("resize"))},l=()=>{t&&!t.destroyed&&t.initialized&&i("orientationchange")};n("init",(()=>{t.params.resizeObserver&&"undefined"!==typeof r.ResizeObserver?t&&!t.destroyed&&t.initialized&&(s=new ResizeObserver((e=>{o=r.requestAnimationFrame((()=>{const{width:n,height:i}=t;let r=n,s=i;e.forEach((e=>{let{contentBoxSize:n,contentRect:i,target:o}=e;o&&o!==t.el||(r=i?i.width:(n[0]||n).inlineSize,s=i?i.height:(n[0]||n).blockSize)})),r===n&&s===i||a()}))})),s.observe(t.el)):(r.addEventListener("resize",a),r.addEventListener("orientationchange",l))})),n("destroy",(()=>{o&&r.cancelAnimationFrame(o),s&&s.unobserve&&t.el&&(s.unobserve(t.el),s=null),r.removeEventListener("resize",a),r.removeEventListener("orientationchange",l)}))},function(e){let{swiper:t,extendParams:n,on:i,emit:r}=e;const s=[],o=g9(),a=function(e,n){void 0===n&&(n={});const i=new(o.MutationObserver||o.WebkitMutationObserver)((e=>{if(t.__preventObserver__)return;if(1===e.length)return void r("observerUpdate",e[0]);const n=function(){r("observerUpdate",e[0])};o.requestAnimationFrame?o.requestAnimationFrame(n):o.setTimeout(n,0)}));i.observe(e,{attributes:"undefined"===typeof n.attributes||n.attributes,childList:t.isElement||("undefined"===typeof n.childList||n).childList,characterData:"undefined"===typeof n.characterData||n.characterData}),s.push(i)};n({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",(()=>{if(t.params.observer){if(t.params.observeParents){const e=P9(t.hostEl);for(let t=0;t<e.length;t+=1)a(e[t])}a(t.hostEl,{childList:t.params.observeSlideChildren}),a(t.wrapperEl,{attributes:!1})}})),i("destroy",(()=>{s.forEach((e=>{e.disconnect()})),s.splice(0,s.length)}))}]);const vee=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function yee(e){return"object"===typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)&&!e.__swiper__}function bee(e,t){const n=["__proto__","constructor","prototype"];Object.keys(t).filter((e=>n.indexOf(e)<0)).forEach((n=>{"undefined"===typeof e[n]?e[n]=t[n]:yee(t[n])&&yee(e[n])&&Object.keys(t[n]).length>0?t[n].__swiper__?e[n]=t[n]:bee(e[n],t[n]):e[n]=t[n]}))}function xee(e){return void 0===e&&(e={}),e.navigation&&"undefined"===typeof e.navigation.nextEl&&"undefined"===typeof e.navigation.prevEl}function _ee(e){return void 0===e&&(e={}),e.pagination&&"undefined"===typeof e.pagination.el}function wee(e){return void 0===e&&(e={}),e.scrollbar&&"undefined"===typeof e.scrollbar.el}function See(e){void 0===e&&(e="");const t=e.split(" ").map((e=>e.trim())).filter((e=>!!e)),n=[];return t.forEach((e=>{n.indexOf(e)<0&&n.push(e)})),n.join(" ")}function Tee(e){return void 0===e&&(e=""),e?e.includes("swiper-wrapper")?e:"swiper-wrapper ".concat(e):"swiper-wrapper"}const Mee=["className","tag","wrapperTag","children","onSwiper"],Eee=["tag","children","className","swiper","zoom","lazy","virtualIndex","swiperSlideIndex"];function Cee(){return Cee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Cee.apply(this,arguments)}function Ree(e){return e.type&&e.type.displayName&&e.type.displayName.includes("SwiperSlide")}function Pee(e){const n=[];return t.Children.toArray(e).forEach((e=>{Ree(e)?n.push(e):e.props&&e.props.children&&Pee(e.props.children).forEach((e=>n.push(e)))})),n}function Nee(e){const n=[],i={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return t.Children.toArray(e).forEach((e=>{if(Ree(e))n.push(e);else if(e.props&&e.props.slot&&i[e.props.slot])i[e.props.slot].push(e);else if(e.props&&e.props.children){const t=Pee(e.props.children);t.length>0?t.forEach((e=>n.push(e))):i["container-end"].push(e)}else i["container-end"].push(e)})),{slides:n,slots:i}}function Dee(e,n){return"undefined"===typeof window?(0,t.useEffect)(e,n):(0,t.useLayoutEffect)(e,n)}const Lee=(0,t.createContext)(null),Iee=(0,t.createContext)(null),Oee=(0,t.forwardRef)((function(e,n){let i=void 0===e?{}:e,{className:r,tag:s="div",wrapperTag:o="div",children:a,onSwiper:l}=i,c=C(i,Mee),u=!1;const[h,d]=(0,t.useState)("swiper"),[p,A]=(0,t.useState)(null),[f,m]=(0,t.useState)(!1),g=(0,t.useRef)(!1),v=(0,t.useRef)(null),y=(0,t.useRef)(null),b=(0,t.useRef)(null),x=(0,t.useRef)(null),_=(0,t.useRef)(null),w=(0,t.useRef)(null),S=(0,t.useRef)(null),T=(0,t.useRef)(null),{params:E,passedParams:R,rest:P,events:N}=function(e,t){void 0===e&&(e={}),void 0===t&&(t=!0);const n={on:{}},i={},r={};bee(n,pee),n._emitClasses=!0,n.init=!1;const s={},o=vee.map((e=>e.replace(/_/,""))),a=Object.assign({},e);return Object.keys(a).forEach((a=>{"undefined"!==typeof e[a]&&(o.indexOf(a)>=0?yee(e[a])?(n[a]={},r[a]={},bee(n[a],e[a]),bee(r[a],e[a])):(n[a]=e[a],r[a]=e[a]):0===a.search(/on[A-Z]/)&&"function"===typeof e[a]?t?i["".concat(a[2].toLowerCase()).concat(a.substr(3))]=e[a]:n.on["".concat(a[2].toLowerCase()).concat(a.substr(3))]=e[a]:s[a]=e[a])})),["navigation","pagination","scrollbar"].forEach((e=>{!0===n[e]&&(n[e]={}),!1===n[e]&&delete n[e]})),{params:n,passedParams:r,rest:s,events:i}}(c),{slides:D,slots:L}=Nee(a),I=()=>{m(!f)};Object.assign(E.on,{_containerClasses(e,t){d(t)}});const O=()=>{Object.assign(E.on,N),u=!0;const e=M({},E);if(delete e.wrapperClass,y.current=new gee(e),y.current.virtual&&y.current.params.virtual.enabled){y.current.virtual.slides=D;const e={cache:!1,slides:D,renderExternal:A,renderExternalUpdate:!1};bee(y.current.params.virtual,e),bee(y.current.originalParams.virtual,e)}};v.current||O(),y.current&&y.current.on("_beforeBreakpoint",I);return(0,t.useEffect)((()=>()=>{y.current&&y.current.off("_beforeBreakpoint",I)})),(0,t.useEffect)((()=>{!g.current&&y.current&&(y.current.emitSlidesClasses(),g.current=!0)})),Dee((()=>{if(n&&(n.current=v.current),v.current)return y.current.destroyed&&O(),function(e,t){let{el:n,nextEl:i,prevEl:r,paginationEl:s,scrollbarEl:o,swiper:a}=e;xee(t)&&i&&r&&(a.params.navigation.nextEl=i,a.originalParams.navigation.nextEl=i,a.params.navigation.prevEl=r,a.originalParams.navigation.prevEl=r),_ee(t)&&s&&(a.params.pagination.el=s,a.originalParams.pagination.el=s),wee(t)&&o&&(a.params.scrollbar.el=o,a.originalParams.scrollbar.el=o),a.init(n)}({el:v.current,nextEl:_.current,prevEl:w.current,paginationEl:S.current,scrollbarEl:T.current,swiper:y.current},E),l&&!y.current.destroyed&&l(y.current),()=>{y.current&&!y.current.destroyed&&y.current.destroy(!0,!1)}}),[]),Dee((()=>{!u&&N&&y.current&&Object.keys(N).forEach((e=>{y.current.on(e,N[e])}));const e=function(e,t,n,i,r){const s=[];if(!t)return s;const o=e=>{s.indexOf(e)<0&&s.push(e)};if(n&&i){const e=i.map(r),t=n.map(r);e.join("")!==t.join("")&&o("children"),i.length!==n.length&&o("children")}return vee.filter((e=>"_"===e[0])).map((e=>e.replace(/_/,""))).forEach((n=>{if(n in e&&n in t)if(yee(e[n])&&yee(t[n])){const i=Object.keys(e[n]),r=Object.keys(t[n]);i.length!==r.length?o(n):(i.forEach((i=>{e[n][i]!==t[n][i]&&o(n)})),r.forEach((i=>{e[n][i]!==t[n][i]&&o(n)})))}else e[n]!==t[n]&&o(n)})),s}(R,b.current,D,x.current,(e=>e.key));return b.current=R,x.current=D,e.length&&y.current&&!y.current.destroyed&&function(e){let{swiper:t,slides:n,passedParams:i,changedParams:r,nextEl:s,prevEl:o,scrollbarEl:a,paginationEl:l}=e;const c=r.filter((e=>"children"!==e&&"direction"!==e&&"wrapperClass"!==e)),{params:u,pagination:h,navigation:d,scrollbar:p,virtual:A,thumbs:f}=t;let m,g,v,y,b,x,_,w;r.includes("thumbs")&&i.thumbs&&i.thumbs.swiper&&!i.thumbs.swiper.destroyed&&u.thumbs&&(!u.thumbs.swiper||u.thumbs.swiper.destroyed)&&(m=!0),r.includes("controller")&&i.controller&&i.controller.control&&u.controller&&!u.controller.control&&(g=!0),r.includes("pagination")&&i.pagination&&(i.pagination.el||l)&&(u.pagination||!1===u.pagination)&&h&&!h.el&&(v=!0),r.includes("scrollbar")&&i.scrollbar&&(i.scrollbar.el||a)&&(u.scrollbar||!1===u.scrollbar)&&p&&!p.el&&(y=!0),r.includes("navigation")&&i.navigation&&(i.navigation.prevEl||o)&&(i.navigation.nextEl||s)&&(u.navigation||!1===u.navigation)&&d&&!d.prevEl&&!d.nextEl&&(b=!0);const S=e=>{t[e]&&(t[e].destroy(),"navigation"===e?(t.isElement&&(t[e].prevEl.remove(),t[e].nextEl.remove()),u[e].prevEl=void 0,u[e].nextEl=void 0,t[e].prevEl=void 0,t[e].nextEl=void 0):(t.isElement&&t[e].el.remove(),u[e].el=void 0,t[e].el=void 0))};r.includes("loop")&&t.isElement&&(u.loop&&!i.loop?x=!0:!u.loop&&i.loop?_=!0:w=!0),c.forEach((e=>{if(yee(u[e])&&yee(i[e]))Object.assign(u[e],i[e]),"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e||!("enabled"in i[e])||i[e].enabled||S(e);else{const t=i[e];!0!==t&&!1!==t||"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e?u[e]=i[e]:!1===t&&S(e)}})),c.includes("controller")&&!g&&t.controller&&t.controller.control&&u.controller&&u.controller.control&&(t.controller.control=u.controller.control),r.includes("children")&&n&&A&&u.virtual.enabled?(A.slides=n,A.update(!0)):r.includes("virtual")&&A&&u.virtual.enabled&&(n&&(A.slides=n),A.update(!0)),r.includes("children")&&n&&u.loop&&(w=!0),m&&f.init()&&f.update(!0);g&&(t.controller.control=u.controller.control),v&&(!t.isElement||l&&"string"!==typeof l||(l=document.createElement("div"),l.classList.add("swiper-pagination"),l.part.add("pagination"),t.el.appendChild(l)),l&&(u.pagination.el=l),h.init(),h.render(),h.update()),y&&(!t.isElement||a&&"string"!==typeof a||(a=document.createElement("div"),a.classList.add("swiper-scrollbar"),a.part.add("scrollbar"),t.el.appendChild(a)),a&&(u.scrollbar.el=a),p.init(),p.updateSize(),p.setTranslate()),b&&(t.isElement&&(s&&"string"!==typeof s||(s=document.createElement("div"),s.classList.add("swiper-button-next"),s.innerHTML=t.hostEl.constructor.nextButtonSvg,s.part.add("button-next"),t.el.appendChild(s)),o&&"string"!==typeof o||(o=document.createElement("div"),o.classList.add("swiper-button-prev"),o.innerHTML=t.hostEl.constructor.prevButtonSvg,o.part.add("button-prev"),t.el.appendChild(o))),s&&(u.navigation.nextEl=s),o&&(u.navigation.prevEl=o),d.init(),d.update()),r.includes("allowSlideNext")&&(t.allowSlideNext=i.allowSlideNext),r.includes("allowSlidePrev")&&(t.allowSlidePrev=i.allowSlidePrev),r.includes("direction")&&t.changeDirection(i.direction,!1),(x||w)&&t.loopDestroy(),(_||w)&&t.loopCreate(),t.update()}({swiper:y.current,slides:D,passedParams:R,changedParams:e,nextEl:_.current,prevEl:w.current,scrollbarEl:T.current,paginationEl:S.current}),()=>{N&&y.current&&Object.keys(N).forEach((e=>{y.current.off(e,N[e])}))}})),Dee((()=>{(e=>{!e||e.destroyed||!e.params.virtual||e.params.virtual&&!e.params.virtual.enabled||(e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.parallax&&e.params.parallax&&e.params.parallax.enabled&&e.parallax.setTranslate())})(y.current)}),[p]),t.createElement(s,Cee({ref:v,className:See("".concat(h).concat(r?" ".concat(r):""))},P),t.createElement(Iee.Provider,{value:y.current},L["container-start"],t.createElement(o,{className:Tee(E.wrapperClass)},L["wrapper-start"],E.virtual?function(e,n,i){if(!i)return null;const r=e=>{let t=e;return e<0?t=n.length+e:t>=n.length&&(t-=n.length),t},s=e.isHorizontal()?{[e.rtlTranslate?"right":"left"]:"".concat(i.offset,"px")}:{top:"".concat(i.offset,"px")},{from:o,to:a}=i,l=e.params.loop?-n.length:0,c=e.params.loop?2*n.length:n.length,u=[];for(let t=l;t<c;t+=1)t>=o&&t<=a&&u.push(n[r(t)]);return u.map(((n,i)=>t.cloneElement(n,{swiper:e,style:s,key:n.props.virtualIndex||n.key||"slide-".concat(i)})))}(y.current,D,p):D.map(((e,n)=>t.cloneElement(e,{swiper:y.current,swiperSlideIndex:n}))),L["wrapper-end"]),xee(E)&&t.createElement(t.Fragment,null,t.createElement("div",{ref:w,className:"swiper-button-prev"}),t.createElement("div",{ref:_,className:"swiper-button-next"})),wee(E)&&t.createElement("div",{ref:T,className:"swiper-scrollbar"}),_ee(E)&&t.createElement("div",{ref:S,className:"swiper-pagination"}),L["container-end"]))}));Oee.displayName="Swiper";const kee=(0,t.forwardRef)((function(e,n){let i=void 0===e?{}:e,{tag:r="div",children:s,className:o="",swiper:a,zoom:l,lazy:c,virtualIndex:u,swiperSlideIndex:h}=i,d=C(i,Eee);const p=(0,t.useRef)(null),[A,f]=(0,t.useState)("swiper-slide"),[m,g]=(0,t.useState)(!1);function v(e,t,n){t===p.current&&f(n)}Dee((()=>{if("undefined"!==typeof h&&(p.current.swiperSlideIndex=h),n&&(n.current=p.current),p.current&&a){if(!a.destroyed)return a.on("_slideClass",v),()=>{a&&a.off("_slideClass",v)};"swiper-slide"!==A&&f("swiper-slide")}})),Dee((()=>{a&&p.current&&!a.destroyed&&f(a.getSlideClasses(p.current))}),[a]);const y={isActive:A.indexOf("swiper-slide-active")>=0,isVisible:A.indexOf("swiper-slide-visible")>=0,isPrev:A.indexOf("swiper-slide-prev")>=0,isNext:A.indexOf("swiper-slide-next")>=0},b=()=>"function"===typeof s?s(y):s;return t.createElement(r,Cee({ref:p,className:See("".concat(A).concat(o?" ".concat(o):"")),"data-swiper-slide-index":u,onLoad:()=>{g(!0)}},d),l&&t.createElement(Lee.Provider,{value:y},t.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":"number"===typeof l?l:void 0},b(),c&&!m&&t.createElement("div",{className:"swiper-lazy-preloader"}))),!l&&t.createElement(Lee.Provider,{value:y},b(),c&&!m&&t.createElement("div",{className:"swiper-lazy-preloader"})))}));function Bee(e,t,n,i){return e.params.createElements&&Object.keys(i).forEach((r=>{if(!n[r]&&!0===n.auto){let s=T9(e.el,".".concat(i[r]))[0];s||(s=E9("div",i[r]),s.className=i[r],e.el.append(s)),n[r]=s,t[r]=s}})),n}function Fee(e){let{swiper:t,extendParams:n,on:i,emit:r}=e;function s(e){let n;return e&&"string"===typeof e&&t.isElement&&(n=t.el.querySelector(e)||t.hostEl.querySelector(e),n)?n:(e&&("string"===typeof e&&(n=[...document.querySelectorAll(e)]),t.params.uniqueNavElements&&"string"===typeof e&&n&&n.length>1&&1===t.el.querySelectorAll(e).length?n=t.el.querySelector(e):n&&1===n.length&&(n=n[0])),e&&!n?e:n)}function o(e,n){const i=t.params.navigation;(e=D9(e)).forEach((e=>{e&&(e.classList[n?"add":"remove"](...i.disabledClass.split(" ")),"BUTTON"===e.tagName&&(e.disabled=n),t.params.watchOverflow&&t.enabled&&e.classList[t.isLocked?"add":"remove"](i.lockClass))}))}function a(){const{nextEl:e,prevEl:n}=t.navigation;if(t.params.loop)return o(n,!1),void o(e,!1);o(n,t.isBeginning&&!t.params.rewind),o(e,t.isEnd&&!t.params.rewind)}function l(e){e.preventDefault(),(!t.isBeginning||t.params.loop||t.params.rewind)&&(t.slidePrev(),r("navigationPrev"))}function c(e){e.preventDefault(),(!t.isEnd||t.params.loop||t.params.rewind)&&(t.slideNext(),r("navigationNext"))}function u(){const e=t.params.navigation;if(t.params.navigation=Bee(t,t.originalParams.navigation,t.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!e.nextEl&&!e.prevEl)return;let n=s(e.nextEl),i=s(e.prevEl);Object.assign(t.navigation,{nextEl:n,prevEl:i}),n=D9(n),i=D9(i);const r=(n,i)=>{n&&n.addEventListener("click","next"===i?c:l),!t.enabled&&n&&n.classList.add(...e.lockClass.split(" "))};n.forEach((e=>r(e,"next"))),i.forEach((e=>r(e,"prev")))}function h(){let{nextEl:e,prevEl:n}=t.navigation;e=D9(e),n=D9(n);const i=(e,n)=>{e.removeEventListener("click","next"===n?c:l),e.classList.remove(...t.params.navigation.disabledClass.split(" "))};e.forEach((e=>i(e,"next"))),n.forEach((e=>i(e,"prev")))}n({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),t.navigation={nextEl:null,prevEl:null},i("init",(()=>{!1===t.params.navigation.enabled?d():(u(),a())})),i("toEdge fromEdge lock unlock",(()=>{a()})),i("destroy",(()=>{h()})),i("enable disable",(()=>{let{nextEl:e,prevEl:n}=t.navigation;e=D9(e),n=D9(n),t.enabled?a():[...e,...n].filter((e=>!!e)).forEach((e=>e.classList.add(t.params.navigation.lockClass)))})),i("click",((e,n)=>{let{nextEl:i,prevEl:s}=t.navigation;i=D9(i),s=D9(s);const o=n.target;let a=s.includes(o)||i.includes(o);if(t.isElement&&!a){const e=n.path||n.composedPath&&n.composedPath();e&&(a=e.find((e=>i.includes(e)||s.includes(e))))}if(t.params.navigation.hideOnClick&&!a){if(t.pagination&&t.params.pagination&&t.params.pagination.clickable&&(t.pagination.el===o||t.pagination.el.contains(o)))return;let e;i.length?e=i[0].classList.contains(t.params.navigation.hiddenClass):s.length&&(e=s[0].classList.contains(t.params.navigation.hiddenClass)),r(!0===e?"navigationShow":"navigationHide"),[...i,...s].filter((e=>!!e)).forEach((e=>e.classList.toggle(t.params.navigation.hiddenClass)))}}));const d=()=>{t.el.classList.add(...t.params.navigation.navigationDisabledClass.split(" ")),h()};Object.assign(t.navigation,{enable:()=>{t.el.classList.remove(...t.params.navigation.navigationDisabledClass.split(" ")),u(),a()},disable:d,update:a,init:u,destroy:h})}function Uee(e){return void 0===e&&(e=""),".".concat(e.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,"."))}function zee(e){let{swiper:t,extendParams:n,on:i,emit:r}=e;const s="swiper-pagination";let o;n({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:e=>e,formatFractionTotal:e=>e,bulletClass:"".concat(s,"-bullet"),bulletActiveClass:"".concat(s,"-bullet-active"),modifierClass:"".concat(s,"-"),currentClass:"".concat(s,"-current"),totalClass:"".concat(s,"-total"),hiddenClass:"".concat(s,"-hidden"),progressbarFillClass:"".concat(s,"-progressbar-fill"),progressbarOppositeClass:"".concat(s,"-progressbar-opposite"),clickableClass:"".concat(s,"-clickable"),lockClass:"".concat(s,"-lock"),horizontalClass:"".concat(s,"-horizontal"),verticalClass:"".concat(s,"-vertical"),paginationDisabledClass:"".concat(s,"-disabled")}}),t.pagination={el:null,bullets:[]};let a=0;function l(){return!t.params.pagination.el||!t.pagination.el||Array.isArray(t.pagination.el)&&0===t.pagination.el.length}function c(e,n){const{bulletActiveClass:i}=t.params.pagination;e&&(e=e["".concat("prev"===n?"previous":"next","ElementSibling")])&&(e.classList.add("".concat(i,"-").concat(n)),(e=e["".concat("prev"===n?"previous":"next","ElementSibling")])&&e.classList.add("".concat(i,"-").concat(n,"-").concat(n)))}function u(e){const n=e.target.closest(Uee(t.params.pagination.bulletClass));if(!n)return;e.preventDefault();const i=R9(n)*t.params.slidesPerGroup;if(t.params.loop){if(t.realIndex===i)return;const e=(r=t.realIndex,s=i,o=t.slides.length,(s%=o)===1+(r%=o)?"next":s===r-1?"previous":void 0);"next"===e?t.slideNext():"previous"===e?t.slidePrev():t.slideToLoop(i)}else t.slideTo(i);var r,s,o}function h(){const e=t.rtl,n=t.params.pagination;if(l())return;let i,s,u=t.pagination.el;u=D9(u);const h=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.slides.length,d=t.params.loop?Math.ceil(h/t.params.slidesPerGroup):t.snapGrid.length;if(t.params.loop?(s=t.previousRealIndex||0,i=t.params.slidesPerGroup>1?Math.floor(t.realIndex/t.params.slidesPerGroup):t.realIndex):"undefined"!==typeof t.snapIndex?(i=t.snapIndex,s=t.previousSnapIndex):(s=t.previousIndex||0,i=t.activeIndex||0),"bullets"===n.type&&t.pagination.bullets&&t.pagination.bullets.length>0){const r=t.pagination.bullets;let l,h,d;if(n.dynamicBullets&&(o=N9(r[0],t.isHorizontal()?"width":"height",!0),u.forEach((e=>{e.style[t.isHorizontal()?"width":"height"]="".concat(o*(n.dynamicMainBullets+4),"px")})),n.dynamicMainBullets>1&&void 0!==s&&(a+=i-(s||0),a>n.dynamicMainBullets-1?a=n.dynamicMainBullets-1:a<0&&(a=0)),l=Math.max(i-a,0),h=l+(Math.min(r.length,n.dynamicMainBullets)-1),d=(h+l)/2),r.forEach((e=>{const t=[...["","-next","-next-next","-prev","-prev-prev","-main"].map((e=>"".concat(n.bulletActiveClass).concat(e)))].map((e=>"string"===typeof e&&e.includes(" ")?e.split(" "):e)).flat();e.classList.remove(...t)})),u.length>1)r.forEach((e=>{const r=R9(e);r===i?e.classList.add(...n.bulletActiveClass.split(" ")):t.isElement&&e.setAttribute("part","bullet"),n.dynamicBullets&&(r>=l&&r<=h&&e.classList.add(..."".concat(n.bulletActiveClass,"-main").split(" ")),r===l&&c(e,"prev"),r===h&&c(e,"next"))}));else{const e=r[i];if(e&&e.classList.add(...n.bulletActiveClass.split(" ")),t.isElement&&r.forEach(((e,t)=>{e.setAttribute("part",t===i?"bullet-active":"bullet")})),n.dynamicBullets){const e=r[l],t=r[h];for(let i=l;i<=h;i+=1)r[i]&&r[i].classList.add(..."".concat(n.bulletActiveClass,"-main").split(" "));c(e,"prev"),c(t,"next")}}if(n.dynamicBullets){const i=Math.min(r.length,n.dynamicMainBullets+4),s=(o*i-o)/2-d*o,a=e?"right":"left";r.forEach((e=>{e.style[t.isHorizontal()?a:"top"]="".concat(s,"px")}))}}u.forEach(((e,s)=>{if("fraction"===n.type&&(e.querySelectorAll(Uee(n.currentClass)).forEach((e=>{e.textContent=n.formatFractionCurrent(i+1)})),e.querySelectorAll(Uee(n.totalClass)).forEach((e=>{e.textContent=n.formatFractionTotal(d)}))),"progressbar"===n.type){let r;r=n.progressbarOpposite?t.isHorizontal()?"vertical":"horizontal":t.isHorizontal()?"horizontal":"vertical";const s=(i+1)/d;let o=1,a=1;"horizontal"===r?o=s:a=s,e.querySelectorAll(Uee(n.progressbarFillClass)).forEach((e=>{e.style.transform="translate3d(0,0,0) scaleX(".concat(o,") scaleY(").concat(a,")"),e.style.transitionDuration="".concat(t.params.speed,"ms")}))}"custom"===n.type&&n.renderCustom?(e.innerHTML=n.renderCustom(t,i+1,d),0===s&&r("paginationRender",e)):(0===s&&r("paginationRender",e),r("paginationUpdate",e)),t.params.watchOverflow&&t.enabled&&e.classList[t.isLocked?"add":"remove"](n.lockClass)}))}function d(){const e=t.params.pagination;if(l())return;const n=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.grid&&t.params.grid.rows>1?t.slides.length/Math.ceil(t.params.grid.rows):t.slides.length;let i=t.pagination.el;i=D9(i);let s="";if("bullets"===e.type){let i=t.params.loop?Math.ceil(n/t.params.slidesPerGroup):t.snapGrid.length;t.params.freeMode&&t.params.freeMode.enabled&&i>n&&(i=n);for(let n=0;n<i;n+=1)e.renderBullet?s+=e.renderBullet.call(t,n,e.bulletClass):s+="<".concat(e.bulletElement," ").concat(t.isElement?'part="bullet"':"",' class="').concat(e.bulletClass,'"></').concat(e.bulletElement,">")}"fraction"===e.type&&(s=e.renderFraction?e.renderFraction.call(t,e.currentClass,e.totalClass):'<span class="'.concat(e.currentClass,'"></span>')+" / "+'<span class="'.concat(e.totalClass,'"></span>')),"progressbar"===e.type&&(s=e.renderProgressbar?e.renderProgressbar.call(t,e.progressbarFillClass):'<span class="'.concat(e.progressbarFillClass,'"></span>')),t.pagination.bullets=[],i.forEach((n=>{"custom"!==e.type&&(n.innerHTML=s||""),"bullets"===e.type&&t.pagination.bullets.push(...n.querySelectorAll(Uee(e.bulletClass)))})),"custom"!==e.type&&r("paginationRender",i[0])}function p(){t.params.pagination=Bee(t,t.originalParams.pagination,t.params.pagination,{el:"swiper-pagination"});const e=t.params.pagination;if(!e.el)return;let n;"string"===typeof e.el&&t.isElement&&(n=t.el.querySelector(e.el)),n||"string"!==typeof e.el||(n=[...document.querySelectorAll(e.el)]),n||(n=e.el),n&&0!==n.length&&(t.params.uniqueNavElements&&"string"===typeof e.el&&Array.isArray(n)&&n.length>1&&(n=[...t.el.querySelectorAll(e.el)],n.length>1&&(n=n.filter((e=>P9(e,".swiper")[0]===t.el))[0])),Array.isArray(n)&&1===n.length&&(n=n[0]),Object.assign(t.pagination,{el:n}),n=D9(n),n.forEach((n=>{"bullets"===e.type&&e.clickable&&n.classList.add(...(e.clickableClass||"").split(" ")),n.classList.add(e.modifierClass+e.type),n.classList.add(t.isHorizontal()?e.horizontalClass:e.verticalClass),"bullets"===e.type&&e.dynamicBullets&&(n.classList.add("".concat(e.modifierClass).concat(e.type,"-dynamic")),a=0,e.dynamicMainBullets<1&&(e.dynamicMainBullets=1)),"progressbar"===e.type&&e.progressbarOpposite&&n.classList.add(e.progressbarOppositeClass),e.clickable&&n.addEventListener("click",u),t.enabled||n.classList.add(e.lockClass)})))}function A(){const e=t.params.pagination;if(l())return;let n=t.pagination.el;n&&(n=D9(n),n.forEach((n=>{n.classList.remove(e.hiddenClass),n.classList.remove(e.modifierClass+e.type),n.classList.remove(t.isHorizontal()?e.horizontalClass:e.verticalClass),e.clickable&&(n.classList.remove(...(e.clickableClass||"").split(" ")),n.removeEventListener("click",u))}))),t.pagination.bullets&&t.pagination.bullets.forEach((t=>t.classList.remove(...e.bulletActiveClass.split(" "))))}i("changeDirection",(()=>{if(!t.pagination||!t.pagination.el)return;const e=t.params.pagination;let{el:n}=t.pagination;n=D9(n),n.forEach((n=>{n.classList.remove(e.horizontalClass,e.verticalClass),n.classList.add(t.isHorizontal()?e.horizontalClass:e.verticalClass)}))})),i("init",(()=>{!1===t.params.pagination.enabled?f():(p(),d(),h())})),i("activeIndexChange",(()=>{"undefined"===typeof t.snapIndex&&h()})),i("snapIndexChange",(()=>{h()})),i("snapGridLengthChange",(()=>{d(),h()})),i("destroy",(()=>{A()})),i("enable disable",(()=>{let{el:e}=t.pagination;e&&(e=D9(e),e.forEach((e=>e.classList[t.enabled?"remove":"add"](t.params.pagination.lockClass))))})),i("lock unlock",(()=>{h()})),i("click",((e,n)=>{const i=n.target,s=D9(t.pagination.el);if(t.params.pagination.el&&t.params.pagination.hideOnClick&&s&&s.length>0&&!i.classList.contains(t.params.pagination.bulletClass)){if(t.navigation&&(t.navigation.nextEl&&i===t.navigation.nextEl||t.navigation.prevEl&&i===t.navigation.prevEl))return;const e=s[0].classList.contains(t.params.pagination.hiddenClass);r(!0===e?"paginationShow":"paginationHide"),s.forEach((e=>e.classList.toggle(t.params.pagination.hiddenClass)))}}));const f=()=>{t.el.classList.add(t.params.pagination.paginationDisabledClass);let{el:e}=t.pagination;e&&(e=D9(e),e.forEach((e=>e.classList.add(t.params.pagination.paginationDisabledClass)))),A()};Object.assign(t.pagination,{enable:()=>{t.el.classList.remove(t.params.pagination.paginationDisabledClass);let{el:e}=t.pagination;e&&(e=D9(e),e.forEach((e=>e.classList.remove(t.params.pagination.paginationDisabledClass)))),p(),d(),h()},disable:f,render:d,update:h,init:p,destroy:A})}kee.displayName="SwiperSlide";const qee=e=>{let{slides:t}=e;return(0,r.jsx)("div",{className:"relative z-50 bg-black py-10",children:(0,r.jsx)("div",{className:"container mx-auto",children:(0,r.jsx)("div",{className:"slider-container",children:(0,r.jsx)(Oee,{modules:[Fee,zee],spaceBetween:30,slidesPerView:1,navigation:!0,pagination:{clickable:!0},children:t.map(((e,t)=>(0,r.jsx)(kee,{children:(0,r.jsxs)("div",{className:"slide-content",children:[(0,r.jsx)("img",{src:e.image,alt:e.alt||"Slide ".concat(t+1)}),e.caption&&(0,r.jsx)("p",{children:e.caption})]})},t)))})})})})},Vee=()=>(0,r.jsxs)("div",{className:"flex bg-gray-200 flex-col min-h-screen",children:[(0,r.jsxs)("div",{className:"flex-grow relative overflow-hidden",children:[(0,r.jsx)("div",{className:"relative w-full h-full overflow-hidden",children:(0,r.jsx)(L7,{})}),(0,r.jsx)(i9,{}),(0,r.jsx)(u9,{}),(0,r.jsx)(h9,{}),(0,r.jsx)(qee,{slides:[{image:"./img/1.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/2.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/3.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/5.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/6.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/7.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/8.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/9.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/10.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/11.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/12.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/13.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/14.jpg",caption:"Slide 1",alt:"First slide"},{image:"./img/15.jpg",caption:"Slide 1",alt:"First slide"}]})]}),(0,r.jsx)(I7,{})]}),Gee=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:o}=t;n(e),i(e),r(e),s(e),o(e)}))};i.createRoot(document.getElementById("root")).render((0,r.jsx)(t.StrictMode,{children:(0,r.jsx)(Vee,{})})),Gee()})()})();
//# sourceMappingURL=main.f8134872.js.map